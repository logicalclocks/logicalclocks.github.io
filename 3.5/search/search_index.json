{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"Enterprise Data Feature Engineering Frameworks Pandas Flink Spark SQL Storage connectors JDBC BigQuery Object Store Snowflake RedShift Enterprise Feature Store Govern &amp; Monitor Serve Share &amp; Re-use Create Project Based Collaboration Write API Feature Groups External Feature Groups Read API Feature Views Training Data Feature Vectors Search, Versioning, Statistics Provenance &amp; Lineage Azure AWS Google Cloud On-premise Enterprise AI MLOps Experiments &amp; Model Training Model Registry Model Serving Operational ML Analytical ML BI Tools Vector DBOpenSearch <p>Hopsworks is a data platform for ML with a Python-centric Feature Store and MLOps capabilities. Hopsworks is a modular platform. You can use it as a standalone Feature Store, you can use it to manage, govern, and serve your models, and you can even use it to develop and operate feature pipelines and training pipelines. Hopsworks brings collaboration for ML teams, providing a secure, governed platform for developing, managing, and sharing ML assets - features, models, training data, batch scoring data, logs, and more. </p>"},{"location":"#python-centric-feature-store","title":"Python-Centric Feature Store","text":"<p>Hopsworks is widely used as a standalone Feature Store. Hopsworks breaks the monolithic model development pipeline into separate feature and training pipelines, enabling both feature reuse and better tested ML assets. You can develop features by building feature pipelines in any Python (or Spark or Flink) environment, either inside or outside Hopsworks. You can use the Python frameworks you are familiar with to build production feature pipelines. You can compute aggregations in Pandas, validate feature data with Great Expectations, reduce your data dimensionality with embeddings and PCA, test your feature logic and features end-to-end with PyTest, and transform your categorical and numerical features with Scikit-Learn, TensorFlow, and PyTorch. You can orchestrate your feature pipelines with your Python framework of choice, including Hopsworks' own Airflow support.</p>"},{"location":"#the-widest-feature-store-capabilities","title":"The Widest Feature Store Capabilities","text":"<p>Hopsworks Feature Store also supports feature pipelines in PySpark, Spark, Flink, and SQL. Offline features can either be stored in Hopsworks, as Hudi tables on object storage, or in external data lakehouses (Snowflake, Databricks, Redshift, BigQuery, any JDBC-enabled platform) via External Feature Groups. Online features are served by RonDB, developed by Hopsworks as the lowest latency, highest throughput, highest availability data store for your features.</p>"},{"location":"#mlops-on-hopsworks","title":"MLOps on Hopsworks","text":"<p>Hopsworks provides model serving capabilities through KServe, with additional support for feature/prediction logging to Kafka (also part of Hopsworks), and secure, low-latency model deployments via Istio. Hopsworks also has a Model Registry for KServe, with support for versioning both models and model assets (such as KServe transformers). Hopsworks also includes a vector database to provide similarity search capabilities for embeddings, based on OpenSearch.</p>"},{"location":"#project-based-multi-tenancy-and-team-collaboration","title":"Project-based Multi-Tenancy and Team Collaboration","text":"<p>Hopsworks provides projects as a secure sandbox in which teams can collaborate and share ML assets. Hopsworks' unique multi-tenant project model even enables sensitive data to be stored in a shared cluster, while still providing fine-grained sharing capabilities for ML assets across project boundaries.  Projects can be used to structure teams so that they have end-to-end responsibility from raw data to managed features and models. Projects can also be used to create development, staging, and production environments for data teams. All ML assets support versioning, lineage, and provenance provide all Hopsworks users with a complete view of the MLOps life cycle, from feature engineering through model serving. </p>"},{"location":"#development-and-operations","title":"Development and Operations","text":"<p>Hopsworks provides development tools for Data Science, including conda environments for Python, Jupyter notebooks, jobs, or even notebooks as jobs. You can build production pipelines with the bundled Airflow, and even run ML training pipelines with GPUs in notebooks on Airflow. You can train models on as many GPUs as are installed in a Hopsworks cluster and easily share them among users. You can also run Spark, Spark Streaming, or Flink programs on Hopsworks, with support for elastic workers in the cloud (add/remove workers dynamically).</p>"},{"location":"#available-on-any-platform","title":"Available on any Platform","text":"<p>Hopsworks is available as a both managed platform in the cloud on AWS, Azure, and GCP, and can be installed on any Linux-based virtual machines (Ubuntu/Redhat compatible), even in air-gapped data centers. Hopsworks is also available as a serverless platform that manages and serves both your features and models.</p>"},{"location":"#join-the-community","title":"Join the community","text":"<ul> <li>Ask questions and give us feedback in the Hopsworks Community</li> <li>Follow us on Twitter</li> <li>Check out all our latest product releases</li> <li>Join our public slack-channel</li> </ul>"},{"location":"#contribute","title":"Contribute","text":"<p>We are building the most complete and modular ML platform available in the market, and we count on your support to continuously improve Hopsworks. Feel free to give us suggestions, report bugs and add features to our library anytime.</p>"},{"location":"#open-source","title":"Open-Source","text":"<p>Hopsworks is available under the AGPL-V3 license. In plain English this means that you are free to use Hopsworks and even build paid services on it, but if you modify the source code, you should also release back your changes and any systems built around it as AGPL-V3.</p> <p>We're the best at what we do, and we strive to keep the same standard for our community! Our many thanks to the contributors of Hopsworks.</p>"},{"location":"admin/","title":"Cluster Administration","text":"<p>Hopsworks has a cluster management page that allows you, the administrator, to perform management actions,  monitor and control Hopsworks.</p> <p>To access the cluster management page you should log in into Hopsworks using your administrator account.  In the top right corner, click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu.</p>"},{"location":"admin/alert/","title":"Configure Alerts","text":""},{"location":"admin/alert/#introduction","title":"Introduction","text":"<p>Alerts are sent from Hopsworks using Prometheus'  Alert manager. In order to send alerts we first need to configure the Alert manager.</p>"},{"location":"admin/alert/#prerequisites","title":"Prerequisites","text":"<p>Administrator account on a Hopsworks cluster.</p>"},{"location":"admin/alert/#step-1-go-to-alerts-configuration","title":"Step 1: Go to alerts configuration","text":"<p>To configure the Alert manager click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings' Alerts tab you can configure the alert  manager to send alerts via email, slack or pagerduty.</p> Configure alerts"},{"location":"admin/alert/#step-2-configure-email-alerts","title":"Step 2: Configure Email Alerts","text":"<p>To send alerts via email you need to configure an SMTP server. Click on the Configure  button on the left side of the email row and fill out the form that pops up.</p> Configure Email Alerts <ul> <li>Default from: the address used as sender in the alert email.</li> <li>SMTP smarthost: the Simple Mail Transfer Protocol (SMTP) host through which emails are sent.</li> <li>Default hostname (optional): hostname to identify to the SMTP server.</li> <li>Authentication method: how to authenticate to the SMTP server.   CRAM-MD5, LOGIN or PLAIN.</li> </ul> <p>Optionally cluster wide Email alert receivers can be added in Default receiver emails. These receivers will be available to all users when they create event triggered alerts.</p>"},{"location":"admin/alert/#step-3-configure-slack-alerts","title":"Step 3: Configure Slack Alerts","text":"<p>Alerts can also be sent via Slack messages. To be able to send Slack messages you first need to configure a Slack webhook. Click on the Configure button on the left side of the slack row and past in your Slack webhook in Webhook.</p> Configure slack Alerts <p>Optionally cluster wide Slack alert receivers can be added in Slack channel/user. These receivers will be available to all users when they create event triggered alerts.</p>"},{"location":"admin/alert/#step-4-configure-pagerduty-alerts","title":"Step 4: Configure Pagerduty Alerts","text":"<p>Pagerduty is another way you can send alerts from Hopsworks. Click on the Configure button on the left side of  the pagerduty row and fill out the form that pops up. </p> Configure Pagerduty Alerts <p>Fill in Pagerduty URL: the URL to send API requests to.</p> <p>Optionally cluster wide Pagerduty alert receivers can be added in Service key/Routing key. By first choosing the PagerDuty integration type:</p> <ul> <li>global event routing (routing_key): when using PagerDuty integration type <code>Events API v2</code>.</li> <li>service (service_key): when using PagerDuty integration type <code>Prometheus</code>.</li> </ul> <p>Then adding the Service key/Routing key of the receiver(s). PagerDuty provides  documentation on how to integrate with  Prometheus' Alert manager.</p>"},{"location":"admin/alert/#step-5-advanced-configuration","title":"Step 5: Advanced configuration","text":"<p>If you are familiar with Prometheus' Alert manager  you can also configure alerts by editing the yaml/json file directly.  </p> Advanced configuration <p>Example: Adding the yaml snippet shown below in the global section of the alert manager configuration will have the same effect as creating the SMTP configuration as shown in section 1 above.</p> <pre><code>global:\n    smtp_smarthost: smtp.gmail.com:587\n    smtp_from: hopsworks@gmail.com\n    smtp_auth_username: hopsworks@gmail.com\n    smtp_auth_password: XXXXXXXXX\n    smtp_auth_identity: hopsworks@gmail.com\n ...\n</code></pre> <p>To test the alerts by creating triggers from Jobs and Feature group validations see Alerts.</p> <p>The yaml syntax in the UI is slightly different in that it does not allow double quotes (it will ignore the values but give no error).  Below is an example configuration, that can be used in the UI, with both email and slack receivers configured for system alerts.</p> <pre><code>global:\n    smtp_smarthost: smtp.gmail.com:587\n    smtp_from: hopsworks@gmail.com\n    smtp_auth_username: hopsworks@gmail.com\n    smtp_auth_password: XXXXXXXXX\n    smtp_auth_identity: hopsworks@gmail.com\n    resolveTimeout: 5m\ntemplates:\n  - /srv/hops/alertmanager/alertmanager-0.17.0.linux-amd64/template/*.tmpl\nroute:\n  receiver: default\n  routes:\n    - receiver: email\n      continue: true\n      match:\n        type: system-alert\n    - receiver: slack\n      continue: true\n      match:\n        type: system-alert\n  groupBy:\n    - alertname\n  groupWait: 10s\n  groupInterval: 10s\nreceivers:\n  - name: default\n  - name: email\n    emailConfigs:\n      - to: someone@logicalclocks.com\n        from: hopsworks@logicalclocks.com\n        smarthost: mail.hello.com\n        text: &gt;-\n          summary: {{ .CommonAnnotations.summary }} description: {{\n          .CommonAnnotations.description }}\n  - name: slack\n    slackConfigs:\n      - apiUrl: &gt;-\n          https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX\n        channel: '#general'\n        text: &gt;-\n          &lt;!channel&gt; summary: {{ .Annotations.summary }} description: {{\n          .Annotations.description }}\n</code></pre>"},{"location":"admin/alert/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure alerts in Hopsworks.</p>"},{"location":"admin/auth/","title":"Authentication Methods","text":""},{"location":"admin/auth/#introduction","title":"Introduction","text":"<p>Hopsworks can be configured to use different type of authentication methods. In this guide we will look at the  different authentication methods available in Hopsworks.</p>"},{"location":"admin/auth/#prerequisites","title":"Prerequisites","text":"<p>Administrator account on a Hopsworks cluster.</p>"},{"location":"admin/auth/#step-1-go-to-authentication-methods-page","title":"Step 1: Go to Authentication methods page","text":"<p>To configure Authentication methods click on your name in the top right corner of the navigation bar and choose  Cluster Settings from the dropdown menu.</p>"},{"location":"admin/auth/#step-2-configure-authentication-methods","title":"Step 2: Configure Authentication methods","text":"<p>In the Cluster Settings Authentication tab you can configure how users authenticate.</p> <ol> <li> <p>TOTP Two-factor Authentication: can be disabled, optional or mandatory. If set to mandatory all users are     required to set up two-factor authentication when registering. </p> <p>Note</p> <p>If two-factor is set to mandatory on a cluster with preexisting users all users will need to go through lost device recovery step to enable two-factor. So consider setting it to optional first and allow users to  enable it before setting it to mandatory.</p> </li> <li> <p>OAuth2: if your organization already have an identity management system compatible with     OpenID Connect (OIDC) you can configure Hopsworks to use your identity provider     by enabling OAuth as shown in the figure below. After enabling OAuth     you can register your identity provider by clicking on Add Identity Provider button. See    Create client for details.</p> </li> <li>LDAP/Kerberos: if your organization is using LDAP or Kerberos to manage users and services you can configure     Hopsworks to use it as the user management system. You can enable LDAP/Kerberos by clicking on the checkbox,     as shown in the figure below, and choosing LDAP or Kerberos. For more information on how to configure LDAP and Kerberos see     Configure LDAP and Configure Kerberos.</li> </ol> Setup Authentication Methods <p>In the figure above we see a cluster with Two-factor authentication disabled, OAuth enabled with one registered  identity provider and LDAP authentication enabled. </p>"},{"location":"admin/auth/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure authentication methods in Hopsworks.</p>"},{"location":"admin/project/","title":"Manage Projects","text":"<p>Hopsworks provides an administrator with a view of the projects in a Hopsworks cluster.</p> <p>A Hopsworks administrator is not automatically a member of all the projects in a cluster. However, they can see which projects exist, who is the project owner, and they can limit the storage quota and compute quota for each project.</p>"},{"location":"admin/project/#prerequisites","title":"Prerequisites","text":"<p>You need to be an administrator on a Hopsworks cluster.</p>"},{"location":"admin/project/#changing-project-quotas","title":"Changing project quotas","text":"<p>You can find the Project management page by clicking on your name, in the top right coner of the navigation bar, and choosing Cluster Settings from the dropdown menu and going to the Project tab.</p> Project page <p>This page will list all the projects in a cluster, their name, owner and when its quota was last updated. By clicking on the edit configuration link of a project you will be able to edit the quotas of that project.</p> Project quotas"},{"location":"admin/project/#storage","title":"Storage","text":"<p>Storage quota represents the amount of data a project can store. The storage quota is broken down in three different areas:</p> <ul> <li>Feature Store: This represents the storage quota for files and directories stored in the <code>_featurestore.db</code> dataset in the project. This dataset contains all the feature group offline data for the project.</li> <li>Hive DB: This represents the storage quota for files and directories stored in the <code>[projectName].db</code> dataset in the project. This is a general purpose Hive database for the project that can be used for analytics.</li> <li>Project: This represents the storage quota for all the data stored on any other dataset.</li> </ul> <p>Each storage quota is divided into space quota, i.e., how much space the files can consume, and namespace quota, i.e., how many files and directories there can be. If Hopsworks is deployed on-premise using hard drives to store the data, i.e., Hopsworks is not configured to store its data in a S3-compliant storage system, the data is replicated across multiple nodes (by default 3) and the space quota takes the replication factor into consideration. As an example, a 100MB file stored with a replication factor of 3, will consume 300MB of space quota.</p> <p>By default, all storage quotas are disabled and not enforced. Administrators can change this default by changing the following configuration in the Configuration UI and/or the cluster definition: <pre><code>hopsworks:\n    featurestore_default_quota: [default quota in bytes, -1 to disable]\n    hdfs_default_quota: [default quota in bytes, -1 to disable]\n    hive_default_quota: [default quota in bytes, -1 to disable]\n</code></pre> The values specified will be set during project creation and administrators will be able to customize each project using this UI.</p>"},{"location":"admin/project/#compute","title":"Compute","text":"<p>Compute quotas represents the amount of compute a project can use to run Spark and Flink applications as well as Tez queries. Quota is expressed as number of seconds a container of size 1 CPU and 1GB of RAM can run for.</p> <p>If the Hopsworks cluster is connected to a Kubernetes cluster, Python jobs, Jupyter notebooks and KServe models are not subject to the compute quota. Currently, Hopsworks does not support defining quotas for compute scheduled on the connected Kubernetes cluster.</p> <p>By default, the compute quota is disabled. Administrators can change this default by changing the following configuration in the Condiguration UI and/or the cluster definition: <pre><code>hopsworks:\n    yarn_default_payment_type: [NOLIMIT to disable the quota, PREPAID to enable it]\n    yarn_default_quota: [default quota in seconds]\n</code></pre></p> <p>The values specified will be set during project creation and administrators will be able to customize each project using this UI.</p>"},{"location":"admin/project/#kakfa-topics","title":"Kakfa Topics","text":"<p>Kafka is used within Hopsworks to enable users to write data to the feature store in Real-Time and from a variety of different frameworks. If a user creates a feature group with the stream APIs enabled, then a Kafka topic will be created for that feature group. By default, a project can have up to 100 Kafka topics. Administrators can increase the number of Kafka topics a project is allowed to create by increasing the quota in the project admin UI. </p>"},{"location":"admin/project/#force-deleting-a-project","title":"Force deleting a project","text":"<p>Administrators have the option to force delete a project. This is useful if the project was not created or deleted properly, e.g., because of an error.</p>"},{"location":"admin/project/#controlling-who-can-create-projects","title":"Controlling who can create projects","text":"<p>Every user on Hopsworks can create projects. By default, each user can create up to 10 projects. For production environments, the number of projects should be limited and controlled for resource allocation purposes as well as closer control over the data.  Administrators can control how many projects a user can provision by setting the following configuration in the Configuration UI and/or cluster definition:</p> <pre><code>hopsworks:\n    max_num_proj_per_user: [Maximum number of projects each user can create]\n</code></pre> <p>This value will be set when the user is provisioned. Administrators can grant additional projects to a specific user through the User Administration UI.</p>"},{"location":"admin/roleChaining/","title":"AWS IAM Role Chaining","text":""},{"location":"admin/roleChaining/#introduction","title":"Introduction","text":"<p>When running Hopsworks in the cloud you have several options to give the Hopsworks user access to AWS resources. The simplest is to setup the EC2 instances running Hopsworks with an instance profile giving access to the resources. But, this will make these resources accessible by all the Hopsworks users. To manage access to the resource on a project base you need to use Role chaining.</p> <p>In this document we will see how to configure AWS and Hopsworks to use Role chaining in your Hopsworks projects.</p>"},{"location":"admin/roleChaining/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need the following:</p> <ul> <li>A Hopsworks cluster running on EC2.</li> <li>Administrator account on a Hopsworks cluster.</li> </ul>"},{"location":"admin/roleChaining/#step-1-create-an-instance-profile-role","title":"Step 1: Create an instance profile role","text":"<p>To use role chaining the head node need to be able to impersonate the roles you want to be linked to your project. For this you need to create an instance profile with assume role permissions and attach it to your head node. For more details about the creation of instance profile see the aws documentation. If running in managed.hopsworks.ai you can also refer to our getting started guide.</p> <p>Note</p> <p>To ensure that the Hopsworks users can't use the head node instance profile and impersonate the roles by their own means, you need to ensure that they can't execute code on the head node. This means having all jobs running on worker nodes and using EKS to run jupyter nodebooks.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AssumeDataRoles\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"sts:AssumeRole\",\n            \"Resource\": [\n                \"arn:aws:iam::123456789011:role/test-role\",\n                \"arn:aws:iam::xxxxxxxxxxxx:role/s3-role\",\n                \"arn:aws:iam::xxxxxxxxxxxx:role/dev-s3-role\",\n                \"arn:aws:iam::xxxxxxxxxxxx:role/redshift\"\n            ]\n        }\n    ]\n}\n</code></pre> Example policy for assuming four roles."},{"location":"admin/roleChaining/#step-2-create-the-resource-roles","title":"Step 2: Create the resource roles","text":"<p>For the instance profile to be able to impersonate the roles you need to configure the roles themselves to allow it. This is dome by adding the instance profile to the role's Trust relationships.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n        \"Effect\": \"Allow\",\n        \"Principal\": {\n            \"AWS\": \"arn:aws:iam::xxxxxxxxxxxx:role/instance-profile\"\n        },\n        \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\n</code></pre> Example trust-policy document."},{"location":"admin/roleChaining/#step-3-create-mappings","title":"Step 3: Create mappings","text":"<p>Now that the head node can assume the roles we need to configure Hopsworks to deletegate access to the roles on a project base.</p> <p>In Hopsworks, click on your name in the top right corner of the navigation bar and choose Cluster Settings from the dropdown menu. In the Cluster Settings' IAM Role Chaining tab you can configure the mappings between projects and IAM roles.</p> Role Chaining <p>Add mappings by clicking on New role chaining. Enter the project name. Select the type of user that can assume the role. Enter the role ARN. And click on Create new role chaining</p> Create Role Chaining <p>Project member can now create connectors using temporary credentials to assume the role you configured. More detail about using temporary credentials can be found here.</p> <p>Project member can see the list of role they can assume by going the Project Settings -&gt; Assuming IAM Roles page.</p>"},{"location":"admin/roleChaining/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure and map AWS IAM roles to project roles in Hopsworks.</p>"},{"location":"admin/services/","title":"Manage Services","text":""},{"location":"admin/services/#introduction","title":"Introduction","text":"<p>Hopsworks provides administrators with a view of the status/health of the cluster.  This information is provided through the Services page.</p>"},{"location":"admin/services/#prerequisites","title":"Prerequisites","text":"<p>Administrator account on a Hopsworks cluster.</p>"},{"location":"admin/services/#step-1-check-service-status","title":"Step 1: Check service status","text":"<p>You can find the Services page by clicking on your name, in the top right corner of the navigation bar, and choosing  Cluster Settings from the dropdown menu and going to the Services tab.</p> Services page <p>This page give administrators an overview of which services are running on the cluster.  It provides information about their status as reported by agents that monitor the status of the different  Systemd units.</p> <p>Columns in the services table represent machines in your cluster. Each service running on a machine will have a status  running  (green) or stopped (red). If a service is not installed on a machine it will have a status not installed (gray). </p>"},{"location":"admin/services/#step-2-find-a-service","title":"Step 2: Find a service","text":"<p>Services are divided into groups, and you can search for a service by its name or group. You can also search for machines  by their host name.</p> Services"},{"location":"admin/services/#step-3-manage-a-service","title":"Step 3: Manage a service","text":"<p>After you find the correct service you will be able to start, stop or restart it, by clicking on its status.</p> Start, Stop and Restart a service <p>Note</p> <p>Stopping some services like the web server (glassfish_domain1) is not recommended. If you stop it you will have to access the machine running the service and start it with <code>systemctl start glassfish_domain1</code>. </p>"},{"location":"admin/services/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to manage services in Hopsworks.</p>"},{"location":"admin/user/","title":"User Management","text":""},{"location":"admin/user/#introduction","title":"Introduction","text":"<p>Whether you run Hopsworks on-premise, or on the cloud using managed.hopsworks.ai,  you have a Hopsworks cluster which contains all users and projects.</p>"},{"location":"admin/user/#prerequisites","title":"Prerequisites","text":"<p>Administrator account on a Hopsworks cluster.</p>"},{"location":"admin/user/#step-1-go-to-user-management","title":"Step 1: Go to user management","text":"<p>All the users of your Hopsworks instance have access to your cluster with different access rights.  You can find them by clicking on your name in the top right corner of the navigation bar and choosing Cluster  Settings from the dropdown menu and going to the Users tab (You need to have Admin role to get access to the  Cluster Settings page).</p> Active Users"},{"location":"admin/user/#step-2-manage-user-roles","title":"Step 2: Manage user roles","text":"<p>Roles let you manage the access rights of a user to the cluster.</p> <ul> <li>User: users with this role are only allowed to use the cluster by creating a limited number of projects.</li> <li>Admin: users with this role are allowed to manage the cluster. This includes accepting new users to the cluster or    blocking them, managing user quota, configure alerts and setting up authentication methods.  </li> </ul> <p>You can change the role of a user by clicking on the select dropdown that shows the current role of the user.</p>"},{"location":"admin/user/#step-3-validating-and-blocking-users","title":"Step 3: Validating and blocking users","text":"<p>By default, a user who register on Hopsworks using their own credentials are not granted access to the cluster.  First, a user with an admin role needs to validate their account.</p> <p>By clicking on the Review Requests button you can open a user request review popup as shown in the image below.</p> Review user request <p>On the user request review popup you can activate or block users. Users with a validated email address will have a  check mark on their email.  </p> <p>Similarly, if a user is no longer allowed access to the cluster you can block them. To keep consistency with the history of your datasets, a user can not be deleted but only blocked. If necessary a user can be  deleted manually in the cluster using the command line. You can block a user by clicking on the block icon on the right side of the user in the list.</p> Blocked Users <p>Blocked users will appear on the lower section of the page. Click on display blocked users to show all the blocked  users in your cluster. If a user is blocked by mistake you can reactivate it by clicking on the check mark icon  that corresponds to that user in the blocked users list. </p> <p>If there are too many users in your cluster, use the search box (available for blocked users too) to filter users by  name or email. It is also possible to filter activated users by role. For example to see all administrators in you  cluster click on the select dropdown to the right of the search box and choose Admin. </p>"},{"location":"admin/user/#step-4-create-a-new-users","title":"Step 4: Create a new users","text":"<p>If you want to allow users to login without registering you can pre-create them by clicking on New user.</p> Create new user <p>After setting the user's name and email chose the type of user you want to create (Hopsworks, Kerberos or LDAP). To  create a Kerberos or LDAP user you need to get the users UUID from the Kerberos or LDAP server. Hopsworks user  can also be assigned a Role. Kerberos and LDAP users on the other hand can only be assigned a role through group  mapping.</p> <p>A temporary password will be generated and displayed when you click on Create new user. Copy the password and pass  it securely to the user. </p> Copy temporary password"},{"location":"admin/user/#step-5-reset-user-password","title":"Step 5: Reset user password","text":"<p>In the case where a user loses her/his password and can not recover it with the  password recovery, an administrator can reset it for them.</p> <p>On the bottom of the Users page click on the Reset a user password link. A popup window with a dropdown for  searching users by name or email will open. Find the user and click on Reset new password.</p> Reset user password <p>A temporary password will be displayed. Copy the password and pass it to the user securely.</p> Copy temporary password <p>A user with a temporary password will see a warning message when going to Account settings Authentication tab.</p> Change password <p>Note</p> <p>A temporary password should be changed as soon as possible.</p>"},{"location":"admin/user/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to manage users in Hopsworks.</p>"},{"location":"admin/variables/","title":"Cluster Configuration","text":""},{"location":"admin/variables/#introduction","title":"Introduction","text":"<p>Whether you run Hopsworks on-premise, or on the cloud using managed.hopsworks.ai, it is possible to change a variety of configurations on the cluster, changing its default behaviour. This section is not going into detail for every setting, since every Hopsworks cluster comes with a robust default setup. However, this guide is to explain where to find the configurations and if necessary, how to change them.</p> <p>Note</p> <p>In most cases you will be only be prompted to change these configurations by a Hopsworks Solutions Engineer or similar.</p>"},{"location":"admin/variables/#prerequisites","title":"Prerequisites","text":"<p>An administrator account on a Hopsworks cluster.</p>"},{"location":"admin/variables/#step-1-the-configuration-page","title":"Step 1: The configuration page","text":"<p>You can find the configuration page by navigating in the UI:</p> <ol> <li>Click on your user name in the top right corner, then select Cluster Settings.</li> <li>Among the cluster settings, you will find a tab Configuration</li> </ol> Configuration settings"},{"location":"admin/variables/#step-2-editing-existing-configurations","title":"Step 2: Editing existing configurations","text":"<p>To edit an existing configuration, simply find the property using the search field, then click the edit button to change the value of the setting or its visibility. Once you have made the change, don't forget to click save to persist the changes.</p>"},{"location":"admin/variables/#visibility","title":"Visibility","text":"<p>The visibility setting indicates whether a setting can be read only by Hops Admins or also by simple Hops Users, that is everyone. Additionally, you can also allow to read the setting even when not authenticated. If the setting contains a password or sensitive information, you can also hide the value so it's not shown in the UI.</p>"},{"location":"admin/variables/#step-3-adding-a-new-configuration","title":"Step 3: Adding a new configuration","text":"<p>In rare cases it might be necessary to add additional configurations.</p> <p>To do so, click on New Variable, where you can then configure the new setting with a key, value and visibility. Once you have set the desired properties, you can persist them by clicking Create Configuration</p> Adding a new configuration property"},{"location":"admin/audit/audit-logs/","title":"Access Audit Logs","text":""},{"location":"admin/audit/audit-logs/#introduction","title":"Introduction","text":"<p>Hopsworks collects audit logs on all URL requests to the application server. These logs are saved in Payara log directory under <code>&lt;payara-log-dir&gt;/audit</code> by default.</p>"},{"location":"admin/audit/audit-logs/#prerequisites","title":"Prerequisites","text":"<p>In order to access the audit logs you need the following: </p> <ul> <li>Administrator account on the Hopsworks cluster.</li> <li>SSH access to the Hopsworks cluster with a user in the <code>glassfish</code> group.</li> </ul>"},{"location":"admin/audit/audit-logs/#step-1-configure-audit-logs","title":"Step 1: Configure Audit logs","text":"<p>Audit logs can be configured from the Cluster Settings Configuration tab. You can access the Configuration page of your Hopsworks cluster by clicking on your name, in the top right corner, and choosing Cluster Settings from the dropdown menu.</p> Audit log configuration <p>Type audit in the search box to see the configuration variables associated with audit logs. To edit a configuration variable, you can click on the edit button (), insert the new value and save changes clicking on the check mark ().</p> <p>Audit logs configuration variables</p> Name Description audit_log_count the number of files to keep when rotating logs (java.util.logging.FileHandler.count) audit_log_dir the path where audit logs are saved audit_log_file_format log file name pattern. (java.util.logging.FileHandler.pattern) audit_log_file_type the output format of the log file. Can be one of java.util.logging.SimpleFormatter (default), io.hops.hopsworks.audit.helper.JSONLogFormatter, or io.hops.hopsworks.audit.helper.HtmlLogFormatter. audit_log_size_limit the maximum number of bytes to write to any one file. (java.util.logging.FileHandler.limit) audit_log_date_format if io.hops.hopsworks.audit.helper.JSONLogFormatter is used as audit log file type, this will set the date format of the output JSON. The format should be java.text.SimpleDateFormat compatible string. <p>Warning</p> <p>Hopsworks application needs to be reloaded for any changes to be applied. For doing that, go to the Payara admin panel (<code>https://&lt;your-domain&gt;:4848</code>), click on Applications on the side menu and reload the hopsworks-ear application.</p>"},{"location":"admin/audit/audit-logs/#step-2-access-the-logs","title":"Step 2: Access the Logs","text":"<p>To access the audit logs, SSH into the head node of your Hopsworks cluster and navigate to the path set in the audit_log_dir configuration variable.</p> <p>Audit logs follow the format set in the audit_log_file_type configuration variable.</p> <p>Example of audit logs using JSONLogFormatter</p> <pre><code>{\"className\":\"io.hops.hopsworks.api.user.AuthService\",\"methodName\":\"login\",\"parameters\":\"[admin@hopsworks.ai, org.apache.catalina.connector.ResponseFacade@2de6dd0b, org.apache.catalina.connector.RequestFacade@7a82f674]\",\"outcome\":\"200\",\"caller\":{\"username\":null,\"email\":\"admin@hopsworks.ai\",\"userId\":null},\"clientIp\":\"10.0.2.2\",\"userAgent\":\"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36\",\"pathInfo\":\"/auth/login\",\"dateTime\":\"2022-11-09 12:00:08\"}\n</code></pre> <p>Regardless the format, each line in the audit logs can contain the following variables:</p> <p>Audit log variables</p> Name Description className the class called by the request methodName the method called by the request parameters parameters sent from the client outcome response code sent from the server caller the logged in user that made the request. Can be username, email, or userId clientIp the IP address of the client userAgent the browser used by the client pathInfo the URL path called by the client dateTime time of the request"},{"location":"admin/audit/audit-logs/#conclusion","title":"Conclusion","text":"<p>In this guide we showed how you can configure audit logs in Hopsworks from the admin page and access the audit log files via SSH. To learn how to export audit logs, see Export Audit Logs.</p>"},{"location":"admin/audit/export-audit-logs/","title":"Export Audit Logs","text":""},{"location":"admin/audit/export-audit-logs/#introduction","title":"Introduction","text":"<p>Audit logs can be exported to your storage of preference. In case audit logs have not been configured yet in your Hopsworks cluster, please see Access Audit Logs.</p> <p>Note</p> <pre><code>As an example, in this guide we will show how to export audit logs to BigQuery using the ```bq``` command-line tool.\n</code></pre>"},{"location":"admin/audit/export-audit-logs/#prerequisites","title":"Prerequisites","text":"<p>In order to export audit logs you need SSH access to the Hopsworks cluster.</p>"},{"location":"admin/audit/export-audit-logs/#step-1-create-a-bigquery-table","title":"Step 1: Create a BigQuery Table","text":"<p>Create a dataset and a table in BigQuery.</p> <p>The table schema is shown below.</p> <pre><code>fullname          mode      type        description\npathInfo          NULLABLE  STRING  \nmethodName        NULLABLE  STRING  \ncaller            NULLABLE  RECORD  \ndateTime          NULLABLE  TIMESTAMP   bq-datetime\nuserAgent         NULLABLE  STRING  \nclientIp          NULLABLE  STRING  \noutcome           NULLABLE  STRING  \nparameters        NULLABLE  STRING  \nclassName         NULLABLE  STRING  \ncaller.userId     NULLABLE  STRING  \ncaller.email      NULLABLE  STRING  \ncaller.username   NULLABLE  STRING\n</code></pre>"},{"location":"admin/audit/export-audit-logs/#step-2-export-audit-logs-to-the-bigquery-table","title":"Step 2: Export Audit Logs to the BigQuery Table","text":"<p>Audit logs can be exported in different formats. For instance, to export audit logs in JSON format set <code>audit_log_file_type=io.hops.hopsworks.audit.helper.JSONLogFormatter</code>.</p> <p>Info</p> <pre><code>For more information on how to configure the audit log file type see the ```audit_log_file_type``` configuration variable in [Audit logs](../audit/audit-logs.md#step-1-configure-audit-logs).\n</code></pre> <p>To export the audit logs to the BigQuery table created in the previous step, run the following command.</p> <pre><code>bq load --project_id &lt;projectId&gt; \\\n        --source_format=NEWLINE_DELIMITED_JSON \\\n        &lt;DATASET.TABLE&gt; \\\n        /srv/hops/domains/domain1/logs/audit/server_audit_log0.log\n</code></pre> <p>Tip</p> <pre><code>This command can be configured to run periodically on a given schedule by setting up a cronjob.\n</code></pre>"},{"location":"admin/audit/export-audit-logs/#conclusion","title":"Conclusion","text":"<p>In this guide you showed how you can export audit logs in your Hopsworks cluster to a BigQuery table.</p>"},{"location":"admin/ha-dr/dr/","title":"Disaster Recovery","text":""},{"location":"admin/ha-dr/dr/#backup","title":"Backup","text":"<p>The state of the Hopsworks cluster is divided into data and metadata and distributed across the different node groups. This section of the guide allows you to take a consistent backup between data in the offline and online feature store as well as the metadata.</p> <p>The following services contain critical state that should be backed up:</p> <ul> <li>RonDB: as mentioned above, the RonDB is used by Hopsworks to store the cluster metadata as well as the data for the online feature store.</li> <li>HopsFS: HopsFS stores the data for the batch feature store as well as checkpoints and logs for feature engineering applications.</li> </ul> <p>Backing up service/application metrics and services/applications logs are out of the scope of this guide. By default metrics and logs are rotated after 7 days. Application logs are available on HopsFS when the application has finished and, as such, are backed up with the rest of HopsFS\u2019 data.</p> <p>Apache Kafka and OpenSearch are additional services maintaining state. The OpenSearch metadata can be reconstructed from the metadata stored on RonDB.</p> <p>Apache Kafka is used in Hopsworks to store the in-flight data that is on its way to the online feature store. In the event of a total loss of the cluster, running jobs with inflight data will have to be replayed.</p>"},{"location":"admin/ha-dr/dr/#configuration-backup","title":"Configuration Backup","text":"<p>Hopsworks adopts an Infrastructure-as-code philosophy, as such all the configuration files for the different Hopsworks services are generated during the deployment phase. Cluster-specific customizations should be centralized in the cluster definition used to deploy the cluster. As such the cluster definition should be backed up (e.g., by committing it to a git repository) to be able to recreate the same cluster in case it needs to be recreated.</p>"},{"location":"admin/ha-dr/dr/#rondb-backup","title":"RonDB Backup","text":"<p>The RonDB backup is divided into two parts: user and privileges backup and data backup.</p> <p>To take the backup of users and privileges you can run the following command from any of the nodes in the head node group. This command generates a SQL file containing all the user definitions for both the metadata services (Hopsworks, HopsFS, Metastore) as well as the user and permission grants for the online feature store. This command needs to be run as user \u2018mysql\u2019 or with sudo privileges.</p> <pre><code>/srv/hops/mysql/bin/mysqlpump -S /srv/hops/mysql-cluster/mysql.sock --exclude-databases=% --exclude-users=root,mysql.sys,mysql.session,mysql.infoschema --users &gt; users.sql\n</code></pre> <p>The second step is to trigger the backup of the data. This can be achieved by running the following command as user \u2018mysql\u2019 on one of the nodes of the head node group. </p> <pre><code>/srv/hops/mysql-cluster/ndb/scripts/mgm-client.sh -e \"START BACKUP [replace_backup_id] SNAPSHOTEND WAIT COMPLETED\"\n</code></pre> <p>The backup ID is an integer greater or equal than 1. The script uses the following: <code>$(date +'%y%m%d%H%M')</code> instead of an integer as backup id to make it easier to identify backups over time.</p> <p>The command instructs each RonDB datanode to backup the data it is responsible for. The backup will be located locally on each datanode under the following path: </p> <pre><code>/srv/hops/mysql-cluster/ndb/backups/BACKUP - the directory name will be BACKUP-[backup_id] \n</code></pre> <p>A more comprehensive backup script is available here - The script includes the steps above as well as collecting all the partial RonDB backups on a single node. The script is a good starting point and can be adapted to ship the database backup outside the cluster.</p>"},{"location":"admin/ha-dr/dr/#hopsfs-backup","title":"HopsFS Backup","text":"<p>HopsFS is a distributed file system based on Apache HDFS. HopsFS stores its metadata in RonDB, as such metadata backup has already been discussed in the section above. The data is stored in the form of blocks on the different data nodes.  For availability reasons, the blocks are replicated across three different data nodes.</p> <p>Within a node, the blocks are stored by default under the following directory, under the ownership of the \u2018hdfs\u2019 user: </p> <pre><code>/srv/hopsworks-data/hops/hopsdata/hdfs/dn/\n</code></pre> <p>To safely backup all the data, a copy of all the datanodes should be taken. As the data is replicated across the different nodes, excluding a set of nodes might result in data loss.</p> <p>Additionally, as HopsFS blocks are files on the file system and the filesystem can be quite large, the backup is not transactional. Consistency is dictated by the metadata. Blocks being added during the copying process will not be visible when restoring as they are not part of the metadata backup taken prior to cloning the HopsFS blocks.</p> <p>When the HopsFS data blocks are stored in a cloud block storage, for example, Amazon S3, then it is sufficient to only backup the metadata. The blob cloud storage service will ensure durability of the data blocks.</p>"},{"location":"admin/ha-dr/dr/#restore","title":"Restore","text":"<p>As with the backup phase, the restore operation is broken down in different steps.</p>"},{"location":"admin/ha-dr/dr/#cluster-deployment","title":"Cluster deployment","text":"<p>The first step to redeploy the cluster is to redeploy the binaries and configuration. You should reuse the same cluster definition used to deploy the first (original) cluster. This will re-create the same cluster with the same configuration.</p>"},{"location":"admin/ha-dr/dr/#rondb-restore","title":"RonDB restore","text":"<p>The deployment step above created a functioning empty cluster. To restore the cluster, the first step is to restore the metadata and online feature store data stored on RonDB.  To restore the state of RonDB, we first need to restore its schemas and tables, then its data, rebuild the indices, and finally restore the users and grants.</p>"},{"location":"admin/ha-dr/dr/#restore-rondb-schemas-and-tables","title":"Restore RonDB schemas and tables","text":"<p>This command should be executed on one of the nodes in the head node group and is going to recreate the schemas, tables, and internal RonDB metadata. In the command below, you should replace the node_id with the id of the node you are running the command on, backup_id with the id of the backup you want to restore. Finally, you should replace the mgm_node_ip with the address of the node where the RonDB management service is running.</p> <pre><code>/srv/hops/mysql/bin/ndb_restore -n [node_id] -b [backup_id] -m --disable-indexes --ndb-connectstring=[mgm_node_ip]:1186 --backup_path=/srv/hops/mysql-cluster/ndb/backups/BACKUP/BACKUP-[backup_id]\n</code></pre>"},{"location":"admin/ha-dr/dr/#restore-rondb-data","title":"Restore RonDB data","text":"<p>This command should be executed on all the RonDB datanodes. Each command should be customized with the node id of the node you are trying to restore (i.e., replace the node_id). As for the command above you should replace the backup_id and mgm_node_ip.</p> <pre><code>/srv/hops/mysql/bin/ndb_restore -n [node_id] -b [backup_id] -r --ndb-connectstring=[mgm_node_ip]:1186 --backup_path=/srv/hops/mysql-cluster/ndb/backups/BACKUP/BACKUP-[backup_id]\n</code></pre>"},{"location":"admin/ha-dr/dr/#rebuild-the-indices","title":"Rebuild the indices","text":"<p>In the first command we disable the indices for recovery. This last command will take care of enabling them again. This command needs to run only once on one of the nodes of the head node group. As for the commands above, you should replace node_id, backup_id and mgm_node_id.</p> <pre><code>/srv/hops/mysql/bin/ndb_restore -n [node_id] -b [backup_id] --rebuild-indexes --ndb-connectstring=[mgm_node_ip]:1186 --backup_path=/srv/hops/mysql-cluster/ndb/backups/BACKUP/BACKUP-[backup_ip]\n</code></pre>"},{"location":"admin/ha-dr/dr/#restore-users-and-grants","title":"Restore Users and Grants","text":"<p>In the backup phase, we took the backup of the user and grants separately. The last step of the RonDB restore process is to re-create all the users and grants both for Hopsworks services as well as for the online feature store users. This can be achieved by running the following command on one node of the head node group:</p> <pre><code>/srv/hops/mysql-cluster/ndb/scripts/mysql-client.sh source users.sql\n</code></pre>"},{"location":"admin/ha-dr/dr/#hopsfs-restore","title":"HopsFS restore","text":"<p>With the metadata restored, you can now proceed to restore the file system blocks on HopsFS and restart the file system. When starting the datanode, it will advertise it\u2019s ID/ClusterID and Storage ID based on the VERSION file that can be found in this directory:</p> <pre><code>/srv/hopsworks-data/hops/hopsdata/hdfs/dn/current\n</code></pre> <p>It\u2019s important that all the datanodes are restored and they report their block to the namenodes processes running on the head nodes. By default the namenodes in HopsFS will exit \u201cSAFE MODE\u201d (i.e., the mode that allows only read operations) only when the datanodes have reported 99.9% of the blocks the namenodes have in the metadata.  As such, the namenodes will not resume operations until all the file blocks have been restored.</p>"},{"location":"admin/ha-dr/dr/#opensearch-state-rebuild","title":"OpenSearch state rebuild","text":"<p>The OpenSearch state can be rebuilt using the Hopsworks metadata stored on RonDB. The rebuild process is done by using the re-indexing mechanism provided by ePipe. The re-indexing can be triggered by running the following command on the head node where ePipe is running:</p> <pre><code>/srv/hops/epipe/bin/reindex-epipe.sh\n</code></pre> <p>The script is deployed and configured during the platform deployment.</p>"},{"location":"admin/ha-dr/dr/#kafka-topics-rebuild","title":"Kafka topics rebuild","text":"<p>The backup and restore plan doesn\u2019t cover the data in transit in Kafka, for which the jobs producing it will have to be replayed. However, the RonDB backup contains the information necessary to recreate the topics of all the feature groups.  You can run the following command, as super user, to recreate all the topics with the correct partitioning and replication factors:</p> <pre><code>/srv/hops/kafka/bin/kafka-restore.sh\n</code></pre> <p>The script is deployed and configured during the platform deployment.</p>"},{"location":"admin/ha-dr/ha/","title":"High Availability","text":"<p>At a high level a Hopsworks cluster can be divided into 4 groups of nodes. Each node group should be deployed according to the requirements (e.g., 3/5/7 nodes for the head node group) to guarantee the availability of the components. </p> <ul> <li>Head nodes: The head node is responsible for running all the metadata, public API, and user interface services that are required for Hopsworks to provide its functionality. They need to be deployed in an odd number (1, 3, 5) as the head nodes run services like Zookeeper and OpenSearch which enforce consistency through quorum based protocols. The head nodes are also responsible for managing the services running on the remaining group of nodes.</li> <li>Worker nodes: The worker node is responsible for executing the feature engineering pipeline code as well as storing the data for the offline feature store (HopsFS). In an on-prem deployment, the data is stored and replicated on the workers\u2019 local hard drives. By default the data is replicated across 3 workers. In a cloud deployment, HopsFS\u2019 data is persisted in a cloud object store (Amazon S3, Azure Blob Storage, Google Cloud Blob Storage) and the HopsFS datanodes are responsible for persisting, retrieving and caching of blocks from the object store.</li> <li>RonDB Data nodes: These nodes are responsible for storing the services\u2019 metadata (Hopsworks, HopsFS, Hive Metastore, Airflow) as well as the data for the online feature store. For high availability, at least two data nodes should be deployed and RonDB is typically  configured with a replication factor of 2, as it uses synchronous replication with 2-phase commit, not a quorum-based replication protocol. More advanced deployment patterns and best practices are covered in the RonDB documentation (https://docs.rondb.ai) .</li> <li>Query brokers: The query brokers are the entry point for querying the online feature store. They handle authentication, authorization and execution of the requests for online feature data being submitted from the feature store APIs. At least two query brokers should be deployed to achieve high availability. Query brokers are stateless. Additional query brokers should be deployed to handle additional load and clients.</li> </ul> <p>Example deployment:</p> Example High Available deployment <p>For higher availability, a Hopsworks cluster should be deployed across multiple availability zones, however, a single cluster cannot be deployed across multiple regions. Multiple region deployments are out of the scope of this guide.</p> <p>A different service placement is also possible, e.g., separating RonDB data nodes between metadata and online feature store or adding more replicas of a metadata service without necessarily adding a whole new head node, however, this is outside the scope of this guide.</p>"},{"location":"admin/ha-dr/intro/","title":"Hopsworks High Availability and Disaster Recovery Documentation","text":"<p>The Hopsworks Feature Store is the underlying component powering enterprise ML pipelines as well as serving feature data to model making user facing predictions. Sometimes the Hopsworks cluster can experience hardware failures or power loss, to help you plan for these occasions and avoid Hopsworks Feature Store downtime, we put together this guide. This guide is divided into three sections:</p> <ul> <li>High availability: deployment patterns and best practices to make sure individual component failures do not impact the availability of the Hopsworks cluster.</li> <li>Backup: configuration policies and best practices to make sure you have have fresh copy of the data and metadata in case of necessity</li> <li>Restore: procedures and best practices to restore a previous backup if needed.</li> </ul>"},{"location":"admin/ldap/configure-krb/","title":"Configure Kerberos","text":""},{"location":"admin/ldap/configure-krb/#introduction","title":"Introduction","text":"<p>Kerberos is a network authentication protocol that allow nodes to communicating over a non-secure network to prove their identity to one another in a secure manner. This tutorial shows an administrator how to configure Kerberos authentication.</p> <p>Kerberos need some server configuration before you can enable it from the UI.</p>"},{"location":"admin/ldap/configure-krb/#prerequisites","title":"Prerequisites","text":"<p>A server configured with Kerberos. See Server Configuration for Kerberos for  instruction on how to do this. </p>"},{"location":"admin/ldap/configure-krb/#step-1-enable-kerberos","title":"Step 1: Enable Kerberos","text":"<p>After configuring the server you can configure Authentication methods by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings, you can enable Kerberos by clicking on the Kerberos checkbox.</p> <p>If LDAP/Kerberos checkbox is not checked, make sure that you configured your application server and enable it by clicking on the checkbox.</p> Setup Authentication Methods"},{"location":"admin/ldap/configure-krb/#step-2-edit-configuration","title":"Step 2: Edit configuration","text":"<p>Finally, click on edit configuration and fill in the attributes.</p> Configure Kerberos <ul> <li>Account status: the status a user will be assigned when logging in for the first time. If a user is assigned a status   different from Activated an admin needs to manually activate each user from the User management.</li> <li>Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a   semicolon separated string in the form <code>Directory Administrators-&gt;HOPS_ADMIN;IT People-&gt; HOPS_USER</code>. Default    is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in.</li> <li>User id: the id field in LDAP with a string placeholder. Default <code>uid=%s</code>.</li> <li>User given name: the given name field in LDAP. Default <code>givenName</code>.</li> <li>User surname: the surname field in LDAP. Default <code>sn</code>.</li> <li>User email: the email field in LDAP. Default <code>mail</code>.</li> <li>User search filter: the search filter for user. Default <code>uid=%s</code>.</li> <li>Principal search filter: the search filter for principal name. Default <code>krbPrincipalName=%s</code>.</li> <li>Group search filter: the search filter for groups. Default <code>member=%d</code>.</li> <li>Group target: the target to search for groups in the LDAP directory tree. Default <code>cn</code>.</li> <li>Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default <code>memberOf</code>.</li> <li>User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is   empty.</li> <li>Group dn: specify the DN of the container or base point where the groups are stored. Default is empty.</li> </ul> <p>All defaults are taken from OpenLDAP.</p> <p>Note</p> <p>Group mapping can be disabled by setting <code>ldap_group_mapping_enabled=false</code> in the Configuration UI. When group mapping is disabled an administrator needs to activate each user from the User Management page.</p> <p>If group mapping is disabled then Account status in the Kerberos configuration above should be set to <code>Verified</code>.</p> <p>The login page will now have the choice to use Kerberos for authentication.</p> Log in using Kerberos <p>Note</p> <p>Make sure that you have Kerberos properly configured on your computer and you are logged in. Kerberos support must also be configured on the browser to use Kerberos for authentication.</p>"},{"location":"admin/ldap/configure-krb/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure Kerberos for authentication.</p>"},{"location":"admin/ldap/configure-ldap/","title":"Configure LDAP/Kerberos","text":""},{"location":"admin/ldap/configure-ldap/#introduction","title":"Introduction","text":"<p>LDAP (Lightweight Directory Access Protocol) is a software protocol for enabling anyone in a network to gain access to resources such as files and devices. This tutorial shows an administrator how to configure LDAP authentication.</p> <p>LDAP need some server configuration before you can enable it from the UI.</p>"},{"location":"admin/ldap/configure-ldap/#prerequisites","title":"Prerequisites","text":"<p>A server configured with LDAP. See Server Configuration for LDAP for  instruction on how to do this.</p>"},{"location":"admin/ldap/configure-ldap/#step-1-enable-ldap","title":"Step 1: Enable LDAP","text":"<p>After configuring the server you can configure Authentication methods by clicking on your name in the top right  corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Authentication tab you can find in Cluster Settings, you can enable LDAP by clicking on the LDAP checkbox.</p> <p>If LDAP/Kerberos checkbox is not checked make sure that you configured your application server and enable it by  clicking on the checkbox.</p> Setup Authentication Methods"},{"location":"admin/ldap/configure-ldap/#step-2-edit-configuration","title":"Step 2: Edit configuration","text":"<p>Finally, click on edit configuration and fill in the attributes.</p> Configure LDAP <ul> <li>Account status: the status a user will be assigned when logging in for the first time. If a use is assigned a status    different from Activated an admin needs to manually activate each user from the User management.</li> <li>Group mapping: allows you to specify a mapping between LDAP groups and Hopsworks groups. The mapping is a    semicolon separated string in the form <code>Directory Administrators-&gt;HOPS_ADMIN;IT People-&gt; HOPS_USER</code>. Default   is empty. If no mapping is specified, users need to be assigned a role by an admin before they can log in.</li> <li>User id: the id field in LDAP with a string placeholder. Default <code>uid=%s</code>.</li> <li>User given name: the given name field in LDAP. Default <code>givenName</code>.</li> <li>User surname: the surname field in LDAP. Default <code>sn</code>.</li> <li>User email: the email field in LDAP. Default <code>mail</code>.</li> <li>User search filter: the search filter for user. Default <code>uid=%s</code>.</li> <li>Group search filter: the search filter for groups. Default <code>member=%d</code>.</li> <li>Group target: the target to search for groups in the LDAP directory tree. Default <code>cn</code>.</li> <li>Dynamic group target: the target to search for dynamic groups in the LDAP directory tree. Default <code>memberOf</code>.</li> <li>User dn: specify the distinguished name (DN) of the container or base point where the users are stored. Default is    empty. </li> <li>Group dn: specify the DN of the container or base point where the groups are stored. Default is empty.</li> </ul> <p>All defaults are taken from OpenLDAP.</p> <p>The login page will now have the choice to use LDAP for authentication.</p> Log in using LDAP <p>Note</p> <p>Group mapping can be disabled by setting <code>ldap_group_mapping_enabled=false</code> in the Configuration UI. When group mapping is disabled an administrator needs to activate each user from the User Management page.</p> <p>If group mapping is disabled then Account status in LDAP configuration above should be set to <code>Verified</code>.</p>"},{"location":"admin/ldap/configure-ldap/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure LDAP for authentication.</p>"},{"location":"admin/ldap/configure-project-mapping/","title":"Configure LDAP/Kerberos group to project mapping","text":""},{"location":"admin/ldap/configure-project-mapping/#introduction","title":"Introduction","text":"<p>A group to project mapping allows you to add members of your LDAP group to a project without having to add each user manually. A mapping is created by specifying a group from LDAP that will be mapped to a project in Hopsworks and what role the members of that group will be assigned in the project.</p> <p>Once a mapping is created, project membership is managed by LDAP group membership. Any change to group membership in LDAP will be reflected  in Hopsworks i.e. removing a user from the LDAP group will also remove them from the project.</p>"},{"location":"admin/ldap/configure-project-mapping/#prerequisites","title":"Prerequisites","text":"<ol> <li>A server configured with LDAP or Kerberos. See Server Configuration for Kerberos and Server Configuration for LDAP for instructions on how to do this.</li> <li>LDAP group mapping sync enabled. This can be done by setting the variable <code>ldap_group_mapping_sync_enabled=true</code>.  See Cluster Configuration on how to change variable values in Hopsworks.</li> </ol>"},{"location":"admin/ldap/configure-project-mapping/#step-1-create-a-mapping","title":"Step 1: Create a mapping","text":"<p>To create a mapping go to Cluster Settings by clicking on your name in the top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Project mapping tab, you can create a new mapping by clicking on Create new mapping.</p> Project mapping <p>This will take you to the create mapping page shown below</p> Create mapping <p>Here you can choose multiple Remote groups from your LDAP groups and map them to a project from the Project drop down list. You can also choose the Project role users will be assigned when they are added to the project.</p> <p>Finally, click on Create mapping and go back to mappings. You should see the newly created mapping(s) as shown below.</p> Project mappings <p>Note</p> <p>If there are no groups in the Remote group drop down list check if ldap_groups_search_filter is correct by using the value in <code>ldapsearch</code> replacing <code>%c</code> with <code>*</code>, as shown in the example below.</p> <p><code>ldapsearch -LLL -H ldap:/// -b '&lt;base dn&gt;' -D '&lt;user dn&gt;' -w &lt;password&gt; '(&amp;(objectClass=groupOfNames)(cn=*))'</code></p> <p>This should return all the groups in your LDAP. </p> <p>See Cluster Configuration on how to find and update the value of this variable.</p>"},{"location":"admin/ldap/configure-project-mapping/#step-2-edit-a-mapping","title":"Step 2: Edit a mapping","text":"<p>From the list of mappings click on the edit button (). This will make the row editable and allow you to change the remote group, project name, and project role of a mapping.</p> Edit mapping <p>Warning</p> <p>Updating a mapping's remote group or project name will remove all members of the previous group from the project.</p>"},{"location":"admin/ldap/configure-project-mapping/#step-3-delete-a-mapping","title":"Step 3: Delete a mapping","text":"<p>To delete a mapping click on the delete button.</p> <p>Warning</p> <p>Deleting a mapping will remove all members of that group from the project.</p>"},{"location":"admin/ldap/configure-project-mapping/#step-4-configure-sync-interval","title":"Step 4: Configure sync interval","text":"<p>After configuring all the group mappings users will be added to or removed from the projects in the mapping when they login to Hopsworks. It is also possible to synchronize mappings without requiring users to log out. This can be done by setting <code>ldap_group_mapping_sync_interval</code> to an interval greater or equal to 2 minutes. If <code>ldap_group_mapping_sync_interval</code> is set group mapping sync will run periodically based on the interval and add or remove users from projects.</p>"},{"location":"admin/ldap/configure-project-mapping/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure LDAP group to project mapping.</p>"},{"location":"admin/ldap/configure-server/","title":"Configure Server for LDAP and Kerberos","text":""},{"location":"admin/ldap/configure-server/#introduction","title":"Introduction","text":"<p>LDAP and Kerberos integration need some configuration in the Karamel  cluster definition used to deploy your Hopsworks cluster. This tutorial shows an administrator how to configure the application server for LDAP and Kerberos integration.</p>"},{"location":"admin/ldap/configure-server/#prerequisites","title":"Prerequisites","text":"<p>An accessable LDAP domain.  A Kerberos Key Distribution Center (KDC) running on the same domain as Hopsworks (Only for Kerberos).</p>"},{"location":"admin/ldap/configure-server/#step-1-server-configuration-for-ldap","title":"Step 1: Server Configuration for LDAP","text":"<p>The LDAP attributes below are used to configure JNDI external resource in Payara. The JNDI resource will communicate  with your LDAP server to perform the authentication.</p> <pre><code>ldap:\n    enabled: true\n    jndilookupname: \"dc=hopsworks,dc=ai\"\n    provider_url: \"ldap://193.10.66.104:1389\"\n    attr_binary_val: \"entryUUID\"\n    security_auth: \"none\"\n    security_principal: \"\"\n    security_credentials: \"\"\n    referral: \"ignore\"\n    additional_props: \"\"\n</code></pre> <ul> <li>jndilookupname: should contain the LDAP domain.</li> <li>attr_binary_val: is the binary unique identifier that will be used in subsequent logins to identify the user.</li> <li>security_auth: how to authenticate to the LDAP server.</li> <li>security_principal: contains the username of the user that will be used to query LDAP.</li> <li>security_credentials: contains the password of the user that will be used to query LDAP.</li> <li>referral: whether to follow or ignore an alternate location in which an LDAP Request may be processed.</li> </ul>"},{"location":"admin/ldap/configure-server/#without-karamelchef","title":"Without Karamel/Chef","text":"<p>An already deployed instance can be configured to connect to LDAP without re-running Karamel/Chef.  Go to the payara admin UI and create a new JNDI external resource. The name of the resource should be ldap/LdapResource. </p> LDAP Resource <p>This can also be achived by running the bellow asadmin command.</p> <pre><code>asadmin create-jndi-resource \\\n --restype javax.naming.ldap.LdapContext \\\n --factoryclass com.sun.jndi.ldap.LdapCtxFactory \\\n --jndilookupname dc\\=hopsworks\\,dc\\=ai \\\n --property java.naming.provider.url=ldap\\\\://193\\.10\\.66\\.104\\\\:1389:\\\n hopsworks.ldap.basedn=dc\\\\\\=hopsworks\\,dc\\\\\\=ai:\\\n java.naming.ldap.attributes.binary=entryUUID:\\\n java.naming.security.authentication=simple:\\\n java.naming.security.principal=&lt;username&gt;:\\\n java.naming.security.credentials=&lt;password&gt;:\\\n java.naming.referral=ignore \\\n ldap/LdapResource\n</code></pre>"},{"location":"admin/ldap/configure-server/#step-2-server-configuration-for-kerberos","title":"Step 2: Server Configuration for Kerberos","text":"<p>The Kerberos attributes are used to configure SPNEGO. SPNEGO is used to establish a secure context between the requester and the application server when using Kerberos  authentication.  </p> <pre><code>kerberos:\n    enabled: true\n    krb_conf_path: \"/etc/krb5.conf\"\n    krb_server_key_tab_path: \"/etc/security/keytabs/service.keytab\"\n    krb_server_key_tab_name: \"service.keytab\"\n    spnego_server_conf: '\\nuseKeyTab=true\\nprincipal=\\\"HTTP/server.hopsworks.ai@HOPSWORKS.AI\\\"\\nstoreKey=true\\nisInitiator=false'\nldap:\n    jndilookupname: \"dc=hopsworks,dc=ai\"\n    provider_url: \"ldap://193.10.66.104:1389\"\n    attr_binary_val: \"objectGUID\"\n    security_auth: \"none\"\n    security_principal: \"\"\n    security_credentials: \"\"\n    referral: \"ignore\"\n    additional_props: \"\"\n</code></pre> <p>Both Kerberos and LDAP attributes need to be specified to configure Kerberos. The LDAP attributes are explained above.</p> <ul> <li>krb_conf_path: contains the path to the krb5.conf used by SPNEGO to get information about the default domain and the    location of the Kerberos KDC. The file is copied by the recipe in to /srv/hops/domains/domain1/config.</li> <li>krb_server_key_tab_path: contains the path to the Kerberos service keytab. The keytab is copied by the recipe in to   /srv/hops/domains/domain/config with the name set in the krb_server_key_tab_name attribute.</li> <li>spnego_server_conf: contains the configuration that will be appended to Payara's (application serve used to host hopsworks)    login.conf. In particular, it should contain useKeyTab=true, and the principal name to be used in the authentication phase.    Initiator should be set to false.</li> </ul>"},{"location":"admin/ldap/configure-server/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure the application server for LDAP and Kerberos.</p>"},{"location":"admin/monitoring/export-metrics/","title":"Exporting Hopsworks metrics","text":""},{"location":"admin/monitoring/export-metrics/#introduction","title":"Introduction","text":"<p>Hopsworks services produce metrics which are centrally gathered by Prometheus and visualized in Grafana. Although the system is self-contained, it is possible to export these metrics to third-party services or another Prometheus instance.</p>"},{"location":"admin/monitoring/export-metrics/#prerequisites","title":"Prerequisites","text":"<p>In order to configure Prometheus to export metrics you need <code>root</code> SSH access to either Hopsworks or to the target server depending on the export method you choose below.</p>"},{"location":"admin/monitoring/export-metrics/#exporting-metrics","title":"Exporting metrics","text":"<p>Prometheus can be configured to export metrics to another Prometheus instance (cross-service federation) or to a custom service which knows how to handle them.</p>"},{"location":"admin/monitoring/export-metrics/#prometheus-federation","title":"Prometheus federation","text":"<p>Prometheus servers can be federated to scale better or to just clone all metrics (cross-service federation). Prometheus federation is well documented but there are some specificities to Hopsworks.</p> <p>In the guide below we assume Prometheus A is the service running in Hopsworks and Prometheus B is the server you want to clone metrics to.</p>"},{"location":"admin/monitoring/export-metrics/#step-1","title":"Step 1","text":"<p>Prometheus B needs to be able to connect to TCP port <code>9089</code> of Prometheus B to scrape metrics. If you have any firewall (or Security Group) in place, allow ingress for that port.</p>"},{"location":"admin/monitoring/export-metrics/#step-2","title":"Step 2","text":"<p>SSH into Prometheus B server, edit Prometheus configuration file and add the following under the <code>scrape_configs</code></p> <p>Note</p> <p>Replace IP_ADDRESS with the actual address of Hopsworks server</p> <pre><code>- job_name: 'federate'\n    scrape_interval: 15s\n\n    honor_labels: true\n    metrics_path: '/federate'\n\n    params:\n      'match[]':\n        - '{job=\"airflow\"}'\n        - '{job=\"pushgateway\"}'\n        - '{job=\"hadoop\"}'\n        - '{job=\"hopsworks\"}'\n\n    static_configs:\n      - targets:\n        - 'IP_ADDRESS:9089'\n</code></pre> <p>These are the basic labels gathered by Hopsworks.</p> <ul> <li> <p>If your Hopsworks cluster runs without Kubernetes append <code>'{job=\"cadvisor\"}'</code> to <code>match[]</code> list</p> </li> <li> <p>If your Hopsworks cluster runs with Kubernetes append the following labels to <code>match[]</code></p> <ul> <li><code>'{job=~\"knative.+\"}'</code></li> <li><code>'{job=\"kubernetes-cadvisor\"}'</code></li> <li><code>'{job=\"istio-envoy\"}'</code></li> <li><code>'{job=\"kube-state-metrics\"}'</code></li> <li><code>'{job=\"cadvisor\"}'</code></li> <li><code>'{job=\"cadvisor\"}'</code></li> <li><code>'{job=\"cadvisor\"}'</code></li> </ul> </li> </ul>"},{"location":"admin/monitoring/export-metrics/#step-3","title":"Step 3","text":"<p>Finally restart Prometheus service with <code>sudo systemctl restart prometheus</code></p>"},{"location":"admin/monitoring/export-metrics/#custom-service","title":"Custom service","text":"<p>Prometheus can push metrics to another custom resource via HTTP. The custom service is responsible for handling the received metrics. To push metrics with this method we use the <code>remote_write</code> configuration.</p> <p>We will only give a sample configuration as <code>remote_write</code> is extensively documented in Prometheus documentation In the example below we push metrics to a custom service listening on port 9096 which transforms the metrics and forwards them.</p> <pre><code>remote_write:\n  - url: \"http://localhost:9096\"\n    queue_config:\n      capacity: 10000\n      max_samples_per_send: 5000\n      batch_send_deadline: 60s\n</code></pre>"},{"location":"admin/monitoring/export-metrics/#conclusion","title":"Conclusion","text":"<p>In this guide we showed how you can push metrics outside of Hopsworks cluster using two methods, (a) federated Prometheus or (b) remote write to a custom service. This configuration is useful if you already have a centralized monitoring system with alerts already configured.</p>"},{"location":"admin/monitoring/grafana/","title":"Services Dashboards","text":""},{"location":"admin/monitoring/grafana/#introduction","title":"Introduction","text":"<p>The Hopsworks platform is composed of different services. Hopsworks uses Prometheus to collect health and performance metrics from the different services and Grafana to display them to the Hopsworks administrators. </p> <p>In this guide you will learn how to access the Grafana dashboards to monitor the health of the cluster or to troubleshoot performance issues.</p>"},{"location":"admin/monitoring/grafana/#prerequisites","title":"Prerequisites","text":"<p>To access the services dashboards in Grafana, you need to have an administrator account on the Hopsworks cluster.</p>"},{"location":"admin/monitoring/grafana/#step-1-access-grafana","title":"Step 1: Access Grafana","text":"<p>You can access the admin page of your Hopsworks cluster by clicking on your name, in the top right corner, and choosing Cluster Settings from the dropdown menu.</p> <p>You can then navigate to the Monitoring tab. The Monitoring tab gives you access to several of the observability tools that are already deployed to help you manage the health of the cluster.</p> Monitoring tab <p>Click on the Grafana link to open the Grafana web application and navigate through the dashboards.</p>"},{"location":"admin/monitoring/grafana/#step-2-navigate-through-the-dashboards","title":"Step 2: Navigate through the dashboards","text":"<p>In the Grafana web application, you can click on the Home button on the top left corner and navigate through the available dashboards.</p> <p>Dashboards are organized into three folders:</p> <ul> <li> <p>Hops: This folder contains all the dashboards of the Hopsworks services (e.g. the web application, the file system, resource manager) as well as the dashboards of the hosts (e.g. EC2 instances, virtual machines, servers) on which the cluster is deployed.</p> </li> <li> <p>RonDB: This folder contains all the dashboard related to the database. The Database dashboard contains a general overview of the RonDB cluster, while the remaining dashboards focus on specific items (e.g. thread activity, memory management, etc).</p> </li> <li> <p>Kubernetes: If you have integrated Hopsworks with a Kubernetes cluster, this folder contains the dashboards to monitor the health of the Kubernetes cluster.</p> </li> </ul> Grafana view <p>The default dashboards are read only and cannot be edited. Additional dashboards can be created by logging in to Grafana. You can log in into Grafana using the username and password specified in the cluster definition.</p> <p>Warning</p> <p>By default Hopsworks keeps metrics information only for the past 15 days. This means that, by default, you will not be able to access health and performance metrics which are older than 15 days.</p>"},{"location":"admin/monitoring/grafana/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to access the Grafana dashboards to monitor the health and performance of the Hopsworks services.</p> <p>You can find additional documentation on Grafana itself at: https://grafana.com/docs/</p>"},{"location":"admin/monitoring/services-logs/","title":"Services Logs","text":""},{"location":"admin/monitoring/services-logs/#introduction","title":"Introduction","text":"<p>The Hopsworks platform is composed of different services running on different nodes. Hopsworks uses Filebeat, Logstash and OpenSearch to collect, parse, index and present the logs to the Hopsworks administrators. </p> <p>In this guide you will learn how to access the Hopsworks logs using OpenSearch Dashboards.</p>"},{"location":"admin/monitoring/services-logs/#prerequisites","title":"Prerequisites","text":"<p>To access the services logs, you need to have an administrator account on the Hopsworks cluster.</p>"},{"location":"admin/monitoring/services-logs/#step-1-access-the-logs","title":"Step 1: Access the Logs","text":"<p>You can access the admin page of your Hopsworks cluster by clicking on your name, in the top right corner, and choosing Cluster Settings from the dropdown menu.</p> <p>You can then navigate to the Monitoring tab. The Monitoring tab gives you access to several of the observability tools that are already deployed to help you manage the health of the cluster.</p> Monitoring tab <p>Click on the Service Logs link to open the OpenSearch Dashboards web application and navigate through the logs.</p>"},{"location":"admin/monitoring/services-logs/#step-2-search-the-logs","title":"Step 2: Search the logs","text":"<p>In the OpenSearch dashboard web application you will see by default all the logs generated by all monitored services in the last 15 minutes. </p> <p>You can filter the logs of a specific service by searching for the term <code>service:[service name]</code>. As shown in the picture below, you can search for the namenode logs by querying <code>service:namenode</code>.</p> <p>Currently only the logs of the following services are collected and indexed: Hopsworks web application (called <code>domain1</code> in the log entires), namenodes, resource managers, datanodes, nodemanagers, Kafka brokers, Hive services and RonDB. These are the core component of the platform, additional logs will be added in the future.</p> OpenSearch Dashboards displaying the logs <p>Warning</p> <p>By default, logs are rotated automatically after 7 days. This means that by default, you will not be able to access logs through OpenSearch Dashboards which are older than 7 days. Depending on the service and on the Hopsworks configuration, you can still access the logs by SSH directly into the machines of the cluster.</p>"},{"location":"admin/monitoring/services-logs/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to access the services logs using OpenSearch Dashboards from the Hopsworks admin page. </p> <p>You can find additional documentation on OpenSearch Dashboards at: https://opensearch.org/docs/latest/</p>"},{"location":"admin/oauth2/create-azure-client/","title":"Create An Application in Azure Active Directory.","text":""},{"location":"admin/oauth2/create-azure-client/#introduction","title":"Introduction","text":"<p>This example uses Azure Active Directory as the identity provider, but the same can be done with any identity provider  supporting OAuth2 OpenID Connect protocol.</p>"},{"location":"admin/oauth2/create-azure-client/#prerequisites","title":"Prerequisites","text":"<p>Azure account.</p>"},{"location":"admin/oauth2/create-azure-client/#step-1-register-hopsworks-as-an-application-in-your-identity-provider","title":"Step 1: Register Hopsworks as an application in your identity provider","text":"<p>To use OAuth2 in Hopsworks you first need to create and configure an OAuth client in your identity provider. We will take the example of Azure AD for the remaining of this documentation, but equivalent steps can be taken on other identity providers.</p> <p>Navigate to the Microsoft Azure Portal and authenticate. Navigate to Azure Active Directory. Click on App Registrations. Click on New Registration.</p> <p> Create application </p> <p>Enter a name for the client such as hopsworks_oauth_client. Verify the Supported account type is set to Accounts in this organizational directory only. And Click Register.</p> <p> Name application </p>"},{"location":"admin/oauth2/create-azure-client/#step-2-get-the-nessary-fields-for-client-registration","title":"Step 2: Get the nessary fields for client registration","text":"<p>In the Overview section, copy the Application (client) ID field. We will use it in  Identity Provider registration under the name Client id.</p> <p> Copy client ID </p> <p>Click on Endpoints and copy the OpenId Connect metadata document endpoint excluding the .well-known/openid-configuration part.  We will use it in Identity Provider registration under the name Connection URL.</p> <p> Endpoint </p> <p>Click on Certificates &amp; secrets, then Click on New client secret.</p> <p> New client secret </p> <p>Add a description of the secret. Select an expiration period. And, Click Add.</p> <p> Client secret creation </p> <p>Copy the secret. This will be used in Identity Provider registration under the name  Client Secret.</p> <p> Client secret creation </p> <p>Click on Authentication. Then click on Add a platform</p> <p> Add a platform </p> <p>In Configure platforms click on Web.</p> <p> Configure platform: Web </p> <p>Enter the Redirect URI and click on Configure. The redirect URI is HOPSWORKS-URI/callback with HOPSWORKS-URI the URI of your Hopsworks cluster.</p> <p> Configure platform: Redirect </p> <p>Note</p> <p>If your Hopsworks cluster is created on the cloud (managed.hopsworks.ai), you can find your HOPSWORKS-URI by going to the managed.hopsworks.ai dashboard  in the General tab of your cluster and copying the URI.</p>"},{"location":"admin/oauth2/create-azure-client/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a client in your Azure identity provider and  acquire a client id and a client secret.</p>"},{"location":"admin/oauth2/create-client/","title":"Register Identity Provider in Hopsworks","text":""},{"location":"admin/oauth2/create-client/#introduction","title":"Introduction","text":"<p>Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and  acquire a client id and a client secret. An example on how to create a client using Okta and Azure Active Directory  identity providers can be found here and here respectively.</p>"},{"location":"admin/oauth2/create-client/#prerequisites","title":"Prerequisites","text":"<p>Acquired a client id and a client secret from your identity provider.</p>"},{"location":"admin/oauth2/create-client/#step-1-register-a-client","title":"Step 1: Register a client","text":"<p>After acquiring the client id and client secret create the client in Hopsworks by enabling OAuth2 and clicking on add another identity provider in the Authentication configuration page. Then set  base uri of your identity provider in Connection URL give a name to your identity provider (the name will be used  in the login page as an alternative login method) and set the client id and client secret in their respective  fields,  as shown in the figure below.</p> Application overview <ul> <li>Connection URL: (provider Uri) is the base uri of the identity provider's API (URI should contain scheme http:// or    https://). </li> </ul> <p>Additional configuration can be set here:</p> <ul> <li>Verify email: if checked only users with verified email address (in the identity provider) can log in to Hopsworks. </li> <li>Code challenge: if your identity provider requires code challenge for authorization request check    the code challenge check box. This will allow you to choose code challenge method that can be either plain or    S256.</li> <li>Logo URL: optionally a logo URL to an image can be added. The logo will be shown on the login page with the name    as shown in the figure below.</li> <li>Claim names for given name, family name, email and group can also be set here. If left empty the default openid claim names will be used.</li> </ul>"},{"location":"admin/oauth2/create-client/#step-2-add-group-mappings","title":"Step 2: Add Group mappings","text":"<p>Optionally you can add a group mapping from your identity provider to Hopsworks groups, by clicking on your name in the  top right corner of the navigation bar and choosing Cluster Settings from the dropdown menu. In the Cluster  Settings Configuration tab search for oauth_group_mapping and click on the edit button.</p> Set Configuration variables <p>Note</p> <p>Setting <code>oauth_group_mapping</code> to <code>ANY_GROUP-&gt;HOPS_USER</code> will assign the role user to any user from any group in  your identity provider when they log into Hopsworks with OAuth for the first time. You can replace ANY_GROUP with  the group of your choice in the identity provider. You can replace HOPS_USER by HOPS_ADMIN if you want the  users of that group to be admins in Hopsworks. You can do several mappings by separating them with a semicolon.</p> <p>Group mapping can be disabled by setting <code>oauth_group_mapping_enabled=false</code> in the Configuration UI. When group mapping is disabled an administrator needs to activate each user from the User Management page.</p> <p>If group mapping is disabled then <code>oauth_account_status</code> in the Configuration UI should be set to 1 (Verified).</p> <p>Users will now see a new button on the login page. The button has the name you set above for Name and will  redirect to your identity provider.</p> Login with OAuth2 <p>Note</p> <p>When creating a client make sure you can access the provider metadata by making a GET request on the well known  endpoint of the provider. The well-known URL, will typically be the Connection URL plus  <code>.well-known/openid-configuration</code>. For the above client it would be  <code>https://dev-86723251.okta.com/.well-known/openid-configuration</code>.</p>"},{"location":"admin/oauth2/create-client/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to register an identity provider in Hopsworks.</p>"},{"location":"admin/oauth2/create-okta-client/","title":"Create An Application in Okta","text":""},{"location":"admin/oauth2/create-okta-client/#introduction","title":"Introduction","text":"<p>This example uses an Okta development account to create an application that will represent a Hopsworks client in the  identity provider.</p>"},{"location":"admin/oauth2/create-okta-client/#prerequisites","title":"Prerequisites","text":"<p>Okta development account. To create a developer account go to Okta developer.</p>"},{"location":"admin/oauth2/create-okta-client/#step-1-register-hopsworks-as-an-application-in-your-identity-provider","title":"Step 1: Register Hopsworks as an application in your identity provider","text":"<p>After creating a developer account register a client by going to Applications and click on Create App Integration.</p> Okta Applications <p>This will open a popup as shown in the figure below. Select OIDC as Sign-in-method and Web Application as  Application type and click next.  Create new Application </p> <p>Give your application a name and select Client credential as Grant Type. Then add a Sign-in redirect URI  that is your Hopsworks cluster domain name (including the port number if needed) with path /callback, and a Sign-out  redirect URI that is Hopsworks cluster domain name (including the port number if needed) with no path.</p> New Application <p>If you want to limit who can access your Hopsworks cluster select Limit access to selected groups and  select group(s) you want to give access to. Here we will allow everyone in the organization to access the cluster.</p> Group assignment"},{"location":"admin/oauth2/create-okta-client/#group-mapping","title":"Group mapping","text":"<p>You can also create mappings from groups in Okta to groups in Hopsworks. To achieve this you need to configure Okta to  send Groups with user information. To do this go to Applications and select your application name. In the Sign  On tab click edit OpenID Connect ID Token and select Filter for Groups claim type, then for Groups claim  filter add groups as the claim name, select Match Regex from the dropdown and .* (dot star) as Regex to  match all groups. See Group mapping on how to do the mapping in Hopsworks.</p> Group claim"},{"location":"admin/oauth2/create-okta-client/#step-2-get-the-nessary-fields-for-client-registration","title":"Step 2: Get the nessary fields for client registration","text":"<p>After the application is created go back to Applications and click on the application you just created. Use the Okta domain (Connection URL), client id and client secret generated for your app in the  Identity Provider registration in Hopsworks.</p> Application overview <p>Note</p> <p>When copying the domain in the figure above make sure to add the url scheme (http:// or https://) when using it  in the Connection URL in the Identity Provider registration form.</p>"},{"location":"admin/oauth2/create-okta-client/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a client in your Okta identity provider and  acquire a client id and a client secret.</p>"},{"location":"concepts/hopsworks/","title":"Hopsworks Platform","text":"<p>Hopsworks is a modular MLOps platform with:</p> <ul> <li>a feature store (available as standalone)</li> <li>model registry and model serving based on KServe</li> <li>vector database based on OpenSearch</li> <li>a data science and data engineering platform</li> </ul> <p></p>"},{"location":"concepts/hopsworks/#standalone-feature-store","title":"Standalone Feature Store","text":"<p>Hopsworks was the first open-source and first enterprise feature store for ML.  You can use Hopsworks as a standalone feature store with the HSFS API.</p>"},{"location":"concepts/hopsworks/#model-management","title":"Model Management","text":"<p>Hopsworks includes support for model management, with model deployments using the KServe framework and a model registry designed for KServe. Hopsworks logs all inference requests to Kafka to enable easy monitoring of deployed models, and provides model metrics with grafana/prometheus.</p>"},{"location":"concepts/hopsworks/#vector-db","title":"Vector DB","text":"<p>Hopsworks provides a vector database (or embedding store) based on OpenSearch kNN (FAISS and nmslib). Hopsworks Vector DB includes out-of-the-box support for authentication, access control, filtering, backup-and-restore, and horizontal scalability. Hopsworks' Feature Store and vector DB are often used together to build scalable recommender systems, such as ranking-and-retrieval for real-time recommendations. </p>"},{"location":"concepts/hopsworks/#governance","title":"Governance","text":"<p>Hopsworks provides a data-mesh architecture for managing ML assets and teams, with multi-tenant projects. Not unlike a GitHub repository, a project is a sandbox containing team members, data, and ML assets. In Hopsworks, all ML assets (features, models, training data) are versioned, taggable, lineage-tracked, and support free-text search. Data can be also be securely shared between projects.</p>"},{"location":"concepts/hopsworks/#data-science-platform","title":"Data Science Platform","text":"<p>You can develop feature engineering pipelines and training pipelines in Hopsworks. There is support for version control (GitHub, GitLab, BitBucket), Jupyter notebooks, a shared distributed file system, per project conda environments for managing python dependencies without needing to write Dockerfiles, jobs (Python, Spark, Flink), and workflow orchestration with Airflow.</p>"},{"location":"concepts/dev/inside/","title":"Inside Hopsworks","text":"<p>Hopsworks provides a complete self-service development environment for feature engineering and model training. You can develop programs as Jupyter notebooks or jobs, you can manage the Python libraries in a project using its conda environment, you can manage your source code with Git, and you can orchestrate jobs with Airflow.</p> <p></p>"},{"location":"concepts/dev/inside/#jupyter-notebooks","title":"Jupyter Notebooks","text":"<p>Hopsworks provides a Jupyter notebook development environment for programs written in Python, Spark, Flink, and SparkSQL. You can also develop in your IDE (PyCharm, IntelliJ, etc), test locally, and then run your programs as Jobs in Hopsworks. Jupyter notebooks can also be run as Jobs.</p>"},{"location":"concepts/dev/inside/#source-code-control","title":"Source Code Control","text":"<p>Hopsworks provides source code control support using Git (GitHub, GitLab or BitBucket). You can securely checkout code into your project and commit and push updates to your code to your source code repository. </p>"},{"location":"concepts/dev/inside/#conda-environment-per-project","title":"Conda Environment per Project","text":"<p>Hopsworks supports the self-service installation of Python libraries using PyPi, Conda, Wheel files, or GitHub URLs. The Python libraries are installed in a Conda environment linked with your project. Each project has a base Docker image and its custom conda environment. Jobs are run as Docker images, but they are compiled transparently for you when you update your Conda environment. That is, there is no need to write a Dockerfile, users install Python libraries in their project. You can setup custom development and production environments by creating new projects, each with their own conda environment.</p>"},{"location":"concepts/dev/inside/#jobs","title":"Jobs","text":"<p>In Hopsworks, a Job is a schedulable program that is allocated compute and memory resources. You can run a Job in Hopsworks:</p> <ul> <li>from the UI;</li> <li>programmatically with the Hopsworks SDK (Python, Java) or REST API;</li> <li>from Airflow programs (either inside our outside Hopsworks);</li> <li>from your IDE using a plugin (PyCharm/IntelliJ plugin);</li> </ul>"},{"location":"concepts/dev/inside/#orchestration","title":"Orchestration","text":"<p>Airflow comes out-of-the box with Hopsworks, but you can also use an external Airflow cluster (with the Hopsworks Job operator) if you have one. Airflow can be used to schedule the execution of Jobs, individually or as part of Airflow DAGs.</p>"},{"location":"concepts/dev/outside/","title":"Outside Hopsworks","text":"<p>You can write programs that use Hopsworks in any Python, Spark, PySpark, or Flink environment. Hopsworks also running SQL queries to compute features in external data warehouses. The Feature Store can also be queried with SQL.</p> <p>There is REST API for Hopsworks that can be used with a valid API key, generated in Hopsworks. However, it is often easier to develop your programs against SDKs available in Python and Java/Scala for HSFS, in Python for HSML, and in Python for the Hopsworks API.</p> <p></p>"},{"location":"concepts/fs/","title":"Architecture","text":""},{"location":"concepts/fs/#what-is-hopsworks-feature-store","title":"What is Hopsworks Feature Store?","text":"<p>Hopsworks and its Feature Store are an open source data-intensive AI platform used for the development and operation of machine learning models at scale. The Hopsworks Feature Store provides the HSFS API to enable clients to write features to feature groups in the feature store, and to read features from feature views - either through a low latency Online API to retrieve pre-computed features for operational models or through a high throughput, latency insensitive Offline API, used to create training data and to retrieve batch data for scoring.</p> <p></p>"},{"location":"concepts/fs/#hsfs-api","title":"HSFS API","text":"<p>The HSFS (HopsworkS Feature Store) API is how you, as a developer, will use the feature store. The HSFS API helps simplify some of the problems that feature stores address including:</p> <ul> <li>consistent features for training and serving</li> <li>centralized, secure access to features</li> <li>point-in-time JOINs of features to create training data with no data leakage</li> <li>easier connection and backfilling of features from external data sources</li> <li>use of external tables as features</li> <li>transparent computation of statistics and usage data for features.</li> </ul>"},{"location":"concepts/fs/#write-to-feature-groups-read-from-feature-views","title":"Write to feature groups, read from feature views.","text":"<p>You write to feature groups with a feature pipeline program. The program can be written in Python, Spark, Flink, or SQL.</p> <p>You read from views on top of the feature groups, called feature views. That is, a feature view does not store feature data, but is a logical grouping of features. Typically, you define a feature view because you want to train/deploy a model with exactly those features in the feature view. Feature views enable the reuse of feature data from different feature groups across different models.</p>"},{"location":"concepts/fs/feature_group/external_fg/","title":"External Feature Groups","text":"<p>External feature groups are offline feature groups where their data is stored in an external table. An external table requires a storage connector, defined with the Connector API (or more typically in the user interface), to enable HSFS to retrieve data from the external table. An external table includes a user-defined SQL string for retrieving data, but you also perform SQL operations, including projections, aggregations, and so on. The SQL query is executed on-demand when HSFS retrieves data from the external Feature Group, for example, when creating training data using features in the external table.</p> <p>In the image below, we can see that HSFS currently supports a large number of data sources, including any JDBC-enabled source, Snowflake, Data Lake, Redshift, BigQuery, S3, ADLS, GCS, and Kafka</p> <p></p>"},{"location":"concepts/fs/feature_group/feature_pipelines/","title":"Feature Pipelines","text":"<p>A feature pipeline is a program that orchestrates the execution of a dataflow graph of data validation, aggregation, dimensionality reduction, transformation, and other feature engineering steps on input data to create and/or update feature data. With HSFS, you can write feature pipelines in different languages as shown in the figure below. </p> <p></p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#data-sources","title":"Data Sources","text":"<p>Your feature pipeline needs to connect to some (external) data source to read the data to be processed. Python, Spark, and Flink have connectors to a huge number of different data sources, while SQL feature pipelines are often restricted to a single data source (for example, your connector to SnowFlake only runs SQL on SnowFlake). SparkSQL, in contrast, can be used over tables that originate in different  data sources.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#data-validation","title":"Data Validation","text":"<p>In order to be able to train and serve models that you can rely on, you need clean, high quality features. Data validation operations include removing bad data, removing or imputing missing values, and identifying problems such as feature shift. HSFS supports Great Expectations to specify data validation rules that are executed in the client before features are written to the Feature Store. The validation results are collected and shown in Hopsworks.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#aggregations","title":"Aggregations","text":"<p>Aggregations are used to summarize large datasets into more concise, signal-rich features. Popular aggregations include count(), sum(), mean(), median(), stddev(), min(), and max(). These aggregations produce a single number (a numerical feature) that captures information about a potentially large dataset. Both numerical and categorical features are often transformed before being used to train or serve models.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#dimensionality-reduction","title":"Dimensionality Reduction","text":"<p>If input data is impractically large or if it has a significant amount of redundancy, it can often be transformed into a reduced set of features with dimensionality reduction (often called feature extraction). Popular dimensionality algorithms include embedding algorithms, PCA, and TSNE.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#transformations","title":"Transformations","text":"<p>Transformations are covered in more detail in training/inference pipelines, as transformations typically happen after the feature store. If you store transformed features in feature groups, the feature data is no longer useful for EDA (as it near to impossible for Data Scientists to understand the transformed values). It also makes it impossible for inference pipelines to log untransformed feature values and predictions for an operational model. There is one use case for storing transformed features in feature groups - when you need to have ultra low latency when reading precomputed features (and online transformations when reading features add too much latency for your use case). The figure below shows to include transformations in your feature pipelines. </p> <p></p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#feature-engineering-in-python","title":"Feature Engineering in Python","text":"<p>Python is the most widely used framework for feature engineering due to its extensive library support for aggregations (Pandas), data validation (Great Expectations), and dimensionality reduction (embeddings, PCA), and transformations (in Scikit-Learn, TensorFlow, PyTorch). Python also supports open-source feature engineering frameworks used for automated feature engineering, such as featuretools that supports relational and temporal sources.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#feature-engineering-in-sparkpyspark","title":"Feature Engineering in Spark/PySpark","text":"<p>Spark is popular as a feature engineering framework as it can scale to process larger volumes of data than Python, and provides native support for aggregations, and it supports many of the same data validation (Great Expectations), and dimensionality reduction algorithms (embeddings, PCA) as Python. Spark also has native support for transformations, which are useful for analytical models (batch scoring), but less useful for operational models, where online transformations are required, and Spark environments are less common. Online model serving environments typically only support online transformations in Python.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#feature-engineering-in-sql","title":"Feature Engineering in SQL","text":"<p>SQL has grown in popularity for performing heavy lifting in feature pipelines - computing aggregates on data - when the input data already resides in a data warehouse. Data warehouses also support data validation, for example, through Great Expectations in DBT. However, SQL is not mature as a platform for transformations and dimensionality reductions, where UDFs are applied row-wise.</p> <p>You can do aggregation in SQL for data in your data warehouse or database.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#feature-engineering-in-flink","title":"Feature Engineering in Flink","text":"<p>Apache Flink is a powerful and flexible framework for stateful feature computation operations over unbounded and bounded data streams. It is used for feature engineering when you need very fresh features computed in real-time. Flink provides a rich set of operators and functions such as time windows and aggregation operations that can be applied to keyed and/or global window streams. Flink\u2019s stateful operations allow users to maintain and update state across multiple data records or events, which is particularly useful for feature engineering tasks such as sessionization and/or maintaining rolling aggregates over a sliding window of data.</p> <p>Flink feature engineering pipelines are supported in Java/Scala only.</p>"},{"location":"concepts/fs/feature_group/feature_pipelines/#feature-engineering-in-beam","title":"Feature Engineering in Beam","text":"<p>Beam feature engineering pipelines are supported in Java/Scala only. </p>"},{"location":"concepts/fs/feature_group/fg_overview/","title":"Overview","text":"<p>As a programmer, you can consider a feature, in machine learning, to be a variable associated with some entity that contains a value that is useful for helping train a model to solve a prediction problem. That is, the feature is just a variable with predictive power for a machine learning problem, or task.</p> <p>A feature group is a table of features, where each feature group has a primary key, and optionally an event_time column (indicating when the features in that row were observed), and a partition key. Collectively, they are referred to as columns. The partition key determines how to layout the feature group rows on disk such that you can efficiently query the data using queries with the partition key. For example, if your partition key is the day and you have hundreds of days worth of data, with a partition key, you can query the day for only a given day or a range of days, and only the data for those days will be read from disk.</p> <p></p>"},{"location":"concepts/fs/feature_group/fg_overview/#online-and-offline-storage","title":"Online and offline Storage","text":"<p>Feature groups can be stored in a low-latency \"online\" database and/or in low cost, high throughput  \"offline\" storage, typically a data lake or data warehouse. The online store stores only the latest values of features for a feature group. It is used to serve pre-computed features to models at runtime. The offline store stores the historical values of features for a feature group, so it may store many times more data than the online store. Offline feature groups are used, typically, to create training data for models, but also to retrieve data for batch scoring of models:</p> <p></p>"},{"location":"concepts/fs/feature_group/fg_statistics/","title":"Data Validation/Stats/Alerts","text":"<p>HSFS supports monitoring, validation, and alerting for features:</p> <ul> <li>transparently compute statistics over features on writing to a feature group;</li> <li>validation of data written to feature groups using Great Expectations</li> <li>alerting users when there was a problem writing or update features. </li> </ul>"},{"location":"concepts/fs/feature_group/fg_statistics/#statistics","title":"Statistics","text":"<p>When you create a Feature Group in HSFS, you can configure it to compute statistics over the features inserted into the fFeature Group by setting the <code>statistics_config</code> dict parameter, see Feature Group Statistics for details. Every time you write to the Feature Group, new statistics will be computed over all of the data in the Feature Group.</p>"},{"location":"concepts/fs/feature_group/fg_statistics/#data-validation","title":"Data Validation","text":"<p>You can define expectation suites in Great Expectations and associate them with feature groups. When you write to a feature group, the expectations are executed, then you can define a policy on the feature group for what to do if any expectation fails.</p> <p></p>"},{"location":"concepts/fs/feature_group/fg_statistics/#alerting","title":"Alerting","text":"<p>HSFS also supports alerts, that can be triggered when there are problems in your feature pipelines, for example, when a write fails due to an error or a failed expectation. You can send alerts to different alerting endpoints, such as email or Slack, that can be configured in the Hopsworks UI. For example, you can send a slack message if features being written to a feature group are missing some input data.</p>"},{"location":"concepts/fs/feature_group/on_demand_feature/","title":"On-demand features","text":"<p>Features are defined as on-demand when their value cannot be pre-computed beforehand, rather they need to be computed in real-time during inference. This is achieved by implementing the on-demand features as a Python function in a Python module. Also ensure that the same version of the Python module is installed in both the feature and inference pipelines.</p> <p>In the image below shows an example of a housing price model that demonstrates how to implement an on-demand feature, a zip code (or post code) that is computed using longitude/latitude parameters. In your online application, longitude and latitude are provided as parameters to the application, and the same python function used to calculate the zip code in the feature pipeline is used to compute the zip code in the Online Inference pipeline. </p> <p></p>"},{"location":"concepts/fs/feature_group/spine_group/","title":"Spine Group","text":"<p>It is possible to maintain labels or prediction events among the regular features in a regular feature group with a feature pipeline updating the labels at a specific cadence.</p> <p>Often times, however, it is more convenient to provide the training events or entities in a Dataframe when reading feature data from the feature store through a feature view. We call such a Dataframe a Spine as it is the structure around which the training data or batch data is built. In order to retrieve the correct feature values for the entities in the Dataframe, using a point-in-time correct join, some additional metadata apart from the Dataframe schema is necessary. Namely, the information about which columns define the primary key, and which column indicates the event time at which the label was valid. The spine Dataframe together with this additional metadata is what we call a Spine Group.</p> <p>For example, in the following spine, we want to retrieve the features for the three locations, no later than the event time of each of the rainfall measurements, which is our prediction target:</p> location_id event_time rainfall (label) 1 2022-06-01 13:11 44 2 2022-06-01 09:14 5 3 2022-06-01 06:36 2 <p>A Spine Group does not materialize any data to the feature store itself, and always needs to be provided when retrieving features from the offline API. You can think of it as a place holder or a temporary feature group, to be replaced by a Dataframe in point-in-time joins.</p> <p>When using the online API, it is not necessary to provide the spine, since the online feature store contains only the latest feature values, and therefore no point in time join is required, the label is not required, as the inference pipeline is going to compute the prediction and the primary key values are specified when calling the online API.</p>"},{"location":"concepts/fs/feature_group/versioning/","title":"Versioning","text":"<p>See here for information about version of feature views.</p>"},{"location":"concepts/fs/feature_group/versioning/#schema-versioning","title":"Schema Versioning","text":"<p>The schema of feature groups is versioned. If you make a breaking change to the schema of a feature group, you need to increment the version of the feature group, and then backfill the new feature group. A breaking schema change is when you:</p> <ul> <li>drop a column from the schema</li> <li>add a new feature without any default value for the new feature</li> <li>change how a feature is computed, such that, for training models, the data for the old feature is not compatible with the data for the new feature. For example, if you have an embedding as a feature and change the algorithm to compute that embedding, you probably should not mix feature values computed with the old embedding model with feature values computed with the new embedding model.</li> </ul> <p></p>"},{"location":"concepts/fs/feature_group/versioning/#data-versioning-for-feature-groups","title":"Data Versioning for Feature Groups","text":"<p>Data Versioning of a feature group involves tracking updates to the feature group, so that you can recover the state of the feature group at a given point-in-time in the past.</p> <p></p>"},{"location":"concepts/fs/feature_group/write_apis/","title":"Write APIs","text":"<p>You write to feature groups, and read from feature views.</p> <p>There are 3 APIs for writing to feature groups, as shown in the table below:</p> Stream API Batch API Connector API Python X - - Spark X X - Flink X - - External Table - - X"},{"location":"concepts/fs/feature_group/write_apis/#stream-api","title":"Stream API","text":"<p>The Stream API is the only API for Python and Flink clients, and is the preferred API for Spark, as it ensures consistent features between offline and online feature stores. The Stream API first writes data to be ingested to a Kafka topic, and then Hopsworks ensures that the data is synchronized to the Online and Offline Feature Groups through the OnlineFS service and Hudi DeltaStreamer jobs, respectively. The data in the feature groups is guaranteed to arrive at-most-once, through idempotent writes to the online feature group (only the latest values of features are stored there, and duplicates in Kafka only cause idempotent updates) and duplicate removal by Apache Hudi for the offline feature group.</p> <p></p>"},{"location":"concepts/fs/feature_group/write_apis/#batch-api","title":"Batch API","text":"<p>For very large updates to feature groups, such as when you are backfilling large amounts of data to an offline feature group, it is often preferential to write directly to the Hudi tables in Hopsworks, instead of via Kafka - thus reducing write amplification. Spark clients can write directly to Hudi tables on Hopsworks with Hopsworks libraries and certificates using a HDFS API. This requires network connectivity between the Spark clients and the datanodes in Hopsworks.</p> <p></p>"},{"location":"concepts/fs/feature_group/write_apis/#connector-api","title":"Connector API","text":"<p>Hopsworks supports external tables as feature groups. You can mount a table from an external database as an offline feature group using the Connector API - you create an external table using the connector. This enables you to use features from your external data source (Snowflake, Redshift, Delta Lake, etc) as you would any feature in an offline feature group in Hopsworks. You can, for example, join features from different feature groups (external or not) together to create feature views and training data for models.</p> <p></p>"},{"location":"concepts/fs/feature_view/fv_overview/","title":"Overview","text":"<p>A feature view is a logical view over (or interface to) a set of features that may come from different feature groups. You create a feature view by joining together features from existing feature groups. In the illustration below, we can see that features are joined together from the two feature groups: seller_delivery_time_monthly and the seller_reviews_quarterly. You can also see that features in the feature view inherit not only the feature type from their feature groups, but also whether they are the primary key and/or the event_time. The image also includes transformation functions that are applied to individual features. Transformation functions are a part of the feature types included in the feature view. That is, a feature in a feature view is not only defined by its data type (int, string, etc) or its feature type (categorical, numerical, embedding), but also by its transformation. </p> <p></p> <p>Feature views can also include:</p> <ul> <li>the label for the supervised ML problem </li> <li>transformation functions that should be applied to specified features consistently between training and serving</li> <li>the ability to create training data</li> <li>the ability to retrieve a feature vector with the most recent feature values</li> </ul> <p>In the flow chart below, we can see the decisions that can be taken when creating (1) a feature view, and (2) creating training data with the feature view.</p> <p></p> <p>We can see here how the feature view is a representation for a model in the feature store - the same feature view is used to retrieve feature vectors for operational model that was created with training data from this feature view. As such, you can see that the most common use case for creating a feature view is to define the features that will be used in a model. In this way, feature views enable features from different feature groups to be reused across different models, and if features are stored untransformed in feature groups, they become even more reusable, as different feature views can apply different transformations to the same feature.</p>"},{"location":"concepts/fs/feature_view/offline_api/","title":"Offline API","text":"<p>The feature view provides an Offline API for</p> <ul> <li>creating training data</li> <li>creating batch (scoring) data</li> </ul>"},{"location":"concepts/fs/feature_view/offline_api/#training-data","title":"Training Data","text":"<p>Training data is created using a feature view. You can create training data as either:</p> <ul> <li>in-memory Pandas DataFrames, useful when you have a small amount of training data;</li> <li>materialized training data in files, in a file format of your choice (such as .tfrecord, .csv, or .parquet).</li> </ul> <p>You can apply filters when creating training data from a feature view:</p> <ul> <li>start-time and end-time, for example, to create the train-set from an earlier time range, and the test-set from a later (unseen) time range;</li> <li>feature value features, for example, only train a model on customers from a particular country.</li> </ul> <p>Note that filters are not applied when retrieving feature vectors using feature views, as we only look up features for a specific entity, like a customer. In this case, the application should know that predictions for this customer should be made on the model trained on customers in USA, for example.</p>"},{"location":"concepts/fs/feature_view/offline_api/#point-in-time-correct-training-data","title":"Point-in-time Correct Training Data","text":"<p>When you create training data from features in different feature groups, it is possible that the feature groups are updated at different cadences. For example, maybe one feature group is updated hourly, while another feature group is updated daily. It is very complex to write code that joins features together from such feature groups and ensures there is no data leakage in the resultant training data. HSFS hides this complexity by performing the point-in-time JOIN transparently, similar to the illustration below:</p> <p></p> <p>HSFS uses the event_time columns on both feature groups to determine the most recent (but not newer) feature values that are joined together with the feature values from the feature group containing the label. That is, the features in the feature group containing the label are the observation times for the features in the resulting training data, and we want feature values from the other feature groups that have the most recent timestamps, but not newer than the timestamp in the label-containing feature group.</p>"},{"location":"concepts/fs/feature_view/offline_api/#spine-dataframes","title":"Spine Dataframes","text":"<p>The left side of the point-in-time join is typically the set of training entities/primary key values for which the relevant features need to be retrieved. This left side of the join can also be replaced by a spine group. When using feature groups also so save labels/prediction targets, it can happen that you end up with the same entity multiple times in the training dataset depending on the cadence at which the label group was updated and the length of the event time interval that is being used to generate the training dataset. This can lead to bias in the training dataset and should be avoided. To avoid this kind of situation, users can either narrow down the event time interval during training dataset creation or use a spine in order to precisely define the entities to be included in the training dataset. This is just one example where spines are helpful.</p>"},{"location":"concepts/fs/feature_view/offline_api/#splitting-training-data","title":"Splitting Training Data","text":"<p>You can create random train/validation/test splits of your training data using the HSFS API. You can also time-based splits with the HSFS API.</p>"},{"location":"concepts/fs/feature_view/offline_api/#evaluation-sets","title":"Evaluation Sets","text":"<p>Test data can also be split into evaluation sets to help evaluate a model for potential bias. First, you have to identify the classes of samples that could be at risk of bias, and generate evaluation sets from your unseen test set - one evaluation set for each group of samples at risk of bias. For example, if you have a feature group of users, where one of the features is gender, and you want to evaluate the risk of bias due to gender, you can use filters to generate 3 evaluation sets from your test set - one for male, female, and non-binary. Then you score your model against all 3 evaluation sets to ensure that the prediction performance is comparable and non-biased across all 3 gender.</p>"},{"location":"concepts/fs/feature_view/offline_api/#batch-scoring-data","title":"Batch (Scoring) Data","text":"<p>Batch data for scoring models is created using a feature view. Similar to training data, you can create batch data as either:</p> <ul> <li>in-memory Pandas DataFrames, useful when you have a small amount of data to score;</li> <li>materialized data in files, in a file format of your choice (such as .tfrecord, .csv, or .parquet)</li> </ul> <p>Batch data requires specification of a <code>start_time</code> for the start of the batch scoring data. You can also specify the <code>end_time</code> (default is the current date).</p> <p></p>"},{"location":"concepts/fs/feature_view/offline_api/#spine-dataframes_1","title":"Spine Dataframes","text":"<p>Similar to training dataset generation, it might be helpful to specify a spine when retrieving features for batch inference. The only difference in this case is that the spine dataframe doesn't need to contain the label, as this will be the output of the inference pipeline. A typical use case is the handling of opt-ins, where certain customers have to be excluded from an inference pipeline due to a missing marketing opt-in.</p>"},{"location":"concepts/fs/feature_view/online_api/","title":"Online API","text":"<p>The Feature View provides an Online API to return an individual feature vector, or a batch of feature vectors, containing the latest feature values. To retrieve a feature vector, a client needs to provide the primary key(s) for the feature groups backing the feature view. For example, if you have <code>customer_profile</code> and <code>customer_purchases</code> Feature Groups both with <code>customer_id</code> as a primary key, and a Feature View made up from features from both Feature Groups, then, you would use <code>customer_id</code> to retrieve a feature vector using the Feature View object.</p>"},{"location":"concepts/fs/feature_view/online_api/#feature-vectors","title":"Feature Vectors","text":"<p>A feature vector is a row of features (without the primary key(s) and event timestamp):</p> <p></p> <p>It may be the case that for any given feature vector, not all features will come pre-engineered from the feature store. Some features will be provided by the client (or at least the raw data to compute the feature will come from the client). We call these 'passed' features and, similar to precomputed features from the feature store, they can also be transformed by the HSFS client in the method:</p> <ul> <li>feature_view.get_feature_vector(entry, passed_features={...})</li> </ul>"},{"location":"concepts/fs/feature_view/statistics/","title":"Statistics","text":"<p>The feature view does not contain any statistics, as it is simply an interface consisting of a number of features and any transformation functions applied to those features.</p> <p>However, training data can have descriptive statistics over it computed by HSFS. Descriptive statistics for training data is important for model monitoring, as it can enable model monitoring. If you compute the same descriptive statistics over windows of input features to models, you can help determine when there is a significant change in the distribution of an input feature, so-called feature shift.</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/","title":"Consistent Transformations","text":"<p>A training pipeline is a program that orchestrates the training of a machine learning model. For supervised machine learning, a training pipeline requires both features and labels, and these can typically be retrieved from the feature store as either in-memory Pandas DataFrames or read as training data files, created from the feature store. An inference pipeline is a program that takes user input, optionally enriches it with features from the feature store, and builds a feature vector (or batch of feature vectors) with with it uses a model to make a prediction.</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/#transformations","title":"Transformations","text":"<p>Feature transformations are mathematical operations that change feature values with the goal of improving model convergence or performance properties. Transformation functions take as input a single value (or small number of values), they often require state (such as the mean value of a feature to normalize the input), and they output a single value or a list of values.</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/#training-serving-skew","title":"Training Serving Skew","text":"<p>It is crucial that the transformations performed when creating features (for training or serving) are consistent - use the same code - to avoid training/serving skew. In the image below, you can see that transformations happen after the Feature Store, but that the implementation of the transformation functions need to be consistent between the training and inference pipelines. </p> <p></p> <p>There are 3 main approaches to prevent training/serving skew that we support in Hopsworks. These are (1) perform transformations in models, (2) perform transformations in pipelines (sklearn, TF, PyTorch) and use the model registry to save the transformation pipeline so that the same transformation is used in your inference pipeline, and (3) use HSFS transformations, defined as UDFs in Python.</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/#transformations-as-pre-processing-layers-in-models","title":"Transformations as Pre-Processing Layers in Models","text":"<p>Transformation functions can be implemented as preprocessing steps within a model. For example, you can write a transformation function as a pre-processing layer in Keras/TensorFlow. When you save the model, the preprocessing steps will also be saved as part of the model. Any state required to compute the transformation, such as the arithmetic mean of a numerical feature in the train set, is also stored with the function, enabling consistent transformations during inference.  When data preprocessing is part of the model, users can just send the untransformed feature values to the model and the model itself will apply any transformation functions as preprocessing layers (such as encoding categorical variables or normalizing numerical variables).</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/#transformation-pipelines-in-scikit-learntensorflowpytorch","title":"Transformation Pipelines in Scikit-Learn/TensorFlow/PyTorch","text":"<p>You have to save your transformation pipeline (serialize the object or the parameters) and make sure you apply exactly the same transformations in your inference pipeline. This means you should version the transformations. In Hopsworks, you can store the transformations with your versioned models in the Model Registry, helping you to ensure the same transformation pipeline is applied to both training/serving for the same model version.</p>"},{"location":"concepts/fs/feature_view/training_inference_pipelines/#transformations-as-python-udfs-in-hsfs","title":"Transformations as Python UDFs in HSFS","text":"<p>Hopsworks feature store also supports consistent transformation functions by enabling a Python UDF, that implements a transformation, to be attached a to feature in a feature view. When training data is created with a feature view or when a feature vector is retrieved from a feature view, HSFS ensures that any transformation functions defined over any features will be applied before returning feature values. You can use built-in transformation objects in HSFS or write your own custom transformation functions as Python UDFs. The benefit of this approach is that transformations are applied consistently when creating training data and when retrieving feature data from the online feature store. Transformations no longer need to be included in either your training pipeline or inference pipeline, as they are applied transparently when creating training data and retrieving feature vectors. Hopsworks uses Spark to create training data as files, and any transformation functions for features are executed as Python UDFs in Spark - enabling transformation functions to be applied on large volumes of data and removing potentially CPU-intensive transformations from training pipelines.</p>"},{"location":"concepts/fs/feature_view/versioning/","title":"Versioning","text":"<p>Feature views are interfaces, and if there is a change in the interface (the types of the features, the transformations applied to the features), then you need to change the version, to prevent breaking existing clients.</p> <p>Training datasets are associated with a specific feature view version. Training data also has its own version number (along with the version of its parent feature view). For example, online transformation functions often need training data statistics (e.g., normalizing a numerical feature requires you to divide the feature value by the mean value for that feature in the training dataset). As many training datasets can be created from a feature view, when you initialize the feature view you need to tell it which version of the training data to use - <code>feature_view.init(1)</code> means use version 1 of the training data for this feature view.</p>"},{"location":"concepts/mlops/bi_tools/","title":"BI Tools","text":"<p>The Hopsworks Feature Store is based on an offline data store, queryable via an Apache Hive API, and an online data store, queryable via a MySQL Server API.</p> <p>Given that Feature Groups in Hopsworks have well-defined schemas, features in the Hopsworks Feature Store can be analyzed and reports can be generated from them using any BI Tools that include connectors for MySQL (JDBC) and Apache Hive (2-way TLS required). One platform we use with customers is Apache Superset, as it can be configured alongside Hopsworks to provide BI Tooling capabilities.</p>"},{"location":"concepts/mlops/kserve/","title":"Model Serving","text":"<p>KServe is an open-source framework for model serving on Kubernetes. In Hopsworks, you can easily deploy models from the model registry in KServe or in Docker containers (for Hopsworks Community). You can deploy models in either programs, using the HSML library, or in the UI. A KServe model deployment can include the following components:</p> <ul> <li>Transformer<ul> <li>A pre-processing and post-processing component that can transform model inputs before predictions are made</li> </ul> </li> <li>Predictor <ul> <li>A predictor is a ML model in a Python object that takes a feature vector as input and returns a prediction as output</li> </ul> </li> <li>Inference Logger<ul> <li>Hopsworks logs inputs and outputs of transformers and predictors to a Kafka topic that is part of the same project as the model</li> </ul> </li> <li>Inference Batcher<ul> <li>Inference requests can be batched in different ways to adjust the trade-off between throughput and latencies of the model predictions</li> </ul> </li> <li>Versioned Deployments<ul> <li>Model deployments are versioned, enabling A/B testing and more.</li> </ul> </li> <li>Istio Model Endpoint<ul> <li>You can publish model via a REST Endpoint using Istio and access it over HTTP using a Hopsworks API key (with serving scope). Secure and authorized access is guaranteed by Hopsworks.</li> </ul> </li> </ul> <p>Models deployed on KServe in Hopsworks can be easily integrated with the Hopsworks feature store using a Transformer Python script, that builds the predictor's input feature vector using the application input and pre-computed features from the feature store.</p> <p></p>"},{"location":"concepts/mlops/mlops/","title":"Mlops","text":""},{"location":"concepts/mlops/opensearch/","title":"Vector Database","text":"<p>Hopsworks includes OpenSearch as a multi-tenant service in projects. OpenSearch provides vector database capabilities through its k-NN plugin, that supports the FAISS and nsmlib embedding indexes. Through Hopsworks, OpenSearch also provides enterprise capabilities, including authentication and access control to indexes (an index can be private to a Hopsworks project), filtering, scalability, high availability, and disaster recovery support.</p> <p></p>"},{"location":"concepts/mlops/prediction_services/","title":"Prediction Services","text":"<p>A prediction service is an end-to-end analytical or operational machine learning system that takes in data and outputs predictions that are consumed by users of the prediction service.</p> <p>A prediction service consists of the following components:</p> <ul> <li>feature pipeline(s),</li> <li>training pipeline,</li> <li>inference pipeline (for either batch predictions or online predictions)</li> <li>a sink for predictions - either a store or a user-interface.</li> </ul>"},{"location":"concepts/mlops/prediction_services/#analytical-ml","title":"Analytical ML","text":"<p>In the analytical ML figure below, we can see an analytical prediction service, where feature pipelines update the feature store with new feature data, running at some schedule (e.g., hourly, daily), and a batch program also runs on a schedule, reading batch scoring data from the feature store, computing predictions for that data with an embedded model, and writing those predictions to a database sink, from where the predictions are used for (predictive, prescriptive) analytical reports and/or to AI-enable operational services.</p> <p></p>"},{"location":"concepts/mlops/prediction_services/#operational-ml","title":"Operational ML","text":"<p>In the operational ML figure below, we can see an operational prediction service, where feature pipelines update the feature store with new feature data, running at some schedule (e.g., streaming, hourly, daily), and the operational service sends prediction requests to a model deployed on KServe via its secured Istio endpoint. A deployed model on KServer handles the prediction request by first retrieving pre-computed features from the feature store for the given request, and then building a feature vector that is scored by the model. The prediction result is returned to the client (the operational service). KServe logs both the feature values and the prediction results back to Hopsworks for further analysis and to help create new training data.</p> <p></p>"},{"location":"concepts/mlops/prediction_services/#mlops-flywheel","title":"MLOps Flywheel","text":"<p>Once you have built your analytical or operational ML system, the MLOps flywheel is the path to building a self-managing system that automatically collects and processes feature logs, prediction logs, and outcomes to help create new training data for models. This enables a ML flywheel where new training data and insights are generated from your operational or analytical ML service, by feeding logs back into the feature store. More training data enables the training of better models, and with better models, you should hopefully improve you operational/batch services, so that you attract more clients, who in turn produce more data for training models. And, thus, the ML flywheel is bootstrapped and leads to a virtuous cycle of more data leading to better models and more models leading to more users, who produce more data, and so on.</p> <p></p>"},{"location":"concepts/mlops/registry/","title":"Model Registry","text":"<p>Hopsworks Model Registry is designed with specific support for KServe and MLOps, through versioning. It enables developers to publish, test, monitor, govern and share models for collaboration with other teams. The model registry is where developers publish their models during the experimentation phase. The model registry can also be used to share models with the team and stakeholders.</p> <p>Like other project-based multi-tenant services in Hopsworks, a model registry is private to a project. That means you can easily add a development, staging, and production model registry to a cluster, and implement CI/CD processes for transitioning a model from development to staging to production.</p> <p>The model registry for KServe's capability are shown in the diagram below:</p> <p></p> <p>The model registry centralizes model management, enabling models to be securely accessed and governed. Models are more than just the model itself - the registry also stores sample data for testing, configuration information, provenance information, environment variables, links to the code used to generate the model, the model version, and tags/descriptions). When you save a model, you can also save model metrics with the model, enabling users to understand, for example, performance of the model on test (or unseen) data.</p>"},{"location":"concepts/mlops/registry/#model-package","title":"Model Package","text":"<p>A ML model consists of a number of different components in a model package:  - Model Input/Output Schema  - Model artifacts  - Model version information  - Model format (based on the ML framework used to train the model - e.g., .pkl or .tb files)</p> <p>You can also optionally include in your packaged model:  - Sample data (used to test the model  in KServe)  - The source notebook/program/experiment used to create the model</p>"},{"location":"concepts/mlops/training/","title":"Model Training","text":"<p>Hopsworks supports running model training pipelines on any Python environment, whether on an external Python client or on a Hopsworks cluster. The outputs of a training pipeline are typically experiment results, including logs, and possibly a trained model. You can plugin your own experimentation tracking platform or model registry, or you can use Hopsworks.</p>"},{"location":"concepts/mlops/training/#training-pipelines-on-hopsworks","title":"Training Pipelines on Hopsworks","text":"<p>If you train models with Hopsworks, you can setup CI/CD pipelines as shown below, where the experiments are tracked by Hopsworks, and any model created is published to a model registry. Each project has its own private model registry, so when you are working in a development project, you typically publish models to your project's private development registry, and if all model validation tests pass, and the model performance is good enough, the same training pipeline can be submitted via a CI/CD pipeline (e.g., GitHub push request) to a staging project, and the same procedure can be repeated to push the training pipeline to a production project.</p> <p></p> <p>Hopsworks Model Registry and Model Serving capabilities can then be used to build a batch or online prediction service using the model.</p>"},{"location":"concepts/projects/cicd/","title":"CI/CD","text":"<p>You can setup traditional development, staging, and production environment in Hopsworks using Projects. A project enables you provide access control for the different environments - just like a GitHub repository, owners of projects can add and remove members of projects and assign different roles to project members - the \"data owner\" role can write to feature store, while a \"data scientist\" can only read from the feature store and create training data.</p>"},{"location":"concepts/projects/cicd/#dev-staging-prod","title":"Dev, Staging, Prod","text":"<p>You can create dev, staging, and prod projects - either on the same cluster, but mostly commonly, with production on its own cluster:</p> <p></p>"},{"location":"concepts/projects/cicd/#versioning","title":"Versioning","text":"<p>Hopsworks supports the versioning of ML assets, including:</p> <ul> <li>Feature Groups: the version of its schema - breaking schema changes require a new version and backfilling the new version;</li> <li>Feature Views:  the version of its schema, and breaking schema changes only require a new version;</li> <li>Models: the version of a model;</li> <li>Deployments: the version of the deployment of a model - a model with the same version can be found in &gt;1 deployment.</li> </ul>"},{"location":"concepts/projects/cicd/#pytest-for-feature-logic-and-feature-pipeline-tests","title":"Pytest for feature logic and feature pipeline tests","text":"<p>Pytest and Great Expectations can be used for testing feature pipelines. Pytest is used to test feature logic and for end-to-end feature pipeline tests, while Great Expectations is used for data validation tests.  Here, we can see how a feature pipeline test uses sample data to compute features and validate they have been written successfully, first to a development feature store, and then they can be pushed to a staging feature store, before finally being promoted to production. </p>"},{"location":"concepts/projects/governance/","title":"Governance","text":"<p>Hopsworks provides project-level multi-tenancy, a data mesh enabling technology. Think of it as a GitHub repository for your teams and ML assets. More specifically, a project is a sandbox for team members, ML assets (features, training data, models, vector database, model deployments), and optionally feature pipelines and training pipelines. The ML assets can only be accessed by project members, and there is role-based access control (RBAC) for project members within a project.</p> <p></p>"},{"location":"concepts/projects/governance/#devstagingprod-for-data","title":"Dev/Staging/Prod for Data","text":"<p>Projects enable you to define development, staging, and even production projects on the same cluster. Often, companies deploy production projects on dedicated clusters, but development projects and staging projects on a shared cluster. This way, projects can be easily used to implement CI/CD workflows.</p>"},{"location":"concepts/projects/governance/#data-mesh-of-feature-stores","title":"Data Mesh of Feature Stores","text":"<p>Projects enable you to move beyond the traditional dev/staging/prod ownership model for data. Different teams or lines of business can have their own private feature stores, you can mix them with a group-wide feature store, and feature stores can be securely shared between teams/organizations. Effectively, you can have decentralized ownership of feature stores, with domain-specific projects, and each project managing its own feature pipelines. Hopsworks provides data/feature sharing support between these self-service projects. </p>"},{"location":"concepts/projects/governance/#audit-logs-with-rest-api","title":"Audit Logs with REST API","text":"<p>Hopsworks stores audit logs for all calls on its REST API in its file system, HopsFS. The audit log can be used to analyze the historical usage of services by users.</p>"},{"location":"concepts/projects/search/","title":"Tags/Search/Lineage","text":"<p>Hopsworks supports free-text search for ML assets:</p> <ul> <li>features,</li> <li>feature groups,</li> <li>feature views,</li> <li>training data,</li> <li>models, and</li> <li>deployments.</li> </ul> <p>You can use the search bar at the top of your project to free-text search for the names or descriptions of any ML asset. You can also search using keywords or tags that are attached to an ML asset. A keyword is a single user-defined word attached to an ML asset. Keywords can be used to help it make it easier to find ML assets or understand the context in which they should be used (for example, PII could be used to indicate that the ML asset is based on personally identifiable information.</p> <p>However, it may be preferable to have a stronger governance framework for ML assets than keywords alone. For this, you can define a schematized tag, defining a list of key/value tags along with a type for a value. In the figure below, you can see an example of a schematized tag with two key/value pairs: pii of type boolean (indicating if this feature group contains PII data), and owner of type string (indicating who the owner of the data in this feature group is). Note there is also a keyword defined for this feature group called eu_region, indicating the data has its origins in the EU.</p> <p></p>"},{"location":"concepts/projects/search/#lineage","title":"Lineage","text":"<p>Hopsworks tracks the lineage (or provenance) of ML assets automatically for you. You can see what features are used in which feature view or training dataset. You can see what training dataset was used to train a given model. For assets that are managed outside of Hopsworks, there is support for the explicit definition of lineage dependencies.</p> <p></p>"},{"location":"concepts/projects/storage/","title":"Data Storage/Sharing","text":"<p>Every project in Hopsworks has its own private assets:</p> <ul> <li>a Feature Store (including both Online and Offline Stores)</li> <li>a Filesystem subtree (all directory and files under /Projects//) <li>a Model Registry</li> <li>Model Deployments</li> <li>Kafka topics</li> <li>OpenSearch indexes (including KNN indexes - the vector DB)</li> <li>a Hive Database</li> <p>Access control to these assets is controlled using project membership ACLs (access-control lists). Users in a project who have a Data Owner role have read/write access to these assets.  Users in a project who have a Data Scientist role have mostly read-only access to these assets, with the exception of the ability to write to well-known directories (Resources, Jupyter, Logs). </p> <p>However, it is often desirable to share assets between projects, with read-only, read/write privileges, and to restrict the privileges to specific role (e.g., Data Owners) in the target project. In Hopsworks, you can explicitly share assets between projects without copying the assets. Sharing is managed by ACLs in Hopsworks, see example below: </p>"},{"location":"reference_guides/","title":"Index","text":"Hopsworks Feature Store (hsfs) Model Registry &amp; Model Serving (hsml)"},{"location":"setup_installation/","title":"Setup and Installation","text":"<p>This section contains installation guides for the Hopsworks Platform, on </p> <ul> <li>AWS</li> <li>Azure</li> <li>GCP</li> <li>On-Prem environments</li> </ul> <p>and common setup instructions.</p> <p>For instructions on installing the Hopsworks Client libraries, see the Client Installation guide.</p>"},{"location":"setup_installation/aws/cluster_creation/","title":"Getting started with managed.hopsworks.ai (AWS)","text":"<p>This guide goes into detail for each of the steps of the cluster creation in managed.hopsworks.ai</p>"},{"location":"setup_installation/aws/cluster_creation/#step-1-starting-to-create-a-cluster","title":"Step 1 starting to create a cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p>"},{"location":"setup_installation/aws/cluster_creation/#step-2-setting-the-general-information","title":"Step 2 setting the General information","text":"<p> Create a Hopsworks cluster, general information </p> <p>Select the Region in which you want your cluster to run (1), name your cluster (2).</p> <p>Select the Instance type (3) and Local storage (4) size for the cluster Head node.</p>"},{"location":"setup_installation/aws/cluster_creation/#enable-ebs-encryption","title":"Enable EBS encryption","text":"<p>Select the checkbox (5) to enable encryption of EBS drives and shapshots. After enabling, the KMS key to be used for encryption can be specified by its alias, ID or ARN. Leaving the KMS key unspecified results in the EC2 default encryption key being used.</p>"},{"location":"setup_installation/aws/cluster_creation/#s3-bucket-configuration","title":"S3 bucket configuration","text":"<p>Enter the name of the S3 bucket (6) you want the cluster to store its data in.</p> <p>Note</p> <p>The S3 bucket you are using must be empty.</p> <p>Premium users have the option to use encrypted S3 buckets. To configure an encrypted bucket click on the Advanced tab and select the appropriate encryption type.</p> <p>Note</p> <p>Encryption must have been already enabled for the bucket</p> <p>We support the following encryption schemes:</p> <ol> <li>SSE-S3</li> <li>SSE-KMS<ol> <li>S3 managed key</li> <li>User managed key</li> </ol> </li> </ol> <p>Users can also select an AWS canned ACLs for the objects:</p> <ol> <li><code>bucket-owner-full-control</code></li> </ol>"},{"location":"setup_installation/aws/cluster_creation/#ecr-aws-account-id","title":"ECR AWS Account Id","text":"<p>Enter the AWS account Id (7) to setup ECR repositories for the cluster. It is set by default to the AWS account id where you set the cross account role.  </p> <p>On the main page, you can also choose to aggregate logs in CloudWatch and to opt out of managed.hopsworks.ai log collection. The first one is to aggregate the logs of services running in your cluster in CloudWatch service in your configured AWS account. This can be useful if you want to understand what is happening on your cluster, without having to ssh into the instances. The second one is for managed.hopsworks.ai to collect logs about the services running in your cluster. These logs will help us improve our system and provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process.</p>"},{"location":"setup_installation/aws/cluster_creation/#step-3-workers-configuration","title":"Step 3 workers configuration","text":"<p>In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation. In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand.</p>"},{"location":"setup_installation/aws/cluster_creation/#static-workers-configuration","title":"Static workers configuration","text":"<p>You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p> Create a Hopsworks cluster, static workers configuration </p>"},{"location":"setup_installation/aws/cluster_creation/#autoscaling-workers-configuration","title":"Autoscaling workers configuration","text":"<p>You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You can configure:</p> <ol> <li>The instance type you want to use.</li> <li>The size of the instances' disk.</li> <li>The minimum number of workers. </li> <li>The maximum number of workers.</li> <li>The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources.</li> <li>The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system.</li> </ol> <p>Note</p> <p>The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources.</p> <p> Create a Hopsworks cluster, autoscale workers configuration </p>"},{"location":"setup_installation/aws/cluster_creation/#step-4-select-an-ssh-key","title":"Step 4 select an SSH key","text":"<p>When deploying clusters, managed.hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in AWS refer to Create an ssh key</p> <p> Choose SSH key </p>"},{"location":"setup_installation/aws/cluster_creation/#step-5-select-the-instance-profile","title":"Step 5 select the Instance Profile","text":"<p>To let the cluster instances access the S3 bucket we need to attach an instance profile to the virtual machines. In this step, you choose which profile to use. This profile needs to have access right to the S3 bucket you selected in Step 2. For more details on how to create the instance profile and give it access to the S3 bucket refer to Creating an instance profile and giving it access to the bucket</p> <p>If you want to use role chaining, it is recommanded to use a different instance profile for the head node and the other cluster's nodes. You do this by clicking the Advanced configuration check box and selecting instance profile for the head node. This profile should have the same permission as the profile you selected above, plus the extra permissions for the role chaining.</p> <p> Choose the instance profile </p>"},{"location":"setup_installation/aws/cluster_creation/#step-6-set-the-backup-retention-policy","title":"Step 6 set the backup retention policy","text":"<p>To backup the S3 bucket data when taking a cluster backup we need to set a retention policy for S3. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster.</p> <p> Choose the backup retention policy </p>"},{"location":"setup_installation/aws/cluster_creation/#step-7-managed-containers","title":"Step 7 Managed Containers","text":"<p>Hopsworks can integrate with Amazon Elastic Kubernetes Service (EKS) to launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS. For more detail on how to set up this integration refer to Integration with Amazon EKS.</p> <p> Add EKS cluster name </p>"},{"location":"setup_installation/aws/cluster_creation/#step-8-vpc-selection","title":"Step 8 VPC selection","text":"<p>In this step, you can select the VPC which will be used by the Hopsworks cluster. You can either select an existing VPC or let managed.hopsworks.ai create one for you. If you decide to let managed.hopsworks.ai create the VPC for you, you can choose the CIDR block for this virtual network.  Refer to Create a VPC for more details on how to create your own VPC in AWS.</p> <p> Choose a VPC </p> <p>Note</p> <p>If the VPC uses a custom domain read our guide on how to set this up</p>"},{"location":"setup_installation/aws/cluster_creation/#step-9-availability-zone-selection","title":"Step 9 Availability Zone selection","text":"<p>If you selected an existing VPC in the previous step, this step lets you select which availability zone of this VPC to use.</p> <p>If you did not select an existing virtual network in the previous step managed.hopsworks.ai will create an availability zone for you. You can choose the CIDR block this subnet will use.</p> <p> Choose an availability zone </p>"},{"location":"setup_installation/aws/cluster_creation/#step-10-security-group-selection","title":"Step 10 Security group selection","text":"<p>If you selected an existing VPC in the previous step, this step lets you select which security group to use.</p> <p>Note</p> <p>Managed.hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules.</p> <p>Note</p> <p>Managed.hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox.</p> <p> Choose security group </p>"},{"location":"setup_installation/aws/cluster_creation/#limiting-outbound-traffic-to-managedhopsworksai","title":"Limiting outbound traffic to managed.hopsworks.ai","text":"<p>Clusters created on managed.hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with managed.hopsworks.ai checkbox to get a list of IPs to be allowed as shown below:</p> <p> Enable static IPs  </p>"},{"location":"setup_installation/aws/cluster_creation/#step-11-user-management-selection","title":"Step 11 User management selection","text":"<p>In this step, you can choose which user management system to use. You have four choices: </p> <ul> <li>Managed: Managed.hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization (more details here).</li> <li>OAuth2: integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail.</li> <li>LDAP: integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail.</li> <li>Disabled: let you manage users manually from within Hopsworks.</li> </ul> <p> Choose user management type </p>"},{"location":"setup_installation/aws/cluster_creation/#step-12-managed-rondb","title":"Step 12 Managed RonDB","text":"<p>Hopsworks uses RonDB as a database engine for its online Feature Store. By default database will run on its own VM. Premium users can scale-out database services to multiple VMs to handle increased workload.</p> <p>For details on how to configure RonDB check our guide here.</p> <p> Configure RonDB </p> <p>If you need to deploy a RonDB cluster instead of a single node please contact us.</p>"},{"location":"setup_installation/aws/cluster_creation/#step-13-add-tags-to-your-instances","title":"Step 13 add tags to your instances.","text":"<p>In this step, you can define tags that will be added to the cluster virtual machines.</p> <p> Add tags </p>"},{"location":"setup_installation/aws/cluster_creation/#step-14-add-an-init-script-to-your-instances","title":"Step 14 add an init script to your instances.","text":"<p>In this step, you can enter an initialization script that will be run at startup on every instance.</p> <p>You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation.</p> <p>Note</p> <p>this init script must be a bash script starting with #!/usr/bin/env bash</p> <p> Add initialization script </p>"},{"location":"setup_installation/aws/cluster_creation/#step-15-review-and-create","title":"Step 15 Review and create","text":"<p>Review all information and select Create:</p> <p> Review cluster information </p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/aws/custom_domain_name/","title":"Deploy in a VPC with a custom domain name","text":"<p>Some organizations follow network patterns which impose a specific domain name for Instances. In that case, the instance's hostname instead of <code>ip-10-0-0-175.us-east-2.compute.internal</code> would be <code>ip-10-0-0-175.bar.foo</code></p> <p>The control plane at managed.hopsworks.ai needs to be aware of such case in order to properly initialize the Cluster.</p> <p>Note</p> <p>This feature is enabled only upon request. If you want this feature to be enable for your account please contact sales</p> <p>There are multiple ways to use custom domain names in your organization which are beyond the scope of this guide. We assume your cloud/network team has already setup the infrastructure.</p> <p>If you are using a resolver such as Amazon Route 53, it is advised to update the record sets automatically. See our guide below for more information.</p>"},{"location":"setup_installation/aws/custom_domain_name/#set-cluster-domain-name","title":"Set cluster domain name","text":"<p>If this feature is enabled for your account, then in the VPC selection step you will have the option to specify the custom domain name as shown in the figure below.</p> <p> VPC with custom domain name </p> <p>In this case, the hostname of the Instance would be <code>INSTANCE_ID.dev.hopsworks.domain</code></p> <p>Hostnames must be resolvable by all Virtual Machines in the cluster. For that reason we suggest, if possible, to automatically register the hostnames with your DNS.</p> <p>In the following section we present an example of automatic name registration in Amazon Route 53</p>"},{"location":"setup_installation/aws/custom_domain_name/#auto-registration-with-amazon-route-53","title":"Auto registration with Amazon Route 53","text":"<p>It is quite common for organizations in AWS to use Route 53 for DNS or for hosted zones. You can configure a cluster in managed.hopsworks.ai to execute some custom initialization script before any other action. This script will be executed on all nodes of the cluster.</p> <p>Since the hostname of the VM is in the form of <code>INSTANCE_ID.DOMAIN_NAME</code> it is easy to automate the zone update. The script below creates an A record in a configured Route 53 hosted zone.</p> <p>Warning</p> <p>If you want the VM to register itself with Route 53 you must amend the Instance Profile with the following permissions</p> <pre><code>{\n    \"Sid\": \"Route53RecordSet\",\n    \"Effect\": \"Allow\",\n    \"Action\": [\n        \"route53:ChangeResourceRecordSets\"\n    ],\n    \"Resource\": \"arn:aws:route53:::hostedzone/YOUR_HOSTED_ZONE_ID\"\n},\n{\n    \"Sid\": \"Route53GetChange\",\n    \"Effect\": \"Allow\",\n    \"Action\": [\n        \"route53:GetChange\"\n    ],\n    \"Resource\": \"arn:aws:route53:::change/*\"\n}\n</code></pre> <p>The following script will get the instance ID from the EC2 metadata server and add an A record to the hosted zone in Route53. Update the  <code>YOUR_HOSTED_ZONE_ID</code> and <code>YOUR_CUSTOM_DOMAIN_NAME</code> to match yours.</p> <pre><code>#!/usr/bin/env bash\nset -e\n\nHOSTED_ZONE_ID=YOUR_HOSTED_ZONE_ID\nZONE=YOUR_CUSTOM_DOMAIN_NAME\n\nrecord_set_file=/tmp/record_set.json\n\ninstance_id=$(curl --silent http://169.254.169.254/2016-09-02/meta-data/instance-id)\n\ndomain_name=\"${instance_id}.${ZONE}\"\n\nlocal_ip=$(curl --silent http://169.254.169.254/2016-09-02/meta-data/local-ipv4)\n\ncat &lt;&lt; EOC | tee $record_set_file\n{\n    \"Changes\": [\n        {\n            \"Action\": \"UPSERT\",\n            \"ResourceRecordSet\": {\n                \"Name\": \"${domain_name}\",\n                \"Type\": \"A\",\n                \"TTL\": 60,\n                \"ResourceRecords\": [\n                    {\n                        \"Value\": \"${local_ip}\"\n                    }\n                ]\n            }\n        }\n    ]\n}\nEOC\n\necho \"Adding A record ${domain_name} -&gt; ${local_ip} to Hosted Zone ${HOSTED_ZONE_ID}\"\nchange_resource_id=$(aws route53 change-resource-record-sets --hosted-zone-id ${HOSTED_ZONE_ID} --change-batch file://${record_set_file} | jq -r '.ChangeInfo.Id')\n\necho \"Change resource ID: ${change_resource_id}\"\naws route53 wait resource-record-sets-changed --id ${change_resource_id}\necho \"Added resource record set\"\n\nrm -f ${record_set_file}\n</code></pre>"},{"location":"setup_installation/aws/custom_domain_name/#set-vm-initialization-script","title":"Set VM initialization script","text":"<p>As a final step you need to configure the Cluster to use the script above during VM creation with the user init script option.</p> <p>Paste the script to the text box and make sure you select this script to be executed before anything else on the VM.</p> <p> Automatic domain name registration with Route53 </p>"},{"location":"setup_installation/aws/eks_ecr_integration/","title":"Integration with Amazon EKS","text":"<p>This guide shows how to create a cluster in managed.hopsworks.ai with integrated support for Amazon Elastic Kubernetes Service (EKS). So that Hopsworks can launch Python jobs, Jupyter servers, and ML model servings on top of Amazon EKS.</p> <p>Warning</p> <p>In the current version, we don't support sharing EKS clusters between Hopsworks clusters. That is, an EKS cluster can be only used by one Hopsworks cluster.</p>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-1-create-an-eks-cluster-on-aws","title":"Step 1: Create an EKS cluster on AWS","text":"<p>If you have an existing EKS cluster, skip this step and go directly to Step 2.</p> <p>Amazon provides two getting started guides using AWS management console or <code>eksctl</code> to help you create an EKS cluster. The easiest way is to use the eksctl command.</p>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-11-installing-eksctl-aws-and-kubectl","title":"Step 1.1: Installing eksctl, aws, and kubectl","text":"<p>Follow the prerequisites section in getting started with <code>eksctl</code> to install aws, eksctl, and kubectl.</p>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-12-create-an-eks-cluster-using-eksctl","title":"Step 1.2: Create an EKS cluster using eksctl","text":"<p>You can create a sample EKS cluster with the name my-eks-cluster using Kubernetes version 1.20 with 2 managed nodes in the us-east-2 region by running the following command. For more details on the eksctl usage, check the <code>eksctl</code> documentation.</p> <pre><code>eksctl create cluster --name my-eks-cluster --version 1.20 --region us-east-2 --nodegroup-name my-nodes --nodes 2 --managed\n</code></pre> <p>Output:</p> <pre><code>[\u2139]  eksctl version 0.26.0\n[\u2139]  using region us-east-2\n[\u2139]  setting availability zones to [us-east-2b us-east-2a us-east-2c]\n[\u2139]  subnets for us-east-2b - public:192.168.0.0/19 private:192.168.96.0/19\n[\u2139]  subnets for us-east-2a - public:192.168.32.0/19 private:192.168.128.0/19\n[\u2139]  subnets for us-east-2c - public:192.168.64.0/19 private:192.168.160.0/19\n[\u2139]  using Kubernetes version 1.20\n[\u2139]  creating EKS cluster \"my-eks-cluster\" in \"us-east-2\" region with managed nodes\n[\u2139]  will create 2 separate CloudFormation stacks for cluster itself and the initial managed nodegroup\n[\u2139]  if you encounter any issues, check CloudFormation console or try 'eksctl utils describe-stacks --region=us-east-2 --cluster=my-eks-cluster'\n[\u2139]  CloudWatch logging will not be enabled for cluster \"my-eks-cluster\" in \"us-east-2\"\n[\u2139]  you can enable it with 'eksctl utils update-cluster-logging --region=us-east-2 --cluster=my-eks-cluster'\n[\u2139]  Kubernetes API endpoint access will use default of {publicAccess=true, privateAccess=false} for cluster \"my-eks-cluster\" in \"us-east-2\"\n[\u2139]  2 sequential tasks: { create cluster control plane \"my-eks-cluster\", 2 sequential sub-tasks: { no tasks, create managed nodegroup \"my-nodes\" } }\n[\u2139]  building cluster stack \"eksctl-my-eks-cluster-cluster\"\n[\u2139]  deploying stack \"eksctl-my-eks-cluster-cluster\"\n[\u2139]  building managed nodegroup stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\"\n[\u2139]  deploying stack \"eksctl-my-eks-cluster-nodegroup-my-nodes\"\n[\u2139]  waiting for the control plane availability...\n[\u2714]  saved kubeconfig as \"/Users/maism/.kube/config\"\n[\u2139]  no tasks\n[\u2714]  all EKS cluster resources for \"my-eks-cluster\" have been created\n[\u2139]  nodegroup \"my-nodes\" has 2 node(s)\n[\u2139]  node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready\n[\u2139]  node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready\n[\u2139]  waiting for at least 2 node(s) to become ready in \"my-nodes\"\n[\u2139]  nodegroup \"my-nodes\" has 2 node(s)\n[\u2139]  node \"ip-192-168-21-142.us-east-2.compute.internal\" is ready\n[\u2139]  node \"ip-192-168-62-117.us-east-2.compute.internal\" is ready\n[\u2139]  kubectl command should work with \"/Users/maism/.kube/config\", try 'kubectl get nodes'\n[\u2714]  EKS cluster \"my-eks-cluster\" in \"us-east-2\" region is ready\n</code></pre> <p>Once the cluster is created, eksctl will write the cluster credentials for the newly created cluster to your local kubeconfig file (~/.kube/config). To test the cluster credentials, you can run the following command to get the list of nodes in the cluster.</p> <pre><code>kubectl get nodes\n</code></pre> <p>Output:</p> <pre><code>NAME                                           STATUS   ROLES    AGE     VERSION\nip-192-168-21-142.us-east-2.compute.internal   Ready    &lt;none&gt;   2m35s   v1.17.9-eks-4c6976\nip-192-168-62-117.us-east-2.compute.internal   Ready    &lt;none&gt;   2m34s   v1.17.9-eks-4c6976\n</code></pre>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-2-create-an-instance-profile-role-on-aws","title":"Step 2: Create an instance profile role on AWS","text":"<p>You need to add permission to the instance profile you use for instances deployed by managed.hopsworks.ai to give them access to EKS. Go to the IAM service in the AWS management console, click Roles, search for your role, and click on it. Click on Add inline policy. Go to the JSON tab and replace the existing JSON permissions with the JSON permissions below..</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AllowDescirbeEKS\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"eks:DescribeCluster\",\n            \"Resource\": \"arn:aws:eks:*:*:cluster/*\"\n        }\n    ]\n}\n</code></pre> <p>Click on Review policy. Give a name to your policy and click on Create policy.</p> <p>Copy the Role ARN of your profile (not to be confused with the Instance Profile ARNs two lines bellow).</p> <p> Copy the *Role ARN* </p>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-3-allow-your-role-to-use-your-eks-cluster","title":"Step 3: Allow your role to use your EKS cluster","text":"<p>You need to configure your EKS cluster to accept connections from the role you created above. This is done by using the following kubectl command. For more details, check Managing users or IAM roles for your cluster.</p> <p>Note</p> <p>The kubectl edit command uses the vi editor by default, however, you can override this behavior by setting KUBE_EDITOR to your preferred editor.</p> <pre><code>KUBE_EDITOR=\"vi\" kubectl edit configmap aws-auth -n kube-system\n</code></pre> <p>Output:</p> <pre><code># Please edit the object below. Lines beginning with a '#' will be ignored,\n# and an empty file will abort the edit. If an error occurs while saving this file will be\n# reopened with the relevant failures.\n#\napiVersion: v1\ndata:\nmapRoles: |\n    - groups:\n        - system:bootstrappers\n        - system:nodes\n        rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC\n        username: system:node:{{EC2PrivateDNSName}}\nkind: ConfigMap\nmetadata:\ncreationTimestamp: \"2020-08-24T07:42:31Z\"\nname: aws-auth\nnamespace: kube-system\nresourceVersion: \"770\"\nselfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth\nuid: c794b2d8-9f10-443d-9072-c65d0f2eb552\n</code></pre> <p>Follow the example below (lines 13-16) to add your role to mapRoles and assign the system:masters group to your role. Make sure to replace 'YOUR ROLE RoleARN' with the Role ARN you copied in the previous step before saving.</p> <p>Warning</p> <p>Make sure to keep the same formatting as in the example below. The configuration format is sensitive to indentation and copy-pasting does not always keep the correct indentation.</p> <pre><code># Please edit the object below. Lines beginning with a '#' will be ignored,\n# and an empty file will abort the edit. If an error occurs while saving this file will be\n# reopened with the relevant failures.\n#\napiVersion: v1\ndata:\n  mapRoles: |\n    - groups:\n      - system:bootstrappers\n      - system:nodes\n      rolearn: arn:aws:iam::xxxxxxxxxxxx:role/eksctl-my-eks-cluster-nodegroup-m-NodeInstanceRole-FQ7L0HQI4NCC\n      username: system:node:{{EC2PrivateDNSName}}\n    - groups:\n      - system:masters\n      rolearn: &lt;YOUR ROLE RoleARN&gt;\n      username: hopsworks\nkind: ConfigMap\nmetadata:\ncreationTimestamp: \"2020-08-24T07:42:31Z\"\nname: aws-auth\nnamespace: kube-system\nresourceVersion: \"770\"\nselfLink: /api/v1/namespaces/kube-system/configmaps/aws-auth\nuid: c794b2d8-9f10-443d-9072-c65d0f2eb552\n</code></pre> <p>Once you are done with editing the configmap, save it and exit the editor. The output should be:</p> <pre><code>configmap/aws-auth edited\n</code></pre>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-4-setup-network-connectivity","title":"Step 4: Setup network connectivity","text":"<p>For Hopsworks to be able to start containers in the EKS cluster and for these containers to be able to use Hopsworks we need to establish network connectivity between Hopsworks and EKS. For this, we have two solutions. The first option (A) is to run Hopsworks and EKS in the same virtual network and security group. The second option (B) is to pair the EKS and Hopsworks virtual networks. If you choose this option, make sure to create the peering before starting the Hopsworks cluster as it connects to EKS at startup.</p>"},{"location":"setup_installation/aws/eks_ecr_integration/#option-a-run-hopsworks-and-eks-in-the-same-virtual-network","title":"Option A: run Hopsworks and EKS in the same virtual network.","text":"<p>Running EKS and Hopsworks in the same security group is the simplest of the two solutions when it comes to setting up the system. All you need to do is to open the ports needed by Hopsworks in the security group created by the EKS cluster. Then you can just select this security group during the Hopsworks cluster creation. We will now see how to open the ports for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. </p> <p>Note</p> <p>It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details.</p> <p>First, you need to get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster.</p> <pre><code>eksctl utils describe-stacks --region=us-east-2 --cluster=my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1\n</code></pre> <p>Check the output for OutputValue, which will be the id of your EKS security group.</p> <pre><code>ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\",\nOutputKey: \"ClusterSecurityGroupId\",\nOutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\"\n</code></pre> <p>Go to the Security Groups section of EC2 in the AWS management console and search for your security group using the id obtained above. Note the VPC ID, you will need it when creating the Hopsworks cluster. Then, click on it then go to the Inbound rules tab and click on Edit inbound rules. You should now see the following screen.</p> <p> Edit inbound rules </p> <p>Add two rules for HTTP and HTTPS as follows:</p> <p> Edit inbound rules </p> <p>Click Save rules to save the updated rules to the security group.</p>"},{"location":"setup_installation/aws/eks_ecr_integration/#option-b-create-a-pairing-between-hopsworks-and-eks","title":"Option B: create a pairing between Hopsworks and EKS","text":"<p>To establish virtual peering between the Kubernetes cluster and Hopsworks, you need to select or create a virtual network for Hopsworks. You can create the virtual network by following the AWS documentation steps to create the virtual private network. Make sure to configure your subnet to use an address space that does not overlap with the address space in the Kubernetes network.</p> <p>You then need to select or create a security group for the Hopsworks VPC. You can create the security group by following the steps in the AWS documentation. Remember to open the port for HTTP (80) and HTTPS (443) to allow Hopsworks to run with all its functionalities. </p> <p>Note</p> <p>It is possible not to open ports 80 and 443 at the cost of some features. See Limiting permissions for more details.</p> <p>Once the Hopsworks VPC and security group are created you need to create a peering between the Hopsworks VPC and the EKS VPC. For this follow the AWS documentation here.</p> <p>Finally, you need to edit the security groups for the EKS cluster and for Hopsworks to allow full communication between both VPC. This can be done following the instruction in the AWS documentation.</p> <p>You can get the name of the security group of your EKS cluster by using the following eksctl command. Notice that you need to replace my-eks-cluster with the name of your cluster.</p> <pre><code>eksctl utils describe-stacks --region=us-east-2 --cluster=my-eks-cluster | grep 'OutputKey: \"ClusterSecurityGroupId\"' -a1\n</code></pre> <p>Check the output for OutputValue, which will be the id of your EKS security group.</p> <pre><code>ExportName: \"eksctl-my-eks-cluster-cluster::ClusterSecurityGroupId\",\nOutputKey: \"ClusterSecurityGroupId\",\nOutputValue: \"YOUR_EKS_SECURITY_GROUP_ID\"\n</code></pre>"},{"location":"setup_installation/aws/eks_ecr_integration/#step-6-create-a-hopsworks-cluster-with-eks-support","title":"Step 6: Create a Hopsworks cluster with EKS support","text":"<p>In managed.hopsworks.ai, follow the same instructions as in the cluster creation guide except when setting Managed Containers, VPC, Subnet, and Security group. </p> <p>Choose Enabled to enable the use of Amazon EKS:</p> <p> Choose Enabled </p> <p>Add your EKS cluster name, then click Next:</p> <p> Add EKS cluster name </p> <p>If you followed option A when setting up the network Choose the VPC of your EKS cluster. Its name should have the form eksctl-YOUR-CLUSTER-NAME-cluster (click on the refresh button if the VPC is not in the list).</p> <p>If you followed option B choose the VPC you created during Step 4.</p> <p> Choose VPC </p> <p>Choose any of the subnets in the VPC, then click Next.</p> <p>Note</p> <p>Avoid private subnets if you want to enjoy all the Hopsworks features.</p> <p> Choose Subnet </p> <p>Choose the security group that you have updated/created in Step 4, then click Next:</p> <p>Note</p> <p>If you followed option A select the Security Group with the same id as in Step 4 and NOT the ones containing ControlPlaneSecurity or ClusterSharedNode in their name.</p> <p> Choose Security Group </p> <p>Click Review and submit, then Create. Once the cluster is created, Hopsworks will use EKS to launch Python jobs, Jupyter servers, and ML model servings.</p>"},{"location":"setup_installation/aws/getting_started/","title":"Getting started with managed.hopsworks.ai (AWS)","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up managed.hopsworks.ai with your organization's AWS account.</p>"},{"location":"setup_installation/aws/getting_started/#prerequisites","title":"Prerequisites","text":"<p>To run the commands in this guide, you must have the AWS CLI installed and configured and your user must have at least the set of permission listed below. See the Getting started guide in the AWS CLI User Guide for more information about installing and configuring the AWS CLI.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:CreateInstanceProfile\",\n                \"iam:PassRole\",\n                \"iam:CreateRole\",\n                \"iam:PutRolePolicy\",\n                \"iam:AddRoleToInstanceProfile\",\n                \"ec2:ImportKeyPair\",\n                \"ec2:CreateKeyPair\",\n                \"s3:CreateBucket\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n</code></pre> <p>All the commands have unix-like quotation rules. These commands will need to be adapted to your terminal's quoting rules. See Using quotation marks with strings in the AWS CLI User Guide.</p> <p>All the commands use the default AWS profile. Add the --profile parameter to use another profile. </p>"},{"location":"setup_installation/aws/getting_started/#step-1-connecting-your-aws-account","title":"Step 1: Connecting your AWS account","text":"<p>Managed.hopsworks.ai deploys Hopsworks clusters to your AWS account. To enable this you have to permit us to do so. This is done using an AWS cross-account role.</p> <p> </p> <p>In managed.hopsworks.ai click on Connect to AWS or go to Settings and click on Configure next to AWS. This will direct you to a page with the instructions needed to create the Cross account role and set up the connection. Follow the instructions.</p> <p>Note</p> <p>it is possible to limit the permissions that are set up during this phase. For more details see restrictive-permissions.</p> <p> Instructions to create the cross account role </p>"},{"location":"setup_installation/aws/getting_started/#step-2-creating-storage","title":"Step 2: Creating storage","text":"<p>Note</p> <p>If you prefer using terraform, you can skip this step and the remaining steps, and instead, follow this guide.</p> <p>The Hopsworks clusters deployed by managed.hopsworks.ai store their data in an S3 bucket in your AWS account.</p> <p>To create the bucket run the following command, replacing BUCKET_NAME with the name you want for your bucket and setting the region to the aws region in which you want to run your cluster.</p> <p>Warning</p> <p>The bucket must be in the same region as the hopsworks cluster you are going to run</p> <pre><code>aws s3 mb s3://BUCKET_NAME --region us-east-2\n</code></pre>"},{"location":"setup_installation/aws/getting_started/#step-3-creating-instance-profile","title":"Step 3: Creating Instance profile","text":"<p>Hopsworks cluster nodes need access to certain resources such as the S3 bucket you created above, an ecr repository, and CloudWatch.</p> <p>First, create an instance profile by running: <pre><code>aws iam create-instance-profile --instance-profile-name hopsworksai-instances\n</code></pre></p> <p>We will now create a role with the needed permissions for this instance profile.  Start by creating a file named assume-role-policy.json containing the following: <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"ec2.amazonaws.com\"\n            },\n            \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\n</code></pre></p> <p>Run the following to create the role:</p> <pre><code>aws iam create-role --role-name hopsworksai-instances \\\n   --description \"Role for the hopsworks cluster instances\" \\\n   --assume-role-policy-document file://assume-role-policy.json\n</code></pre> <p>Create a file called instances-policy.json containing the following permissions. Replace the following placeholders with their appropiate values</p> <ul> <li>BUCKET_NAME - S3 bucket name </li> <li>REGION - region where the cluster is deployed</li> <li>ECR_AWS_ACCOUNT_ID - AWS account id for ECR repositories</li> </ul> <p>Note</p> <p>Some of these permissions can be removed. Refer to this guide for more information.</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"hopsworksaiInstanceProfile\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"S3:PutObject\",\n        \"S3:ListBucket\",\n        \"S3:GetObject\",\n        \"S3:DeleteObject\",\n        \"S3:AbortMultipartUpload\",\n        \"S3:ListBucketMultipartUploads\",\n        \"S3:PutLifecycleConfiguration\",\n        \"S3:GetLifecycleConfiguration\",\n        \"S3:PutBucketVersioning\",\n        \"S3:GetBucketVersioning\",\n        \"S3:ListBucketVersions\",\n        \"S3:DeleteObjectVersion\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME/*\",\n        \"arn:aws:s3:::BUCKET_NAME\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowPullImagesFromHopsworkAi\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:REGION:822623301872:repository/filebeat\",\n        \"arn:aws:ecr:REGION:822623301872:repository/base\",\n        \"arn:aws:ecr:REGION:822623301872:repository/onlinefs\",\n        \"arn:aws:ecr:REGION:822623301872:repository/airflow\",\n        \"arn:aws:ecr:REGION:822623301872:repository/git\",\n        \"arn:aws:ecr:REGION:822623301872:repository/testconnector\",\n        \"arn:aws:ecr:REGION:822623301872:repository/flyingduck\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowCreateRespositry\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ecr:CreateRepository\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowPushandPullImagesToUserRepo\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:CompleteLayerUpload\",\n        \"ecr:UploadLayerPart\",\n        \"ecr:InitiateLayerUpload\",\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:PutImage\",\n        \"ecr:ListImages\",\n        \"ecr:BatchDeleteImage\",\n        \"ecr:GetLifecyclePolicy\",\n        \"ecr:PutLifecyclePolicy\",\n        \"ecr:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/filebeat\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/base\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/onlinefs\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/airflow\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/git\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/testconnector\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/flyingduck\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowGetAuthToken\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ecr:GetAuthorizationToken\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeTags\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\"\n    }\n  ]\n}\n</code></pre> <p>Attach the permission to the role by running: <pre><code>aws iam put-role-policy --role-name hopsworksai-instances \\\n   --policy-name hopsworksai-instances \\\n   --policy-document file://instances-policy.json\n</code></pre></p> <p>Finally, attach the role to the instance profile by running: <pre><code>aws iam add-role-to-instance-profile \\\n   --role-name hopsworksai-instances \\\n   --instance-profile-name hopsworksai-instances\n</code></pre></p>"},{"location":"setup_installation/aws/getting_started/#step-4-create-an-ssh-key","title":"Step 4: Create an SSH key","text":"<p>When deploying clusters, managed.hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. For this purpose, you need to add an ssh key to your AWS EC2 environment. This can be done in two ways: creating a new key pair or importing an existing key pair.</p>"},{"location":"setup_installation/aws/getting_started/#step-41-create-a-new-key-pair","title":"Step 4.1: Create a new key pair","text":"<p>To create a new key pair run the following command replacing REGION by the region in which you want to run the hopsworks cluster. <pre><code>aws ec2 create-key-pair --key-name hopsworksai \\\n    --region REGION\n</code></pre> The output is an ASCII version of the private key and key fingerprint. You need to save the key to a file.</p>"},{"location":"setup_installation/aws/getting_started/#step-42-import-a-key-pair","title":"Step 4.2: Import a key pair","text":"<p>To import an existing key pair run the following command replacing PATH_TO_PUBLIC_KEY by the path to the public key on your machine and REGION by the region in which you want to run the hopsworks cluster. <pre><code>aws ec2 import-key-pair --key-name hopsworskai \\\n   --public-key-material fileb://PATH_TO_PUBLIC_KEY \\\n   --region REGION\n</code></pre></p>"},{"location":"setup_installation/aws/getting_started/#step-5-deploying-a-hopsworks-cluster","title":"Step 5: Deploying a Hopsworks cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p> <p>Select the Region in which you want your cluster to run (1), name your cluster (2).</p> <p>Select the Instance type (3) and Local storage (4) size for the cluster Head node.</p> <p>Check if you want to Enable EBS encryption (5)</p> <p>Enter the name of the S3 bucket (6) you created in step 2.</p> <p>Note</p> <p>The S3 bucket you are using must be empty.</p> <p>Make sure that the ECR AWS Account Id (7) is correct. It is set by default to the AWS account id where you set the cross-account role and need to match the permissions you set in step 3.  Press Next:</p> <p> Create a Hopsworks cluster, general information </p> <p>Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p>Note</p> <p>It is possible to add or remove workers or to enable autoscaling once the cluster is running.</p> <p>Press Next:</p> <p> Create a Hopsworks cluster, static workers configuration </p> <p>Select the SSH key you created in step 4:</p> <p> Choose SSH key </p> <p>Select the Instance Profile that you created in step 3:</p> <p> Choose the instance profile </p> <p>To backup the S3 bucket data when taking a cluster backup we need to set a retention policy for S3. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the retention period in days and click on Review and submit:</p> <p> Choose the backup retention policy </p> <p>Review all information and select Create:</p> <p> Review cluster information </p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/aws/getting_started/#step-6-next-steps","title":"Step 6: Next steps","text":"<p>Check out our other guides for how to get started with Hopsworks and the Feature Store:</p> <ul> <li>Make Hopsworks services accessible from outside services</li> <li>Get started with the Hopsworks Feature Store</li> <li>Follow one of our tutorials</li> <li>Follow one of our Guide</li> <li>Code examples and notebooks: hops-examples</li> </ul>"},{"location":"setup_installation/aws/instance_profile_permissions/","title":"Instance profile permissions","text":"<p>Replace the following placeholders with their appropiate values</p> <ul> <li>BUCKET_NAME - S3 bucket name </li> <li>REGION - region where the cluster is deployed</li> <li>ECR_AWS_ACCOUNT_ID - AWS account id for ECR repositories</li> </ul> <p>Note</p> <p>Some of these permissions can be removed. Refer to this guide for more information.</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"hopsworksaiInstanceProfile\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"S3:PutObject\",\n        \"S3:ListBucket\",\n        \"S3:GetObject\",\n        \"S3:DeleteObject\",\n        \"S3:AbortMultipartUpload\",\n        \"S3:ListBucketMultipartUploads\",\n        \"S3:PutLifecycleConfiguration\",\n        \"S3:GetLifecycleConfiguration\",\n        \"S3:PutBucketVersioning\",\n        \"S3:GetBucketVersioning\",\n        \"S3:ListBucketVersions\",\n        \"S3:DeleteObjectVersion\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::BUCKET_NAME/*\",\n        \"arn:aws:s3:::BUCKET_NAME\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowPullImagesFromHopsworkAi\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:REGION:822623301872:repository/filebeat\",\n        \"arn:aws:ecr:REGION:822623301872:repository/base\",\n        \"arn:aws:ecr:REGION:822623301872:repository/onlinefs\",\n        \"arn:aws:ecr:REGION:822623301872:repository/airflow\",\n        \"arn:aws:ecr:REGION:822623301872:repository/git\",\n        \"arn:aws:ecr:REGION:822623301872:repository/testconnector\",\n        \"arn:aws:ecr:REGION:822623301872:repository/flyingduck\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowCreateRespositry\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ecr:CreateRepository\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowPushandPullImagesToUserRepo\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:CompleteLayerUpload\",\n        \"ecr:UploadLayerPart\",\n        \"ecr:InitiateLayerUpload\",\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:PutImage\",\n        \"ecr:ListImages\",\n        \"ecr:BatchDeleteImage\",\n        \"ecr:GetLifecyclePolicy\",\n        \"ecr:PutLifecyclePolicy\",\n        \"ecr:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/filebeat\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/base\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/onlinefs\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/airflow\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/git\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/testconnector\",\n        \"arn:aws:ecr:REGION:ECR_AWS_ACCOUNT_ID:repository/*/flyingduck\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowGetAuthToken\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ecr:GetAuthorizationToken\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeTags\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/","title":"Limiting AWS permissions","text":"<p>Managed.hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s AWS account. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down AWS permissions following the IT security policy principle of least privilege allowing managed.hopsworks.ai to only access resources in a specific VPC.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#default-permissions","title":"Default permissions","text":"<p>This is the list of default permissions that are required by managed.hopsworks.ai. If you prefer to limit these permissions, then proceed to the next section.</p> <pre><code>{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n      {\n          \"Sid\": \"ListResources\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:DescribeInstances\",\n              \"ec2:DescribeVpcs\",\n              \"ec2:DescribeVolumes\",\n              \"ec2:DescribeSubnets\",\n              \"ec2:DescribeKeyPairs\",\n              \"ec2:DescribeInstanceStatus\",\n              \"iam:ListInstanceProfiles\",\n              \"ec2:DescribeSecurityGroups\",\n              \"ec2:DescribeVpcAttribute\",\n              \"ec2:DescribeRouteTables\",\n              \"iam:GetInstanceProfile\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"IAMPassRoleToInstance\",\n          \"Effect\": \"Allow\",\n          \"Action\": \"iam:PassRole\",\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"AllowInstanceActions\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:RunInstances\",\n              \"ec2:StopInstances\",\n              \"ec2:TerminateInstances\",\n              \"ec2:StartInstances\",\n              \"ec2:CreateTags\",\n              \"ec2:AssociateIamInstanceProfile\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"AllowNetworkRessourcesCreation\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:CreateVpc\",\n              \"ec2:ModifyVpcAttribute\",\n              \"ec2:CreateInternetGateway\",\n              \"ec2:AttachInternetGateway\",\n              \"ec2:CreateSubnet\",\n              \"ec2:CreateSecurityGroup\",\n              \"ec2:CreateRouteTable\",\n              \"ec2:CreateRoute\",\n              \"ec2:AssociateRouteTable\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"AllowNetworkRessourcesDeletion\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:DeleteSubnet\",\n              \"ec2:DeleteRouteTable\",\n              \"ec2:DeleteInternetGateway\",\n              \"ec2:DeleteRoute\",\n              \"ec2:DetachInternetGateway\",\n              \"ec2:DisassociateRouteTable\",\n              \"ec2:DeleteSecurityGroup\",\n              \"ec2:DeleteVpc\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"AllowOpeningPorts\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:AuthorizeSecurityGroupIngress\",\n              \"ec2:RevokeSecurityGroupIngress\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"AllowTestingOfInstanceRole\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"iam:SimulatePrincipalPolicy\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"HopsworksAIBackup\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:RegisterImage\",\n              \"ec2:DeregisterImage\",\n              \"ec2:DescribeImages\",\n              \"ec2:CreateSnapshot\",\n              \"ec2:DeleteSnapshot\",\n              \"ec2:DescribeSnapshots\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n          \"Sid\": \"HopsworksAIModifyInstanceType\",\n          \"Effect\": \"Allow\",\n          \"Action\": [\n              \"ec2:ModifyInstanceAttribute\"\n          ],\n          \"Resource\": \"*\"\n      },\n      {\n        \"Sid\": \"ManageLoadBalancersForExternalAccess\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"elasticloadbalancing:CreateLoadBalancer\",\n            \"elasticloadbalancing:CreateListener\",\n            \"elasticloadbalancing:CreateTargetGroup\",\n            \"elasticloadbalancing:RegisterTargets\",\n            \"elasticloadbalancing:AddTags\",\n            \"elasticloadbalancing:DescribeTargetGroups\",\n            \"elasticloadbalancing:DeleteLoadBalancer\",\n            \"elasticloadbalancing:DeleteTargetGroup\"\n        ],\n        \"Resource\": \"*\"\n    }\n  ]\n}\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-the-cross-account-role-permissions","title":"Limiting the cross-account role permissions","text":""},{"location":"setup_installation/aws/restrictive_permissions/#step-1-create-a-vpc","title":"Step 1: Create a VPC","text":"<p>To restrict managed.hopsworks.ai from accessing resources outside of a specific VPC, you need to create a new VPC connected to an Internet Gateway. This can be achieved in the AWS Management Console following this guide: Create the VPC. Follow the steps of <code>Create a VPC, subnets, and other VPC resources</code>, naming your vpc and changing the <code>Number of Availability Zones</code> to 1 are the only changes you need to make to the default configuration. Alternatively, an existing VPC such as the default VPC can be used and managed.hopsworks.ai will be restricted to this VPC. Note the VPC ID of the VPC you want to use for the following steps.</p> <p>Note</p> <p>Make sure you enable <code>DNS hostnames</code> for your VPC</p> <p>Note</p> <p>If you use VPC endpoints to managed access to services such as S3 and ECR you need to ensure that the endpoints provide the same permissions as set in the instance profile</p> <p>After you have created the VPC either Create a Security Group or use VPC's default. Make sure that the VPC allow the following traffic.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#inbound-traffic","title":"Inbound traffic","text":"<p>It is imperative that the Security Group allows Inbound traffic from any Instance within the same Security Group in any (TCP) port. All VMs of the Cluster should be able to communicate with each other. It is also recommended to open TCP port <code>80</code> to sign the certificates. If you do not open port <code>80</code> you will have to use a self-signed certificate in your Hopsworks cluster. This can be done by checking the <code>Continue with self-signed certificate</code> check box in the <code>Security Group</code> step of the cluster creation.</p> <p>We recommend configuring the Network ACLs to be open to all inbound traffic and let the security group handle the access restriction. But if you want to set limitations at the Network ACLs level, they must be configured so that at least the TCP ephemeral port <code>32768 - 65535</code> are open to the internet (this is so that outbound trafic can receive answers). It is also recommended to open TCP port <code>80</code> to sign the certificates. If you do not open port <code>80</code> you will have to use a self-signed certificate in your Hopsworks cluster. This can be done by checking the <code>Continue with self-signed certificate</code> check box in the <code>Security Group</code> step of the cluster creation.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#outbound-traffic","title":"Outbound traffic","text":"<p>Clusters created on managed.hopsworks.ai need to be able to send http requests to api.hopsworks.ai. The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation.</p> <p>Similar to Inbound traffic, the Security Group in place must allow Outbound traffic in any (TCP) port towards any VM withing the same Security Group.</p> <p>Note</p> <p>If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#step-2-create-an-instance-profile","title":"Step 2: Create an instance profile","text":"<p>You need to create an instance profile that will identify all instances started by managed.hopsworks.ai. Follow this guide to create a role to be used by EC2 with no permissions attached: Creating a Role for an AWS Service (Console). Take note of the ARN of the role you just created.</p> <p>You will need to add permissions to the instance profile to give access to the S3 bucket where Hopsworks will store its data. For more details about these permissions check our guide here. Check bellow for more information on restricting the permissions given the instance profile.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#step-3-set-permissions-of-the-cross-account-role","title":"Step 3: Set permissions of the cross-account role","text":"<p>During the account setup for managed.hopsworks.ai, you were asked to create and provide a cross-account role. If you don\u2019t remember which role you used then you can find it in Settings/Account Settings in managed.hopsworks.ai. Edit this role in the AWS Management Console and overwrite the existing inline policy with the following policy.</p> <p>Note that you have to replace <code>[INSTANCE_PROFILE_NAME]</code> and <code>[VPC_ID]</code> for multiple occurrences in the given policy.</p> <p>If you want to learn more about how this policy works check out: How to Help Lock Down a User\u2019s Amazon EC2 Capabilities to a Single VPC.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n      {\n        \"Sid\": \"NonResourceBasedPermissions\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:DescribeInstances\",\n          \"ec2:DescribeVpcs\",\n          \"ec2:DescribeVolumes\",\n          \"ec2:DescribeSubnets\",\n          \"ec2:DescribeKeyPairs\",\n          \"ec2:DescribeInstanceStatus\",\n          \"iam:ListInstanceProfiles\",\n          \"ec2:DescribeSecurityGroups\",\n          \"ec2:DescribeVpcAttribute\",\n          \"ec2:DescribeRouteTables\"\n        ],\n        \"Resource\": \"*\"\n      },\n      {\n        \"Sid\": \"IAMPassRoleToInstance\",\n        \"Effect\": \"Allow\",\n        \"Action\": \"iam:PassRole\",\n        \"Resource\": \"arn:aws:iam::*:role/[INSTANCE_PROFILE_NAME]\"\n      },\n      {\n        \"Sid\": \"EC2RunInstancesOnlyWithGivenRole\",\n        \"Effect\": \"Allow\",\n        \"Action\": \"ec2:RunInstances\",\n        \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n        \"Condition\": {\n          \"ArnLike\": {\n            \"ec2:InstanceProfile\": \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\"\n          }\n        }\n      },\n      {\n        \"Sid\": \"EC2RunInstancesOnlyInGivenVpc\",\n        \"Effect\": \"Allow\",\n        \"Action\": \"ec2:RunInstances\",\n        \"Resource\": \"arn:aws:ec2:*:*:subnet/*\",\n        \"Condition\": {\n          \"ArnLike\": {\n            \"ec2:vpc\": \"arn:aws:ec2:*:*:vpc/[VPC_ID]\"\n          }\n        }\n      },\n      {\n        \"Sid\": \"AllowInstanceActions\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:StopInstances\",\n          \"ec2:TerminateInstances\",\n          \"ec2:StartInstances\",\n          \"ec2:CreateTags\",\n          \"ec2:AssociateIamInstanceProfile\"\n        ],\n        \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n        \"Condition\": {\n          \"ArnLike\": {\n            \"ec2:InstanceProfile\": \"arn:aws:iam::*:instance-profile/[INSTANCE_PROFILE_NAME]\"\n          }\n        }\n      },\n      {\n        \"Sid\": \"RemainingRunInstancePermissions\",\n        \"Effect\": \"Allow\",\n        \"Action\": \"ec2:RunInstances\",\n        \"Resource\": [\n          \"arn:aws:ec2:*:*:volume/*\",\n          \"arn:aws:ec2:*::image/*\",\n          \"arn:aws:ec2:*::snapshot/*\",\n          \"arn:aws:ec2:*:*:network-interface/*\",\n          \"arn:aws:ec2:*:*:key-pair/*\",\n          \"arn:aws:ec2:*:*:security-group/*\"\n        ]\n      },\n      {\n        \"Sid\": \"EC2VpcNonResourceSpecificActions\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:AuthorizeSecurityGroupIngress\",\n          \"ec2:RevokeSecurityGroupIngress\"\n        ],\n        \"Resource\": \"*\",\n        \"Condition\": {\n          \"ArnLike\": {\n            \"ec2:vpc\": \"arn:aws:ec2:*:*:vpc/[VPC_ID]\"\n          }\n        }\n      },\n      {\n        \"Sid\": \"EC2BackupCreation\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:RegisterImage\",\n          \"ec2:DeregisterImage\",\n          \"ec2:DescribeImages\",\n          \"ec2:CreateSnapshot\",\n          \"ec2:DeleteSnapshot\",\n          \"ec2:DescribeSnapshots\"\n        ],\n        \"Resource\": \"*\"\n      }\n    ]\n  }\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#step-4-create-your-hopsworks-instance","title":"Step 4: Create your Hopsworks instance","text":"<p>You can now create a new Hopsworks instance in managed.hopsworks.ai by selecting the configured instance profile, VPC and security group during instance configuration. Selecting any other VPCs or instance profiles will result in permissions errors.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#step-5-supporting-multiple-vpcs","title":"Step 5: Supporting multiple VPCs","text":"<p>The policy can be extended to give managed.hopsworks.ai access to multiple VPCs. See: Creating a Condition with Multiple Keys or Values.</p>"},{"location":"setup_installation/aws/restrictive_permissions/#other-removable-permissions","title":"Other removable permissions","text":"<p>There are other permissions that are required by Hopsworks to provide certain product capabilities to the users. In this section, we go through these permissions and what are the implication or removing them. </p>"},{"location":"setup_installation/aws/restrictive_permissions/#backup-permissions","title":"Backup permissions","text":"<p>The following permissions are only needed for the backup feature. You can remove them if you are not going to create backups or if you do not have access to this Enterprise feature.</p> <pre><code>      {\n        \"Sid\": \"EC2BackupCreation\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:RegisterImage\",\n          \"ec2:DeregisterImage\",\n          \"ec2:DescribeImages\",\n          \"ec2:CreateSnapshot\",\n          \"ec2:DeleteSnapshot\",\n          \"ec2:DescribeSnapshots\"\n        ],\n        \"Resource\": \"*\",\n      }\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#early-warnings-if-vpc-is-not-configured-correctly","title":"Early warnings if VPC is not configured correctly","text":"<p>The following permissions are needed to give an early warning if your VPC and security groups are badly configured. You can remove them if you don't need it. <pre><code>          \"ec2:DescribeVpcAttribute\",\n          \"ec2:DescribeRouteTables\"\n</code></pre></p>"},{"location":"setup_installation/aws/restrictive_permissions/#open-and-close-ports-from-within-hopsworksai","title":"Open and close ports from within Hopsworks.ai","text":"<p>The following permissions are used to let you close and open ports on your cluster from hopswork.ai, you can remove them if you do not want to open ports on your cluster or if you want to manually open ports in EC2.</p> <pre><code>      {\n        \"Sid\": \"EC2VpcNonResourceSpecificActions\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n          \"ec2:AuthorizeSecurityGroupIngress\",\n          \"ec2:RevokeSecurityGroupIngress\",\n        ],\n        \"Resource\": \"*\",\n        \"Condition\": {\n          \"ArnLike\": {\n            \"ec2:vpc\": \"arn:aws:ec2:*:*:vpc/[VPC_ID]\"\n          }\n        }\n      }\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#non-resource-based-permissions-used-for-listing","title":"Non resource based permissions used for listing","text":"<p>If you are using terraform, then you can also remove most of the Describe permissions in <code>NonResourceBasedPermissions</code> and use the following permissions instead</p> <pre><code>        {\n            \"Sid\": \"NonResourceBasedPermissions\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:DescribeInstances\",\n                \"ec2:DescribeVolumes\",\n                \"ec2:DescribeSecurityGroups\"\n            ],\n            \"Resource\": \"*\"\n        },\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#load-balancers-permissions-for-external-access","title":"Load balancers permissions for external access","text":"<p>If you plan to access your Hopsworks cluster from an external python environment, especially if you plan to use the ArrowFlight with DuckDB, then it is required to create a network load balancer that forward requests to the ArrowFlight server(s) co-located with the RonDB MySQL Server(s). If you are not planning to use ArrowFlight server(s) or multiple mysql server(s), you can skip adding the following permissions. If you still wish to use the ArrowFlight server(s) but without adding the following permissions to your cross account role, check this advanced terraform example for more details.</p> <pre><code>      {\n        \"Sid\": \"ManageLoadBalancersForExternalAccess\",\n        \"Effect\": \"Allow\",\n        \"Action\": [\n            \"elasticloadbalancing:CreateLoadBalancer\",\n            \"elasticloadbalancing:CreateListener\",\n            \"elasticloadbalancing:CreateTargetGroup\",\n            \"elasticloadbalancing:RegisterTargets\",\n            \"elasticloadbalancing:AddTags\",\n            \"elasticloadbalancing:DescribeTargetGroups\",\n            \"elasticloadbalancing:DeleteLoadBalancer\",\n            \"elasticloadbalancing:DeleteTargetGroup\"\n        ],\n        \"Resource\": \"*\"\n    }\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#limiting-the-instance-profile-permissions","title":"Limiting the instance profile permissions","text":""},{"location":"setup_installation/aws/restrictive_permissions/#backups","title":"Backups","text":"<p>If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring instance profile permissions . For this remove the following permissions from the instance profile:</p> <pre><code>      \"S3:PutLifecycleConfiguration\", \n      \"S3:GetLifecycleConfiguration\", \n      \"S3:PutBucketVersioning\", \n      \"S3:ListBucketVersions\",\n      \"S3:DeleteObjectVersion\",\n</code></pre>"},{"location":"setup_installation/aws/restrictive_permissions/#cloudwatch-logs","title":"CloudWatch Logs","text":"<p>Hopsworks put its logs in Amazon CloudWatch so that you can access them without having to ssh into the machine. If you are not interested in this feature you can remove the following from your instance profile policy:</p> <pre><code>    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeTags\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/AmazonCloudWatch-*\"\n    }\n</code></pre>"},{"location":"setup_installation/aws/troubleshooting/","title":"Troubleshooting","text":"<p>A list of common problems that you might encounter during cluster creation and how to solve them. </p>"},{"location":"setup_installation/aws/troubleshooting/#unauthorized-error-during-cluster-creation","title":"Unauthorized error during cluster creation","text":"<p>If you encounter the following error right after creating your cluster, then it is likely that you have either missed or misconfigured one of the permissions in the cross account role setup. </p> <p> Unauthorized error during cluster creation </p> <p>In order to get more details regarding the authorization error above, you need to use the AWS Command Line Interface (AWS CLI) to decode the message using the <code>aws sts decode-authorization-message --encoded-message</code> command.</p> <pre><code>$ aws sts decode-authorization-message --encoded-message hg-Sh5-CUNT5jgB305YbOp_FDp2P70ZPw5iwoextxcdWmoc4wgm_K0pAUZEvTtCpvCk_-EwtaqaRS0act1BM-Bz-id4NOwo-OVZES5q9fLQIqk5_typL767idkb4jdzrrwNLD3h7iaaoleKGQpaW5kzI_oHEtibBRY2uWhU07oiwDHOAwb-cQ-kIA4nJIay7wVoL7QRx8nECpb56s68lMWhrdbqKj6uRQwsAILY7eoV-sDCbWWjnr98ja_olixhlV95txiV-oCR2qW6GKn4TVKl2raGbwjWRdS2GACP0fm7RUI_glPl7q65Erhrcr7Z2uF2SRF46VI5vfXkjXxv58e0x6SSRmKXF397e4QpPM6RyopmgDa9sSWAbkBxC86O9b30l47GX9w98trc76jsfU-UcdqK-Vu7Qy3-j8ehYMDpNvZRFNX64fUrsfusLJcHnhAPqUgCbvjfmEa605GkH7amlP2j23vprb94auzCVk8rgVkrSrBMek6YlWA0nzXtSjq8mVAvFE-n6x3ByLdt68Ldgc602FsFqifuzUm7CnjapIIwSAat_TXQCs-mjXyB983AEw__RwiXN\n</code></pre> <p>Then you will get the following message as response  <pre><code>{\n    \"DecodedMessage\": \"{\\\"allowed\\\":false,\\\"explicitDeny\\\":false,\\\"matchedStatements\\\":{\\\"items\\\":[]},\\\"failures\\\":{\\\"items\\\":[]},\\\"context\\\":{\\\"principal\\\":{\\\"id\\\":\\\"AROA27VDEGQLGDB4JOSOI:1f708920-18a6-11ed-8dd4-f162dca8fc19\\\",\\\"arn\\\":\\\"arn:aws:sts::xxxxx:assumed-role/cross-acount-role/1f708920-18a6-11ed-8dd4-f162dca8fc19\\\"},\\\"action\\\":\\\"ec2:CreateVpc\\\",\\\"resource\\\":\\\"arn:aws:ec2:us-east-2:xxxxx:vpc/*\\\",\\\"conditions\\\":{\\\"items\\\":[{\\\"key\\\":\\\"aws:Region\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"us-east-2\\\"}]}},{\\\"key\\\":\\\"aws:Service\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"ec2\\\"}]}},{\\\"key\\\":\\\"aws:Resource\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"vpc/*\\\"}]}},{\\\"key\\\":\\\"aws:Type\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"vpc\\\"}]}},{\\\"key\\\":\\\"aws:Account\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"xxxxxx\\\"}]}},{\\\"key\\\":\\\"ec2:VpcID\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"*\\\"}]}},{\\\"key\\\":\\\"aws:ARN\\\",\\\"values\\\":{\\\"items\\\":[{\\\"value\\\":\\\"arn:aws:ec2:us-east-2:xxxx:vpc/*\\\"}]}}]}}}\"\n}\n</code></pre></p> <p>From the above response we can see that the cross-account role is missing the <code>ec2:CreateVpc</code> permission. The solution is to terminate the cluster in error and update cross account role setup with the missing permission(s) and then try to create a new cluster.</p>"},{"location":"setup_installation/aws/troubleshooting/#missing-permissions-error-during-cluster-creation","title":"Missing permissions error during cluster creation","text":"<p>If you encounter the following error right after creating your cluster, then the issue is with the instance profile permissions.  </p> <p> Missing permissions error during cluster creation </p> <p>This issue could be caused by one of the following:</p> <ul> <li> <p>The instance profile that you have chosen during cluster creation is actually missing the permissions stated in the error  on your chosen S3 bucket. Then in that case, update your instance profile accordingly and then click Retry to retry cluster creation operation. </p> </li> <li> <p>Your AWS organization is using SCPs policy that disallow policy simulation. In that case, you could do a simple test to confirm the issue by using the AWS PolicySim on AWS console. If policy simulation is disallowed, you can configure managed.hopsworks.ai to skip the policy simulation step by removing the <code>iam:SimulatePrincipalPolicy</code> permission from your cross account role, by navigating to the AWS Roles console, search for your cross account role name and click on it, on the permissions tab click edit on hopsworks inline policy, choose JSON tab, remove <code>iam:SimulatePrincipalPolicy</code>, click Review Policy, and then click Save Changes, and finally navigate back to managed.hopsworks.ai and click Retry to retry the cluster creation.</p> </li> </ul>"},{"location":"setup_installation/aws/upgrade/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 2.2 or older (AWS)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/aws/upgrade/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear.</p> <p>You can proceed by clicking the Upgrade button.</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/aws/upgrade/#step-2-add-upgrade-permissions-to-your-instance-profile","title":"Step 2: Add upgrade permissions to your instance profile","text":"<p>Note</p> <p>You can skip this step if you already have the following permissions in your instance profile: <pre><code>[ \"ec2:DescribeVolumes\", \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\"]\n</code></pre></p> <p>We require extra permissions to be added to the instance profile attached to your cluster to proceed with the upgrade. First to get the name of your instance profile, click on the Details tab as shown below:</p> <p> Getting the name of your instance profile </p> <p>Once you get your instance profile name, navigate to AWS management console, then click on Roles and then search for your role name and click on it.  Go to the Permissions tab, click on Add inline policy, and then go to the JSON tab. Paste the following snippet, click on Review policy, name it, and click Create policy.</p> <p>Note</p> <p>You can restrict the upgrade permissions given to your instance profile. Refer to this guide for more information.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"UpgradePermissions\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:DescribeVolumes\",\n                \"ec2:DetachVolume\",\n                \"ec2:AttachVolume\",\n                \"ec2:ModifyInstanceAttribute\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n</code></pre>"},{"location":"setup_installation/aws/upgrade/#step-3-run-the-upgrade-process","title":"Step 3: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the following message since this is done already in Step 2</p> <p>Make sure that your instance profile (hopsworks-doc) includes the following permissions: [ \"ec2:DetachVolume\", \"ec2:AttachVolume\", \"ec2:ModifyInstanceAttribute\" ]</p> <p> Upgrade confirmation </p> <p>Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below:</p> <p> Upgrade is complete </p>"},{"location":"setup_installation/aws/upgrade/#error-handling","title":"Error handling","text":"<p>There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your instance profile, see Error 1. Second, an error during the upgrade process running on your cluster, see Error 2.</p>"},{"location":"setup_installation/aws/upgrade/#error-1-misconfigured-upgrade-permissions","title":"Error 1: Misconfigured upgrade permissions","text":"<p>During the upgrade process, managed.hopsworks.ai starts by validating your instance profile permissions to ensure that it includes the required upgrade permissions. If one or more permissions are missing, or if the resource is not set correctly, you will be notified with an error message and a Retry button will appear as shown below:</p> <p> Upgrade permissions are missing </p> <p>Update you instance profile accordingly, then click Retry</p> <p> Upgrade is running </p>"},{"location":"setup_installation/aws/upgrade/#error-2-upgrade-process-error","title":"Error 2: Upgrade process error","text":"<p>If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: </p> <p> Error occurred during upgrade </p> <p>Click on Rollback to recover your old cluster before upgrade.</p> <p> Upgrade rollback confirmation </p> <p>Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below:</p> <p> Upgrade rollback confirmation </p> <p>Once the rollback is completed, you will be able to continue working as normal with your old cluster.</p> <p>Note</p> <p>The old cluster will be stopped after the rollback. You have to click on the Start button.</p>"},{"location":"setup_installation/aws/upgrade_2.4/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 2.4 or newer (AWS)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/aws/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear.</p> <p>You can proceed by clicking the Upgrade button.</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/aws/upgrade_2.4/#step-2-add-backup-permissions-to-your-cross-account-role","title":"Step 2: Add backup permissions to your cross account role","text":"<p>Note</p> <p>You can skip this step if you already have the following permissions in your cross account role: <pre><code>[ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"]\n</code></pre></p> <p>We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide. These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. </p> <p>First, check which role or access key you have added to managed.hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account</p> <p> Cloud Accounts </p> <p>Once you have clicked on Edit, you will be able to see the current assigned role</p> <p> AWS Cross-Account Role </p> <p>Once you get your role name, navigate to AWS management console, then click on Roles and then search for your role name and click on it.  Go to the Permissions tab, click on Add inline policy, and then go to the JSON tab. Paste the following snippet, click on Review policy, name it, and click Create policy.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"HopsworksAIBackup\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:RegisterImage\",\n                \"ec2:DeregisterImage\",\n                \"ec2:DescribeImages\",\n                \"ec2:CreateSnapshot\",\n                \"ec2:DeleteSnapshot\",\n                \"ec2:DescribeSnapshots\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n</code></pre>"},{"location":"setup_installation/aws/upgrade_2.4/#step-3-run-the-upgrade-process","title":"Step 3: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the following message since this is done already in Step 2</p> <p>Make sure that your cross-account role which you have connected to managed.hopsworks.ai has the following permissions: [ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"]</p> <p> Upgrade confirmation </p> <p>Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster.</p>"},{"location":"setup_installation/aws/upgrade_2.4/#error-handling","title":"Error handling","text":"<p>There are two categories of errors that you may encounter during an upgrade. First, a permission error due to missing permission or a misconfigured policy in your cross-account role, see Error 1. Second, an error during the upgrade process running on your cluster, see Error 2.</p>"},{"location":"setup_installation/aws/upgrade_2.4/#error-1-missing-backup-permissions","title":"Error 1: Missing backup permissions","text":"<p>If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below:</p> <p> Upgrade permissions are missing </p> <p>Update you cross account role as described in Step 2, then click Start. Once the cluster is up and running, you can try running the upgrade again.</p>"},{"location":"setup_installation/aws/upgrade_2.4/#error-2-upgrade-process-error","title":"Error 2: Upgrade process error","text":"<p>If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: </p> <p> Error occurred during upgrade </p> <p>Click on Rollback to recover your old cluster before upgrade.</p> <p> Upgrade rollback confirmation </p> <p>Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below:</p> <p> Upgrade rollback confirmation </p> <p>Once the rollback is completed, you will be able to continue working as normal with your old cluster.</p> <p>Note</p> <p>The old cluster will be stopped after the rollback. You have to click on the Start button.</p>"},{"location":"setup_installation/aws/upgrade_3.0/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 3.0 or newer (AWS)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/aws/upgrade_3.0/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear.</p> <p>You can proceed by clicking the Upgrade button.</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/aws/upgrade_3.0/#step-2-add-backup-permissions-to-your-cross-account-role","title":"Step 2: Add backup permissions to your cross account role","text":"<p>Note</p> <p>You can skip this step if you already have the following permissions in your cross account role: <pre><code>[ \"ec2:RegisterImage\", \"ec2:DeregisterImage\", \"ec2:DescribeImages\", \"ec2:CreateSnapshot\", \"ec2:DeleteSnapshot\", \"ec2:DescribeSnapshots\"]\n</code></pre></p> <p>We require some extra permissions to be added to the role you have created when connecting your AWS account as described in getting started guide. These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. </p> <p>First, check which role or access key you have added to managed.hopsworks.ai, you can go to the Settings tab, and then click Edit next to the AWS cloud account</p> <p> Cloud Accounts </p> <p>Once you have clicked on Edit, you will be able to see the current assigned role</p> <p> AWS Cross-Account Role </p> <p>Once you get your role name, navigate to AWS management console, then click on Roles and then search for your role name and click on it.  Go to the Permissions tab, click on Add inline policy, and then go to the JSON tab. Paste the following snippet, click on Review policy, name it, and click Create policy.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"HopsworksAIBackup\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:RegisterImage\",\n                \"ec2:DeregisterImage\",\n                \"ec2:DescribeImages\",\n                \"ec2:CreateSnapshot\",\n                \"ec2:DeleteSnapshot\",\n                \"ec2:DescribeSnapshots\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n</code></pre>"},{"location":"setup_installation/aws/upgrade_3.0/#step-3-update-the-instance-profile-permissions","title":"Step 3: Update the instance profile permissions","text":"<p>We have enforced using managed docker registry (ECR) starting from Hopsworks version 3.1.0, so you need to update your instance profile to include extra permissions to allow access to ECR. First, get the instance profile of your cluster by clicking on the Details tab and check the IAM role ARN shown in front of IAM Instance Profile. Once you get your role name, navigate to AWS management console, then click on Roles and then search for your role name and click on it.  Go to the Permissions tab, click on Add inline policy, and then go to the JSON tab. Paste the following snippet, click on Review policy, name it, and click Create policy.</p> <pre><code>{\n   \"Version\":\"2012-10-17\",\n   \"Statement\":[\n      {\n         \"Sid\":\"AllowPullImagesFromHopsworkAi\",\n         \"Effect\":\"Allow\",\n         \"Action\":[\n            \"ecr:GetDownloadUrlForLayer\",\n            \"ecr:BatchGetImage\"\n         ],\n         \"Resource\":[\n            \"arn:aws:ecr:*:822623301872:repository/filebeat\",\n            \"arn:aws:ecr:*:822623301872:repository/base\",\n            \"arn:aws:ecr:*:822623301872:repository/onlinefs\",\n            \"arn:aws:ecr:*:822623301872:repository/airflow\",\n            \"arn:aws:ecr:*:822623301872:repository/git\"\n         ]\n      },\n      {\n         \"Sid\":\"AllowCreateRespositry\",\n         \"Effect\":\"Allow\",\n         \"Action\":\"ecr:CreateRepository\",\n         \"Resource\":\"*\"\n      },\n      {\n         \"Sid\":\"AllowPushandPullImagesToUserRepo\",\n         \"Effect\":\"Allow\",\n         \"Action\":[\n            \"ecr:GetDownloadUrlForLayer\",\n            \"ecr:BatchGetImage\",\n            \"ecr:CompleteLayerUpload\",\n            \"ecr:UploadLayerPart\",\n            \"ecr:InitiateLayerUpload\",\n            \"ecr:BatchCheckLayerAvailability\",\n            \"ecr:PutImage\",\n            \"ecr:ListImages\",\n            \"ecr:BatchDeleteImage\",\n            \"ecr:GetLifecyclePolicy\",\n            \"ecr:PutLifecyclePolicy\",\n            \"ecr:TagResource\"\n         ],\n         \"Resource\":[\n            \"arn:aws:ecr:*:*:repository/*/filebeat\",\n            \"arn:aws:ecr:*:*:repository/*/base\",\n            \"arn:aws:ecr:*:*:repository/*/onlinefs\",\n            \"arn:aws:ecr:*:*:repository/*/airflow\",\n            \"arn:aws:ecr:*:*:repository/*/git\"\n         ]\n      },\n      {\n         \"Sid\":\"AllowGetAuthToken\",\n         \"Effect\":\"Allow\",\n         \"Action\":\"ecr:GetAuthorizationToken\",\n         \"Resource\":\"*\"\n      }\n   ]\n}\n</code></pre>"},{"location":"setup_installation/aws/upgrade_3.0/#step-4-run-the-upgrade-process","title":"Step 4: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the steps shown below if you have already completed Step 2 and Step 3</p> <p> Upgrade confirmation </p> <p>Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version on the Details tab of your cluster.</p> <p>For more details about error handling check this guide</p>"},{"location":"setup_installation/azure/aks_acr_integration/","title":"Integration with Azure AKS","text":"<p>This guide shows how to create a cluster in managed.hopsworks.ai with integrated support for Azure Kubernetes Service (AKS). This enables Hopsworks to launch Python jobs, Jupyter servers, and serve models on top of AKS.</p> <p>This guide provides an example setup with a private AKS cluster.</p> <p>Note</p> <p>If you prefer to use Terraform over command lines you can refer to our Terraform example here.</p>"},{"location":"setup_installation/azure/aks_acr_integration/#step-1-create-a-virtual-network-and-a-subnet","title":"Step 1: Create a Virtual network and a subnet","text":"<p>First, you need to create the virtual network and the subnet in which Hopsworks and the AKS nodes will run. To do this run the following commands, replacing $RESOURCE_GROUP with the resource group in which you will run your cluster.</p> <pre><code>az network vnet create --resource-group $RESOURCE_GROUP --name hopsworks-vnet --address-prefixes 172.18.0.0/16\naz network vnet subnet create --resource-group $RESOURCE_GROUP --name hopsworks-subnet --vnet-name hopsworks-vnet --address-prefixes 172.18.0.0/24\n</code></pre>"},{"location":"setup_installation/azure/aks_acr_integration/#step-2-create-the-aks-cluster","title":"Step 2: Create the AKS cluster.","text":"<p>Run the following command to create the AKS cluster. Replace $RESOURCE_GROUP with the resource group in which you will run your cluster and $SUBSCRIPTION_ID .</p> <pre><code>aksidentity=$(az aks create --resource-group $RESOURCE_GROUP --name hopsworks-aks --network-plugin azure --enable-private-cluster --enable-managed-identity --vnet-subnet-id /subscriptions/$SUBSCRIPTION_ID/resourceGroups/$RESOURCE_GROUP/providers/Microsoft.Network/virtualNetworks/hopsworks-vnet/subnets/hopsworks-subnet --query identityProfile.kubeletidentity.objectId -o tsv)\n</code></pre>"},{"location":"setup_installation/azure/aks_acr_integration/#step-3-add-permissions-to-the-managed-identity","title":"Step 3: Add permissions to the managed identity","text":"<p>You need to add permission to the managed identity you will assign to your Hopsworks cluster to access the AKS cluster. To do it run the following command, replacing $RESOURCE_GROUP with the resource group in which you will run your cluster and $identityId with the id of the identity you will assign to your Hopsworks cluster.</p> <pre><code>az role assignment create --resource-group $RESOURCE_GROUP --role \"Azure Kubernetes Service Cluster User Role\" --assignee $identityId\n</code></pre> <p>You also need to grant permission to pull images from the ACR to the AKS nodes. To do it run the following command, replacing $RESOURCE_GROUP with the resource group in which you will run your cluster</p> <pre><code>az role assignment create --resource-group $RESOURCE_GROUP --role \"AcrPull\" --assignee $aksidentity\n</code></pre>"},{"location":"setup_installation/azure/aks_acr_integration/#step-4-create-the-hopsworks-cluster","title":"Step 4: Create the Hopsworks cluster","text":"<p>Create the hopsworks cluster by following the same steps as in the getting started until the backup tab. Then click on next to get to the Managed containers tab. Set Use Azure AKS as enabled. One new field will pop up. Fill it with the name of the AKS you created above (hopsworks-aks). Click next and in the Virtual Network tab select the virtual network we created above (hopsworks-vnet). Finally, click next and select the subnet we created above (hopsworks-subnet) in the Subnet tab. You can now click on Review and Submit and create your cluster.</p> <p> Hopsworks AKS configuration </p>"},{"location":"setup_installation/azure/aks_acr_integration/#going-further","title":"Going further","text":"<p>You can also deploy the AKS cluster and the Hopsworks cluster in two different virtual networks by using network peering. For this we recommend to use our terraform provider and to refer to our example</p>"},{"location":"setup_installation/azure/cluster_creation/","title":"Getting started with managed.hopsworks.ai (Azure)","text":"<p>This guide goes into detail for each of the steps of the cluster creation in managed.hopsworks.ai</p>"},{"location":"setup_installation/azure/cluster_creation/#step-1-starting-to-create-a-cluster","title":"Step 1 starting to create a cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p>"},{"location":"setup_installation/azure/cluster_creation/#step-2-setting-the-general-information","title":"Step 2 setting the General information","text":"<p>Select the Resource Group (1) you want to use.</p> <p>Note</p> <p>If the Resource Group does not appear in the drop-down, make sure that you properly created and set the custom role for this resource group.</p> <p>Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3).</p> <p>Select the Instance type (4) and Local storage (5) size for the cluster Head node.</p> <p>Optional (6): Enable customer-managed encryption keys and specify a disk encryption set to be used for encryption of local storage. The disk encryption set has to be specified using the format: <code>/subscriptions/[SUBSCRIPTION_ID]/resourceGroups/[RESOURCE_GROUP]/providers/Microsoft.Compute/diskEncryptionSets/[DISK_ENCRYPTION_SET]</code>. Note that you have to grant the service principal of managed.hopsworks.ai <code>Reader</code> access to the disk encryption set and <code>Key Vault Reader</code> and <code>Key Vault Secrets User</code> on the key vault used with the disk encryption set. Refer to the Azure documentation for more details: Server-side encryption of Azure Disk Storage.</p> <p>To provide the capacity of adding and removing workers on demand, the Hopsworks clusters deployed by managed.hopsworks.ai store their data in an Azure storage container. In this step, you select which storage account and container to use for this purpose. Select the storage account (7) you want to use in Azure Storage account name. The name of the container in which the data will be stored is displayed in Azure Container name (8). You can change this name. For more details on how to create and configure a storage in Azure refer to Creating and configuring a storage</p> <p>Note</p> <p>You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty.</p> <p>Enter the Azure container registry name (9) to be used as the managed docker registry for the cluster. </p> <p> General configuration </p> <p>On this page, you can also choose to opt out of managed.hopsworks.ai log collection. Managed.hopsworks.ai collects logs about the services running in your cluster to help us improve our system and to provide support. If you choose to opt-out from the log collection and need support you will have to provide us the log by yourself, which will slow down the support process.</p>"},{"location":"setup_installation/azure/cluster_creation/#step-3-workers-configuration","title":"Step 3 workers configuration","text":"<p>In this step, you configure the workers. There are two possible setups static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: the documentation. In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand.</p>"},{"location":"setup_installation/azure/cluster_creation/#static-workers-configuration","title":"Static workers configuration","text":"<p>You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p> Create a Hopsworks cluster, static workers configuration </p>"},{"location":"setup_installation/azure/cluster_creation/#autoscaling-workers-configuration","title":"Autoscaling workers configuration","text":"<p>You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You can configure:</p> <ol> <li>The instance type you want to use.</li> <li>The size of the instances' disk.</li> <li>The minimum number of workers. </li> <li>The maximum number of workers.</li> <li>The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources.</li> <li>The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system.</li> </ol> <p>Note</p> <p>The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources.</p> <p> Create a Hopsworks cluster, autoscale workers configuration </p>"},{"location":"setup_installation/azure/cluster_creation/#step-4-select-a-ssh-key","title":"Step 4 select a SSH key","text":"<p>When deploying clusters, managed.hopsworks.ai installs a ssh key on the cluster's instances so that you can access them if necessary. Select the SSH key that you want to use to access cluster instances. For more detail on how to add a shh key in Azure refer to Adding a ssh key to your resource group</p> <p> Choose SSH key </p>"},{"location":"setup_installation/azure/cluster_creation/#step-5-select-the-user-assigned-managed-identity","title":"Step 5 select the User assigned managed identity:","text":"<p>In order to let the cluster instances access to the Azure storage we need to attach a User assigned managed identity to the virtual machines. In this step you choose which identity to use. This identity need to have access right to the storage account you selected in Step 2. For more information about how to create this identity and give it access to the storage account refer to Creating and configuring a storage:</p> <p> Choose the User assigned managed identity </p>"},{"location":"setup_installation/azure/cluster_creation/#step-6-set-the-backup-retention-policy","title":"Step 6 set the backup retention policy:","text":"<p>To backup the Azure blob storage data when taking a cluster backups we need to set a retention policy for the blob storage. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster.</p> <p> Choose the backup retention policy </p>"},{"location":"setup_installation/azure/cluster_creation/#step-7-virtual-network-selection","title":"Step 7 Virtual network selection","text":"<p>In this step, you can select the virtual network which will be used by the Hopsworks cluster. You can either select an existing virtual network or let managed.hopsworks.ai create one for you. If you decide to let managed.hopsworks.ai create the virtual network for you, you can choose the CIDR block for this virtual network.  Refer to Create a virtual network and subnet for more details on how to create your own virtual network in Azure.</p> <p> Choose virtual network </p>"},{"location":"setup_installation/azure/cluster_creation/#step-8-subnet-selection","title":"Step 8 Subnet selection","text":"<p>If you selected an existing virtual network in the previous step, this step lets you select which subnet of this virtual network to use. For more information about creating your own subnet refer to Create a virtual network and subnet.</p> <p>If you did not select an existing virtual network in the previous step managed.hopsworks.ai will create the subnet for you. You can choose the CIDR block this subnet will use.</p> <p> Choose subnet </p>"},{"location":"setup_installation/azure/cluster_creation/#step-9-network-security-group-selection","title":"Step 9 Network Security group selection","text":"<p>In this step, you can select the network security group you want to use to manage the inbound and outbound network rules. You can either let managed.hopsworks.ai create a network security group for you or select an existing security group. For more information about how to create your own network security group in Azure refer to Create a network security group.</p> <p>Note</p> <p>Managed.hopsworks.ai require some rules for inbound and outbound traffic in your security group, for more details refer to inbound traffic rules and outbound traffic rules.</p> <p>Note</p> <p>Managed.hopsworks.ai attaches a public ip to your cluster by default. However, you can disable this behavior by unchecking the Attach Public IP checkbox.</p> <p> Choose security group </p>"},{"location":"setup_installation/azure/cluster_creation/#limiting-outbound-traffic-to-managedhopsworksai","title":"Limiting outbound traffic to managed.hopsworks.ai","text":"<p>Clusters created on managed.hopsworks.ai need to be able to send http requests to api.hopsworks.ai. If you have strict regulation regarding outbound traffic, you can enable the Use static IPs to communicate with managed.hopsworks.ai checkbox to get the list of IPs to be allowed as shown below:</p> <p> Enable static IPs </p>"},{"location":"setup_installation/azure/cluster_creation/#step-10-user-management-selection","title":"Step 10 User management selection","text":"<p>In this step, you can choose which user management system to use. You have four choices: </p> <ul> <li>Managed: managed.hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization  (more details here).</li> <li>OAuth2: integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail.</li> <li>LDAP: integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail.</li> <li>Disabled: let you manage users manually from within Hopsworks.</li> </ul> <p> Choose user management type </p>"},{"location":"setup_installation/azure/cluster_creation/#step-12-managed-rondb","title":"Step 12 Managed RonDB","text":"<p>Hopsworks uses RonDB as a database engine for its online Feature Store. By default database will run on its own VM. Premium users can scale-out database services to multiple VMs to handle increased workload.</p> <p>For details on how to configure RonDB check our guide here.</p> <p> Configure RonDB </p> <p>If you need to deploy a RonDB cluster instead of a single node please contact us.</p>"},{"location":"setup_installation/azure/cluster_creation/#step-13-add-tags-to-your-instances","title":"Step 13 add tags to your instances.","text":"<p>In this step, you can define tags that will be added to the cluster virtual machines.</p> <p> Add tags </p>"},{"location":"setup_installation/azure/cluster_creation/#step-14-add-an-init-script-to-your-instances","title":"Step 14 add an init script to your instances.","text":"<p>In this step, you can enter an initialization script that will be run at startup on every instance.</p> <p>Note</p> <p>this init script must be a bash script starting with #!/usr/bin/env bash</p> <p> Add initialization script </p>"},{"location":"setup_installation/azure/cluster_creation/#step-15-review-and-create","title":"Step 15 Review and create","text":"<p>Review all information and select Create:</p> <p> Review cluster information </p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/azure/getting_started/","title":"Getting started with managed.hopsworks.ai (Azure)","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up managed.hopsworks.ai with your organization's Azure account.</p>"},{"location":"setup_installation/azure/getting_started/#prerequisites","title":"Prerequisites","text":"<p>To follow the instruction on this page you will need the following:</p> <ul> <li>An Azure resource group in which the Hopsworks cluster will be deployed. </li> <li>The azure CLI installed and logged in.</li> </ul>"},{"location":"setup_installation/azure/getting_started/#permissions","title":"Permissions","text":"<p>To run all the commands on this page the user needs to have at least the following permissions on the Azure resource group:</p> <pre><code>Microsoft.Authorization/roleDefinitions/write\nMicrosoft.Authorization/roleAssignments/write\nMicrosoft.Compute/sshPublicKeys/generateKeyPair/action\nMicrosoft.Compute/sshPublicKeys/read\nMicrosoft.Compute/sshPublicKeys/write\nMicrosoft.ContainerRegistry/registries/operationStatuses/read\nMicrosoft.ContainerRegistry/registries/read\nMicrosoft.ContainerRegistry/registries/write\nMicrosoft.ManagedIdentity/userAssignedIdentities/write\nMicrosoft.Resources/subscriptions/resourcegroups/read\nMicrosoft.Storage/storageAccounts/write\n</code></pre> <p>You will also need to have a role such as Application Administrator on the Azure Active Directory to be able to create the hopsworks.ai service principal.</p>"},{"location":"setup_installation/azure/getting_started/#resource-providers","title":"Resource providers","text":"<p>For managed.hopsworks.ai to deploy a cluster the following resource providers need to be registered on your Azure subscription.</p> <p><pre><code>Microsoft.Network\nMicrosoft.Compute\nMicrosoft.Storage\nMicrosoft.ManagedIdentity\nMicrosoft.ContainerRegistry\n</code></pre> This can be done by running the following commands:</p> <p>Note</p> <p>To run these commands you need to have the following permission on your subscription: Microsoft.Network/register/action</p> <pre><code>az provider register --namespace 'Microsoft.Network'\naz provider register --namespace 'Microsoft.Compute'\naz provider register --namespace 'Microsoft.Storage'\naz provider register --namespace 'Microsoft.ManagedIdentity'\naz provider register --namespace 'Microsoft.ContainerRegistry'\n</code></pre>"},{"location":"setup_installation/azure/getting_started/#other","title":"Other","text":"<p>All the commands have been written for a Unix system. These commands will need to be adapted to your terminal if it is not directly compatible.</p> <p>All the commands use your default location. Add the --location parameter if you want to run your cluster in another location. Make sure to create the resources in the same location as you are going to run your cluster.</p>"},{"location":"setup_installation/azure/getting_started/#step-1-connect-your-azure-account","title":"Step 1: Connect your Azure account","text":"<p>Managed.hopsworks.ai deploys Hopsworks clusters to your Azure account. To enable this, you have to create a service principal and a custom role for managed.hopsworks.ai granting access to your resource group.</p> <p> </p>"},{"location":"setup_installation/azure/getting_started/#step-11-connect-your-azure-account","title":"Step 1.1: Connect your Azure account","text":"<p>In managed.hopsworks.ai click on Connect to Azure or go to Settings and click on Configure next to Azure. This will direct you to a page with the instructions needed to create the service principal and set up the connection. Follow the instructions.</p> <p>Note</p> <p>it is possible to limit the permissions that are set up during this phase. For more details see restrictive-permissions.</p> <p> Cloud account settings </p>"},{"location":"setup_installation/azure/getting_started/#step-2-create-a-storage","title":"Step 2: Create a storage","text":"<p>Note</p> <p>If you prefer using terraform, you can skip this step and the remaining steps, and instead, follow this guide.</p> <p>The Hopsworks clusters deployed by managed.hopsworks.ai store their data in a storage container in your Azure account. To enable this you need to create a storage account. This is done by running the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>az storage account create --resource-group $RESOURCE_GROUP --name hopsworksstorage$RANDOM\n</code></pre>"},{"location":"setup_installation/azure/getting_started/#step-3-create-an-acr-container-registry","title":"Step 3: Create an ACR Container Registry","text":"<p>The Hopsworks clusters deployed by managed.hopsworks.ai store their docker images in a container registry in your Azure account.  To create this storage account run the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>az acr create --resource-group $RESOURCE_GROUP --name hopsworksecr --sku Premium\n</code></pre> <p>To prevent the registry from filling up with unnecessary images and artifacts you can enable a retention policy. A retention policy will automatically remove untagged manifests after a specified number of days. To enable a retention policy, run the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>az acr config retention update --resource-group $RESOURCE_GROUP --registry hopsworksecr --status Enabled --days 7 --type UntaggedManifests\n</code></pre>"},{"location":"setup_installation/azure/getting_started/#step-4-create-a-managed-identity","title":"Step 4: Create a managed identity","text":"<p>To allow the hopsworks cluster instances to access the storage account and the container registry, managed.hopsworks.ai assigns a managed identity to the cluster nodes. To enable this you need to:</p> <ul> <li>Create a managed identity</li> <li>Create a role with appropriate permission and assign it to the managed identity</li> </ul>"},{"location":"setup_installation/azure/getting_started/#step-41-create-a-managed-identity","title":"Step 4.1: Create a managed identity","text":"<p>You create a managed identity by running the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>identityId=$(az identity create --name hopsworks-instance --resource-group $RESOURCE_GROUP --query principalId -o tsv)\n</code></pre>"},{"location":"setup_installation/azure/getting_started/#step-42-create-a-role-for-the-managed-identity","title":"Step 4.2: Create a role for the managed identity","text":"<p>To create a new role for the managed identity, first, create a file called instance-role.json with the following content. Replace SUBSCRIPTION_ID by your subscription id and RESOURCE_GROUP by your resource group</p> <p><pre><code>{\n  \"Name\": \"hopsworks-instance\",\n  \"IsCustom\": true,\n  \"Description\": \"Allow the hopsworks instance to access the storage and the docker repository\",\n  \"Actions\": [\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/write\",\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/read\",\n      \"Microsoft.Storage/storageAccounts/blobServices/write\",\n      \"Microsoft.Storage/storageAccounts/blobServices/read\",\n      \"Microsoft.Storage/storageAccounts/listKeys/action\",\n      \"Microsoft.ContainerRegistry/registries/artifacts/delete\",\n      \"Microsoft.ContainerRegistry/registries/pull/read\",\n      \"Microsoft.ContainerRegistry/registries/push/write\"\n  ],\n  \"NotActions\": [\n\n  ],\n  \"DataActions\": [\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete\",\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read\",\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/move/action\",\n      \"Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write\"\n  ],\n  \"AssignableScopes\": [\n    \"/subscriptions/SUBSCRIPTION_ID/resourceGroups/RESOURCE_GROUP\"\n  ]\n}\n</code></pre> Then run the following command, to create the new role.</p> <pre><code>az role definition create --role-definition instance-role.json\n</code></pre> <p>Finally assign the role to the managed identity by running the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>az role assignment create --resource-group $RESOURCE_GROUP --role hopsworks-instance --assignee $identityId\n</code></pre> <p>Note</p> <p>It takes several minutes between the time you create the managed identity and the time a role can be assigned to it. So if we get an error message starting by the following wait and retry: Cannot find user or service principal in graph database</p>"},{"location":"setup_installation/azure/getting_started/#step-5-add-an-ssh-key-to-your-resource-group","title":"Step 5: Add an ssh key to your resource group","text":"<p>When deploying clusters, managed.hopsworks.ai installs an ssh key on the cluster's instances so that you can access them if necessary. For this purpose, you need to add an ssh key to your resource group.</p> <p>To create an ssh key in your resource group run the following command, replacing $RESOURCE_GROUP with the name of your resource group.</p> <pre><code>az sshkey create --resource-group $RESOURCE_GROUP --name hopsworksKey \n</code></pre> <p>Note</p> <p>the command returns the path to the private and public keys associated with this ssh key. You can also create a key from an existing public key as indicated in the Azure documentation</p>"},{"location":"setup_installation/azure/getting_started/#step-6-deploy-a-hopsworks-cluster","title":"Step 6: Deploy a Hopsworks cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p> <p>Select the Resource Group (1) in which you created your storage account and managed identity (see above).</p> <p>Note</p> <p>If the Resource Group does not appear in the drop-down, make sure that the custom role you created in step 1.1 has the Microsoft.Resources/subscriptions/resourceGroups/read permission and is assigned to the hopsworks.ai user.</p> <p>Name your cluster (2). Your cluster will be deployed in the Location of your Resource Group (3).</p> <p>Select the Instance type (4) and Local storage (5) size for the cluster Head node.</p> <p>Check if you want to Use customer-managed encryption key (6)</p> <p>Select the storage account (7) you created above in Azure Storage account name. The name of the container in which the data will be stored is displayed in Azure Container name (8), you can modify it if needed.</p> <p>Note</p> <p>You can choose to use a container already existing in your storage account by using the name of this container, but you need to first make sure that this container is empty.</p> <p>Enter the Azure container registry name (9) of the ACR registry created in Step 3.1</p> <p>Press Next:</p> <p> General configuration </p> <p>Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p>Note</p> <p>It is possible to add or remove workers or to enable autoscaling once the cluster is running.</p> <p>Press Next:</p> <p> Create a Hopsworks cluster, static workers configuration </p> <p>Select the SSH key that you want to use to access cluster instances:</p> <p> Choose SSH key </p> <p>Select the User assigned managed identity that you created above:</p> <p> Choose the User assigned managed identity </p> <p>To backup the Azure blob storage data when taking a cluster backup we need to set a retention policy for the blob storage. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the retention period in days and click on Review and submit.</p> <p> Choose the backup retention policy </p> <p>Review all information and select Create:</p> <p> Review cluster information </p> <p>Note</p> <p>We skipped cluster creation steps that are not mandatory. You can find more details about these steps here</p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/azure/getting_started/#step-7-next-steps","title":"Step 7: Next steps","text":"<p>Check out our other guides for how to get started with Hopsworks and the Feature Store:</p> <ul> <li>Make Hopsworks services accessible from outside services</li> <li>Get started with the Hopsworks Feature Store</li> <li>Follow one of our tutorials</li> <li>Follow one of our Guide</li> <li>Code examples and notebooks: hops-examples</li> </ul>"},{"location":"setup_installation/azure/restrictive_permissions/","title":"Limiting Azure permissions","text":"<p>Managed.hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s Azure resource group. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#default-permissions","title":"Default permissions","text":"<p>This is the list of default permissions that are required by managed.hopsworks.ai. If you prefer to limit these permissions, then proceed to the next section.</p> <pre><code>{\n    \"Name\": \"hopsworks.ai\",\n    \"IsCustom\": true,\n    \"Description\": \"Allows hopsworks.ai to start and manage clusters\",\n    \"Actions\": [\n      \"Microsoft.Compute/virtualMachines/write\",\n      \"Microsoft.Compute/virtualMachines/start/action\",\n      \"Microsoft.Compute/virtualMachines/delete\",\n      \"Microsoft.Compute/virtualMachines/read\",\n      \"Microsoft.Compute/virtualMachines/deallocate/action\",\n      \"Microsoft.Compute/disks/write\",\n      \"Microsoft.Compute/disks/delete\",\n      \"Microsoft.Network/networkInterfaces/read\",\n      \"Microsoft.Network/networkInterfaces/join/action\",\n      \"Microsoft.Network/networkInterfaces/write\",\n      \"Microsoft.Network/networkInterfaces/delete\",\n      \"Microsoft.Network/networkSecurityGroups/read\",\n      \"Microsoft.Network/networkSecurityGroups/join/action\",\n      \"Microsoft.Network/networkSecurityGroups/write\",\n      \"Microsoft.Network/networkSecurityGroups/delete\",\n      \"Microsoft.Network/publicIPAddresses/join/action\",\n      \"Microsoft.Network/publicIPAddresses/read\",\n      \"Microsoft.Network/publicIPAddresses/write\",\n      \"Microsoft.Network/publicIPAddresses/delete\",\n      \"Microsoft.Network/virtualNetworks/write\",\n      \"Microsoft.Network/virtualNetworks/delete\",\n      \"Microsoft.Network/virtualNetworks/read\",\n      \"Microsoft.Network/virtualNetworks/subnets/read\",\n      \"Microsoft.Network/virtualNetworks/subnets/join/action\",\n      \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n      \"Microsoft.Compute/sshPublicKeys/read\",\n      \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\",\n      \"Microsoft.ManagedIdentity/userAssignedIdentities/read\",\n      \"Microsoft.Storage/storageAccounts/read\",\n      \"Microsoft.Compute/snapshots/write\",\n      \"Microsoft.Compute/snapshots/read\",\n      \"Microsoft.Compute/snapshots/delete\",\n      \"Microsoft.Compute/disks/beginGetAccess/action\",\n      \"Microsoft.Compute/disks/read\",\n      \"Microsoft.Authorization/roleAssignments/read\"\n    ],\n    \"NotActions\": [],\n    \"AssignableScopes\": [\"/subscriptions/SUBSCRIPTION_ID/resourceGroups/RESOURCE_GROUP\"]\n  }\n</code></pre>"},{"location":"setup_installation/azure/restrictive_permissions/#limiting-the-cross-account-role-permissions","title":"Limiting the cross-account role permissions","text":""},{"location":"setup_installation/azure/restrictive_permissions/#step-1-create-a-virtual-network-and-subnet","title":"Step 1: Create a virtual network and subnet","text":"<p>To restrict managed.hopsworks.ai from having write and delete access on virtual networks and subnet you need to create them manually. This can be achieved in the Azure portal following this guide: Create a virtual network. Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster. For the remaining of the configuration, the default options proposed by the portal should work out of the box. Note the names of the virtual network and subnet you want to use for the following steps.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#step-2-create-a-network-security-group","title":"Step 2: Create a network security group","text":"<p>To restrict managed.hopsworks.ai from having write and delete access on network security groups you need to create it manually. This can be achieved in the Azure portal following this guide: Create a network security group. Make sure to use the resource group and location in which you intend to deploy your Hopsworks cluster.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#inbound-traffic","title":"Inbound traffic","text":"<p>For managed.hopsworks.ai to create the SSL certificates the network security group needs to allow inbound traffic on port 80. For this, you need to add an inbound security rule to your network security group. This can be achieved in the Azure portal following this guide: Create a security rule. Setting the destination port ranges to 80 and letting the default values for the other fields should work out of the box.</p> <p>Note</p> <p>If you intend to use the managed users option on your Hopsworks cluster you should also add a rule to open port 443.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#outbound-traffic","title":"Outbound traffic","text":"<p>Clusters created on managed.hopsworks.ai need to be able to send http requests to api.hopsworks.ai. The api.hopsworks.ai domain use a content delivery network for better performance. This result in the impossibility to predict which IP the request will be sent to. If you require a list of static IPs to allow outbound traffic from your security group, use the static IPs option during cluster creation.</p> <p>Note</p> <p>If you intend to use the managed users option on your Hopsworks cluster you should also allow outbound traffic to cognito-idp.us-east-2.amazonaws.com and managedhopsworks-prod.auth.us-east-2.amazoncognito.com.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#step-3-set-permissions-of-the-cross-account-role","title":"Step 3: Set permissions of the cross-account role","text":"<p>During the account setup for managed.hopsworks.ai, you were asked to create create a custom role for your resource group. Edit this role in the Azure portal by going to your resource group, clicking on Access control (IAM), opening the tab Roles, searching for the role you created, clicking on the three dots at the end of the role line and clicking on edit. You can then navigate to the JSON tab and overwrite the \"action\" field with the following:</p> <pre><code>\"actions\": [\n    \"Microsoft.Compute/virtualMachines/write\",\n      \"Microsoft.Compute/virtualMachines/start/action\",\n      \"Microsoft.Compute/virtualMachines/delete\",\n      \"Microsoft.Compute/virtualMachines/read\",\n    \"Microsoft.Compute/virtualMachines/deallocate/action\",\n    \"Microsoft.Compute/disks/write\",\n    \"Microsoft.Compute/disks/delete\",\n    \"Microsoft.Network/networkInterfaces/read\",\n    \"Microsoft.Network/networkInterfaces/join/action\",\n    \"Microsoft.Network/networkInterfaces/write\",\n    \"Microsoft.Network/networkInterfaces/delete\",\n    \"Microsoft.Network/networkSecurityGroups/read\",\n    \"Microsoft.Network/networkSecurityGroups/join/action\",\n    \"Microsoft.Network/publicIPAddresses/join/action\",\n    \"Microsoft.Network/publicIPAddresses/read\",\n    \"Microsoft.Network/publicIPAddresses/write\",\n    \"Microsoft.Network/publicIPAddresses/delete\",\n    \"Microsoft.Network/virtualNetworks/read\",\n    \"Microsoft.Network/virtualNetworks/subnets/read\",\n    \"Microsoft.Network/virtualNetworks/subnets/join/action\",\n    \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n    \"Microsoft.Compute/sshPublicKeys/read\",\n    \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\",\n    \"Microsoft.ManagedIdentity/userAssignedIdentities/read\",\n    \"Microsoft.Storage/storageAccounts/read\",\n    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n    \"Microsoft.Compute/disks/read\"\n\n  ]\n</code></pre>"},{"location":"setup_installation/azure/restrictive_permissions/#step-4-create-your-hopsworks-instance","title":"Step 4: Create your Hopsworks instance","text":"<p>You can now create a new Hopsworks instance in managed.hopsworks.ai by selecting the virtual network, subnet, and network security group during the instance configuration.</p>"},{"location":"setup_installation/azure/restrictive_permissions/#backup-permissions","title":"Backup permissions","text":"<p>The following permissions are only needed for the backup feature: </p> <pre><code>\"actions\": [\n    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n  ]\n</code></pre> <p>If you are not going to create backups or if you do not have access to this Enterprise feature, you can further limit the permission of the cross-account role to the following:</p> <pre><code>\"actions\": [\n    \"Microsoft.Compute/virtualMachines/write\",\n      \"Microsoft.Compute/virtualMachines/start/action\",\n      \"Microsoft.Compute/virtualMachines/delete\",\n      \"Microsoft.Compute/virtualMachines/read\",\n    \"Microsoft.Compute/virtualMachines/deallocate/action\",\n    \"Microsoft.Compute/disks/write\",\n    \"Microsoft.Compute/disks/delete\",\n    \"Microsoft.Network/networkInterfaces/read\",\n    \"Microsoft.Network/networkInterfaces/join/action\",\n    \"Microsoft.Network/networkInterfaces/write\",\n    \"Microsoft.Network/networkInterfaces/delete\",\n    \"Microsoft.Network/networkSecurityGroups/read\",\n    \"Microsoft.Network/networkSecurityGroups/join/action\",\n    \"Microsoft.Network/publicIPAddresses/join/action\",\n    \"Microsoft.Network/publicIPAddresses/read\",\n    \"Microsoft.Network/publicIPAddresses/write\",\n    \"Microsoft.Network/publicIPAddresses/delete\",\n    \"Microsoft.Network/virtualNetworks/read\",\n    \"Microsoft.Network/virtualNetworks/subnets/read\",\n    \"Microsoft.Network/virtualNetworks/subnets/join/action\",\n    \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n    \"Microsoft.Compute/sshPublicKeys/read\",\n    \"Microsoft.ManagedIdentity/userAssignedIdentities/assign/action\",\n    \"Microsoft.ManagedIdentity/userAssignedIdentities/read\",\n    \"Microsoft.Storage/storageAccounts/read\",\n  ]\n</code></pre>"},{"location":"setup_installation/azure/restrictive_permissions/#public-ip-addresses-permissions","title":"Public IP Addresses permissions","text":"<p>The following permissions are used to create and attach a public IP Address to the head node. If you do not want to use a public IP Address for the head node, you can remove them:</p> <p><pre><code>\"actions\": [\n    \"Microsoft.Network/publicIPAddresses/join/action\",\n    \"Microsoft.Network/publicIPAddresses/read\",\n    \"Microsoft.Network/publicIPAddresses/write\",\n    \"Microsoft.Network/publicIPAddresses/delete\",\n  ]\n</code></pre> You then have to make sure that you uncheck the Attach Public IP check box in the Security Group section of the cluster creation:</p> <p> Attach Public IP </p>"},{"location":"setup_installation/azure/restrictive_permissions/#other-removable-permissions","title":"Other removable permissions","text":"<p>The following permission is only needed to select the Azure Storage account through a drop-down during cluster creation. You can remove it from the cross-account role and enter the value manually</p> <pre><code>\"actions\": [\n    \"Microsoft.Storage/storageAccounts/read\",\n  ]\n</code></pre> <p>The following permission is only needed, during cluster creation, to check that the managed identity has the proper permission. If you remove it, this check will not be done and the deployment may fail later if the managed identity does not have the proper permissions</p> <pre><code>\"actions\": [\n    \"Microsoft.Authorization/roleAssignments/read\"\n]\n</code></pre>"},{"location":"setup_installation/azure/restrictive_permissions/#limiting-the-user-assigned-managed-identity-permissions","title":"Limiting the User Assigned Managed Identity permissions","text":""},{"location":"setup_installation/azure/restrictive_permissions/#backups","title":"Backups","text":"<p>If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your managed identity storage permissions. For this remove the following actions from your user assigned managed identity:</p> <pre><code>  \"actions\": [\n    \"Microsoft.Storage/storageAccounts/blobServices/write\",\n    \"Microsoft.Storage/storageAccounts/listKeys/action\"\n  ]\n</code></pre>"},{"location":"setup_installation/azure/upgrade/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 2.2 or older (Azure)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/azure/upgrade/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear:</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/azure/upgrade/#step-2-add-upgrade-permissions-to-your-user-assigned-managed-identity","title":"Step 2: Add upgrade permissions to your user assigned managed identity","text":"<p>Note</p> <p>You can skip this step if you already have the following permissions in your user assigned managed identity: <pre><code>[\n  \"Microsoft.Compute/virtualMachines/read\", \n  \"Microsoft.Compute/virtualMachines/write\", \n  \"Microsoft.Compute/disks/read\", \n  \"Microsoft.Compute/disks/write\",\n  \"Microsoft.Storage/storageAccounts/listKeys/action\"\n]\n</code></pre> Make sure that the scope of these permissions is your resource group.</p> <p>We require extra permissions to be added to the user assigned managed identity attached to your cluster to proceed with the upgrade. First to get the name of your user assigned managed identity and the resource group of your cluster, click on the Details tab as shown below:</p> <p> Get the resource group name (1) and the user assigned managed identity (2) of your cluster </p>"},{"location":"setup_installation/azure/upgrade/#step-21-add-custom-role-for-upgrade-permissions","title":"Step 2.1: Add custom role for upgrade permissions","text":"<p>Once you get the names of the resource group and user-assigned managed identity, navigate to Azure portal, then click on Resource groups and then search for your resource group and click on it. Go to the Access control (IAM) tab, select Add, and click on Add custom role </p> <p> Add a custom role for upgrade </p> <p>Name the custom role and then click on next till you reach the JSON tab.</p> <p> Name the custom role for upgrade </p> <p>Once you reach the JSON tab, click on Edit to edit the role permissions:</p> <p> Edit the JSON permissions for the custom role for upgrade </p> <p>Once you have clicked on Edit, replace the permissions array with the following snippet:</p> <pre><code>\"permissions\": [\n    {\n        \"actions\": [\n            \"Microsoft.Compute/virtualMachines/read\",\n            \"Microsoft.Compute/virtualMachines/write\",\n            \"Microsoft.Compute/disks/read\",\n            \"Microsoft.Compute/disks/write\",\n            \"Microsoft.Storage/storageAccounts/listKeys/action\"\n        ],\n        \"notActions\": [],\n        \"dataActions\": [],\n        \"notDataActions\": []\n    }\n]\n</code></pre> <p>Then, click on Save to save the updated permissions</p> <p> Save permissions for the custom role for upgrade </p> <p>Click on Review and create and then click on Create to create the custom role:</p> <p> Save permissions for the custom role for upgrade </p>"},{"location":"setup_installation/azure/upgrade/#step-22-assign-the-custom-role-to-your-user-assigned-managed-identity","title":"Step 2.2: Assign the custom role to your user-assigned managed identity","text":"<p>Navigate back to the your Resource group home page at Azure portal, click on Add and then click on Add role assignment</p> <p> Assign upgrade role to your user assigned managed identity </p> <p>(1) choose the upgrade role that you have just created in Step 2.1, (2) choose User Assigned Managed Identity, (3) search for the user assigned managed identity attached to your cluster and select it. Finally, (4) click on Save to save the role assignment.</p> <p> Assign upgrade role to your user assigned managed identity </p> <p>Warning</p> <p>When you assign roles or remove role assignments, it can take up to 30 minutes for changes to take effect.</p>"},{"location":"setup_installation/azure/upgrade/#step-3-add-disk-read-permissions-to-your-role-connected-to-managedhopsworksai","title":"Step 3: Add disk read permissions to your role connected to managed.hopsworks.ai","text":"<p>We require extra permission (\"Microsoft.Compute/disks/read\") to be added to the role you used to connect to managed.hopsworks.ai, the one that you have created when connecting your azure account.  If you don't remember the name of the role that you have created when connecting your azure account, you can navigate to your Resource group, (1) click on Access Control, (2) navigate to the Check Access tab, (3) search for hopsworks.ai, (4) click on it, (5) now you have the name of your custom role used to connect to managed.hopsworks.ai. </p> <p> Get your role connected to hopswork.ai </p> <p>To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ..., (4) click on Edit.</p> <p> Edit your role connected to hopswork.ai </p> <p>You will arrive at the Update a custom role page as shown below:</p> <p> Edit your role connected to hopswork.ai </p> <p>Navigate to the JSON tab, then click on Edit, as shown below:</p> <p> Edit your role connected to hopswork.ai </p> <p>Now, add the missing permission \"Microsoft.Compute/disks/read\" to the list of actions, then click on Save, click on Review + update, and finally click on Update.</p> <p> Add missing permissions to your role connected to hopswork.ai </p>"},{"location":"setup_installation/azure/upgrade/#step-4-run-the-upgrade-process","title":"Step 4: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the following message since this is done already in Step 2</p> <p>Make sure that your user assigned managed identity (hopsworks-doc-identity) includes the following permissions: [ \"Microsoft.Compute/virtualMachines/read\", \"Microsoft.Compute/virtualMachines/write\", \"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\", \"Microsoft.Storage/storageAccounts/listKeys/action\" ]</p> <p> Upgrade confirmation </p> <p>Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the Details tab of your cluster as below:</p> <p> Upgrade is complete </p>"},{"location":"setup_installation/azure/upgrade/#error-handling","title":"Error handling","text":"<p>There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to managed.hopsworks.ai, see Error 1. Second, an error during the upgrade process running on your cluster, see Error 2.</p>"},{"location":"setup_installation/azure/upgrade/#error-1-missing-permissions-error","title":"Error 1: Missing permissions error","text":"<p>If you encounter the following permission error right after starting an upgrade, then you need to make sure that the role you used to connect to managed.hopsworks.ai, the one that you have created when connecting your azure account, have permissions to read and write disks (\"Microsoft.Compute/disks/read\", \"Microsoft.Compute/disks/write\"). </p> <p> Missing permission error </p> <p>If you don't remember the name of the role that you have created when connecting your azure account, you can navigate to your Resource group, (1) click on Access Control, (2) navigate to the Check Access tab, (3) search for hopsworks.ai, (4) click on it, (5) now you have the name of your custom role used to connect to managed.hopsworks.ai. </p> <p> Get your role connected to hopswork.ai </p> <p>To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ..., (4) click on Edit.</p> <p> Edit your role connected to hopswork.ai </p> <p>You will arrive at the Update a custom role page as shown below:</p> <p> Edit your role connected to hopswork.ai </p> <p>Navigate to the JSON tab, then click on Edit, as shown below:</p> <p> Edit your role connected to hopswork.ai </p> <p>In our example, we were missing only the read permission (\"Microsoft.Compute/disks/read\"). First, add the missing permission, then click on Save, click on Review + update, and finally click on Update.</p> <p> Add missing permissions to your role connected to hopswork.ai </p> <p>Once you have updated your role, click on Retry to retry the upgrade process.</p> <p> Retry the upgrade process </p>"},{"location":"setup_installation/azure/upgrade/#error-2-upgrade-process-error","title":"Error 2: Upgrade process error","text":"<p>If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: </p> <p> Error occurred during upgrade </p> <p>Click on Rollback to recover your old cluster before upgrade.</p> <p> Upgrade rollback confirmation </p> <p>Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below:</p> <p> Upgrade rollback confirmation </p> <p>Once the rollback is completed, you will be able to continue working as normal with your old cluster.</p> <p>Note</p> <p>The old cluster will be stopped after the rollback. You have to click on the Start button.</p>"},{"location":"setup_installation/azure/upgrade_2.4/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 2.4 or newer (Azure)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/azure/upgrade_2.4/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear:</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/azure/upgrade_2.4/#step-2-add-backup-permissions-to-your-role-connected-to-managedhopsworksai","title":"Step 2: Add backup permissions to your role connected to managed.hopsworks.ai","text":"<p>We require extra permission to be added to the role you used to connect to managed.hopsworks.ai, the one that you have created when connecting your Azure account.  These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. </p> <pre><code>\"actions\": [\n    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n  ]\n</code></pre> <p>If you don't remember the name of the role that you have created when connecting your Azure account, you can navigate to your Resource group, (1) click on Access Control, (2) navigate to the Check Access tab, (3) search for hopsworks.ai, (4) click on it, (5) now you have the name of your custom role used to connect to managed.hopsworks.ai. </p> <p> Get your role connected to managed.hopsworks.ai </p> <p>To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ..., (4) click on Edit.</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>You will arrive at the Update a custom role page as shown below:</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>Navigate to the JSON tab, then click on Edit, as shown below:</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>Now, add the following permissions to the list of actions, then click on Save, click on Review + update, and finally click on Update.</p> <pre><code>    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n</code></pre> <p> Add missing permissions to your role connected to managed.hopsworks.ai </p>"},{"location":"setup_installation/azure/upgrade_2.4/#step-3-run-the-upgrade-process","title":"Step 3: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the following message since this is done already in Step 2</p> <p>Make sure that your custom role which you have connected to managed.hopsworks.ai has the following permissions: [ \"Microsoft.Compute/snapshots/write\", \"Microsoft.Compute/snapshots/read\", \"Microsoft.Compute/snapshots/delete\", \"Microsoft.Compute/disks/beginGetAccess/action\", ]</p> <p> Upgrade confirmation </p> <p>Check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster.</p>"},{"location":"setup_installation/azure/upgrade_2.4/#error-handling","title":"Error handling","text":"<p>There are two categories of errors that you may encounter during an upgrade. First, a permission error due to a missing permission in your role connected to managed.hopsworks.ai, see Error 1. Second, an error during the upgrade process running on your cluster, see Error 2.</p>"},{"location":"setup_installation/azure/upgrade_2.4/#error-1-missing-permissions-error","title":"Error 1: Missing permissions error","text":"<p>If one or more backup permissions are missing, or if the resource is not set correctly, you will be notified with an error message as shown below:</p> <p> Missing permission error </p> <p>Update your cross custom role as described in Step 2, then click Start. Once the cluster is up and running, you can try running the upgrade again.</p>"},{"location":"setup_installation/azure/upgrade_2.4/#error-2-upgrade-process-error","title":"Error 2: Upgrade process error","text":"<p>If an error occurs during the upgrade process, you will have the option to rollback to your old cluster as shown below: </p> <p> Error occurred during upgrade </p> <p>Click on Rollback to recover your old cluster before upgrade.</p> <p> Upgrade rollback confirmation </p> <p>Check the Yes, rollback cluster checkbox to proceed, then the Rollback button will be activated as shown below:</p> <p> Upgrade rollback confirmation </p> <p>Once the rollback is completed, you will be able to continue working as normal with your old cluster.</p> <p>Note</p> <p>The old cluster will be stopped after the rollback. You have to click on the Start button.</p>"},{"location":"setup_installation/azure/upgrade_3.0/","title":"Upgrade existing clusters on managed.hopsworks.ai from version 3.0 or newer (Azure)","text":"<p>This guide shows you how to upgrade your existing Hopsworks cluster to a newer version of Hopsworks.</p>"},{"location":"setup_installation/azure/upgrade_3.0/#step-1-make-sure-your-cluster-is-running","title":"Step 1: Make sure your cluster is running","text":"<p>It is important that your cluster is Running. Otherwise you will not be able to upgrade. As soon as a new version is available an upgrade notification will appear:</p> <p> A new Hopsworks version is available </p>"},{"location":"setup_installation/azure/upgrade_3.0/#step-2-add-backup-permissions-to-your-role-connected-to-managedhopsworksai","title":"Step 2: Add backup permissions to your role connected to managed.hopsworks.ai","text":"<p>We require extra permission to be added to the role you used to connect to managed.hopsworks.ai, the one that you have created when connecting your Azure account.  These permissions are required to create a snapshot of your cluster before proceeding with the upgrade. </p> <pre><code>\"actions\": [\n    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n  ]\n</code></pre> <p>If you don't remember the name of the role that you have created when connecting your Azure account, you can navigate to your Resource group, (1) click on Access Control, (2) navigate to the Check Access tab, (3) search for hopsworks.ai, (4) click on it, (5) now you have the name of your custom role used to connect to managed.hopsworks.ai. </p> <p> Get your role connected to managed.hopsworks.ai </p> <p>To edit the permissions associated with your role, stay on the same Access Control page, (1) click on the Roles tab, (2) search for your role name (the one you obtained above), (3) click on ..., (4) click on Edit.</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>You will arrive at the Update a custom role page as shown below:</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>Navigate to the JSON tab, then click on Edit, as shown below:</p> <p> Edit your role connected to managed.hopsworks.ai </p> <p>Now, add the following permissions to the list of actions, then click on Save, click on Review + update, and finally click on Update.</p> <pre><code>    \"Microsoft.Compute/snapshots/write\",\n    \"Microsoft.Compute/snapshots/read\",\n    \"Microsoft.Compute/snapshots/delete\",\n    \"Microsoft.Compute/disks/beginGetAccess/action\",\n</code></pre> <p> Add missing permissions to your role connected to managed.hopsworks.ai </p>"},{"location":"setup_installation/azure/upgrade_3.0/#step-3-create-an-acr-container-registry","title":"Step 3: Create an ACR Container Registry","text":"<p>We have enforced using managed docker registry (ACR) starting from Hopsworks version 3.1.0, so you need to create an ACR container registry and configure your managed identity to allow access to the container registry. First, get the name of the managed identity used in your cluster by clicking on the Details tab and check the name shown infront of Managed Identity. Then, follow this guide to create and configure an ACR container registry.</p>"},{"location":"setup_installation/azure/upgrade_3.0/#step-4-run-the-upgrade-process","title":"Step 4: Run the upgrade process","text":"<p>You need to click on Upgrade to start the upgrade process. You will be prompted with the screen shown below to confirm your intention to upgrade: </p> <p>Note</p> <p>No need to worry about the steps shown below if you have already completed Step 2 and Step 3</p> <p> Upgrade confirmation </p> <p>Enter the name of your ACR container registry that you have created in Step 3 and check the Yes, upgrade cluster checkbox to proceed, then the Upgrade button will be activated as shown below:</p> <p>Warning</p> <p>Currently, we only support upgrade for the head node and you will need to recreate your workers once the upgrade is successfully completed. </p> <p> Upgrade confirmation </p> <p>Depending on how big your current cluster is, the upgrade process may take from 1 hour to a few hours until completion.</p> <p>Note</p> <p>We don't delete your old cluster until the upgrade process is successfully completed. </p> <p> Upgrade is running </p> <p>Once the upgrade is completed, you can confirm that you have the new Hopsworks version by checking the version number on the Details tab of your cluster.</p> <p>For more details about error handling check this guide</p>"},{"location":"setup_installation/common/adding_removing_workers/","title":"Adding and removing workers","text":"<p>Once you have started a Hopsworks cluster you can add and remove workers from the cluster to accommodate your workload.</p>"},{"location":"setup_installation/common/adding_removing_workers/#adding-workers","title":"Adding workers","text":"<p>If the computation you are running is using all the resources of your Hopsworks cluster you can add workers to your cluster. To add workers to a cluster, go to the Details tab of this cluster and click on Add workers.</p> <p> Add worker </p> <p>Select the number of workers you want to add (1). Select the type of instance you want the workers to run on (2). Select the local storage size for the workers (3). Click on Next.</p> <p> Add workers </p> <p>Review your request and click Add.</p> <p> Add workers </p> <p>Managed.hopsworks.ai will start the new workers and you will be able to use them in your cluster as soon as they have finished starting.</p>"},{"location":"setup_installation/common/adding_removing_workers/#removing-workers","title":"Removing workers","text":"<p>If the load on your Hopsworks cluster is low, you can decide to remove worker nodes from your cluster.</p> <p>Warning</p> <p>When removing workers managed.hopsworks.ai will try to select workers that can be removed while interfering as little as possible with any ongoing computation. It will also wait for the workers to be done with their computation before stopping them. But, if this computation lasts too long, the worker may get stopped before the computation properly finish. This could interfere with your ongoing computation.</p> <p>Note</p> <p>You can remove all the workers of your cluster. If you do so the cluster will be able to store data but not run any computations. This may affect feature store functionality.</p> <p>To remove workers from a cluster, go to the Details tab of this cluster and click on Remove workers</p> <p> Remove workers </p> <p>For each of the types of instances existing in your cluster select the number of workers you want to remove and click on Next.</p> <p> Remove workers </p> <p>Review your request and click Remove.</p> <p> Remove workers </p> <p>Managed.hopsworks.ai will select the workers corresponding to your criteria which can be stopped with as little interferences as possible with any ongoing computation. It will set them to decommission and stop them when they have finished decommissioning.</p>"},{"location":"setup_installation/common/api_key/","title":"Managed.hopsworks.ai API Key","text":"<p>Managed.hopsworks.ai allows users to generate an API Key that can be used to authenticate and access the managed.hopsworks.ai REST APIs.</p>"},{"location":"setup_installation/common/api_key/#generate-an-api-key","title":"Generate an API Key","text":"<p>First, login to your managed.hopsworks.ai account, then click on the Settings tab as shown below:</p> <p> Click on the Settings tab </p> <p>Click on the API Key tab, and then click on the Generate API Key button:</p> <p> Generate an API Key </p> <p>Copy the generated API Key and store it in a secure location.</p> <p>Warning</p> <p>Make sure to copy your API Key now. You won\u2019t be able to see it again. However, you can always delete it and generate a new one.</p> <p> Copy the generated API Key </p>"},{"location":"setup_installation/common/api_key/#use-the-api-key","title":"Use the API Key","text":"<p>To access the managed.hopsworks.ai REST APIs, you should pass the API key as a header x-api-key when executing requests on managed.hopsworks.ai as shown below:</p> <pre><code>curl -XGET -H \"x-api-key: &lt;YOUR API KEY&gt;\" https://api.hopsworks.ai/api/clusters\n</code></pre> <p>Alternatively, you can use your API Key with the Hopsworks.ai terraform provider to manage your Hopsworks clusters using terraform.</p>"},{"location":"setup_installation/common/api_key/#delete-your-api-key","title":"Delete your API Key","text":"<p>First, login to your managed.hopsworks.ai account, click on the Settings tab, then click on the API Key tab, and finally click on Delete API Key as shown below:</p> <p> Delete your API Key </p>"},{"location":"setup_installation/common/arrow_flight_duckdb/","title":"ArrowFlight Server with DuckDB","text":"<p>By default, Hopsworks uses big data technologies (Spark or Hive) to create training data and read data for Python clients. This is great for large datasets, but for small or moderately sized datasets (think of the size of data that would fit in a Pandas DataFrame in your local Python environment), the overhead of starting a Spark or Hive job and doing distributed data processing can be significant.</p> <p>ArrowFlight Server with DuckDB significantly reduces the time that Python clients need to read feature groups  and batch inference data from the Feature Store, as well as creating moderately-sized in-memory training datasets.</p> <p>When the service is enabled, clients will automatically use it for the following operations:</p> <ul> <li>reading Feature Groups</li> <li>reading Queries</li> <li>reading Training Datasets</li> <li>creating In-Memory Training Datasets</li> <li>reading Batch Inference Data</li> </ul> <p>For larger datasets, clients can still make use of the Spark/Hive backend by explicitly setting <code>read_options={\"use_hive\": True}</code>.</p>"},{"location":"setup_installation/common/arrow_flight_duckdb/#service-configuration","title":"Service configuration","text":"<p>Note</p> <p>Supported only on AWS at the moment.</p> <p>Note</p> <p>Make sure that your cross account role has the load balancer permissions as described in here, otherwise you have to create and manage the load balancer yourself.</p> <p>The ArrowFlight Server is co-located with RonDB in the Hopsworks cluster. If the ArrowFlight Server is activated, RonDB and ArrowFlight Server can each use up to 50%  of the available resources on the node, so they can co-exist without impacting each other. Just like RonDB, the ArrowFlight Server can be replicated across multiple nodes to serve more clients at lower latency. To guarantee high performance, each individual ArrowFlight Server instance processes client requests sequentially. Requests will be queued for up to 10 minutes before they are rejected.</p> <p> Activate ArrowFlight Server with DuckDB on a RonDB cluster </p> <p>To deploy ArrowFlight Server on a cluster:</p> <ol> <li>Select \"RonDB cluster\"</li> <li>Select an instance type with at least 16GB of memory and 4 cores. (*)</li> <li>Tick the checkbox <code>Enable ArrowFlight Server</code>.</li> </ol> <p>(*) The service should have at least the 2x the amount of memory available that a typical Python client would have.    Because RonDB and ArrowFlight Server share the same node we recommend selecting an instance type with at least 4x the    client memory. For example, if the service serves Python clients with typically 4GB of memory,    an instance with at least 16GB of memory should be selected.    An instance with 16GB of memory will be able to read feature groups and training datasets of up to 10-100M rows,    depending on the number of columns and size of the features (~2GB in parquet). The same instance will be able to create    point-in-time correct training datasets with 1-10M rows, also depending on the number and the size of the features.    Larger instances are able to handle larger datasets. The numbers scale roughly linearly with the instance size.</p>"},{"location":"setup_installation/common/autoscaling/","title":"Autoscaling","text":"<p>If you run a Hopsworks cluster version 2.2 or above you can enable autoscaling to let managed.hopsworks.ai start and stop workers depending on the demand.</p>"},{"location":"setup_installation/common/autoscaling/#enabling-and-configuring-the-autoscaling","title":"Enabling and configuring the autoscaling","text":"<p>Once you have created a cluster you can enable autoscaling by going to the Details tab and clicking on Configure autoscale. You can also set up autoscaling during the cluster creation. For more details about this see the cluster creation documentation (AWS, AZURE).</p> <p> Configure autoscale </p> <p>Once you have clicked on Configure autoscale you will access a form allowing you to configure the autoscaling. You can configure the following:</p> <ol> <li>The instance type you want to use.</li> <li>The size of the instances' disk.</li> <li>The minimum number of workers. </li> <li>The maximum number of workers.</li> <li>The targeted number of standby workers. Setting some resources in standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the amount of workers you want to be in standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook request the resources.</li> <li>The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system.</li> </ol> <p>Note</p> <p>The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources.</p> <p> Configure autoscale details </p> <p>Once you have set your configuration you can review it and enable the autoscaling.</p> <p>Note</p> <p>There are two scenarios if you already have workers in your cluster when enabling the autoscaling:</p> <ol> <li>The preexisting workers have the same instance type as the one you set up in the autoscaling. In this case, the autoscaling system will manage these workers and start or stop them automatically.</li> <li>The preexisting workers have a different instance type from the one you set up in the autoscaling. In this case, the autoscaling will not manage these nodes but you will still be able to remove them manually.</li> </ol> <p> Configure autoscale review </p>"},{"location":"setup_installation/common/autoscaling/#modifying-the-autoscaling-configuration","title":"Modifying the autoscaling configuration","text":"<p>You can update the autoscale configuration by going to the Details tab of the cluster and clicking on Configure autoscale. You will then go through the same steps as above. Note that if you change the instance type, nodes that currently exist in the cluster with a different instance type will not be managed by the autoscale system anymore and you will have to remove them manually. </p>"},{"location":"setup_installation/common/autoscaling/#disabling-the-autoscaling","title":"Disabling the autoscaling","text":"<p>To disable the autoscaling go to the Details tab, click on Disable autoscale and confirm your action. When you disable autoscaling the nodes that are currently running will keep running. You will need to stop them manually.</p> <p> Disable autoscale </p>"},{"location":"setup_installation/common/backup/","title":"How to take, restore and manage backups in managed.hopsworks.ai","text":""},{"location":"setup_installation/common/backup/#introduction","title":"Introduction","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. When managing a cluster it is important to be able to take and restore backups to handle any failure eventuality. In this tutorial you will learn how to take, restore and manage backups in managed.hopsworks.ai</p>"},{"location":"setup_installation/common/backup/#prerequisites","title":"Prerequisites","text":"<p>To follow this tutorial you need to create a cluster in Managed.hopsworks.ai. During the cluster creation you need to set a positive number for the maximum retention period for your backups. This is done in the backups step of the cluster creation by setting the wanted retention period in Validity of cluster backup images. This step is needed because the backup process relies on the cloud bucket retention policy and needs to configure it before any backup is taken.</p> <p>Warning</p> <p>This value cannot be edited later on so make sure to set the proper one.</p> <p>Note</p> <p>To be able to take backup the cluster instances need special permissions. These permissions are cloud provider specific and indicated on the cluster creation page.</p> <p> Choose the backup retention policy </p>"},{"location":"setup_installation/common/backup/#taking-a-backup","title":"Taking a backup","text":"<p>To take a backup go to the backup tab of your cluster (1) and click on Create backup (2). If you wish to give a name to your backup edit the value in New backup name (3) before clicking on Create backup.</p> <p>Note</p> <p>The cluster needs to be running to take a backup.</p> <p> Create a backup </p> <p>Taking a backup takes time and necessitates restarting the cluster. To avoid any risk of accidental restart you will be asked to confirm that you want to take a backup. To confirm check the check box and click on the  Backup button.</p> <p>Warning</p> <p>This will interrupt any operation currently running on the cluster. Make sure to stop them properly before taking a backup.</p> <p> Confirm backup creation </p> <p>You can then wait until the backup is complete. The backup process being underway is indicated next to the cluster status.</p> <p> Backup ongoing </p> <p>Once the backup is taken your cluster will be back up and running and ready to use.</p>"},{"location":"setup_installation/common/backup/#restoring-a-backup","title":"Restoring a backup","text":"<p>Go to the Backup tab of the dashboard (left menu (1)) to the list of all the backups. This list is organized by cluster. For each of the clusters, you can see the state of the cluster (2) and the list of backups for this cluster (3). </p> <p>To be able to restore a backup the corresponding cluster needs to be terminated. If your cluster is not terminated go and terminate it. Once the cluster is terminated you restore a backup by clicking on the Restore button (4) of the backup you want to restore.</p> <p> List of backups </p> <p>Warning</p> <p>Restoring a backup put back the bucket in the state it was at the time of the backup. This makes it impossible to then restore a backup taken more recently. </p> <p>If you try to restore a backup that is not the latest backup you will be asked to confirm that you want to restore and thus delete any more recent backup.</p> <p><p> Delete succeeding backups </p></p> <p>Once you have clicked on Restore you will be brought to the cluster creation menu. All the entries should be prefilled with the values corresponding to your cluster configuration. You can go through all the cluster configurations to verify (recommended) or directly click on Review in the left menu and click on the Create button.</p> <p> Review and restore backup </p> <p>A new cluster will be created and set in the state your cluster was at the time of the backup.</p> <p>Note</p> <p>Restoring a backup does not recreate the workers for this cluster. You need to add the workers back once the cluster is created.</p>"},{"location":"setup_installation/common/backup/#managing-your-backups","title":"Managing your backups","text":"<p>To manage your backups either go to the Backup tab of your cluster (1) or go to the backup tab of the dashboard (2).</p> <p> Backup tabs </p> <p>If you go to the backup tab of your cluster you will see the list of backups associated with this cluster. For each of the backups, you will see their name (1), id (2), date of creation (3), and status (4). The status can be:</p> <ul> <li>Completed: the backup has been created and is ready to be restored.</li> <li>Expired: the backup is older than the maximum retention time set during cluster creation, it will not be possible to restore it.</li> <li>Failed: the backup failed during its creation.</li> <li>Running: the backup is currently being created.</li> <li>Deleting: the backup is being deleted.</li> </ul> <p> Backup info </p> <p>If you go to the dashboard backup tab you will get a view of all the backups of all the clusters. For each of the backups, you get the same information as above.</p> <p>To delete a backup click on the Delete button on the same line as the backup name.</p> <p> Delete backup </p> <p>Once you have clicked on the Delete button, you will be asked to confirm that you want to delete it. Check the check box and click Delete to confirm.</p> <p> Confirm backup deletion </p> <p>The backup will then be deleted.</p>"},{"location":"setup_installation/common/backup/#conclusion","title":"Conclusion","text":"<p>During this tutorial, you have created a backup, restored a cluster from this backup, checked the information about this backup, and finally deleted the backup.</p> <p>Now that you have restored a cluster you can add workers or set up autoscale on it.</p>"},{"location":"setup_installation/common/dashboard/","title":"How to manage your clusters in managed.hopsworks.ai","text":""},{"location":"setup_installation/common/dashboard/#introduction","title":"Introduction","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. On this page, you will get an overview of the different functionalities of the managed.hopsworks.ai dashboard.</p>"},{"location":"setup_installation/common/dashboard/#prerequisites","title":"Prerequisites","text":"<p>If you want to navigate the to the different tabs presented in this document you will need to connect managed.hopsworks.ai and create a cluster. Instructions about this process can be found in the getting started pages (AWS, Azure, GCP)</p>"},{"location":"setup_installation/common/dashboard/#dashboard-overview","title":"Dashboard overview","text":"<p>The landing page of managed.hopsworks.ai can be seen in the picture below. It is composed of three main parts. At the top, you have a menu bar (1) allowing you to navigate between the dashboard and the settings. Bellow, you have a menu column (2) allowing you to navigate between different functionalities of the dashboard. And finally, in the middle, you find pannels representing your different clusters (3) and a button to create new clusters (4).</p> <p> Dashboard overview </p> <p>The different functionalities of the dashboard are:</p> <ul> <li>Clusters: the landing page which we will detail below.</li> <li>Members: the place to manage the members of your organization (doc).</li> <li>Backup: the place to manage your clusters' backup (doc).</li> <li>Usage: the place to get your credits consumption.</li> </ul>"},{"location":"setup_installation/common/dashboard/#managing-your-clusters-in-the-cluster-panel","title":"Managing your clusters in the cluster panel","text":"<p>The cluster panels contain the name of the cluster (1), its state (2) a button to terminate the cluster (3), a button to stop the cluster (4) and different tabs to manage the cluster (5). You will now learn more details about these actions and tabs.</p> <p> Cluster pannel structure </p>"},{"location":"setup_installation/common/dashboard/#stop-the-cluster","title":"Stop the cluster","text":"<p>To stop a cluster click on the Stop button on the top right part of the cluster panel. Stopping the cluster stop in instances it is running on and delete the workers nodes. This allows you to save credits in managed.hopsworks.ai and in your cloud provider.</p> <p> Stop a cluster </p>"},{"location":"setup_installation/common/dashboard/#terminate-the-cluster","title":"Terminate the cluster","text":"<p>To terminate a cluster click on the Terminate button on the top right part of the cluster panel.</p> <p> Terminate a cluster </p> <p>Terminating the cluster will destroy it and delete all the resources that were automatically created during the cluster creation. To be sure that you are not terminating a cluster by accident you will be asked to confirm that you want to terminate the cluster. To confirm the termination, check the check box and click on Terminate.</p> <p>Note</p> <p>Terminating a cluster does not delete or empty the bucket associated with the cluster. This is because this bucket is needed to restore a backup. You can find more information about backups in the backup documentation.</p> <p> Confirm a cluster Termination </p>"},{"location":"setup_installation/common/dashboard/#the-general-tab","title":"The general tab","text":"<p>The General tab gives you the basic information about your cluster. If you have created a cluster with managed users it will only give you the URL of the cluster. If you have created a cluster without managed cluster it will also give you the user name and password that were set for the admin user at cluster creation.</p> <p> General tab </p>"},{"location":"setup_installation/common/dashboard/#manage-the-services-in-the-services-tab","title":"Manage the services in the services tab","text":"<p>The services tab shows which service ports are open to the internet on your cluster. More details can be found in the services documentation.</p> <p> Services tab </p>"},{"location":"setup_installation/common/dashboard/#get-information-about-your-cluster-state-in-the-console-tab","title":"Get information about your cluster state in the Console tab","text":"<p>The console tab display more detailed information about the current state of your cluster. If your cluster is running and everything is as planned it will only say \"everything is ok\". But, if something failed, this is where you will find more details about the error.</p> <p> Console tab </p>"},{"location":"setup_installation/common/dashboard/#manage-your-backups-in-the-backups-tab","title":"Manage your backups in the Backups tab","text":"<p>The backups tab is where you create and manage backups for your cluster. You can find more details about the backups, in the backups documentation.</p> <p> Backups tab </p>"},{"location":"setup_installation/common/dashboard/#get-more-details-and-manage-your-workers-in-the-details-tab","title":"Get more details and manage your workers in the Details tab","text":"<p>The Details tab provides you with details about your cluster setup. It is also where you can add and remove workers or configure the autoscaling.</p> <p> Details tab </p>"},{"location":"setup_installation/common/dashboard/#get-more-details-about-your-cluster-rondb-in-the-rondb-tab","title":"Get more details about your cluster RonDB in the RonDB tab","text":"<p>The RonDB tab provides you with details about the instances running RonDB in your cluster. This is also where you can scale up Rondb if needed.</p> <p> RonDB tab </p>"},{"location":"setup_installation/common/dashboard/#conclusion","title":"Conclusion","text":"<p>You now have an overview of where your different cluster information can be found and how you can manage your cluster. To go further you can learn how to add and remove workers or configure the autoscaling on your cluster or how to take and restore backups.</p>"},{"location":"setup_installation/common/rondb/","title":"Managed RonDB","text":"<p>For applications where Feature Store's performance and scalability is paramount we give users the option to create clusters with Managed RonDB. You don't need to worry about configuration as managed.hopsworks.ai will automatically pick the best options for your setup.</p> <p>To start a new Hopsworks Cluster with a Managed RonDB installation one first goes to the Dashboard view seen below.</p> <p> Dashboard </p> <p>After clicking on Create cluster we can select the Cloud to use, AWS, GCP or Azure.</p> <p> Choose cloud menu </p> <p>The configuration of your RonDB cluster is done in the RonDB database tab at the left in your Create cluster menu.</p>"},{"location":"setup_installation/common/rondb/#single-node-rondb","title":"Single node RonDB","text":"<p>The minimum setup for a Hopsworks cluster is to run all database services on their own virtual machine additionally to the Head node. This way the RonDB database service can scale independently of other cluster services. You can pick the VM type of this VM in the scroll bar RonDB database instance type.</p> <p>It is also possible to change the size of the local storage in the VM through the scroll bar Local storage size. Normally it isn't necessary to change this setting.</p> <p>It is possible to reconfigure from a Single Node RonDB to a RonDB cluster. It is not possible to reconfigure from a RonDB cluster to a Single Node RonDB.</p> <p>When reconfiguring from a Single Node RonDB to RonDB cluster the Single Node VM is converted into the Management Server VM. The management server VM only needs to use 2 VCPUs in a RonDB cluster.</p> <p>The Single Node RonDB is mainly intended for experiments and Proof of Concept installations. For production usage it is better to select a RonDB cluster and use a single replica if a really small cluster is desired. Scaling from a small RonDB cluster to a very large RonDB cluster can be done as online operations.</p> <p> Configure RonDB </p> <p>Note</p> <p>For cluster versions &lt;= 2.5.0 the database services run on Head node</p>"},{"location":"setup_installation/common/rondb/#rondb-cluster","title":"RonDB cluster","text":"<p>To setup a cluster with multiple RonDB nodes, select <code>RonDB cluster</code> during cluster creation. If this option is not available contact us.</p>"},{"location":"setup_installation/common/rondb/#general","title":"General","text":"<p>If you enable Managed RonDB you will see a basic configuration page where you can configure the database nodes.</p> <p> RonDB basic configuration </p>"},{"location":"setup_installation/common/rondb/#data-node","title":"Data node","text":"<p>First, you need to select the instance type and local storage size for the data nodes. These are the database nodes that will store data.</p> <p>RonDB in Hopsworks is an in-memory database, so in order to fit more data you need to choose an instance type with more memory. Local storage is used for offline storage of recovery data. RonDB does support on-disk columns that can be used for on-disk features, this will be accessible from Hopsworks in some future version.</p> <p>Since the data node is an in-memory database we only provide options with high memory compared to the CPUs. Most VMs have 8 GByte of memory per VCPU. The VM type is changed with the scroll bar RonDB Data node instance type. Local storage size should be sufficient to use the default.</p>"},{"location":"setup_installation/common/rondb/#number-of-replicas","title":"Number of replicas","text":"<p>Next you need to select the number of replicas. This is the number of copies the cluster will maintain of your data.</p> <ul> <li>Choosing 1 replica is the cheapest option since it requires the lowest number of nodes, but this way you don't have High Availability.   Whenever any of the RonDB data nodes in the cluster fails, the cluster will also fail, so only choose 1 replica if you are willing to accept cluster failure.</li> <li>The default and recommended is to use 2 replicas, which allows the cluster to continue operating after any one data node fails.</li> <li>With 3 replicas, the cluster can continue operating after any two data node failures that happen after each other.</li> </ul> <p>If you want to try out RonDB with a cheap setup it is possible to select 1 replica when you create the cluster and later reconfigure the cluster with 2 or 3 replicas. One can also decrease the number of replicas through online reconfiguration.</p>"},{"location":"setup_installation/common/rondb/#mysqld-nodes","title":"MySQLd nodes","text":"<p>Next you can configure the number of MySQLd nodes. These are dedicated nodes for performing SQL queries against your RonDB cluster.</p> <p>The Feature Store will use all the MySQL Servers with load balancing. The load balancing is implemented using Consul. This means that if a MySQL Server is stopped the application will discover a failure and will reconnect and choose one of the MySQL Servers that are still up. Similarly when a MySQL Server is started it will be used in the selection of which MySQL Server to use for a new connection setup.</p> <p>Selection of VM type for the MySQL Servers is done in the scroll bar MySQLd instance type. As usual the default for local storage size should be sufficient.</p> <p>Feature Stores is a read-heavy application. In such environment it is normal that optimal throughput is to have 50% to 100% more CPUs in the MySQL Servers compared to the Data nodes. MySQL Servers are most efficient up to 32 VCPUs. Scaling to more MySQL Servers is efficient, thus it is best to first use enough MySQL Servers for high availability, next to scale them to 32 VCPUs. If more CPUs are needed then scale with even more MySQL Servers.</p> <p>MySQL Servers are only clients to the data nodes in RonDB. Thus it will not use a lot of memory, we mainly provide options with high CPU compared to the memory.</p>"},{"location":"setup_installation/common/rondb/#advanced","title":"Advanced","text":"<p>The advanced tab offers less common options. One node group will serve most use cases, it is mainly useful to have several node groups if the database doesn't fit in a single data node VM. API nodes is currently mostly useful for benchmarking, but is intended also for custom applications with extreme requirements on low latency.</p> <p>We recommend keeping the defaults unless you know what you are doing.</p> <p> RonDB advanced configuration </p>"},{"location":"setup_installation/common/rondb/#rondb-data-node-groups","title":"RonDB Data node groups","text":"<p>You can choose the number of node groups, also known as database shards. The default is 1 node group, which means that all nodes will have a complete copy of all data. Increasing the number of node groups will split the data evenly. This way, you can create a cluster with higher capacity than a single node. For use cases where it is possible, we recommend using 1 node group and choose an instance type with enough memory to fit all data.</p> <p>Below the number of node groups, you will see a summary of cluster resources.</p> <ul> <li>The number of data nodes is an important consideration for the cost of the cluster.   It is calculated as the number of node groups multiplied by the number of replicas.</li> <li>The memory available to the cluster is calculated as the number of node groups multiplied by the memory per node.   Note that the number replicas does not affect the available memory.</li> <li>The CPUs available to the cluster is calculated as the number of node groups multiplied by the number of CPUs per node.   Note that the number replicas does not affect the available CPUs.</li> </ul>"},{"location":"setup_installation/common/rondb/#api-nodes","title":"API nodes","text":"<p>API nodes are specialized nodes which can run user code connecting directly to RonDB datanodes for increased performance.</p> <p>You can choose the number of nodes, the instance type and local storage size.</p> <p>There is also a checkbox to grant access to benchmark tools. This will let a benchmark user access specific database tables, so that you can benchmark RonDB safely.</p> <p>For more information on how to benchmark RonDB, see the RonDB documentation.</p>"},{"location":"setup_installation/common/rondb/#online-reconfiguration-of-rondb","title":"Online Reconfiguration of RonDB","text":"<p>After creating a RonDB cluster it is possible to resize the RonDB cluster through an online reconfiguration. This means that both reads and writes of tables and feature groups can continue while the change is ongoing without any downtime.</p> <p>During reconfiguration of data nodes there could be periods where no new tables can be added and tables cannot be dropped. Reads and writes to all existing tables will however always be possible.</p> <p>The online reconfiguration supports increasing and decreasing size of VMs, local storage of MySQL Servers. For data nodes we support changing to larger VMs and changing numbers of replicas to 1,2 and 3 and changing the local storage size to a larger size.</p>"},{"location":"setup_installation/common/rondb/#why-reconfiguring-storage-client-layer-mysql-servers","title":"Why Reconfiguring Storage Client Layer (MySQL Servers)","text":"<p>Reconfiguration of MySQL Servers can be done several times per day to meet current demands by the application. During a reconfiguration new MySQL Servers are added to the Consul address onlinefs.mysql.service.consul. Thus new connections will be quickly using the new MySQL Servers. MySQL Servers that are stopped will be removed from Consul a few seconds before the MySQL Server is stopped.</p> <p>Thus an application using the MySQL Server can avoid most, if not all temporary errors due to reconfiguration by reconnecting to the MySQL Server after using a connection for about 3 seconds. However even without this the impact on applications due to the reconfiguration will be very small.</p> <p>An example of an application could be an online retailer. During nights the activity is low, so the need of the MySQL Servers is low and one could use 2 x 4 VCPUs. In the morning business picks up and one can increase the use to 2 x 16 VCPUs. In the evening the business is heavier and one needs 2 x 32 VCPUs to meet the demand. Finally weekend rushes is handled with 3 x 32 VCPUs.</p>"},{"location":"setup_installation/common/rondb/#why-reconfiguring-storage-layer-rondb-data-nodes","title":"Why Reconfiguring Storage Layer (RonDB Data nodes)","text":"<p>Reconfiguration of the RonDB Data nodes is a bit more rare since the database resides in memory. At the moment we only support increasing the size of the RonDB data nodes to ensure that we always have room for the database. Storing the database in-memory provides much lower latency to online applications.</p> <p>Thus reconfiguring of the Storage Layer is mainly intended to meet long-term needs of the business in terms of CPU and memory. In addition one can change the number of replicas to improve the availability of the RonDB cluster.</p>"},{"location":"setup_installation/common/rondb/#reconfiguration-of-storage-client-layer","title":"Reconfiguration of Storage Client Layer","text":"<p>To start a reconfiguration of the MySQL Servers choose the RonDB tab in the Cluster you want to change. In the Configuration Tab you select the MySQLd instance type scroll bar and set the new VM type you want to use. In the figure above we selected e2-highcpu-16 (previously used e2-highcpu-8), thus doubling the VCPUs used by the Storage Client Layer.</p> <p> Reconfiguration of MySQL Server </p> <p>When you made this choice the Changes to be submitted is listed above the Submit button.</p> <p>If you decide to skip the current change you can push the Reset button to return to the original settings and start again the reconfiguration change.</p> <p>After clicking the Submit button, the below pop-up window appears. You need to check the Yes, reconfigure RonDB cluster button to proceeed.</p> <p> Accept Reconfiguration </p> <p>After clicking this button you now need to push Reconfigure button in the below pop-up window.</p> <p> Final Accept Reconfiguration </p> <p>After clicking the Reconfigure the reconfiguration and you will see the below.</p> <p> Reconfiguration Pending </p> <p>And shortly thereafter you will see the state change to only reconfiguring.</p> <p> Reconfiguration Ongoing </p> <p>The process to reconfigure a few MySQL Servers will take a few minutes where a major portion is spent on creating the new MySQL Server VMs.</p> <p>During this process we can follow the process by clicking at the Console where the state of the Reconfiguration will be presented in more details.</p>"},{"location":"setup_installation/common/rondb/#the-reconfiguration-process","title":"The Reconfiguration process","text":"<p>The first step in the reconfiguration process is to create the new VMs. During this step the we see the below message in the Console. The steps below isn't all the states shown and could change in future versions. So this part is mostly to give an idea of what is happening during the reconfiguration process.</p> <p> Reconfiguration Console Wait For VMs </p> <p>The next step is to initialise the VMs and the below message is shown while this step is ongoing.</p> <p> Reconfiguration Console Wait For Initialisation of VMs </p> <p>When all VMs have been created and initialised we see the below message in the Console.</p> <p> Reconfiguration Console All VMs created </p> <p>With all the new MySQL Server VMs created and initialised we are ready to start the first MySQL Server. During this we see the following message for a short time.</p> <p> Reconfiguration Console Start MySQL Server </p> <p>After starting the new MySQL Server we need to insert the MySQL Server into Consul and other post init activities. During this step we see the message below. Already here the new MySQL Server can start serving queries in the cluster.</p> <p> Reconfiguration Console Post Init MySQL Server </p> <p>At some point the old MySQL Servers need to be stopped and removed from the cluster. During this step we see this message. After this step the old MySQL Servers are no longer serving queries in the cluster.</p> <p>The order of starting MySQL Server and stopping them can change, but we always ensure that we never decrease the number of MySQL Servers until the final step if at all.</p> <p> Reconfiguration Console Deactivate MySQL Server </p> <p>After starting all the MySQL Servers we have some cleanup steps to go through such as deleting the old VMs. However during this step the cluster is already reconfigured. After all cleanup steps are completed the final message arrives. As you can see the state is changed to running. This means that a new reconfiguration can be started again as well. Only one reconfiguration at a time is allowed.</p> <p> Reconfiguration Console Final state </p>"},{"location":"setup_installation/common/rondb/#reconfiguration-of-the-storage-layer-rondb-data-nodes","title":"Reconfiguration of the Storage Layer (RonDB Data nodes)","text":"<p>When reconfiguring the Storage Layer we can change 3 things. We can change the VM type to choose a VM type with more memory and more CPUs. We can change the number of replicas and finally we can change the local storage size.</p> <p>We can change all three parameters at once. The below shows an example of how to do this.</p> <p> Reconfiguration Data nodes </p> <p>It is currently not possible to reconfigure API nodes. The VM type differs from cloud to cloud.</p> <p>The start of a reconfiguration uses the same pop-up windows as when reconfiguring the Storage Client Layer.</p> <p>The steps it goes through is slightly different but shares many similarities. However starting a RonDB data node will take longer time, the time it takes is dependent on the database size.</p>"},{"location":"setup_installation/common/rondb/#combined-reconfiguration-of-all-layers","title":"Combined reconfiguration of all Layers","text":"<p>It is possible to reconfigure both the Storage Layer and the Storage Client Layer simultaneously. The process is the same, but will obviously take a bit more time since more changes are required.</p>"},{"location":"setup_installation/common/rondb/#rondb-details","title":"RonDB details","text":"<p>Once the cluster is created you can view some details by clicking on the <code>RonDB</code> tab, followed by clicking on the <code>Nodes</code> tab as shown in the picture below.</p> <p> RonDB cluster details </p>"},{"location":"setup_installation/common/scalingup/","title":"Scaling up","text":"<p>If you run into limitations due to the instance types you chose during a cluster creation it is possible to scale up the instances to overcome these limitations.</p>"},{"location":"setup_installation/common/scalingup/#scaling-up-the-workers","title":"Scaling up the workers","text":"<p>If spark jobs are not starting in your cluster it may come from the fact that you don't have worker resources to run them. As workers are stateless the best way to solve this problem is to add new workers with enough resources to handle your job. Or to configure autoscalling to automatically add the workers when needed.</p>"},{"location":"setup_installation/common/scalingup/#scaling-up-the-head-node","title":"Scaling up the head node","text":"<p>You may run into the need to scale up the head node for different reasons. For example:</p> <ul> <li>You are running a cluster without dedicated RonDB nodes and have a workload with a high demand on the online feature store.</li> <li>You are running a cluster without managed containers and want to run an important number of jupyter notebooks simultaneously.</li> </ul> <p>While we are working on implementing a solution to add these features to an existing cluster you can use the following approach to run your head node on an instance with more vcores and memory to handle more load.</p> <p>To scale up the head node you first have to stop your cluster.</p> <p> Stop the cluster </p> <p>Once the cluster is stopped you can go to the Details tab and click on the head node instance type.</p> <p> Go to details tab an click on the head node instance type </p> <p>This will open a new window. Select the type of instance you want to change to and click on Review and submit</p> <p> Select the new instance type for the heade node </p> <p>Verify your choice and click on Modify</p> <p>Note</p> <p>If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your managed.hopsworks.ai role.</p> <p> Validate your choice </p> <p>You can now start your cluster. The head node will be started on an instance type of the new type you chose. </p>"},{"location":"setup_installation/common/scalingup/#scaling-up-the-rondb-nodes","title":"Scaling up the RonDB nodes","text":"<p>If you are running a cluster with dedicated RonDB nodes and have a workload with a high demand on the online feature store you may need to scale up the RonDB Datanodes and MySQLd nodes. For this stop the cluster.</p> <p> Stop the cluster </p> <p>Once the cluster is stopped you can go to the RonDB tab. To scale MySQLd or API nodes, click on the instance type for the node you want to scale up. To scale all datanodes, click on the Change button over their instance types. Datanodes cannot be scaled individually.</p> <p> Go to RonDB tab and click on the instance type you want to change or, for datanodes, click on the Change button </p> <p>This will open a new window. Select the type of instance you want to change to and click on Review and submit</p> <p> Select the new instance type for the heade node </p> <p>Verify your choice and click on Modify</p> <p>Note</p> <p>If you set up your account with AWS in a period predating the introduction of this feature you may need to add the indicated permission to your managed.hopsworks.ai role.</p> <p> Validate your choice </p> <p>You can now start your cluster. The nodes will be started on an instance type of the new type you chose.</p>"},{"location":"setup_installation/common/services/","title":"Services","text":"<p>Hopsworks clusters provide several services that can be accessed from outside Hopsworks. In this documentation, we first show how to make these services accessible to external networks. We will then go through the different services to give a short introduction and link to the associated documentation.</p>"},{"location":"setup_installation/common/services/#outside-access-to-the-feature-store","title":"Outside Access to the Feature Store","text":"<p>By default, only the Hopsworks UI is made available to clients on external networks, like the Internet. To integrate with external platforms and access APIs for services such as the Feature Store, you have to open the service's ports.</p> <p>Open ports by going to the Services tab, selecting a service, and pressing Update. This will update the Security Group attached to the Hopsworks cluster to allow incoming traffic on the relevant ports.</p> <p> Outside Access to the Feature Store </p> <p>If you do not want the ports to be open to the internet you can set up VPC peering between the Hopsworks VPC and your client VPC. You then need to make sure that the ports associated with the services you want to use are open between the two VPCs. The ports associated with each of the services are indicated in the descriptions of the services below.</p>"},{"location":"setup_installation/common/services/#feature-store","title":"Feature store","text":"<p>The Feature Store is a data management system for managing machine learning features, including the feature engineering code and the feature data. The Feature Store helps ensure that features used during training and serving are consistent and that features are documented and reused within enterprises. You can find more about the feature store here and information about how to connect to the Feature Store from different external services here</p> <p>Ports: 8020, 30010, 9083 and 9085</p>"},{"location":"setup_installation/common/services/#online-feature-store","title":"Online Feature store","text":"<p>The online Feature store is required for online applications, where the goal is to retrieve a single feature vector with low latency and the same logic as was applied to generate the training dataset, such that the vector can subsequently be passed to a machine learning model in production to compute a prediction. You can find a more detailed explanation of the difference between Online and Offline Feature Store here. Once you have opened the ports, the Online Feature store can be used with the same library as the offline feature store. You can find more in the user guildes.</p> <p>Port: 3306</p>"},{"location":"setup_installation/common/services/#kafka","title":"Kafka","text":"<p>Hopsworks provides Kafka-as-a-Service for streaming applications and to ingest data. You can find more information about how to use Kafka in Hopsworks in this documentation</p> <p>Port: 9092</p>"},{"location":"setup_installation/common/services/#ssh","title":"SSH","text":"<p>If you want to be able to SSH into the virtual machines running the Hopsworks cluster, you can open the ports using the Services tab. You can then SSH into the machine using your cluster operation system (ubuntu or centos) as the user name and the ssh key you selected during the cluster creation.</p> <p>Port: 22.</p>"},{"location":"setup_installation/common/services/#arrowflight-with-duckdb","title":"ArrowFlight with DuckDB","text":"<p>Hopsworks provides ArrowFlight Server(s) with DuckDB to significantly reduce the time that Python clients need to read feature groups and batch inference data from the Feature Store, as well as creating moderately-sized in-memory training datasets.</p> <p>Port: 5005</p>"},{"location":"setup_installation/common/services/#limiting-outbound-traffic-to-managedhopsworksai","title":"Limiting outbound traffic to managed.hopsworks.ai","text":"<p>If you have enabled the use of static IPs to communicate with managed.hopsworks.ai as described in AWS and AZURE, you need to ensure that your security group allow outbound traffic to the two IPs indicated in the service page.</p> <p> Limiting outbound traffic to managed.hopsworks.ai </p>"},{"location":"setup_installation/common/settings/","title":"How to manage your managed.hopsworks.ai account","text":""},{"location":"setup_installation/common/settings/#introduction","title":"Introduction","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. On this page, you will get an overview of the managed.hopsworks.ai page.</p>"},{"location":"setup_installation/common/settings/#how-to-get-to-the-settings-page-and-what-does-it-look-like","title":"How to get to the settings page and what does it look like.","text":"<p>From the managed.hopsworks.ai landing page, you can access the setting page by clicking on Settings on the top left.</p> <p>The settings page contains a menu on the left. The remaining of the page display information depending on the section you have selected in the menu.</p> <p> Getting to the settings page </p>"},{"location":"setup_installation/common/settings/#manage-the-connection-to-your-cloud-accounts-under-cloud-accounts","title":"Manage the connection to your cloud accounts under Cloud Accounts","text":"<p>The landing section of the settings page is the Cloud Accounts section. On this page you can edit the link between managed.hopsworks.ai and your cloud provider by clicking on the Edit button (1). You can delete the link and remove any access from managed.hopsworks.ai to your cloud manager by clicking on the Delete button (2). Or, you can configure a new connection with a cloud provider by clicking on the Configure button (3).</p> <p>For more details about setting up a connection with a cloud provider see the getting started pages for:</p> <ul> <li>AWS</li> <li>Azure</li> <li>GCP</li> </ul> <p> Cloud accounts management </p>"},{"location":"setup_installation/common/settings/#manage-your-personal-information-under-profile","title":"Manage your personal information under Profile","text":"<p>The Profile section is where you can edit your personal information such as name, phone number, company, etc.</p> <p> Profile </p>"},{"location":"setup_installation/common/settings/#change-your-password-and-configure-multi-factor-authentication-under-the-security-section","title":"Change your password and configure multi-factor authentication under the Security section","text":""},{"location":"setup_installation/common/settings/#change-your-password","title":"Change your password","text":"<p>To change your password, go to the security section, enter your current password in the Current password field (1), enter the new password in the New password field (2), and click on Save (3).</p> <p> Change password </p>"},{"location":"setup_installation/common/settings/#set-up-multi-factor-authentication","title":"Set up multi-factor authentication.","text":"<p>To set up multi-factor authentication, go to the security section, scan the QR code (1) with your authenticator app (example: Google Authenticator). Then enter the security code provided by the authenticator app in the Security code field (2) and click on Enable TOTP (3).</p> <p> Enable MFA </p>"},{"location":"setup_installation/common/settings/#create-and-manage-api-keys-under-the-api-keys-section","title":"Create and manage API keys under the API keys section","text":"<p>The API key section is where you create or delete your managed.hopsworks.ai API keys. More details about the API keys can be found in the API keys documentation</p> <p> Generate an API Key </p>"},{"location":"setup_installation/common/settings/#conclusion","title":"Conclusion","text":"<p>You now know where and how to update your profile, cloud accounts, and API keys.</p> <p>To keep familiarizing with managed.hopsworks.ai check the dashboard documentation</p>"},{"location":"setup_installation/common/terraform/","title":"Hopsworks.ai Terraform Provider","text":"<p>Managed.hopsworks.ai allows users to create and manage their clusters using the Hopsworks.ai terraform provider. In this guide, we first provide brief description on how to get started on AWS and AZURE, then we show how to import an existing cluster to be managed by terraform.</p>"},{"location":"setup_installation/common/terraform/#getting-started-with-aws","title":"Getting Started with AWS","text":"<p>Complete the following steps to start using Hopsworks.ai Terraform Provider on AWS.</p> <ol> <li>Create a managed.hopsworks.ai API KEY as described in details here, and export the API KEY as follows  <pre><code>export HOPSWORKSAI_API_KEY=&lt;YOUR_API_KEY&gt;\n</code></pre></li> <li>Download the proper Terraform CLI for your os from here.</li> <li>Install the AWS CLI and run <code>aws configurre</code> to configure your AWS credentials.</li> </ol>"},{"location":"setup_installation/common/terraform/#example","title":"Example","text":"<p>In this section, we provide a simple example to create a Hopsworks cluster on AWS along with all its required resources (ssh key, S3 bucket, and instance profile with the required permissions). </p> <ol> <li>In your terminal, run the following to create a demo directory and cd to it  <pre><code>mkdir demo\ncd demo\n</code></pre></li> <li>In this empty directory, create an empty file <code>main.tf</code>. Open the file and paste the following configurations to it then save it. <pre><code>terraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.16.0\"\n    }\n    hopsworksai = {\n      source = \"logicalclocks/hopsworksai\"\n    }\n  }\n}\n\nvariable \"region\" {\n  type    = string\n  default = \"us-east-2\"\n}\n\nprovider \"aws\" {\n  region = var.region\n}\n\nprovider \"hopsworksai\" {\n}\n\n# Create the required aws resources, an ssh key, an s3 bucket, and an instance profile with the required Hopsworks permissions\nmodule \"aws\" {\n  source  = \"logicalclocks/helpers/hopsworksai//modules/aws\"\n  region  = var.region\n  version = \"2.3.0\"\n}\n\n# Create a cluster with no workers\nresource \"hopsworksai_cluster\" \"cluster\" {\n  name    = \"tf-hopsworks-cluster\"\n  ssh_key = module.aws.ssh_key_pair_name\n\n  head {\n    instance_type = \"m5.2xlarge\"\n  }\n\n  aws_attributes {\n    region               = var.region\n    instance_profile_arn = module.aws.instance_profile_arn\n    bucket {\n      name = module.aws.bucket_name\n    }\n  }\n\n  rondb {\n    single_node {\n      instance_type = \"t3a.xlarge\"\n    }\n  }\n\n  autoscale {\n    non_gpu_workers {\n      instance_type       = \"m5.2xlarge\"\n      disk_size           = 256\n      min_workers         = 1\n      max_workers         = 5\n      standby_workers     = 0.5\n      downscale_wait_time = 300\n    }\n  }\n\n  open_ports {\n    ssh = true\n  }\n}\n\noutput \"hopsworks_cluster_url\" {\n  value = hopsworksai_cluster.cluster.url\n}\n</code></pre></li> <li>Initialize the terraform directory by running the following command  <pre><code>terraform init \n</code></pre></li> <li>Now you can apply the changes to create all required resources <pre><code>terraform apply \n</code></pre></li> <li> <p>Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your managed.hopsworks.ai dashboard to get your login credentials.</p> </li> <li> <p>After you finish working with the cluster, you can terminate it along with the other AWS resources using the following command <pre><code>terraform destroy \n</code></pre></p> </li> </ol>"},{"location":"setup_installation/common/terraform/#getting-started-with-azure","title":"Getting Started with AZURE","text":"<p>Complete the following steps to start using Hopsworks.ai Terraform Provider on AZURE.</p> <ol> <li>Create a managed.hopsworks.ai API KEY as described in details here, and export the API KEY as follows  <pre><code>export HOPSWORKSAI_API_KEY=&lt;YOUR_API_KEY&gt;\n</code></pre></li> <li>Download the proper Terraform CLI for your os from here.</li> <li>Install the AZURE CLI and run <code>az login</code> to configure your AZURE credentials.</li> </ol>"},{"location":"setup_installation/common/terraform/#example_1","title":"Example","text":"<p>In this section, we provide a simple example to create a Hopsworks cluster on AZURE along with all its required resources (ssh key, storage account, acr registry, and user assigned managed identity with the required permissions).</p> <ol> <li>In your terminal, run the following to create a demo directory and cd to it  <pre><code>mkdir demo\ncd demo\n</code></pre></li> <li>In this empty directory, create an empty file <code>main.tf</code>. Open the file and paste the following configurations to it then save it. <pre><code>terraform {\n  required_providers {\n    azurerm = {\n      source  = \"hashicorp/azurerm\"\n      version = \"3.8.0\"\n    }\n    hopsworksai = {\n      source = \"logicalclocks/hopsworksai\"\n    }\n  }\n}\n\nvariable \"resource_group\" {\n  type    = string\n}\n\nprovider \"azurerm\" {\n  features {}\n  skip_provider_registration = true\n}\n\nprovider \"hopsworksai\" {\n}\n\ndata \"azurerm_resource_group\" \"rg\" {\n  name = var.resource_group\n}\n\n# Create the required azure resources, an ssh key, a storage account, and an user assigned managed identity with the required Hopsworks permissions\nmodule \"azure\" {\n  source         = \"logicalclocks/helpers/hopsworksai//modules/azure\"\n  resource_group = var.resource_group\n  version        = \"2.3.0\"\n}\n\n# Create an ACR registry \nresource \"azurerm_container_registry\" \"acr\" {\n  name                = replace(module.azure.storage_account_name, \"storageaccount\", \"acr\")\n  resource_group_name = module.azure.resource_group\n  location            = module.azure.location\n  sku                 = \"Premium\"\n  admin_enabled       = false\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}\n\n# Create a cluster with no workers\nresource \"hopsworksai_cluster\" \"cluster\" {\n  name    = \"tf-hopsworks-cluster\"\n  ssh_key = module.azure.ssh_key_pair_name\n\n  head {\n    instance_type = \"Standard_D8_v3\"\n  }\n\n azure_attributes {\n    location                       = module.azure.location\n    resource_group                 = module.azure.resource_group\n    user_assigned_managed_identity = module.azure.user_assigned_identity_name\n    container {\n      storage_account = module.azure.storage_account_name\n    }\n    acr_registry_name = azurerm_container_registry.acr.name\n  }\n\n  rondb {\n    single_node {\n      instance_type = \"Standard_D4s_v4\"\n    }\n  }\n\n  autoscale {\n    non_gpu_workers {\n      instance_type       = \"Standard_D8_v3\"\n      disk_size           = 256\n      min_workers         = 1\n      max_workers         = 5\n      standby_workers     = 0.5\n      downscale_wait_time = 300\n    }\n  }\n\n  open_ports {\n    ssh = true\n  }\n}\n\noutput \"hopsworks_cluster_url\" {\n  value = hopsworksai_cluster.cluster.url\n}\n</code></pre></li> <li>Initialize the terraform directory by running the following command  <pre><code>terraform init \n</code></pre></li> <li>Now you can apply the changes to create all required resources. Replace the placeholders with your Azure resource group <pre><code>terraform apply -var=\"resource_group=&lt;YOUR_RESOURCE_GROUP&gt;\"\n</code></pre></li> <li> <p>Once terraform finishes creating the resources, it will output the url to the newly created cluster. Notice that for now, you have to navigate to your managed.hopsworks.ai dashboard to get your login credentials.</p> </li> <li> <p>After you finish working with the cluster, you can terminate it along with the other AZURE resources using the following command <pre><code>terraform destroy -var=\"resource_group=&lt;YOUR_RESOURCE_GROUP&gt;\"\n</code></pre></p> </li> </ol>"},{"location":"setup_installation/common/terraform/#importing-an-existing-cluster-to-terraform","title":"Importing an existing cluster to terraform","text":"<p>In this section, we show how to use <code>terraform import</code> to manage your existing Hopsworks cluster. </p> <ul> <li>Step 1: In your managed.hopsworks.ai dashboard, choose the cluster you want to import to terraform, then go to the Details tab and copy the Id as shown in the figure below </li> </ul> <p> Click on the Details tab and copy the Id </p> <ul> <li> <p>Step 2: In your terminal, create an empty directory and cd to it. <pre><code>mkdir import-demo\ncd import-demo\n</code></pre></p> </li> <li> <p>Step 3: In this empty directory, create an empty file <code>versions.tf</code>. Open the file and paste the following configurations. </p> </li> </ul> <p>Note</p> <p>Notice that you need to change these configurations depending on your cluster, in this example, the Hopsworks cluster reside in region <code>us-east-2</code> on AWS.</p> <pre><code>terraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"4.16.0\"\n    }\n    hopsworksai = {\n      source = \"logicalclocks/hopsworksai\"\n    }\n  }\n}\n\nprovider \"aws\" {\n  region = us-east-2\n}\n\nprovider \"hopsworksai\" {\n}\n</code></pre> <ul> <li> <p>Step 4: Initialize the terraform directory by running the following command  <pre><code>terraform init \n</code></pre></p> </li> <li> <p>Step 5: Create another file <code>main.tf</code>. Open the file and paste the following configuration. <pre><code>resource \"hopsworksai_cluster\" \"cluster\" {\n}\n</code></pre></p> </li> <li> <p>Step 6: Import the cluster state using <code>terraform import</code>, in this step you need the cluster id from Step 1 (33ae7ae0-d03c-11eb-84e2-af555fb63565). <pre><code>terraform import hopsworksai_cluster.cluster 33ae7ae0-d03c-11eb-84e2-af555fb63565\n</code></pre></p> </li> </ul> <p>The output should be similar to the following snippet  <pre><code>hopsworksai_cluster.cluster: Importing from ID \"33ae7ae0-d03c-11eb-84e2-af555fb63565\"...\nhopsworksai_cluster.cluster: Import prepared!\n  Prepared hopsworksai_cluster for import\nhopsworksai_cluster.cluster: Refreshing state... [id=33ae7ae0-d03c-11eb-84e2-af555fb63565]\n\nImport successful!\n\nThe resources that were imported are shown above. These resources are now in\nyour Terraform state and will henceforth be managed by Terraform.\n</code></pre></p> <ul> <li> <p>Step 7: At that moment the local terraform state is updated, however, if we try to run <code>terraform plan</code> or <code>terraform apply</code> it will complain about missing configurations. The reason is that our local resource configuration in <code>main.tf</code> is empty, we should populate it using the terraform state commands as shown below: <pre><code>terraform show -no-color &gt; main.tf\n</code></pre></p> </li> <li> <p>Step 8: If you try to run <code>terraform plan</code> again, the command will complain that the read-only attributes are set (Computed attributes) as shown below. The solution is to remove these attributes from the <code>main.tf</code> and retry again until you have no errors. <pre><code>Error: Computed attributes cannot be set\n\n  on main.tf line 3, in resource \"hopsworksai_cluster\" \"cluster\":\n   3:     activation_state               = \"stoppable\"\n\nComputed attributes cannot be set, but a value was set for \"activation_state\".\n\n\nError: Computed attributes cannot be set\n\n  on main.tf line 6, in resource \"hopsworksai_cluster\" \"cluster\":\n   6:     cluster_id                     = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\"\n\nComputed attributes cannot be set, but a value was set for \"cluster_id\".\n\n\nError: Computed attributes cannot be set\n\n  on main.tf line 7, in resource \"hopsworksai_cluster\" \"cluster\":\n   7:     creation_date                  = \"2021-06-18T15:51:07+02:00\"\n\nComputed attributes cannot be set, but a value was set for \"creation_date\".\n\n\nError: Invalid or unknown key\n\n  on main.tf line 8, in resource \"hopsworksai_cluster\" \"cluster\":\n   8:     id                             = \"33ae7ae0-d03c-11eb-84e2-af555fb63565\"\n\n\n\nError: Computed attributes cannot be set\n\n  on main.tf line 13, in resource \"hopsworksai_cluster\" \"cluster\":\n  13:     start_date                     = \"2021-06-18T15:51:07+02:00\"\n\nComputed attributes cannot be set, but a value was set for \"start_date\".\n\n\nError: Computed attributes cannot be set\n\n  on main.tf line 14, in resource \"hopsworksai_cluster\" \"cluster\":\n  14:     state                          = \"running\"\n\nComputed attributes cannot be set, but a value was set for \"state\".\n\n\nError: Computed attributes cannot be set\n\n  on main.tf line 17, in resource \"hopsworksai_cluster\" \"cluster\":\n  17:     url                            = \"https://33ae7ae0-d03c-11eb-84e2-af555fb63565.dev-cloud.hopsworks.ai/hopsworks/#!/\"\n\nComputed attributes cannot be set, but a value was set for \"url\".\n</code></pre></p> </li> <li> <p>Step 9: Once you have fixed all the errors, you should get the following output when running <code>terraform plan</code>. With that, you can proceed as normal to manage this cluster locally using terraform. <pre><code>hopsworksai_cluster.cluster: Refreshing state... [id=33ae7ae0-d03c-11eb-84e2-af555fb63565]\n\nNo changes. Infrastructure is up-to-date.\n\nThis means that Terraform did not detect any differences between your\nconfiguration and real physical resources that exist. As a result, no\nactions need to be performed.\n</code></pre></p> </li> </ul>"},{"location":"setup_installation/common/terraform/#next-steps","title":"Next Steps","text":"<ul> <li>Check the Hopsworks.ai terraform provider documentation for more details about the different resources and data sources supported by the provider and a description of their attributes.</li> <li>Check the Hopsworks.ai terraform AWS examples, each example contains a README file describing how to run it and more details about configuring it.</li> <li>Check the Hopsworks.ai terraform AZURE examples, each example contains a README file describing how to run it and more details about configuring it.</li> </ul>"},{"location":"setup_installation/common/user_management/","title":"User management","text":"<p>In managed.hopsworks.ai users can be grouped into organizations to access the same resources. When a new user registers with managed.hopsworks.ai a new organization is created. This user later on can invite other registered users to their organization so they can share access to the same clusters.</p> <p>Cloud Accounts configuration is also shared among users of the same organization. So if user Alice has configured her account with her credentials, all member of her organization will automatically deploy clusters in her cloud account. Credits and cluster usage are also grouped to ease reporting.</p>"},{"location":"setup_installation/common/user_management/#adding-members-to-an-organization","title":"Adding members to an organization","text":"<p>Organization membership can be edited by clicking Members on the left of managed.hopsworks.ai Dashboard page.</p> <p> Organization membership </p> <p>To add a new member to your organization add the user's email and click Add. The invited user will receive an email with the invitation. You can set the user as administrator by checking the Admin checkbox. More details about organization administrators can be found [here].(#administrator-role)</p> <p>An invited user must accept the invitation to be part of the organization. An invitation will show up on the invitee's Dashboard. The invitee may have to close the Welcome splash screen to be able to see the invitation. In this example, Alice has invited Bob to her organization, but Bob hasn't accepted the invitation yet.</p> <p> Alice has sent the invitation Bob's dashboard </p>"},{"location":"setup_installation/common/user_management/#sharing-resources","title":"Sharing resources","text":"<p>Once Bob has accepted the invitation he does not have to configure his account, they share the same configuration. Also, he will be able to view the same Dashboard as Alice, so he can start, stop or terminate clusters in the organization.</p> <p> Alice's dashboard Bob's dashboard </p> <p>If Alice had existing clusters running and she had selected Managed user management during cluster creation, an account will be automatically created for Bob on these clusters.</p>"},{"location":"setup_installation/common/user_management/#removing-members-from-an-organization","title":"Removing members from an organization","text":"<p>To remove a member from your organization simply go to Members page and click the Remove button next to the user you want to remove. You will stop sharing any resource and the user will be blocked from any shared cluster.</p> <p> Delete organization member </p>"},{"location":"setup_installation/common/user_management/#organization-permissions","title":"Organization permissions","text":"<p>The owner and the administrators of an organization can set permissions at the organization level. For this got to the members tab, check the checkboxes in the Member permissions section and click on Update.</p> <p>The supported permissions are:</p> <ul> <li>Non admin members can invite new members to the organization. If this permission is enabled, any member of the organization will be able to invite other members to the organization. Note that only the owner and the administrators will be able to invite new members as administrators. If this permission is not enabled only the owner and the administrators can invite new members to the organization.</li> <li>Non admin members can create and terminate clusters. If this permission is enabled, any member of the organization will be able to create and terminate clusters. If it is not enabled, only the owner and the administrators will be able to create and terminate clusters.</li> <li>Non admin members can open clusters ports. If this permission is enabled, any member of the organization can open and close services ports on organization's clusters. If it is not enabled, only the organization owner and administrators will be able to do so.</li> </ul> <p> Modify permissions </p>"},{"location":"setup_installation/common/user_management/#administrator-role","title":"Administrator role","text":"<p>Members of an organization can be set as administrators. This can be done by checking the admin checkbox at the time of invitation or by checking the admin checkbox then clicking the Update button next to a member email.</p> <p>Administrators can do all the actions described in the Organization permissions section of this documentation. They can also update the configuration of these permissions and set other users as administrators. Finally, administrators are automatically set as administrators on all the clusters of the organization that have Managed user enabled and are version 2.6.0 or above.</p> <p> Set a member as admin </p>"},{"location":"setup_installation/common/sso/ldap/","title":"Configure your Hopsworks cluster to use LDAP for user management.","text":"<p>If you want to use your organization's LDAP as an identity provider to manage users in your Hopsworks cluster this document will guide you through the necessary steps to configure managed.hopsworks.ai to use LDAP.</p> <p>The LDAP attributes below are used to configure JNDI resources in the Hopsworks server.  The JNDI resource will communicate with your LDAP server to perform the authentication.</p> <p> Setup LDAP </p> <ul> <li>jndilookupname: should contain the LDAP domain.</li> <li>hopsworks.ldap.basedn: the LDAP domain, it should be the same as jndilookupname</li> <li>java.naming.provider.url: url of your LDAP server with port.</li> <li>java.naming.ldap.attributes.binary: is the binary unique identifier that will be used in subsequent logins to identify the user.</li> <li>java.naming.security.authentication: how to authenticate to the LDAP server.</li> <li>java.naming.security.principal: contains the username of the user that will be used to query LDAP.</li> <li>java.naming.security.credentials: contains the password of the user that will be used to query LDAP.</li> <li>java.naming.referral: whether to follow or ignore an alternate location in which an LDAP Request may be processed.</li> </ul> <p>After configuring LDAP and creating your cluster you can log into your Hopsworks cluster and edit the LDAP attributes to field names to match your server. By default all attributes to field names are set to the values in OpenLDAP.  See Configure LDAP on how to edit the LDAP default configurations.</p> <p>Note</p> <p>A default admin user that can log in with username and password will be created for the user that is creating the cluster.   This user can be removed after making sure users can log in using LDAP. </p>"},{"location":"setup_installation/common/sso/oauth/","title":"Configure your Hopsworks cluster to use OAuth2 for user management.","text":"<p>If you want to use your organization's OAuth 2.0 identity provider to manage users in your Hopsworks cluster this document will guide you through the necessary steps to register your identity provider in managed.hopsworks.ai.</p> <p>Before registering your identity provider in Hopsworks you need to create a client application in your identity provider and acquire a client id and a client secret. Examples on how to create a client using Okta and Azure Active Directory identity providers can be found here and here respectively.</p> <p>In the User management step of cluster creation (AWS, Azure) you can choose which user management system to use. Select OAuth2 (OpenId) from the dropdown and configure your identity provider.</p> <p> Setup OAuth </p> <p>Register your identity provider by setting the following fields:</p> <ul> <li>Create Administrator password user: if checked an administrator that can log in to the Hopsworks cluster, with email and password, will be created for the user creating the cluster. If Not checked a group mapping that maps at least one group in the identity provider to HOPS_ADMIN is required. </li> <li>ClientId: the client id generated when registering Hopsworks in your identity provider.</li> <li>Client Secret: the client secret generated when registering Hopsworks in your identity provider.</li> <li>Provider URI: is the base uri of the identity provider (URI should contain scheme http:// or https://).</li> <li>Provider Name: a unique name to identify the identity provider in your Hopsworks cluster.                   This name will be used in the login page as an alternative login method if Provider DisplayName is not set.</li> </ul> <p>Optionally you can also set:</p> <ul> <li>Provider DisplayName: the name to display for the alternative login method (if not set Provider Name will be used)</li> <li>Provider Logo URI: a logo URL to an image. The logo will be shown on the login page with the provider name.</li> <li>Code Challenge Method: if your identity provider requires a code challenge for authorization request check the code challenge check box.                         This will allow you to choose a code challenge method that can be either plain or S256.</li> <li>Group Mapping: will allow you to map groups in your identity provider to groups in hopsworks.                   You can choose to map all users to HOPS_USER or HOPS_ADMIN. Alternatively you can add mappings as in the example below.                   <pre><code>IT-&gt;HOPS_ADMIN;DATA_SCIENCE-&gt;HOPS_USER\n</code></pre>                   This will map users in the IT group in your identity provider to HOPS_ADMIN and users in the DATA_SCIENCE group to HOPS_USER.</li> <li>Verify Email: if checked only users with verified email address (in the identity provider) can log in to Hopsworks.</li> <li>Activate user: if not checked an administrator in Hopsworks needs to activate users before they can login.</li> <li>Need consent: if checked, users will be asked for consent when logging in for the first time.</li> <li>Disable registration: if unchecked users will have the possibility to create accounts in the Hopsworks cluster using user name and password instead of OAuth.</li> <li>Provider Metadata Endpoint Supported: if your provider defines a discovery mechanism, called OpenID Connect Discovery,                                          where it publishes its metadata at a well-known URL, typically <pre><code>https://server.com/.well-known/openid-configuration\n</code></pre> you can check this and the metadata will be discovered by hopsworks. If your provider does not publish its metadata you need to supply these values manually.</li> </ul> <p> Setup Provider </p> <ul> <li>Authorization Endpoint: the authorization endpoint of your identity provider, typically <pre><code>https://server.com/oauth2/authorize\n</code></pre></li> <li>End Session Endpoint: the logout endpoint of your identity provider, typically <pre><code>https://server.com/oauth2/logout\n</code></pre></li> <li>Token Endpoint: the token endpoint of your identity provider, typically <pre><code>https://server.com/oauth2/token\n</code></pre></li> <li>UserInfo Endpoint: the user info endpoint of your identity provider, typically <pre><code>https://server.com/oauth2/userinfo\n</code></pre></li> <li>JWKS URI: the JSON Web Key Set endpoint of your identity provider, typically <pre><code>https://server.com/oauth2/keys\n</code></pre></li> </ul> <p>After configuring OAuth2 you can click on Next to configure the rest of your cluster.</p> <p>You can also configure OAuth2 once you have created a Hopsworks cluster. For instructions on how to configure OAUth2 on Hopsworks see  Authentication Methods.</p>"},{"location":"setup_installation/gcp/cluster_creation/","title":"Cluster creation in managed.hopsworks.ai (GCP)","text":"<p>This guide goes into detail for each of the steps of the cluster creation in managed.hopsworks.ai</p>"},{"location":"setup_installation/gcp/cluster_creation/#step-1-starting-to-create-a-cluster","title":"Step 1 starting to create a cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-2-setting-the-general-information","title":"Step 2 setting the General information","text":"<p>Select the GCP Project (1) in which you want the cluster to run.</p> <p>Note</p> <p>If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project.</p> <p>Name your cluster (2). Choose the Region(3) and Zone(4) in which to deploy the cluster.</p> <p>Select the Instance type (5) and Local storage (6) size for the cluster Head node.</p> <p>Optional: Specify a customer-managed encryption key to be used for encryption of local storage. The key has to be specified using the format: <code>projects/PROJECT_ID/locations/REGION/keyRings/KEY_RING/cryptoKeys/KEY</code>. Note that your project needs to be configured to allow usage of the key. This can be achieved by executing the gcloud command below. Refer to the GCP documentation for more details: Protect resources by using Cloud KMS keys.</p> <pre><code>gcloud projects add-iam-policy-binding KMS_PROJECT_ID \\\n  --member serviceAccount:service-PROJECT_NUMBER@compute-system.iam.gserviceaccount.com \\\n  --role roles/cloudkms.cryptoKeyEncrypterDecrypter\n</code></pre> <p>Enter the name of the bucket in which the Hopsworks cluster will store its data in Cloud Storage Bucket (8)</p> <p>Warning</p> <p>The bucket must be empty and must be in a region accessible from the region in which the cluster is deployed.</p> <p> General configuration </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-3-workers-configuration","title":"Step 3 workers configuration","text":"<p>In this step, you configure the workers. There are two possible setups: static or autoscaling. In the static setup, the cluster has a fixed number of workers that you decide. You can then add and remove workers manually, for more details: documentation. In the autoscaling setup, you configure conditions to add and remove workers and the cluster will automatically add and remove workers depending on the demand, for more details: documentation.</p>"},{"location":"setup_installation/gcp/cluster_creation/#static-workers-configuration","title":"Static workers configuration","text":"<p>You can set the static configuration by selecting Disabled in the first drop-down (1). Then you select the number of workers you want to start the cluster with (2). And, select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p> Create a Hopsworks cluster, static workers configuration </p>"},{"location":"setup_installation/gcp/cluster_creation/#autoscaling-workers-configuration","title":"Autoscaling workers configuration","text":"<p>You can set the autoscaling configuration by selecting enabled in the first drop-down (1). You can configure:</p> <ol> <li>The instance type you want to use.</li> <li>The size of the instances' disk.</li> <li>The minimum number of workers. </li> <li>The maximum number of workers.</li> <li>The targeted number of standby workers. Setting some resources on standby ensures that there are always some free resources in your cluster. This ensures that requests for new resources are fulfilled promptly. You configure the standby by setting the number of workers you want to be on standby. For example, if you set a value of 0.5 the system will start a new worker every time the aggregated free cluster resources drop below 50% of a worker's resources. If you set this value to 0 new workers will only be started when a job or notebook requests the resources.</li> <li>The time to wait before removing unused resources. One often starts a new computation shortly after finishing the previous one. To avoid having to wait for workers to stop and start between each computation it is recommended to wait before shutting down workers. Here you set the amount of time in seconds resources need to be unused before they get removed from the system.</li> </ol> <p>Note</p> <p>The standby will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster. This ensures that the number of nodes can fall to 0 when no resources are used. The standby will start to take effect as soon as you start using resources.</p> <p> Create a Hopsworks cluster, autoscale workers configuration </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-4-select-the-service-account","title":"Step 4 select the Service Account","text":"<p>Hopsworks cluster store their data in a storage bucket. To let the cluster instances access the bucket we need to attach a Service Account to the virtual machines. In this step, you set which Service Account to use by entering its Email. This Service Account needs to have access right to the bucket you selected in Step 2. For more details on how to create the Service Account and give it access to the bucket refer to Creating and configuring a storage</p> <p> Set the instance service account </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-5-set-the-backup-retention-policy","title":"Step 5 set the backup retention policy","text":"<p>To backup the storage bucket data when taking a cluster backup we need to set a retention policy for the bucket. In this step, you choose the retention period in days. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster.</p> <p> Choose the backup retention policy </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-6-vpc-and-subnet-selection","title":"Step 6 VPC and Subnet selection","text":"<p>You can select the VPC which will be used by the Hopsworks cluster.  You can either select an existing VPC or let managed.hopsworks.ai create one for you. If you decide to use restricted managed.hopsworks.ai permissions (see restrictive-permissions for more details)  you will need to select an existing VPC here. </p> <p> Select the vpc </p> <p>If you selected an existing VPC in the previous step, this step lets you select which subnet of this VPC to use.</p> <p>If you did not select an existing virtual network in the previous step managed.hopsworks.ai will create a subnet for you.  You can choose the CIDR block this subnet will use. Select the Subnet to be used by your cluster and press Next.</p> <p> Select the subnet </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-7-user-management-selection","title":"Step 7 User management selection","text":"<p>In this step, you can choose which user management system to use. You have three choices: </p> <ul> <li>Managed: managed.hopsworks.ai automatically adds and removes users from the Hopsworks cluster when you add and remove users from your organization  (more details here).</li> <li>OAuth2: integrate the cluster with your organization's OAuth2 identity provider. See Use OAuth2 for user management for more detail.</li> <li>LDAP: integrate the cluster with your organization's LDAP/ActiveDirectory server. See Use LDAP for user management for more detail.</li> <li>Disabled: let you manage users manually from within Hopsworks.</li> </ul> <p> Choose user management type </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-8-managed-rondb","title":"Step 8 Managed RonDB","text":"<p>Hopsworks uses RonDB as a database engine for its online Feature Store. By default database will run on its own VM. Premium users can scale-out database services to multiple VMs to handle increased workload.</p> <p>For details on how to configure RonDB check our guide here.</p> <p> Configure RonDB </p> <p>If you need to deploy a RonDB cluster instead of a single node please contact us.</p>"},{"location":"setup_installation/gcp/cluster_creation/#step-9-add-tags-to-your-instances","title":"Step 9 add tags to your instances.","text":"<p>In this step, you can define tags that will be added to the cluster virtual machines.</p> <p> Add tags </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-10-add-an-init-script-to-your-instances","title":"Step 10 add an init script to your instances.","text":"<p>In this step, you can enter an initialization script that will be run at startup on every instance.</p> <p>You can select whether this script will run before or after the VM configuration. Be cautious if you select to run it before the VM configuration as this might affect Cluster creation.</p> <p>Note</p> <p>this init script must be a bash script starting with #!/usr/bin/env bash</p> <p> Add initialization script </p>"},{"location":"setup_installation/gcp/cluster_creation/#step-11-review-and-create","title":"Step 11 Review and create","text":"<p>Review all information and select Create:</p> <p> Review cluster information </p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart, or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/gcp/getting_started/","title":"Getting started with managed.hopsworks.ai (Google Cloud Platform)","text":"<p>Managed.hopsworks.ai is our managed platform for running Hopsworks and the Feature Store in the cloud. It integrates seamlessly with third-party platforms such as Databricks, SageMaker and KubeFlow. This guide shows how to set up managed.hopsworks.ai with your organization's Google Cloud Platform's (GCP) account.</p>"},{"location":"setup_installation/gcp/getting_started/#prerequisites","title":"Prerequisites","text":"<p>To follow the instruction of this page you will need the following:</p> <ul> <li>A GCP project in which the Hopsworks cluster will be deployed. </li> <li>The gcloud CLI</li> <li>The gsutil tool</li> </ul> <p>To run all the commands on this page the user needs to have at least the following permissions on the GCP project: <pre><code>    iam.roles.create\n    iam.roles.list\n    iam.serviceAccountKeys.create\n    iam.serviceAccounts.create\n    resourcemanager.projects.getIamPolicy\n    resourcemanager.projects.setIamPolicy\n    serviceusage.services.enable\n    storage.buckets.create\n</code></pre></p> <p>Make sure to enable Compute Engine API, Cloud Resource Manager API, and Identity and Access Management (IAM) API on the GCP project. This can be done by running the following commands. Replacing $PROJECT_ID with the id of your GCP project. <pre><code>gcloud --project=$PROJECT_ID services enable compute.googleapis.com\ngcloud --project=$PROJECT_ID services enable cloudresourcemanager.googleapis.com\ngcloud --project=$PROJECT_ID services enable iam.googleapis.com\n</code></pre> You can find more information about GCP cloud APIs in the GCP documentation.</p>"},{"location":"setup_installation/gcp/getting_started/#step-1-connecting-your-gcp-account","title":"Step 1: Connecting your GCP account","text":"<p>Managed.hopsworks.ai deploys Hopsworks clusters to a project in your GCP account. Managed.hopsworks.ai uses service account keys to connect to your GCP project. To enable this, you need to create a service account in your GCP project. Assign to the service account the required permissions. And, create a service account key JSON. For more details about creating and managing service accounts steps in GCP, see documentation.</p> <p>In managed.hopsworks.ai click on Connect to GCP or go to Settings and click on Configure next to GCP. This will direct you to a page with the instructions needed to create the service account and set up the connection. Follow the instructions.</p> <p>Note</p> <p>it is possible to limit the permissions that step up during this phase. For more details see restrictive-permissions.</p> <p> GCP configuration page </p>"},{"location":"setup_installation/gcp/getting_started/#step-2-creating-storage","title":"Step 2: Creating storage","text":"<p>The Hopsworks clusters deployed by managed.hopsworks.ai store their data in a bucket in your GCP account. This bucket needs to be created before creating the Hopsworks cluster.</p> <p>Execute the following gsutil command to create a bucket. Replace all occurrences $PROJECT_ID with your GCP project id and $BUCKET_NAME with the name you want to give to your bucket. You can also replace US with another location if you are not going to run your cluster in this *Multi-Region (see note below for more details).</p> <pre><code>gsutil mb -p $PROJECT_ID -l US gs://$BUCKET_NAME\n</code></pre> <p>Note</p> <p>The Hopsworks cluster created by managed.hopsworks.ai must be in the same region as the bucket. The above command will create the bucket in the US so in the following steps, you must deploy your cluster in a US region. If you want to deploy your cluster in another part of the world us the -l option of gsutil mb. For more details about creating buckets with gsutil, see the google documentation</p>"},{"location":"setup_installation/gcp/getting_started/#step-3-creating-a-service-account-for-your-cluster-instances","title":"Step 3: Creating a service account for your cluster instances","text":"<p>The cluster instances will need to be granted permission to access the storage bucket. You achieve this by creating a service account that will later be attached to the Hopsworks cluster instances. This service account should be different from the service account created in step 1, as it has only those permissions related to storing objects in a GCP bucket.</p>"},{"location":"setup_installation/gcp/getting_started/#step-31-creating-a-custom-role-for-accessing-storage","title":"Step 3.1: Creating a custom role for accessing storage","text":"<p>Create a file named hopsworksai_instances_role.yaml with the following content:</p> <pre><code>title: Hopsworks AI Instances\ndescription: Role that allows Hopsworks AI Instances to access resources\nstage: GA\nincludedPermissions:\n- storage.buckets.get\n- storage.buckets.update\n- storage.multipartUploads.abort\n- storage.multipartUploads.create\n- storage.multipartUploads.list\n- storage.multipartUploads.listParts\n- storage.objects.create\n- storage.objects.delete\n- storage.objects.get\n- storage.objects.list\n- storage.objects.update\n</code></pre> <p>Note</p> <p>it is possible to limit the permissions that set up during this phase. For more details see restrictive-permissions.</p> <p>Execute the following gcloud command to create a custom role from the file. Replace $PROJECT_ID with your GCP project id:</p> <pre><code>gcloud iam roles create hopsworksai_instances \\\n  --project=$PROJECT_ID \\\n  --file=hopsworksai_instances_role.yaml\n</code></pre>"},{"location":"setup_installation/gcp/getting_started/#step-32-creating-a-service-account","title":"Step 3.2: Creating a service account","text":"<p>Execute the following gcloud command to create a service account for Hopsworks AI instances. Replace $PROJECT_ID with your GCP project id:</p> <pre><code>gcloud iam service-accounts create hopsworks-ai-instances \\\n  --project=$PROJECT_ID \\\n  --description=\"Service account for Hopsworks AI instances\" \\\n  --display-name=\"Hopsworks AI instances\"\n</code></pre> <p>Execute the following gcloud command to bind the custom role to the service account. Replace all occurrences $PROJECT_ID with your GCP project id:</p> <pre><code>gcloud projects add-iam-policy-binding $PROJECT_ID \\\n  --member=\"serviceAccount:hopsworks-ai-instances@$PROJECT_ID.iam.gserviceaccount.com\" \\\n  --role=\"projects/$PROJECT_ID/roles/hopsworksai_instances\"\n</code></pre>"},{"location":"setup_installation/gcp/getting_started/#step-4-deploying-a-hopsworks-cluster","title":"Step 4: Deploying a Hopsworks cluster","text":"<p>In managed.hopsworks.ai, select Create cluster:</p> <p> Create a Hopsworks cluster </p> <p>Select the Project (1) in which you created your Bucket and Service Account (see above).</p> <p>Note</p> <p>If the Project does not appear in the drop-down, make sure that you properly Connected your GCP account for this project.</p> <p>Name your cluster (2). Choose the Region(3) and Zone(4) in which to deploy the cluster.</p> <p>Warning</p> <p>The cluster must be deployed in a region having access to the bucket you created above.</p> <p>Select the Instance type (5) and Local storage (6) size for the cluster Head node.</p> <p>Enter the name of the bucket you created above in Cloud Storage Bucket (7)</p> <p>Press Next:</p> <p> General configuration </p> <p>Select the number of workers you want to start the cluster with (2). Select the Instance type (3) and Local storage size (4) for the worker nodes.</p> <p>Note</p> <p>It is possible to add or remove workers or to enable autoscaling once the cluster is running.</p> <p>Press Next:</p> <p> Create a Hopsworks cluster, static workers configuration </p> <p>Enter Email of the instances service account that you created above. If you followed the instruction it should be hopsworks-ai-instances@$PROJECT_ID.iam.gserviceaccount.com with $PROJECT_ID the name of your project:</p> <p> Set the instance service account </p> <p>To backup the storage bucket data when taking a cluster backup we need to set a retention policy for the bucket. You can deactivate the retention policy by setting this value to 0 but this will block you from taking any backup of your cluster. Choose the retention period in days and click on Review and submit.</p> <p> Choose the backup retention policy </p> <p>Review all information and select Create:</p> <p> Review cluster information </p> <p>Note</p> <p>We skipped cluster creation steps that are not mandatory.</p> <p>The cluster will start. This will take a few minutes:</p> <p> Booting Hopsworks cluster </p> <p>As soon as the cluster has started, you will be able to log in to your new Hopsworks cluster. You will also be able to stop, restart or terminate the cluster.</p> <p> Running Hopsworks cluster </p>"},{"location":"setup_installation/gcp/getting_started/#step-5-next-steps","title":"Step 5: Next steps","text":"<p>Check out our other guides for how to get started with Hopsworks and the Feature Store:</p> <ul> <li>Make Hopsworks services accessible from outside services</li> <li>Get started with the Hopsworks Feature Store</li> <li>Follow one of our tutorials</li> <li>Follow one of our Guide</li> <li>Code examples and notebooks: hops-examples</li> </ul>"},{"location":"setup_installation/gcp/restrictive_permissions/","title":"Limiting GCP permissions","text":"<p>Managed.hopsworks.ai requires a set of permissions to be able to manage resources in the user\u2019s GCP project. By default, these permissions are set to easily allow a wide range of different configurations and allow us to automate as many steps as possible. While we ensure to never access resources we shouldn\u2019t, we do understand that this might not be enough for your organization or security policy. This guide explains how to lock down access permissions following the IT security policy principle of least privilege.</p>"},{"location":"setup_installation/gcp/restrictive_permissions/#default-permissions","title":"Default permissions","text":"<p>This is the list of default permissions that are required by managed.hopsworks.ai. If you prefer to limit these permissions, then proceed to the next section.</p> <pre><code>title: Hopsworks AI\ndescription: Role that allows Hopsworks AI to manage resources\nstage: GA\nincludedPermissions:\n- compute.disks.create\n- compute.disks.createSnapshot\n- compute.snapshots.create\n- compute.snapshots.delete\n- compute.snapshots.setLabels\n- compute.snapshots.get\n- compute.snapshots.useReadOnly\n- compute.firewalls.create\n- compute.firewalls.delete\n- compute.firewalls.get\n- compute.firewalls.list\n- compute.firewalls.update\n- compute.globalOperations.get\n- compute.instances.create\n- compute.instances.delete\n- compute.instances.get\n- compute.instances.setLabels\n- compute.instances.setMetadata\n- compute.instances.setServiceAccount\n- compute.instances.start\n- compute.instances.stop\n- compute.instances.setMachineType\n- compute.networks.create\n- compute.networks.delete\n- compute.networks.get\n- compute.networks.list\n- compute.networks.updatePolicy\n- compute.projects.get\n- compute.subnetworks.create\n- compute.subnetworks.delete\n- compute.subnetworks.get\n- compute.subnetworks.list\n- compute.subnetworks.use\n- compute.subnetworks.useExternalIp\n- compute.zoneOperations.get\n- iam.serviceAccounts.actAs\n- iam.serviceAccounts.list\n- resourcemanager.projects.get\n- iam.roles.get\n- resourcemanager.projects.getIamPolicy\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#limiting-the-account-service-account-permissions","title":"Limiting the Account Service Account permissions","text":"<p>Some of the permissions set up when connection your GCP account to managed.hopsworks.ai (here) can be removed under certain conditions.</p>"},{"location":"setup_installation/gcp/restrictive_permissions/#backup-permissions","title":"Backup permissions","text":"<p>The following permissions are only needed for the backup feature. If you are not going to create backups or if you do not have access to this Enterprise feature, you can limit the permission of the Service Account by removing them.</p> <pre><code>- compute.disks.createSnapshot\n- compute.snapshots.create\n- compute.snapshots.delete\n- compute.snapshots.setLabels\n- compute.snapshots.get\n- compute.snapshots.useReadOnly\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#instance-type-modification-permissions","title":"Instance type modification permissions","text":"<p>The following permission is only needed to be able to change the head node and RonDB nodes instance type on an existing cluster (documentation). If you are not going to use this feature, you can limit the permission of the Service Account by removing it.</p> <pre><code>- compute.instances.setMachineType\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#instance-service-account-check","title":"Instance Service account check","text":"<p>The following permissions are only needed to check that the service account you select for your cluster has the proper permissions. If you remove them the check will be skipped. This may result in your cluster taking more time to detect the error if the service account does not have the proper permissions</p> <pre><code>- iam.roles.get\n- resourcemanager.projects.getIamPolicy\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#create-a-vpc-permissions","title":"Create a VPC permissions","text":"<p>The following permissions are only needed if you want managed.hopsworks.ai to create VPC and subnet for you.</p> <pre><code>- compute.networks.create\n- compute.networks.delete\n- compute.networks.get\n- compute.subnetworks.create\n- compute.subnetworks.delete\n- compute.subnetworks.get\n- compute.firewalls.create\n- compute.firewalls.delete\n</code></pre> <p>You can remove these permissions by creating your own VPC, subnet, and firewalls and selecting them during cluster creation. For the VPC to be accepted you will need to associate it with firewall rules with the following constraints:</p> <ul> <li>One firewall rule associated with the VPC must allow ingress communication on all ports for communication between sources with the service account you will attach to the cluster nodes (source and target). To create such a rule, run the following command replacing $NETWORK with the name of your VPC, $SERVICE_ACCOUNT with the email of your service account, and $PROJECT_ID with the id of your project:</li> </ul> <pre><code>gcloud compute firewall-rules create nodetonode --network=$NETWORK --allow=all --direction=INGRESS --target-service-accounts=$SERVICE_ACCOUNT --source-service-accounts=$SERVICE_ACCOUNT --project=$PROJECT_ID\n</code></pre> <ul> <li>We recommend that you have a firewall rule associated with the VPC allowing TCP ingress communication to ports 443 and 80. If you don't have a rule opening port 443 the cluster will not be accessible from the internet. If you don't have a rule opening port 80 your cluster will be created with a self-signed certificate. You will have to acknowledge it by checking the Continue with self-signed certificate check box during subnet selection. Depending on your firewall rules setup at cluster creation managed.hopsworks.ai may not be able to manage services port at run time. In such a case you will have to open and close the ports yourself in the cluster provider. To create this rule, run the following command replacing $NETWORK with the name of your VPC, $SERVICE_ACCOUNT with the email of your service account and $PROJECT_ID with the id of your project:</li> </ul> <pre><code>gcloud compute firewall-rules create inbound --network=$NETWORK --allow=all --direction=INGRESS --target-service-accounts=$SERVICE_ACCOUNT --allow=tcp:80,tcp:443 --source-ranges=\"0.0.0.0/0\" --project=$PROJECT_ID\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#update-firewall","title":"Update Firewall","text":"<p>The following permission is only needed to open and close service ports on the cluster. If you are not intending to open and close these ports from managed.hopsworks.ai you can remove the permission.</p> <pre><code>- compute.firewalls.update\n</code></pre>"},{"location":"setup_installation/gcp/restrictive_permissions/#limiting-the-instances-service-account-permissions","title":"Limiting the Instances Service Account permissions","text":"<p>Some of the permissions set up for the instances service account used during cluster creation (here) can be removed under certain conditions.</p>"},{"location":"setup_installation/gcp/restrictive_permissions/#backups","title":"Backups","text":"<p>If you do not intend to take backups or if you do not have access to this Enterprise feature you can remove the permissions that are only used by the backup feature when configuring your instances service account. For this remove the following permission from your instances service account:</p> <pre><code>  storage.buckets.update\n</code></pre>"},{"location":"setup_installation/on_prem/external_kafka_cluster/","title":"External Kafka cluster","text":"<p>Hopsworks uses Apache Kafka to ingest data to the feature store. Streaming applications and external clients send data to the Kafka cluster for ingestion to the online and offline feature store. By default, Hopsworks comes with an embedded Kafka cluster managed by Hopsworks itself, however, users can configure Hopsworks to leverage an existing external cluster.  This guide will cover how to configure an Hopsworks cluster to leverage an external Kafka cluster.</p>"},{"location":"setup_installation/on_prem/external_kafka_cluster/#configure-the-external-kafka-cluster-integration","title":"Configure the external Kafka cluster integration","text":"<p>To enable the integration with an external Kafka cluster, you should set the <code>enable_bring_your_own_kafka</code> configuration option to <code>true</code>. This can also be achieved in the cluster definition by setting the following attribute:</p> <pre><code>hopsworks:\n  enable_bring_your_own_kafka: \"true\"\n</code></pre>"},{"location":"setup_installation/on_prem/external_kafka_cluster/#online-feature-store-service-configuration","title":"Online Feature Store service configuration","text":"<p>In addition to the configuration changes above, you should also configure the Online Feature Store service (OnlineFS in short) to connect to the external Kafka cluster. This can be achieved by provisioning the necessary credentials for OnlineFS to subscribe and consume messages from Kafka topics used by the Hopsworks feature store.</p> <p>OnlineFs can be configured to use these credentials by adding the following configurations to the cluster definition used to deploy Hopsworks:</p> <pre><code>  onlinefs:\n    config_dir: \"/home/ubuntu/cluster-definitions/byok\"\n    kafka_cosumers:\n      topic_list: \"comma separated list of kafka topics to subscribe to\"\n</code></pre> <p>In particular, the <code>onlinefs/config_dir</code> should contain the credentials necessary for the Kafka consumers to authenticate.  Additionally the directory should contain a file name <code>onlinefs-kafka.properties</code> with the Kafka consumer configuration. The following is an example of the <code>onlinefs-kafka.properties</code> file:</p> <pre><code>bootstrap.servers=cluster_identifier.us-east-2.aws.confluent.cloud:9092\nsecurity.protocol=SASL_SSL\nsasl.jaas.config=org.apache.kafka.common.security.plain.PlainLoginModule required username=\"username\" password=\"password\";\nsasl.mechanism=PLAIN\n</code></pre> <p>Hopsworks will not provision topics</p> <p>Please note that when using an external Kafka cluster, Hopsworks will not provision the topics for the different projects. Users are responsible for provisioning the necessary topics and configure the projects accordingly (see next section). Users should also specify the list of topics OnlineFS should subscribe to by providing the <code>onlinefs/kafka_consumers/topic_list</code> option in the cluster definition.</p>"},{"location":"setup_installation/on_prem/external_kafka_cluster/#project-configuration","title":"Project configuration","text":""},{"location":"setup_installation/on_prem/external_kafka_cluster/#topic-configuration","title":"Topic configuration","text":"<p>As mentioned above, when configuring Hopsworks to use an external Kafka cluster, Hopsworks will not provision the topics for the different projects. Instead, when creating a project, users will be aksed to provide the topic name to use for the feature store operations.</p> <p> Example project creation when using an external Kafka cluster </p>"},{"location":"setup_installation/on_prem/external_kafka_cluster/#storage-connector-configuration","title":"Storage connector configuration","text":"<p>Users should create a Kafka storage connector named <code>kafka_connector</code> which is going to be used by the feature store clients to configure the necessary Kafka producers to send data. The configuration is done for each project to ensure its members have the necessary authentication/authorization. If the storage connector is not found in the project, default values referring to Hopsworks managed Kafka will be used.</p>"},{"location":"setup_installation/on_prem/hopsworks_installer/","title":"Hopsworks On premises","text":"<p>It is possible to use Hopsworks on-premises, which means that companies can run their machine learning workloads on their own hardware and infrastructure, rather than relying on a cloud provider. This can provide greater flexibility, control, and cost savings, as well as enabling companies to meet specific compliance and security requirements.</p> <p>Working on-premises with Hopsworks typically involves collaboration with the Hopsworks engineering teams, as each infrastructure is unique and requires a tailored approach to deployment and configuration. The process begins with an assessment of the company's existing infrastructure and requirements, including network topology, security policies, and hardware specifications.</p> <p>For further details about on-premise installations; contact us.</p>"},{"location":"setup_installation/on_prem/hopsworks_installer/#minimum-requirements","title":"Minimum Requirements","text":"<p>You need at least one server or virtual machine on which Hopsworks will be installed with at least the following specification:</p> <ul> <li>Ubuntu 22.04, Centos or RHEL Linux (Version 8) supported,</li> <li>at least 32GB RAM,</li> <li>at least 8 CPUs,</li> <li>100 GB of free hard-disk space,</li> <li>a UNIX user account with sudo privileges.</li> </ul>"},{"location":"tutorials/","title":"Tutorials","text":"<p>We are happy to welcome you to our collection of tutorials dedicated to exploring the fundamentals of Hopsworks and Machine Learning development. In addition to offering different types of use cases and common subjects in the field, it facilitates navigation and use of models in a production environment using Hopsworks Feature Store.</p>"},{"location":"tutorials/#how-to-run-the-tutorials","title":"How to run the tutorials","text":"<p>In order to run the tutorials, you will need a Hopsworks account. To do so, go to app.hopsworks.ai and create one. With a managed account, just run the Jupyter notebook from within Hopsworks. Generally the notebooks contain the information you will need on how to interact with the Hopsworks Platform.</p> <p>The easiest way to get started is by using Google Colab to run the notebooks. However, you can also run them in your local Python environment with Jupyter. You can find the raw notebook files in our tutorials repository.</p>"},{"location":"tutorials/#fraud-tutorial","title":"Fraud Tutorial","text":"<p>This is a quick-start of the Hopsworks Feature Store; using a fraud use case we will load data into the feature store, create two feature groups from which we will make a training dataset and train a model.</p>"},{"location":"tutorials/#batch","title":"Batch","text":"<p>This is a batch use case variant of the fraud tutorial, it will give you a high level view on how to use our python APIs and the UI to navigate the feature groups.</p> Notebooks 1. How to load, engineer and create feature groups 2. How to create training datasets 3. How to train a model from the feature store"},{"location":"tutorials/#online","title":"Online","text":"<p>This is a online use case variant of the fraud tutorial, it is similar to the batch use case, however, in this tutorial you will get introduced to the usage of Feature Groups which are kept in online storage, and how to access single feature vectors from the online storage at low latency. Additionally, the model will be deployed as a model serving instance, to provide a REST endpoint for real time serving.</p> Notebooks 1. How to load, engineer and create feature groups 2. How to create training datasets 3. How to train a model from the feature store and deploying it as a serving instance together with the online feature store"},{"location":"tutorials/#churn-tutorial","title":"Churn Tutorial","text":"<p>This is a churn tutorial with the Hopsworks feature store and model serving to build a prediction service. In this tutorial you will get introduced to the usage of Feature Groups which are kept in online storage, and how to access single feature vectors from the online storage at low latency. Additionally, the model will be deployed as a model serving instance, to provide a REST endpoint for real time serving.</p> Notebooks 1. How to load, engineer and create feature groups 2. How to create training datasets 3. How to train a model from the feature store and deploying it as a serving instance together with the online feature store"},{"location":"tutorials/#iris-tutorial","title":"Iris Tutorial","text":"<p>In this tutorial you will learn how to create an online prediction service for the Iris flower prediction problem.</p> Notebooks 1. All-in-one notebook, showing how to create the needed feature groups, train the model and deploy it as a serving instance"},{"location":"tutorials/#integration-tutorials","title":"Integration Tutorials","text":"<p>Hopsworks is easily integrated with many tools, especially from the Python world. In this section you will find examples for some popular libraries and services.</p>"},{"location":"tutorials/#great-expectations","title":"Great Expectations","text":"<p>Great Expectations is a library for data validation. You can use Great Expectations within Hopsworks to validate data which is to be inserted into the feature store, in order to ensure that only high-quality features end up in the feature store.</p> Notebooks 1. A brief introduction to Great Expectations concepts which are relevant for integration with the Hopsworks MLOps platform 2. How to integrate Great Expectations seamlessly with your Hopsworks feature pipelines"},{"location":"tutorials/#weights-and-biases","title":"Weights and Biases","text":"<p>Weights and Biases is a developer tool for machine learning model training that with a couple of lines of code let you keep track of hyperparameters, system metrics, and outputs so you can compare experiments, and easily share your findings with colleagues.</p> <p>This tutorial is a variant of the batch fraud tutorial using Weights and Biases for model training, tracking and as model registry.</p> Notebooks 1. How to load, engineer and create feature groups 2. How to create training datasets 3. How to train a model from the feature store and use Weights and Biases to track the process"},{"location":"user_guides/","title":"How-To Guides","text":"<p>This section serves to provide guides and examples for the common usage of abstractions and functionality of the Hopsworks platform through the Hopsworks UI and APIs.</p> <ul> <li>Client Installation: How to get started with the Hopsworks Client libraries.</li> <li>Feature Store: Learn about the common usage of the core Hopsworks Feature Store abstractions, such as Feature Groups, Feature Views, Data Validation and Storage Connectors. Also, learn from the Client Integrations guides how to connect to the Feature Store from external environments such as a local Python environment, Databricks, or AWS Sagemaker</li> <li>MLOps: Learn about the common usage of Hopsworks MLOps abstractions, such as the Model Registry or Model Serving.</li> <li>Projects: The core abstraction on Hopsworks are Projects. Learn in this section how to manage your projects and the services therein.</li> <li>Migration: Learn how to migrate to newer versions of Hopsworks.</li> </ul>"},{"location":"user_guides/client_installation/","title":"Client Installation Guide","text":""},{"location":"user_guides/client_installation/#hopsworks-including-feature-store-and-mlops","title":"Hopsworks (including Feature Store and MLOps)","text":"<p>The Hopsworks client library is required to connect to the Hopsworks Feature Store and MLOps services from your local machine or any other Python environment such as Google Colab or AWS Sagemaker. Execute the following command to install the full Hopsworks client library in your Python environment:</p> <p>Virtual environment</p> <p>It is recommended to use a virtual python environment instead of the system environment used by your operating system, in order to avoid any side effects regarding interfering dependencies.</p> <p><pre><code>pip install hopsworks\n</code></pre> Supported versions of Python: 3.7, 3.8, 3.9, 3.10, 3.11 (PyPI \u2197)</p> <p>OSX Installation</p> <p>On OSX systems you might need to install librdkafka manually before installing hopsworks. You can verify if you have installed it previously using <code>brew info librdkafka</code>. Hopsworks requires <code>librdkafka</code> version to be lower than 2.0.0. If it is not installed yet, you can do so using <code>brew install</code>, however, you always need to set the <code>C_INCLUDE_PATH</code> and <code>LIBRARY_PATH</code>.</p> <p>If not installed yet, install librdkafka: <pre><code>curl -O https://raw.githubusercontent.com/Homebrew/homebrew-core/f7d0f40bbc4075177ecf16812fd95951a723a996/Formula/librdkafka.rb\nbrew install --build-from-source librdkafka.rb\n</code></pre> If it is already installed, set the environment variables and proceed with installing the hopsworks client library: <pre><code>export C_INCLUDE_PATH=$(brew --prefix)/include\nexport LIBRARY_PATH=$(brew --prefix)/lib\npip install hopsworks\n</code></pre></p> <p>Windows/Conda Installation</p> <p>On Windows systems you might need to install twofish manually before installing hopsworks, if you don't have the Microsoft Visual C++ Build Tools installed. In that case, it is recommended to use a conda environment and run the following commands:</p> <pre><code>conda install twofish\nsetx CONDA_DLL_SEARCH_MODIFICATION_ENABLE 1\npip install hopsworks\n</code></pre>"},{"location":"user_guides/client_installation/#feature-store-only","title":"Feature Store only","text":"<p>To only install the Hopsworks Feature Store client library, execute the following command:</p> <p><pre><code>pip install hsfs[python]\n</code></pre> Supported versions of Python: 3.7, 3.8, 3.9, 3.10, 3.11 (PyPI \u2197)</p> <p>OSX Installation</p> <p>On OSX systems you might need to install librdkafka manually before installing hopsworks. You can verify if you have installed it previously using <code>brew info librdkafka</code>. Hopsworks requires <code>librdkafka</code> version to be lower than 2.0.0. If it is not installed yet, you can do so using <code>brew install</code>, however, you always need to set the <code>C_INCLUDE_PATH</code> and <code>LIBRARY_PATH</code>.</p> <p>If not installed yet, install librdkafka: <pre><code>curl -O https://raw.githubusercontent.com/Homebrew/homebrew-core/f7d0f40bbc4075177ecf16812fd95951a723a996/Formula/librdkafka.rb\nbrew install --build-from-source librdkafka.rb\n</code></pre> If it is already installed, set the environment variables and proceed with installing the hopsworks client library: <pre><code>export C_INCLUDE_PATH=$(brew --prefix)/include\nexport LIBRARY_PATH=$(brew --prefix)/lib\npip install hsfs[python]\n</code></pre></p> <p>Windows/Conda Installation</p> <p>On Windows systems you might need to install twofish manually before installing hsfs, if you don't have the Microsoft Visual C++ Build Tools installed. In that case, it is recommended to use a conda environment and run the following commands:</p> <pre><code>conda install twofish\nsetx CONDA_DLL_SEARCH_MODIFICATION_ENABLE 1\npip install hsfs[python]\n</code></pre>"},{"location":"user_guides/client_installation/#next-steps","title":"Next Steps","text":"<p>If you are using a local python environment and want to connect to the Hopsworks Feature Store, you can follow the Python Guide section to create an API Key and to get started.</p>"},{"location":"user_guides/client_installation/#other-environments","title":"Other environments","text":"<p>The Hopsworks Feature Store client libraries can also be installed in external environments, such as Databricks, AWS Sagemaker, or Azure Machine Learning. For more information, see Client Integrations.</p>"},{"location":"user_guides/fs/","title":"Feature Store Guides","text":"<p>This section serves to provide guides and examples for the common usage of abstractions and functionality of the Feature Store through the Hopsworks UI and APIs.</p> <ul> <li>Storage Connectors</li> <li>Feature Groups</li> <li>Feature Views</li> <li>Compute Engines</li> <li>Integrations</li> </ul>"},{"location":"user_guides/fs/compute_engines/","title":"Compute Engines","text":""},{"location":"user_guides/fs/compute_engines/#compute-engines","title":"Compute Engines","text":"<p>In order to execute a feature pipeline to write to the Feature Store, as well as to retrieve data from the Feature Store, you need a compute engine. Hopsworks Feature Store APIs are built around dataframes, that means feature data is inserted into the Feature Store from a Dataframe and likewise when reading data from the Feature Store, it is returned as a Dataframe.</p> <p>As such, Hopsworks supports three computational engines:</p> <ol> <li>Apache Spark: Spark Dataframes and Spark Structured Streaming Dataframes are supported, both from Python environments (PySpark) and from Scala environments.</li> <li>Pandas: For pure Python environments without dependencies on Spark, Hopsworks supports Pandas Dataframes.</li> <li>Apache Flink: Flink Data Streams are currently supported as an experimental feature from Java/Scala environments.</li> <li>Apache Beam experimental: Beam Data Streams are currently supported as an experimental feature from Java/Scala environments.</li> </ol> <p>Hopsworks supports running compute on the platform itself in the form of Jobs or in Jupyter Notebooks. Alternatlively, you can also connect to Hopsworks using Python or Spark from external environments, given that there is network connectivity.</p>"},{"location":"user_guides/fs/compute_engines/#functionality-support","title":"Functionality Support","text":"<p>Hopsworks is aiming to provide funtional parity between the computational engines, however, there are certain Hopsworks functionalities which are exclusive to the engines.</p> Functionality Method Spark Python Flink Beam Comment Feature Group Creation from dataframes <code>FeatureGroup.create_feature_group()</code> - - Currently Flink/Beam doesn't support registering feature group metadata. Thus it needs to be pre-registered before you can write real time features computed by Flink/Beam. Training Dataset Creation from dataframes <code>TrainingDataset.save()</code> - - - Functionality was deprecated in version 3.0 Data validation using Great Expectations for streaming dataframes <code>FeatureGroup.validate()</code> <code>FeatureGroup.insert_stream()</code> - - - - <code>insert_stream</code> does not perform any data validation even when a expectation suite is attached. Stream ingestion <code>FeatureGroup.insert_stream()</code> - Python/Pandas has currently no notion of streaming. Reading from Streaming Storage Connectors <code>KafkaConnector.read_stream()</code> - - - Python/Pandas has currently no notion of streaming. For Flink/Beam only write operations are supported Reading training data from external storage other than S3 <code>FeatureView.get_training_data()</code> - - - Reading training data that was written to external storage using a Storage Connector other than S3 can currently not be read using HSFS APIs, instead you will have to use the storage's native client. Reading External Feature Groups into Dataframe <code>ExternalFeatureGroup.read()</code> - - - Reading an External Feature Group directly into a Pandas Dataframe is not supported, however, you can use the Query API to create Feature Views/Training Data containing External Feature Groups. Read Queries containing External Feature Groups into Dataframe <code>Query.read()</code> - - - Reading a Query containing an External Feature Group directly into a Pandas Dataframe is not supported, however, you can use the Query to create Feature Views/Training Data and write the data to a Storage Connector, from where you can read up the data into a Pandas Dataframe."},{"location":"user_guides/fs/compute_engines/#python","title":"Python","text":""},{"location":"user_guides/fs/compute_engines/#inside-hopsworks","title":"Inside Hopsworks","text":"<p>If you are using Spark or Python within Hopsworks, there is no further configuration required. Head over to the Getting Started Guide.</p>"},{"location":"user_guides/fs/compute_engines/#outside-hopsworks","title":"Outside Hopsworks","text":"<p>Connecting to the Feature Store from any Python environment, such as your local environment or Google Colab, requires setting up an API Key and installing the HSFS Python client library. The Python integration guide explains step by step how to connect to the Feature Store from any Python environment.</p>"},{"location":"user_guides/fs/compute_engines/#spark","title":"Spark","text":""},{"location":"user_guides/fs/compute_engines/#inside-hopsworks_1","title":"Inside Hopsworks","text":"<p>If you are using Spark or Python within Hopsworks, there is no further configuration required. Head over to the Getting Started Guide.</p>"},{"location":"user_guides/fs/compute_engines/#outside-hopsworks_1","title":"Outside Hopsworks","text":"<p>Connecting to the Feature Store from an external Spark cluster, such as Cloudera or Databricks, requires configuring it with the Hopsworks client jars, configuration and certificates. The Spark integration guide explains step by step how to connect to the Feature Store from an external Spark cluster.</p>"},{"location":"user_guides/fs/compute_engines/#flink","title":"Flink","text":""},{"location":"user_guides/fs/compute_engines/#inside-hopsworks_2","title":"Inside Hopsworks","text":"<p>If you are using Flink within Hopsworks, there is no further configuration required. For more details head over to the Getting Started Guide.</p>"},{"location":"user_guides/fs/compute_engines/#outside-hopsworks_2","title":"Outside Hopsworks","text":"<p>Connecting to the Feature Store from an external Flink cluster, such as GCP DataProc or AWS EMR, requires configuring the Hopsworks certificates. The Flink integration guide explains step by step how to connect to the Feature Store from an external Flink cluster.</p>"},{"location":"user_guides/fs/compute_engines/#beam","title":"Beam","text":""},{"location":"user_guides/fs/compute_engines/#inside-hopsworks_3","title":"Inside Hopsworks","text":"<p>Beam is only supported as an external client. </p>"},{"location":"user_guides/fs/compute_engines/#outside-hopsworks_3","title":"Outside Hopsworks","text":"<p>Connecting to the Feature Store from Beam DataFlowRunner, requires configuring the Hopsworks certificates. The Beam integration guide explains step by step how to connect to the Feature Store from Beam Dataflow Runner.</p> <p>Warning</p> <p>Apache Beam integration with Hopsworks feature store was only tested using Dataflow Runner.</p> <p>For more details head over to the Getting Started Guide.</p>"},{"location":"user_guides/fs/feature_group/","title":"Feature Group User Guides","text":"<p>This section serves to provide guides and examples for the common usage of abstractions and functionality of the Feature Group through the Hopsworks UI and APIs.</p> <ul> <li>Create a Feature Group</li> <li>Create an external Feature Group</li> <li>Deprecating Feature Group</li> <li>Data Types and Schema management</li> <li>Statistics</li> <li>Data Validation</li> </ul>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/","title":"Advanced Data Validation Options and Best Practices","text":"<p>The introduction to data vaildation guide can be found here. The notebook example to get started with Data Validation in Hopsworks can be found here.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#data-validation-configuration-options-in-hopsworks","title":"Data Validation Configuration Options in Hopsworks","text":""},{"location":"user_guides/fs/feature_group/advanced_data_validation/#validation-ingestion-policy","title":"Validation Ingestion Policy","text":"<p>Depending on your use case you can setup data validation as a monitoring or gatekeeping tool when trying to insert new data in your Feature Group. Switch behaviour by using the <code>validation_ingestion_policy</code> kwarg:</p> <ul> <li><code>\"ALWAYS\"</code> is the default option and will attempt to insert the data regardless of the validation result. Hassle free, it is ideal to monitor data ingestion in a development setup.</li> <li><code>\"STRICT\"</code> is the best option for production ready projects. This will prevent insertion of DataFrames which do not pass all data quality requirements. Ideal to avoid \"garbage-in, garbage-out\" scenarios, at the price of a potential loss of data. Check out the best practice section for more on that.</li> </ul>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-ui","title":"In the UI","text":"<p>Go to the Feature Group edit page, in the Expectation section you can choose between the options above.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-python-client","title":"In the python client","text":"<pre><code>fg.expectation_suite.validation_ingestion_policy = \"ALWAYS\" # \"STRICT\"\n</code></pre> <p>If your suite is registered with Hopsworks, it will persist the change to the server.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#disable-data-validation","title":"Disable Data Validation","text":"<p>Should you wish to do so, you can disable data validation on a punctual basis or until further notice.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-ui_1","title":"In the UI","text":"<p>You can do it in the UI in the Expectation section of the Feature Group edit page. Simply tick or untick the enabled checkbox. This will be used as the default option but can be overriden via the API.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-python-client_1","title":"In the python client","text":"<p>To disable data validation until further notice in the API, you can update the <code>run_validation</code> field of the expectation suite. If your suite is registered with Hopsworks, this will persist the change to the server.</p> <pre><code>fg.expectation_suite.run_validation = False\n</code></pre> <p>If you wish to override the default behaviour of the suite when inserting data in the Feature Group, you can do so via the <code>validate_options</code> kwarg. The example below will enable validation for this insertion only.</p> <pre><code>fg.insert(df_to_validate, validation_options={\"run_validation\" : True})\n</code></pre> <p>We recommend to avoid using this option in scheduled job as it silently changes the expected behaviour that is displayed in the UI and prevents changes to the default behaviour to change the behaviour of the job.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#edit-expectations","title":"Edit Expectations","text":"<p>The one constant in life is change. If you need to add, remove or edit an expectation you can do it both in the UI or via the python client. Note that changing the expectation type or its corresponding feature will throw an error in order to preserve a meaningful validation history.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-hopworks-ui","title":"In Hopworks UI","text":"<p>Go to the Feature Group edit page, in the expectation section. You can click on the expectation you want to edit and edit the json configuration. Check out Great Expectations documentation if you need more information on a particular expectation.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-hopsworks-python-client","title":"In Hopsworks Python Client","text":"<p>There are several way to edit an Expectation in the python client. You can use Great Expectations API or directly go through Hopsworks. In the latter case, if you want to edit or remove an expectation, you will need the Hopsworks expectation ID. It can be found in the UI or in the meta field of an expectation. Note that you must have inserted data in the FG and attached the expectation suite to enable the Expectation API.</p> <p>Get an expectation with a given id:</p> <pre><code>my_expectation = fg.expectation_suite.get_expectation(\n    expectation_id = my_expectation_id\n)\n</code></pre> <p>Add a new expectation:</p> <pre><code>new_expectation = ge.core.ExpectationConfiguration(\n    expectation_type=\"expect_column_values_not_to_be_null\",\n    kwargs={\n        \"mostly\": 1\n    }\n)\n\nfg.expectation_suite.add_expectation(new_expectation)\n</code></pre> <p>Edit expectation kwargs of an existing expectation :</p> <pre><code>existing_expectation = fg.expectation_suite.get_expectation(\n    expectation_id=existing_expectation_id\n)\n\nexisting_expectation.kwargs[\"mostly\"] = 0.95\n\nfg.expectation_suite.replace_expectation(existing_expectation)\n</code></pre> <p>Remove an expectation:</p> <pre><code>fg.expectation_suite.remove_expectation(\n    expectation_id=id_of_expectation_to_delete\n)\n</code></pre> <p>If you want to deal only with the Great Expectation API:</p> <pre><code>my_suite = fg.get_expectation_suite()\n\nmy_suite.add_expectation(new_expectation)\n\nfg.save_expectation_suite(my_suite)\n</code></pre>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#save-validation-reports","title":"Save Validation Reports","text":"<p>When running validation using Great Expectations, a validation report is generated containing all validation results for the different expectations. Each result provides information about whether the provided DataFrame conforms to the corresponding expectation. These reports can be stored in Hopsworks to save a validation history for the data written to a particular Feature Group.</p> <p>The boilerplate of uploading report on insertion is taken care of by hopsworks, however for custom pipelines we provide an alternative method in the python client. The UI does not currently support upload of a validation report.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-hopsworks-python-client_1","title":"In Hopsworks Python Client","text":"<pre><code>fg.save_validation_report(ge_report)\n</code></pre>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#monitor-and-fetch-validation-reports","title":"Monitor and Fetch Validation Reports","text":"<p>A summary of uploaded reports will then be available via an API call or in the Hopsworks UI enabling easy monitoring. For in-depth analysis, it is possible to download the complete report from the UI.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-hopsworks-ui","title":"In Hopsworks UI","text":"<p>Open the Feature Group overview page and go to the Expectations section. One tab allows you to check the report history with general information, while the other tab allows you to explore a summary of the result for individual expectations.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-hopsworks-python-client_2","title":"In Hopsworks Python Client","text":"<pre><code># convenience method for rapid development\nge_latest_report = fg.get_latest_validation_report()\n# fetching the latest summary prints a link to the UI\n# where you can download full report if summary is insufficient\n\n# or load multiple reports\nvalidation_history = fg.get_validation_reports()\n</code></pre>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#validate-your-data-manually","title":"Validate your data manually","text":"<p>While Hopsworks provides automatic validation on insertion logic, we recognise that some use cases may require a more fine-grained control over the validation process. Therefore, Feature Group objects offers a convenience wrapper around Great Expectations to manually trigger validation using the registered Expectation Suite.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-ui_2","title":"In the UI","text":"<p>You can validate data already ingested in the Feature Group by going to the Feature Group overview page. In the top right corner is a button to trigger a validation. The button will lauch a job which will read the Feature Group data, run validation and persist the associated report.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#in-the-python-client_2","title":"In the python client","text":"<pre><code>ge_report = fg.validate(df, ingestion_result=\"EXPERIMENT\")\n\n# set the save_report parameter to False to skip uploading the report to Hopsworks\n# ge_report = fg.validate(df, save_report=False)\n</code></pre> <p>If you want to apply validation to the data already in the Feature Group you can call the <code>.validate</code> without providing data. It will read the data in the Feature Group.</p> <pre><code>report = fg.validate()\n</code></pre> <p>As validation objects returned by Hopsworks are native Great Expectation objects you can run validation using the usual Great Expectations syntax:</p> <pre><code>ge_df = ge.from_pandas(df, expectation_suite=fg.get_expectation_suite())\nge_report = ge_df.validate()\n</code></pre> <p>Note that you should always use an expectation suite that has been saved to Hopsworks if you intend to upload the associated validation report.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#best-practices","title":"Best Practices","text":"<p>Below is a set of recommendations and code snippets to help our users follow best practices when it comes to integrating a data validation step in your feature engineering pipelines. Rather than being prescriptive, we want to showcase how the API and configuration options can help adapt validation to your use-case.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#development","title":"Development","text":"<p>Data validation is generally considered to be a production-only feature and as such is often only setup once a project has reached the end of the development phase. At Hopsworks, we think there is a lot of value in setting up validation during early development. That's why we made it quick to get started and ensured that by default data validation is never an obstacle to inserting data.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#validate-early","title":"Validate Early","text":"<p>As often with data validation, the best piece of advice is to set it up early in your development process. Use this phase to build a history you can then use when it becomes time to set quality requirements for a project in production. We made a code snippet to help you get started quickly:</p> <pre><code># Load sample data. Replace it with your own!\nmy_data_df = pd.read_csv(\"https://repo.hops.works/master/hopsworks-tutorials/data/card_fraud_data/credit_cards.csv\")\n\n# Use Great Expectation profiler (ignore deprecation warning)\nexpectation_suite_profiled, validation_report = ge.from_pandas(my_data_df).profile(profiler=ge.profile.BasicSuiteBuilderProfiler)\n\n# Create a Feature Group on hopsworks with an expectation suite attached. Don't forget to change the primary key!\nmy_validated_data_fg = fs.get_or_create_feature_group(\n    name=\"my_validated_data_fg\",\n    version=1,\n    description=\"My data\",\n    primary_key=['cc_num'],\n    expectation_suite=expectation_suite_profiled)\n</code></pre> <p>Any data you insert in the Feature Group from now will be validated and a report will be uploaded to Hopsworks.</p> <pre><code># Insert and validate your data\ninsert_job, validation_report = my_validated_data_fg.insert(my_data_df)\n</code></pre> <p>Great Expectations profiler can inspect your data to build a standard Expectation Suite. You can attach this Expectation Suite directly when creating your Feature Group to make sure every piece of data finding its way in Hopsworks gets validated. Hopsworks will default to its <code>\"ALWAYS\"</code> ingestion policy, meaning data are ingested whether validation succeeds or not. This way data validation is not a barrier, just a monitoring tool.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#identify-unreliable-features","title":"Identify Unreliable Features","text":"<p>Once you setup data validation, every insertion will upload a validation report to Hopsworks. Identifying Features which often have null values or wild statistical variations can help detecting unreliable Features that need refinements or should be avoided. Here are a few expectations you might find useful:</p> <ul> <li><code>expect_column_values_to_not_be_null</code></li> <li><code>expect_column_(min/max/mean/stdev)_to_be_between</code></li> <li><code>expect_column_values_to_be_unique</code></li> </ul>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#get-the-stakeholders-involved","title":"Get the stakeholders involved","text":"<p>Hopsworks UI helps involve every project stakeholder by enabling both setting and monitoring of data quality requirements. No coding skills needed! You can monitor data quality requirements by checkint out the validation reports and results on the Feature Group page.</p> <p>If you need to set or edit the existing requirements, you can go on the Feature Group edit page. The Expectation suite section allows you to edit individual expectations and set success parameters that match ever changing business requirements.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#production","title":"Production","text":"<p>Models in production require high-quality data to make accurate predictions for your customers. Hopsworks can use your Expectation Suite as a gatekeeper to make it simple to prevent low-quality data to make its way into production. Below are some simple tips and snippets to make the most of your data validation when your project is ready to enter its production phase.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#be-strict-in-production","title":"Be Strict in Production","text":"<p>Whether you use an existing or create a new (recommended) Feature Group for production, we recommend you set the validation ingestion policy of your Expectation Suite to <code>\"STRICT\"</code>.</p> <pre><code>fg_prod.save_expectation_suite(\n    my_suite,\n    validation_ingestion_policy=\"STRICT\")\n</code></pre> <p>In this setup, Hopsworks will abort inserting a DataFrame that does not successfully fullfill all expectations in the attached Expectation Suite. This ensures data quality standards are upheld for every insertion and provide downstream users with strong guarantees.</p>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#avoid-data-loss-on-materialization-jobs","title":"Avoid Data Loss on materialization jobs","text":"<p>Aborting insertions of DataFrames which do not satisfy the data quality standards can lead to data loss in your materialization job. To avoid such loss we recommend creating a duplicate Feature Group with the same Expectation Suite in <code>\"ALWAYS\"</code> mode which will hold the rejected data.</p> <pre><code>job, report = fg_prod.insert(df)\n\nif report[\"success\"] is False:\n    job, report = fg_rejected.insert(df)\n</code></pre>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#take-advantage-of-the-validation-history","title":"Take Advantage of the Validation History","text":"<p>You can easily retrieve the validation history of a specific expectation to export it to your favourite visualisation tool. You can filter on time and on whether insertion was successful or not</p> <pre><code>validation_history = fg.get_validation_history(\n    expectation_id=my_id,\n    filters=[\"REJECTED\", \"UNKNOWN\"],\n    ge_type=False\n)\n\ntimeseries = pd.DataFrame(\n    {\n        \"observed_value\": [res.result[\"observed_value\"] for res in validation_histoy]],\n        \"validation_time\": [res.validation_time for res in validation_history]\n    }\n)\n\n# export to your preferred Dashboard\n</code></pre>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#setup-alerts","title":"Setup Alerts","text":"<p>While checking your feature engineering pipeline executed properly in the morning can be good enough in the development phase, it won't make the cut for demanding production use-cases. In Hopsworks, you can setup alerts if ingestion fails or succeeds.</p> <p>First you will need to configure your preferred communication endpoint: slack, email or pagerduty. Check out this page for more information on how to set it up. A typical use-case would be to add an alert on ingestion success to a Feature Group you created to hold data that failed validation. Here is a quick walkthrough:</p> <ol> <li>Go the Feature Group page in the UI</li> <li>Scroll down and click on the <code>Add an alert</code> button.</li> <li>Choose the trigger, receiver and severity and click save.</li> </ol>"},{"location":"user_guides/fs/feature_group/advanced_data_validation/#conclusion","title":"Conclusion","text":"<p>Hopsworks completes Great Expectation by automatically running the validation, persisting the reports along your data and allowing you to monitor data quality in its UI. How you decide to make use of these tools depends on your application and requirements. Whether in development or in production, real-time or batch, we think there is configuration that will work for your team. Check out our quick hands-on tutorial to start applying what you learned so far.</p>"},{"location":"user_guides/fs/feature_group/create/","title":"How to create a Feature Group","text":""},{"location":"user_guides/fs/feature_group/create/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to create and register a feature group with Hopsworks. This guide covers creating a feature group using the HSFS APIs as well as the user interface.</p>"},{"location":"user_guides/fs/feature_group/create/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide we suggest you read the Feature Group concept page to understand what a feature group is and how it fits in the ML pipeline.</p>"},{"location":"user_guides/fs/feature_group/create/#create-using-the-hsfs-apis","title":"Create using the HSFS APIs","text":"<p>To create a feature group using the HSFS APIs, you need to provide a Pandas or Spark DataFrame. The DataFrame will contain all the features you want to register within the feature group, as well as the primary key, event time and partition key.</p>"},{"location":"user_guides/fs/feature_group/create/#create-a-feature-group","title":"Create a Feature Group","text":"<p>The first step to create a feature group is to create the API metadata object representing a feature group. Using the HSFS API you can execute:</p>"},{"location":"user_guides/fs/feature_group/create/#batch-write-api","title":"Batch Write API","text":"PySpark <pre><code>fg = feature_store.create_feature_group(name=\"weather\",\n    version=1,\n    description=\"Weather Features\",\n    online_enabled=True,\n    primary_key=['location_id'],\n    partition_key=['day'],\n    event_time='event_time',\n)\n</code></pre> <p>The full method documentation is available here. <code>name</code> is the only mandatory parameter of the <code>create_feature_group</code> and represents the name of the feature group. </p> <p>In the example above we created the first version of a feature group named weather, we provide a description to make it searchable to the other project members, as well as making the feature group available online. </p> <p>Additionally we specify which columns of the DataFrame will be used as primary key, partition key and event time. Composite primary key and multi level partitioning is also supported. </p> <p>The version number is optional, if you don't specify the version number the APIs will create a new version by default with a version number equals to the highest existing version number plus one. </p> <p>The last parameter used in the examples above is <code>stream</code>. The <code>stream</code> parameter controls whether to enable the streaming write APIs to the online and offline feature store. When using the APIs in a Python environment this behavior is the default and it requires the time travel format to be set to 'HUDI'.  </p>"},{"location":"user_guides/fs/feature_group/create/#primary-key","title":"Primary key","text":"<p>A primary key is required when using the default Hudi file format to store offline feature data. When inserting data in a feature group on the offline feature store, the DataFrame you are writing is checked against the existing data in the feature group. If a row with the same primary key is found in the feature group, the row will be updated. If the primary key is not found, the row is appended to the feature group. When writing data on the online feature store, existing rows with the same primary key will be overwritten by new rows with the same primary key.</p>"},{"location":"user_guides/fs/feature_group/create/#event-time","title":"Event time","text":"<p>The event time column represents the time at which the event was generated. For example, with transaction data, the event time is the time at which a given transaction happened.  In the context of feature pipelines, the event time is often also the end timestamp of the interval of events included in the feature computation. For example, computing the feature \"number of purchases by customer last week\", the event time should be the last day of this \"last week\" window.</p> <p>The event time is added to the primary key when writing to the offline feature store. This will make sure that the offline feature store has the entire history of feature values over time. As an example, if a user has made multiple purchases on a website, each of the purchases for a given user (identified by a user_id) will be saved in the feature group, with each purchase having a different event time (the combination of user_id and event_time makes up the primary key for the offline feature store).</p> <p>The event time is not part of the primary key when writing to the online feature store. This will ensure that the online feature store has the most recent version of the feature vector for each primary key.</p> <p>Event time data type restriction</p> <p>The supported data types for the event time column are: <code>timestamp</code>, <code>date</code> and <code>bigint</code>.</p>"},{"location":"user_guides/fs/feature_group/create/#partition-key","title":"Partition key","text":"<p>It is best practice to add a partition key. When you specify a partition key, the data in the feature group will be stored under multiple directories based on the value of the partition column(s). All the rows with a given value as partition key will be stored in the same directory. </p> <p>Choosing the correct partition key has significant impact on the query performance as the execution engine (Spark) will be able to skip listing and reading files belonging to partitions which are not included in the query.  As an example, if you have partitioned your feature group by day and you are creating a training dataset that includes only the last year of data, Spark will read only 365 partitions and not the entire history of data. On the other hand, if the partition key is too fine grained (e.g. timestamp at millisecond resolution) - a large number of small partitions will be generated. This will slow down query execution as Spark will need to list and read a large amount of small directories/files.</p> <p>If you do not provide a partition key, all the feature data will be stored as files in a single directory. The system has a limit of 10240 direct children (files or other subdirectories) per directory. This means that, as you add new data to a non-partitioned feature group, new files will be created and you might reach the limit. If you do reach the limit, your feature engineering pipeline will fail with the following error:</p> <pre><code>MaxDirectoryItemsExceededException - The directory item limit is exceeded: limit=10240 items=10240\n</code></pre> <p>By using partitioning the system will write the feature data in different subdirectories, thus allowing you to write 10240 files per partition.</p>"},{"location":"user_guides/fs/feature_group/create/#streaming-write-api","title":"Streaming Write API","text":"<p>As explained above, the stream parameter controls whether to enable the streaming write APIs to the online and offline feature store. For Python environments, only the stream API is supported (stream=True).</p> PythonPySpark <pre><code>fg = feature_store.create_feature_group(name=\"weather\",\n    version=1,\n    description=\"Weather Features\",\n    online_enabled=True,\n    primary_key=['location_id'],\n    partition_key=['day'],\n    event_time='event_time'\n)\n</code></pre> <pre><code>fg = feature_store.create_feature_group(name=\"weather\",\n    version=1,\n    description=\"Weather Features\",\n    online_enabled=True,\n    primary_key=['location_id'],\n    partition_key=['day'],\n    event_time='event_time',\n    stream=True\n)\n</code></pre> <p>When using the streaming API, the data will be written directly to the online storage (if <code>online_enabled=True</code>). However, you can control when the sync to the offline storage is going to happen. You can do it synchronously after every call to <code>fg.insert()</code>, which is the default. Often, you defer writes to a later point in order to batch together multiple writes to the offline storage (useful to reduce the overhead of many small writes):</p> <pre><code># run multiple inserts without starting the offline materialization job\njob, _ = fg.insert(df1, write_options={\"start_offline_materialization\": False})\njob, _ = fg.insert(df2, write_options={\"start_offline_materialization\": False})\njob, _ = fg.insert(df3, write_options={\"start_offline_materialization\": False})\n\n# start the materialization job for all three inserts\n# note the job object is always the same, you don't need to call it three times\njob.run()\n</code></pre> <p>It is also possible to define the topics used for data ingestion, this can be done by setting the <code>topic_name</code> parameter with your preferred value. By default, feature groups in hopsworks will share a project-wide topic.</p>"},{"location":"user_guides/fs/feature_group/create/#best-practices-for-writing","title":"Best Practices for Writing","text":"<p>When designing a feature group, it is worth taking a look at how this feature group will be queried in the future, in order to optimize it for those query patterns. At the same time, Spark and Hudi tend to overpartition writes, creatingtoo many small parquet files, which is inefficient and slowing down the write. But they also slow down queries, because file listings are taking more time, but also reading many small files is usually slower. The best practices described in this section hold both for the Streaming API and the Batch API.</p> <p>Four main considerations influence the write and the query performance:</p> <ol> <li>Partitioning on a feature group level</li> <li>Parquet file size within a feature group partition</li> <li>Backfilling of feature group partitions</li> <li>The choice of topic for data ingestion</li> </ol>"},{"location":"user_guides/fs/feature_group/create/#partitioning-on-a-feature-group-level","title":"Partitioning on a feature group level","text":"<p>Partitioning on the feature group level allows Hopsworks and Hudi to push down filters to the filesystem during training dataset or batch data generation. In practice that means, less directories need to be listed and less files need to be read, speeding up queries.</p> <p>For example, most commonly, filtering is done on the event time column of a feature group when generating training data or batches of data: <pre><code>query = fg.select_all()\n\n# create a simple feature view\nfv = fs.create_feature_view(\n    name='transactions_view',\n    query=query\n)\n\n# set up dates\nstart_time = \"2022-01-01\"\nend_time = \"2022-06-30\"\n\n# create a training dataset\nversion, job = feature_view.create_training_data(\n    start_time=start_time,\n    end_time=end_time,\n    description='Description of a dataset',\n)\n</code></pre></p> <p>Assuming the feature group was partitioned by a daily event time column, for example, the features are updated with a daily batch job, the feature store will only have to list and read the files in the directories of those six months that are being queried.</p> <p>Too granular event time columns</p> <p>An event time column which is too granular, such as a timestamp, shouldn't be used as partition key. For example, a streaming pipeline generating features where the event time includes seconds, and therefore almost all event timestamps are unique can lead to many partition directories and small files, each of which contains only a few number of rows, which are inefficient to query even with pushed down filters.</p> <p>A good practice are partition keys with at most daily granularity, if they are based on time. Additionally, one can look at the size of a partition directory, which should be in the 100s of MB.</p> <p>Additionally, if you are commonly training models for different categories of your data, you can add another level of partitioning for this. That is, if the query contains an additional filter: <pre><code>query = fg.select_all().filter(fg.country_code == \"US\")\n</code></pre></p> <p>The feature group can be created with the following partition key in order to push down filters also for the <code>country_code</code> category: <pre><code>fg = feature_store.create_feature_group(...\n    partition_key=['day', 'country_code'],\n    event_time='day',\n)\n</code></pre></p>"},{"location":"user_guides/fs/feature_group/create/#parquet-file-size-within-a-feature-group-partition","title":"Parquet file size within a feature group partition","text":"<p>Once you have decided on the feature group level partitioning and you start inserting data to the feature group, there are multiple ways in order to influence how Hudi will split the data between parquet files within the feature group partitions. The two things that influence the number of parquet files per partition are</p> <ol> <li>The number of feature group partitions written in a single insert</li> <li>The shuffle parallelism used by Hudi</li> </ol> <p>In general, the inserted dataframe (unique combination of partition key values) will be parallised according to the following Hudi settings:</p> <p>Default Hudi partitioning</p> <pre><code>write_options = {\n    'hoodie.bulkinsert.shuffle.parallelism': 5,\n    'hoodie.insert.shuffle.parallelism': 5,\n    'hoodie.upsert.shuffle.parallelism': 5\n}\n</code></pre> <p>That means, using Spark, Hudi shuffles the data into five in-memory partitions, which each fill map to a task and finally a parquet file (see figure below). If the inserted Dataframe contains only a single feature group partition, this feature group partition will be written with five parquet files. If the inserted Dataframe contains multiple feature group partitions, the parquet files will be split among those partition, potentially more parquet files will be added.</p> <p> </p> Mapping in-memory partitions to tasks, workers, executors and feature group partition files for a feature group insert <p>Setting shuffle parallelism</p> <p>In practice that means the shuffle parallelism should be set equal to the number of feature group partitions in the inserted dataframe. This will create one parquet file per feature group partition, which in many cases is optimal.</p> <p>Theoretically, this rule holds up to a partition size of 2GB, which is the limit of Spark. However, one should bump this up accordingly already for smaller inputs. We recommend having shuffle parallelism <code>hoodie.[insert|upsert|bulkinsert].shuffle.parallelism</code> such that its at least input_data_size/500MB.</p> <p>You can change the write options on every insert, depending also on the size of the data you are writing: <pre><code>write_options = {\n    'hoodie.bulkinsert.shuffle.parallelism': 5,\n    'hoodie.insert.shuffle.parallelism': 5,\n    'hoodie.upsert.shuffle.parallelism': 5\n}\nfg.insert(df, write_options=write_options)\n</code></pre></p>"},{"location":"user_guides/fs/feature_group/create/#backfilling-of-feature-group-partitions","title":"Backfilling of feature group partitions","text":"<p>Hudi scales well with the number of partitions to write, when performing backfilling of old feature partitions, meaning moving backwards in time with the event-time, it makes sense to batch those feature group partitions together into a single <code>fg.insert()</code> call. As shown in the figure above, the number of utilised executors you choose for the insert depends highly on the number of partitions and shuffle parallelism you are writing. So by writing multiple feature group partitions in a single insert, you can scale up your Spark application and fully utilise the workers. In that case you can increase the Hudi shuffle parallelism accordingly.</p> <p>Concurrent feature group inserts</p> <p>Hopsworks 3.1 and earlier, currently does not support concurrent inserts to feature groups. This means that if your feature pipeline writes to one feature group partition at a time, you cannot run it multiple times in parallel for backfilling.</p> <p>The recommended approach is to unionise the dataframes and insert them with a single <code>fg.insert()</code> instead. For clients that write with the Stream API, it is enough to defer starting the backfill job until after multiple inserts, as described above.</p>"},{"location":"user_guides/fs/feature_group/create/#the-choice-of-topic-for-data-ingestion","title":"The choice of topic for data ingestion","text":"<p>When creating a feature group that uses streaming write APIs for data ingestion it is possible to define the Kafka topics that should be utilized. The default approach of using a project-wide topic functions great for use cases involving little to no overlap when producing data. However, concurrently inserting into multiple feature groups could cause read amplification for the Hudi delta streamer job. Therefore, it is advised to utilize separate topics when ingestions overlap or there is a large frequently running insertion into a specific feature group.</p>"},{"location":"user_guides/fs/feature_group/create/#register-the-metadata-and-save-the-feature-data","title":"Register the metadata and save the feature data","text":"<p>The snippet above only created the metadata object on the Python interpreter running the code. To register the feature group metadata and to save the feature data with Hopsworks, you should invoke the <code>insert</code> method:</p> <pre><code>fg.insert(df)\n</code></pre> <p>The save method takes in input a Pandas or Spark DataFrame. HSFS will use the DataFrame columns and types to determine the name and types of features, primary key, partition key and event time. </p> <p>The DataFrame must contain the columns specified as primary keys, partition key and event time in the <code>create_feature_group</code> call.</p> <p>If a feature group is online enabled, the <code>insert</code> method will store the feature data to both the online and offline storage.</p>"},{"location":"user_guides/fs/feature_group/create/#api-reference","title":"API Reference","text":"<p>FeatureGroup</p>"},{"location":"user_guides/fs/feature_group/create/#create-using-the-ui","title":"Create using the UI","text":"<p>You can also create a new feature group through the UI. For this, navigate to the <code>Feature Groups</code> section and press the <code>Create</code> button at the top-right corner.</p> <p> </p> <p>Subsequently, you will be able to define its properties (such as name, mode, features, and more). Refer to the documentation above for an explanation of the parameters available, they are the same as when you create a feature group using the SDK. Finally, complete the creation by clicking <code>Create New Feature Group</code> at the bottom of the page.</p> <p> </p>"},{"location":"user_guides/fs/feature_group/create_external/","title":"How to create an External Feature Group","text":""},{"location":"user_guides/fs/feature_group/create_external/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to create and register an external feature group with Hopsworks. This guide covers creating an external feature group using the HSFS APIs as well as the user interface.</p>"},{"location":"user_guides/fs/feature_group/create_external/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide we suggest you read the External Feature Group concept page to understand what a feature group is and how it fits in the ML pipeline.</p>"},{"location":"user_guides/fs/feature_group/create_external/#create-using-the-hsfs-apis","title":"Create using the HSFS APIs","text":""},{"location":"user_guides/fs/feature_group/create_external/#retrieve-the-storage-connector","title":"Retrieve the storage connector","text":"<p>To create an external feature group using the HSFS APIs you need to provide an existing storage connector.</p> Python <pre><code>connector = feature_store.get_storage_connector(\"connector_name\")\n</code></pre>"},{"location":"user_guides/fs/feature_group/create_external/#create-an-external-feature-group","title":"Create an External Feature Group","text":"<p>The first step is to instantiate the metadata through the <code>create_external_feature_group</code> method. Once you have defined the metadata, you can  persist the metadata and create the feature group in Hopsworks by calling <code>fg.save()</code>.</p>"},{"location":"user_guides/fs/feature_group/create_external/#sql-based-external-feature-group","title":"SQL based external feature group","text":"Python <pre><code>query = \"\"\"\n    SELECT TO_NUMERIC(ss_store_sk) AS ss_store_sk\n        , AVG(ss_net_profit) AS avg_ss_net_profit\n        , SUM(ss_net_profit) AS total_ss_net_profit \n        , AVG(ss_list_price) AS avg_ss_list_price\n        , AVG(ss_coupon_amt) AS avg_ss_coupon_amt\n        , sale_date\n        , ss_store_sk\n    FROM STORE_SALES\n    GROUP BY ss_store_sk, sales_date\n\"\"\"\n\nfg = feature_store.create_external_feature_group(name=\"sales\",\n    version=1,\n    description=\"Physical shop sales features\",\n    query=query,\n    storage_connector=connector,\n    primary_key=['ss_store_sk'],\n    event_time='sale_date'\n)\n\nfg.save()\n</code></pre>"},{"location":"user_guides/fs/feature_group/create_external/#data-lake-based-external-feature-group","title":"Data Lake based external feature group","text":"Python <pre><code>fg = feature_store.create_external_feature_group(name=\"sales\",\n    version=1,\n    description=\"Physical shop sales features\",\n    data_format=\"parquet\",\n    storage_connector=connector,\n    primary_key=['ss_store_sk'],\n    event_time='sale_date'\n)\n\nfg.save()\n</code></pre> <p>The full method documentation is available here. <code>name</code> is a mandatory parameter of the <code>create_external_feature_group</code> and represents the name of the feature group.</p> <p>The version number is optional, if you don't specify the version number the APIs will create a new version by default with a version number equals to the highest existing version number plus one.</p> <p>If the storage connector is defined for a data warehouse (e.g. JDBC, Snowflake, Redshift) you need to provide a SQL statement that will be executed to compute the features. If the storage connector is defined for a data lake, the location of the data as well as the format need to be provided.</p> <p>Additionally we specify which columns of the DataFrame will be used as primary key, and event time. Composite primary keys are also supported. </p>"},{"location":"user_guides/fs/feature_group/create_external/#register-the-metadata","title":"Register the metadata","text":"<p>In the snippet above it's important that the created metadata object gets registered in Hopsworks. To do so, you should invoke the <code>save</code> method:</p> Python <pre><code>fg.save()\n</code></pre>"},{"location":"user_guides/fs/feature_group/create_external/#enable-online-storage","title":"Enable online storage","text":"<p>You can enable online storage for external feature groups, however, the sync from the external storage to Hopsworks online storage is not automatic and needs to be setup manually. For an external feature group to be available online, during the creation of the feature group, the <code>online_enabled</code> option needs to be set to <code>True</code>.</p> Python <pre><code>external_fg = fs.create_external_feature_group(\n            name=\"sales\",\n            version=1,\n            description=\"Physical shop sales features\",\n            query=query,\n            storage_connector=connector,\n            primary_key=['ss_store_sk'],\n            event_time='sale_date',\n            online_enabled=True)\nexternal_fg.save()\n\n# read from external storage and filter data to sync to online\ndf = external_fg.read().filter(external_fg.customer_status == \"active\")\n\n# insert to online storage\nexternal_fg.insert(df)\n</code></pre> <p>The <code>insert()</code> method takes a DataFrame as parameter and writes it only to the online feature store. Users can select which subset of the feature group data they want to make available on the online feautre store by using the query APIs.</p>"},{"location":"user_guides/fs/feature_group/create_external/#limitations","title":"Limitations","text":"<p>Hopsworks Feature Store does not support time-travel queries on external feature groups.</p> <p>Additionally, support for <code>.read()</code> and <code>.show()</code> methods when using by the Python engine is limited to external feature groups defined on BigQuery and Snowflake and only when using the Feature Query Service. Nevertheless, external feature groups defined top of any storage connector can be used to create a training dataset from a Python environment invoking one of the following methods: create_training_data, create_train_test_split or the create_train_validation_test_split</p>"},{"location":"user_guides/fs/feature_group/create_external/#api-reference","title":"API Reference","text":"<p>External FeatureGroup</p>"},{"location":"user_guides/fs/feature_group/create_external/#create-using-the-ui","title":"Create using the UI","text":"<p>You can also create a new feature group through the UI. For this, navigate to the <code>Feature Groups</code> section and press the <code>Create</code> button at the top-right corner.</p> <p> </p> <p>Subsequently, you will be able to define its properties (such as name, mode, features, and more). Refer to the documentation above for an explanation of the parameters available, they are the same as when you create a feature group using the SDK. Finally, complete the creation by clicking <code>Create New Feature Group</code> at the bottom of the page.</p> <p> </p>"},{"location":"user_guides/fs/feature_group/create_spine/","title":"How to create Spine Group","text":""},{"location":"user_guides/fs/feature_group/create_spine/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to create and register a Spine Group with Hopsworks.</p>"},{"location":"user_guides/fs/feature_group/create_spine/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide we suggest you read the Spine Group concept page to understand what a Spine Group is and how it fits in the ML pipeline.</p>"},{"location":"user_guides/fs/feature_group/create_spine/#create-using-the-hsfs-apis","title":"Create using the HSFS APIs","text":""},{"location":"user_guides/fs/feature_group/create_spine/#create-a-spine-group","title":"Create a Spine Group","text":"<p>Instead of using a feature group to save the label, you can also use a spine to use a Dataframe containing the labels on the fly. A spine is essentially a metadata object similar to a Feature Group, which tells the feature store the relevant event time column and primary key columns to perform point-in-time correct joins.</p> <p>Additionally, apart from primary key and event time information, a Spark dataframe is required in order to infer the schema of the group from.</p> Python <pre><code>trans_spine = fs.get_or_create_spine_group(\n    name=\"spine_transactions\",\n    version=1,\n    description=\"Transaction data\",\n    primary_key=['cc_num'],\n    event_time='datetime',\n    dataframe=trans_df\n)\n</code></pre> <p>Once created, note that you can inspect the dataframe in the Spine Group:</p> Python <pre><code>trans_spine.dataframe.show()\n</code></pre> <p>And you can always also replace the dataframe contained within the Spine Group. You just need to make sure it has the same schema.</p> Python <pre><code>trans_spine.dataframe = new_df\n</code></pre>"},{"location":"user_guides/fs/feature_group/create_spine/#limitations","title":"Limitations","text":"<p>Python support</p> <p>Currently the HSFS library does not support usage of Spine Groups for training data creation or batch data retrieval in the Python engine. However, it is supported to create Spine Groups from the Python engine.</p>"},{"location":"user_guides/fs/feature_group/create_spine/#api-reference","title":"API Reference","text":"<p>SpineGroup</p>"},{"location":"user_guides/fs/feature_group/data_types/","title":"How to manage schema and feature data types","text":""},{"location":"user_guides/fs/feature_group/data_types/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to manage the feature group schema and control the data type of the features in a feature group.</p>"},{"location":"user_guides/fs/feature_group/data_types/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide we suggest you read the Feature Group concept page to understand what a feature group is and how it fits in the ML pipeline.  We also suggest you familiarize yourself with the APIs to create a feature group.</p>"},{"location":"user_guides/fs/feature_group/data_types/#feature-group-schema","title":"Feature group schema","text":"<p>When a feature is stored in both the online and offline feature stores, it will be stored in a data type native to each store.</p> <ul> <li>Offline data type: The data type of the feature when stored on the offline feature store. The offline feature store is based on Apache Hudi and Hive Metastore, as such,   Hive Data Types can be leveraged.</li> <li>Online data type: The data type of the feature when stored on the online feature store. The online storage is based on RonDB and hence,   MySQL Data Types can be leveraged. </li> </ul> <p>The offline data type is always required, even if the feature group is stored only online. On the other hand, if the feature group is not online_enabled, its features will not have an online data type.</p> <p>The offline and online types for each feature are automatically inferred from the Spark or Pandas types of the input DataFrame as outlined in the following two sections. The default mapping, however, can be overwritten by using an explicit schema definition.</p>"},{"location":"user_guides/fs/feature_group/data_types/#offline-data-types","title":"Offline data types","text":"<p>When registering a Spark DataFrame in a PySpark environment (S), or a Pandas DataFrame in a Python-only environment (P) the following default mapping to offline feature types applies:</p> Spark Type (S) Pandas Type (P) Offline Feature Type Remarks BooleanType bool, object(bool) BOOLEAN ByteType int8, Int8 TINYINT or INT INT when time_travel_type=\"HUDI\" ShortType uint8, int16, Int16 SMALLINT or INT INT when time_travel_type=\"HUDI\" IntegerType uint16, int32, Int32 INT LongType int, uint32, int64, Int64 BIGINT FloatType float, float16, float32 FLOAT DoubleType float64 DOUBLE DecimalType decimal.decimal DECIMAL(PREC, SCALE) Not supported in PO env. when time_travel_type=\"HUDI\" TimestampType datetime64[ns], datetime64[ns, tz] TIMESTAMP s. Timestamps and Timezones DateType object (datetime.date) DATE StringType object (str), object(np.unicode) STRING ArrayType object (list), object (np.ndarray) ARRAY&lt;TYPE&gt; StructType object (dict) STRUCT&lt;NAME: TYPE, ...&gt; BinaryType object (binary) BINARY MapType - MAP&lt;String,TYPE&gt; Only when time_travel_type!=\"HUDI\"; Only string keys permitted <p>When registering a Pandas DataFrame in a PySpark environment (S) the Pandas DataFrame is first converted to a Spark DataFrame, using Spark's default conversion. It results in a less fine-grained mapping between Python and Spark types:</p> Pandas Type (S) Spark Type Remarks bool BooleanType int8, uint8, int16, uint16, int32, int, uint32, int64 LongType float, float16, float32, float64 DoubleType object (decimal.decimal) DecimalType datetime64[ns], datetime64[ns, tz] TimestampType s. Timestamps and Timezones object (datetime.date) DateType object (str), object(np.unicode) StringType object (list), object (np.ndarray) - Not supported object (dict) StructType object (binary) BinaryType"},{"location":"user_guides/fs/feature_group/data_types/#online-data-types","title":"Online data types","text":"<p>The online data type is determined based on the offline type according to the following mapping, regardless of which environment the data originated from.  Only a subset of the data types can be used as primary key, as indicated in the table as well:</p> Offline Feature Type Online Feature Type Primary Key Remarks BOOLEAN TINYINT x TINYINT TINYINT x SMALLINT SMALLINT x INT INT x Also supports: TINYINT, SMALLINT BIGINT BIGINT x FLOAT FLOAT DOUBLE DOUBLE DECIMAL(PREC, SCALE) DECIMAL(PREC, SCALE) e.g. DECIMAL(38, 18) TIMESTAMP TIMESTAMP s. Timestamps and Timezones DATE DATE x STRING VARCHAR(100) x Also supports: TEXT ARRAY&lt;TYPE&gt; VARBINARY(100) x Also supports: BLOB STRUCT&lt;NAME: TYPE, ...&gt; VARBINARY(100) x Also supports: BLOB BINARY VARBINARY(100) x Also supports: BLOB MAP&lt;String,TYPE&gt; VARBINARY(100) x Also supports: BLOB <p>More on how Hopsworks handles string types,  complex data types and the online restrictions for primary keys and row size in the following sections.</p>"},{"location":"user_guides/fs/feature_group/data_types/#string-online-data-types","title":"String online data types","text":"<p>String types are stored as VARCHAR(100) by default. This type is fixed-size, meaning it can only hold as many characters as specified in the argument (e.g. VARCHAR(100) can hold up to 100 unicode characters). The size should thus be within the maximum string length of the input data. Furthermore, the VARCHAR size has to be in line with the online restrictions for row size.</p> <p>If the string size exceeds 100 characters, a larger type (e.g. VARCHAR(500)) can be specified via an explicit schema definition.  If the string size is unknown or if it exceeds the maximum row size, then the TEXT type can be used instead.</p> <p>String data that exceeds the specified VARCHAR size will lead to an error when data gets written to the online feature store. When in doubt, use the TEXT type instead, but note that it comes with a potential performance overhead.</p>"},{"location":"user_guides/fs/feature_group/data_types/#complex-online-data-types","title":"Complex online data types","text":"<p>Hopsworks allows users to store complex types (e.g. ARRAY) in the online feature store. Hopsworks serializes the complex features transparently and stores them as VARBINARY in the online feature store. The serialization happens when calling the save(),  insert() or insert_stream() methods.  The deserialization will be executed when calling the get_serving_vector() method to retrieve data from the online feature store. If users query directly the online feature store, for instance using the <code>fs.sql(\"SELECT ...\", online=True)</code> statement, it will return a binary blob.  <p>On the feature store UI, the online feature type for complex features will be reported as VARBINARY.</p> <p>If the binary size exceeds 100 bytes, a larger type (e.g. VARBINARY(500)) can be specified via an explicit schema definition. If the binary size is unknown of if it exceeds the maximum row size, then the BLOB type can be used instead.</p> <p>Binary data that exceeds the specified VARBINARY size will lead to an error when data gets written to the online feature store. When in doubt, use the BLOB type instead, but note that it comes with a potential performance overhead.</p>"},{"location":"user_guides/fs/feature_group/data_types/#online-restrictions-for-primary-key-data-types","title":"Online restrictions for primary key data types","text":"<p>When a feature is being used as a primary key, certain types are not allowed.  Examples of such types are FLOAT, DOUBLE, TEXT and BLOB.  Additionally, the size of the sum of the primary key online data types storage requirements should not exceed 4KB.</p>"},{"location":"user_guides/fs/feature_group/data_types/#online-restrictions-for-row-size","title":"Online restrictions for row size","text":"<p>The online feature store supports up to 500 columns and all column types combined should not exceed 30000 Bytes.  The byte size of each column is determined by its data type and calculated as follows: </p> Online Data Type Byte Size TINYINT 1 SMALLINT 2 INT 4 BIGINT 8 FLOAT 4 DOUBLE 8 DECIMAL(PREC, SCALE) 16 TIMESTAMP 8 DATE 8 VARCHAR(LENGTH) LENGTH * 4 VARCHAR(LENGTH) charset latin1; LENGTH * 1 TEXT 256 VARBINARY(LENGTH) LENGTH / 1.4 BLOB 256 other 8"},{"location":"user_guides/fs/feature_group/data_types/#timestamps-and-timezones","title":"Timestamps and Timezones","text":"<p>All timestamp features are stored in Hopsworks in UTC time. Also, all timestamp-based functions (such as point-in-time joins) use UTC time.  This ensures consistency of timestamp features across different client timezones and simplifies working with timestamp-based functions in general.  When ingesting timestamp features, the Feature Store Write API will automatically handle the conversion to UTC, if necessary. The follwing table summarizes how different timestamp types are handled:</p> Data Frame (Data Type) Environment Handling Pandas DataFrame (datetime64[ns]) Python-only and PySpark interpreted as UTC, independent of the client's timezone Pandas DataFrame (datetime64[ns, tz]) Python-only and PySpark timzone-sensitive conversion from 'tz' to UTC Spark (TimestampType) PySpark and Spark interpreted as UTC, independent of the client's timezone <p>Timestamp features retrieved from the Feature Store, e.g. using the Feature Store Read API, use a timezone-unaware format:</p> Data Frame (Data Type) Environment Timezone Pandas DataFrame (datetime64[ns]) Python-only timezone-unaware (UTC) Spark (TimestampType) PySpark and Spark timezone-unaware (UTC) <p>Note that our PySpark/Spark client automatically sets the Spark SQL session's timezone to UTC. This ensures that Spark SQL will correctly interpret all timestamps as UTC. The setting will only apply to the client's session, and you don't have to worry about setting/unsetting the configuration yourself.</p>"},{"location":"user_guides/fs/feature_group/data_types/#explicit-schema-definition","title":"Explicit schema definition","text":"<p>When creating a feature group it is possible for the user to control both the offline and online data type of each column. If users explicitly define the schema for the feature group, Hopsworks is going to use that schema to create the feature group, without performing any type mapping. You can explicitly define the feature group schema as follows:</p> Python <pre><code>from hsfs.feature import Feature\n\nfeatures = [\n    Feature(name=\"id\",type=\"int\",online_type=\"int\"),\n    Feature(name=\"name\",type=\"string\",online_type=\"varchar(20)\")\n]\n\nfg = fs.create_feature_group(name=\"fg_manual_schema\",\n                             features=features,\n                             online_enabled=True)\nfg.save(features)\n</code></pre>"},{"location":"user_guides/fs/feature_group/data_types/#append-features-to-existing-feature-groups","title":"Append features to existing feature groups","text":"<p>Hopsworks supports appending additional features to an existing feature group. Adding additional features to an existing feature group is not considered a breaking change.</p> Python <pre><code>from hsfs.feature import Feature\n\nfeatures = [\n    Feature(name=\"id\",type=\"int\",online_type=\"int\"),\n    Feature(name=\"name\",type=\"string\",online_type=\"varchar(20)\")\n]\n\nfg = fs.get_feature_group(name=\"example\", version=1)\nfg.append_features(features)\n</code></pre> <p>When adding additional features to a feature group, you can provide a default values for existing entries in the feature group. You can also backfill the new features for existing entries by running an <code>insert()</code> operation and update all existing combinations of primary key - event time. </p>"},{"location":"user_guides/fs/feature_group/data_validation/","title":"Data Validation","text":"Validation on Insertion with Hopsworks and Great Expectations."},{"location":"user_guides/fs/feature_group/data_validation/#introduction","title":"Introduction","text":"<p>Clean, high quality feature data is of paramount importance to being able to train and serve high quality models. Hopsworks offers integration with Great Expectations to enable a smooth data validation workflow. This guide is designed to help you integrate a data validation step when inserting new DataFrames into a Feature Group. Note that validation is performed inline as part of your feature pipeline (on the client machine) - it is not executed by Hopsworks after writing features.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#ui","title":"UI","text":""},{"location":"user_guides/fs/feature_group/data_validation/#create-a-feature-group-pre-requisite","title":"Create a Feature Group (Pre-requisite)","text":"<p>In the UI, you must create a Feature Group first before attaching an Expectation Suite. You can find out more information about creating a Feature Group here. You can attach at most one expectation suite to a Feature Group. Data validation is an optional step and is not required to write to a Feature Group.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-1-find-and-edit-feature-group","title":"Step 1: Find and Edit Feature Group","text":"<p>Click on the Feature Group section in the navigation menu. Find your Feature Group in the list and click on its name to access the Feature Group page. Select <code>edit</code> in the top right corner or scroll to the Expectations section and click on <code>Edit Expectation Suite</code>.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-2-edit-general-expectation-suite-settings","title":"Step 2: Edit General Expectation Suite Settings","text":"<p>Scroll to the Expectation Suite section. Click add Expectation Suite and edit its metadata:</p> <ul> <li>Choose a name for your expectation suite.</li> <li>Checkbox enabled. This controls whether the Expectation Suite will be used to validate a Dataframe automatically upon insertion into a Feature Group. Note that validation is executed by the client. Disabling validation allows you to skip the validation step without deleting the Expectation Suite.</li> <li>'ALWAYS' vs. 'STRICT' mode. This option controls what happens after validation. Hopsworks defaults to 'ALWAYS', where data is written to the Feature Group regardless of the validation result. This means that even if expectations are failing or throw an exception, Hopsworks will attempt to insert the data into the Feature Group. In 'STRICT' mode, Hopsworks will only write data to the Feature Group if each individual expectation has been successful.</li> </ul>"},{"location":"user_guides/fs/feature_group/data_validation/#step-3-add-new-expectations","title":"Step 3: Add new expectations","text":"<p>By clicking on <code>Add expectation</code> one can choose an expectation type from a searchable dropdown menu. Currently, only the built-in expectations from the Great Expectations framework are supported. For user-defined expectations, please use the Rest API or python client.</p> <p>All default kwargs associated to the selected expectation type are populated as a json below the dropdown menu. Edit the arguments in the json to configure the Expectation. In particular, arguments such as <code>column</code>, <code>columnA</code>, <code>columnB</code>, <code>column_set</code> and <code>column_list</code> require valid feature name(s). Click the tick button to save the expectation configuration and append it to the Expectation Suite locally.</p> <p>Info</p> <p>Click the <code>Save feature group</code> button to persist your changes!</p> <p>You can use the button <code>Clear Expectation Suite</code> to clean up before saving changes if you changed your mind. If the Expectation Suite is already registered, it will instead show a button to delete the Expectation Suite.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-4-save-new-data-to-a-feature-group","title":"Step 4: Save new data to a Feature Group","text":"<p>Use the python client to write a DataFrame to the Feature Group. Note that if an expectation suite is enabled for a Feature Group, calling the <code>insert</code> method will run validation and default to uploading the corresponding validation report to Hopsworks. The report is uploaded even if validation fails and 'STRICT' mode is selected.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-5-check-validation-results-summary","title":"Step 5: Check Validation Results Summary","text":"<p>Hopsworks shows a visual summary of validation reports. To check it out, go to your Feature Group overview and scroll to the expectation section. Click on the <code>Validation Results</code> tab and check that all went according to plan. Each row corresponds to an expectation in the suite. Features can have several corresponding expectations and the same type of expectation can be applied to different features.</p> <p>You can navigate to older reports using the dropdown menu. Should you need more than the information displayed in the UI for e.g., debugging, the full report can be downloaded by clicking on the corresponding button.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-6-check-validation-history","title":"Step 6: Check Validation History","text":"<p>The <code>Validation Reports</code> tab in the Expectations section displays a brief history of recent validations. Each row corresponds to a validation report, with some summary information about the success of the validation step. You can download the full report by clicking the download icon button that appears at the end of the row.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#code","title":"Code","text":"<p>Hopsworks python client interfaces with the Great Expectations library to enable you to add data validation to your feature engineering pipeline. In this section, we show you how in a single line you enable automatic validation on each insertion of new data into your Feature Group. Whether you have an existing Feature Group you want to add validation to or Follow the guide or get your hands dirty by running our tutorial data validation notebook in google colab.</p> <p>First checkout the pre-requisite and hospworks setup to follow the guide below. Create a project, install the hopsworks client and connect via the generated API key. You are ready to load your data in a DataFrame. The second step is a short introduction to the relevant Great Expectations API to build data validation suited to your data. Third and final step shows how to attach your Expectation Suite to the Feature Group to benefit from automatic validation on insertion capabilities.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-1-pre-requisite","title":"Step 1: Pre-requisite","text":"<p>In order to define and validate an expectation when writing to a Feature Group, you will need:</p> <ul> <li>A Hopsworks project. If you don't have a project yet you can go to managed.hopsworks.ai, signup with your email and create your first project.</li> <li>An API key, you can get one by following the instructions here</li> <li>The hopsworks python library installed in your client</li> </ul>"},{"location":"user_guides/fs/feature_group/data_validation/#connect-your-notebook-to-hopsworks","title":"Connect your notebook to Hopsworks","text":"<p>Connect the client running your notebooks to Hopsworks.</p> <pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nfs = project.get_feature_store()\n</code></pre> <p>You will be prompt to paste your API key to connect the notebook to your project. The <code>fs</code> Feature Store entity is now ready to be used to insert or read data from Hopsworks.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#import-your-data","title":"Import your data","text":"<p>Load your data in a DataFrame using the usual pandas API.</p> <pre><code>import pandas as pd\n\ndf = pd.read_csv(\"https://repo.hops.works/master/hopsworks-tutorials/data/card_fraud_data/transactions.csv\", parse_dates=[\"datetime\"])\n\ndf.head(3)\n</code></pre>"},{"location":"user_guides/fs/feature_group/data_validation/#step-2-great-expectation-introduction","title":"Step 2: Great Expectation Introduction","text":"<p>To validate the data, we will use the Great Expectations library. Below is a short introduction on how to build an Expectation Suite to validate your data. Everything is done using the Great Expectations API so you can re-use any prior knowledge you may have of the library.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#create-an-expectation-suite","title":"Create an Expectation Suite","text":"<p>Create (or import an existing) expectation suite using the Great Expectations library. This suite will hold all the validation tests we want to perform on our data before inserting them into Hopsworks.</p> <pre><code>import great_expectations as ge\n\nexpectation_suite = ge.core.ExpectationSuite(\n    expectation_suite_name=\"validate_on_insert_suite\"\n)\n</code></pre>"},{"location":"user_guides/fs/feature_group/data_validation/#add-expectations-in-the-source-code","title":"Add Expectations in the Source Code","text":"<p>Add some expectation to your suite. Each expectation configuration corresponds to a validation test to be run against your data.</p> <pre><code>expectation_suite.add_expectation(\n    ge.core.ExpectationConfiguration(\n        expectation_type=\"expect_column_min_to_be_between\",\n        kwargs={\n            \"column\": \"foo_id\",\n            \"min_value\": 0,\n            \"max_value\": 1\n        }\n    )\n)\n\nexpectation_suite.add_expectation(\n    ge.core.ExpectationConfiguration(\n        expectation_type=\"expect_column_value_lengths_to_be_between\",\n        kwargs={\n            \"column\": \"bar_name\",\n            \"min_value\": 3,\n            \"max_value\": 10\n        }\n    )\n)\n</code></pre>"},{"location":"user_guides/fs/feature_group/data_validation/#using-great-expectations-profiler","title":"Using Great Expectations Profiler","text":"<p>Building Expectation Suite by hand can be a major time commitment when you have dozens of Features. Great Expectations offers <code>Profiler</code> classes to inspect a sample of your data and infers a suitable Expectation Suite that you will be able to register with Hopsworks.</p> <pre><code>ge_profiler = ge.profile.BasicSuiteBuilderProfiler()\nexpectation_suite_profiler, _ = ge_profiler.profile(ge.from_pandas(df))\n</code></pre> <p>Once you have built an Expectation Suite you are satisfied with, it is time to create your first validation enabled Feature Group.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-3-attach-an-expectation-suite-to-your-feature-group-to-enable-automatic-validation-on-insertion","title":"Step 3: Attach an Expectation Suite to your Feature Group to enable Automatic Validation on Insertion.","text":"<p>Writing data in Hopsworks is done using Feature Groups. Once a Feature Group is registered in the Feature Store, you can use it to insert your pandas DataFrames. For more information see create Feature Group. To benefit from automatic validation on insertion, attach your newly created Expectation Suite when creating the Feature Group:</p> <pre><code>fg = fs.create_feature_group(\n  \"fg_with_data_validation\",\n  version=1,\n  description=\"Validated data\",\n  primary_key=['foo_id'],\n  online_enabled=False\n  expectation_suite=expectation_suite\n)\n</code></pre> <p>or, if the Feature Group already exist, you can simply run:</p> <pre><code>fg.save_expectation_suite(expectation_suite)\n</code></pre> <p>That is all there is to it. Hopsworks will now automatically use your suite to validate the DataFrames you want to write to the Feature Group. Try it out!</p> <pre><code>job, validation_report = fg.insert(df.head(5))\n</code></pre> <p>As you can see, Hopsworks runs the validation in the client before attempting to insert the data. By default, Hopsworks will try to insert the data even if validation fails to prevent data loss. However it can be configured for production setup to be more restrictive, checkout the data validation advanced guide.</p> <p>Info</p> <p>Note that once the Expectation Suite is attached to the Feature Group, any subsequent attempt to insert to this Feature Group will apply the Data Validation step even from a different client or in a scheduled job.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#step-4-data-quality-monitoring","title":"Step 4: Data Quality Monitoring","text":"<p>Upon running validation, Great Expectations generates a report to help you assess the quality of your data. Nothing to do here, Hopsworks client automatically uploads the validation report to the backend when ingesting new data. It enables you to monitor the quality of the inserted data in the Feature Group over time.</p> <p>You can checkout a summary of the reports in the UI on your Feature Group page. As you can see, your Feature Group conveniently gather all in one place: your data, the Expectation Suite and the reports generated each time you inserted data!</p> <p>Hopsworks client API allows you to retrieve validation reports for further analysis.</p> <pre><code># load multiple reports\nvalidation_reports = fg.get_validation_reports()\n\n# convenience method for rapid development\nge_latest_report = fg.get_latest_validation_report()\n</code></pre> <p>Similarly you can retrieve the historic of validation results for a particular expectation, e.g to plot a time-series of a given expectation observed value over time.</p> <pre><code>validation_history = fg.get_validation_history(\n    expectationId=1\n)\n</code></pre> <p>You can find the expectationIds in the UI or using <code>fg.get_expectation_suite</code> and looking it up in the expectation's meta field.</p> <p>Info</p> <p>If Validation Reports or Results are too long, they can be truncated to fit in the database. A full version of the reports can be downloaded from the UI.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#conclusion","title":"Conclusion","text":"<p>The integration between Hopsworks and Great Expectations makes it simple to add a data validation step to your feature engineering pipeline. Build your Expectation Suite and attach it to your Feature Group with a single line of code. No need to add any code to your pipeline or job scripts, calling <code>fg.insert</code> will now automatically validate the data before inserting them in the Feature Group. The validation reports are stored along your data in Hopsworks allowing us to provide basic monitoring capabilities to quickly spot a data quality issue in the UI.</p>"},{"location":"user_guides/fs/feature_group/data_validation/#going-further","title":"Going further","text":"<p>If you wish to find out more about how to use the data validation API or best practices for development or production pipelines in Hopsworks, checkout the advanced guide.</p>"},{"location":"user_guides/fs/feature_group/deprecation/","title":"How to deprecate a Feature Group","text":""},{"location":"user_guides/fs/feature_group/deprecation/#introduction","title":"Introduction","text":"<p>To discourage the usage of specific feature groups it is possible to deprecate them. When a feature group is deprecated, user will be warned when they try to use it or use a feature view that depends on it.</p> <p>In this guide you will learn how to deprecate a feature group within Hopsworks, showing examples in HSFS APIs as well as the user interface.</p>"},{"location":"user_guides/fs/feature_group/deprecation/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide it is expected that there is an existing feature group in your project. You can familiarize yourself with the creation of a feature group in the user guide.</p>"},{"location":"user_guides/fs/feature_group/deprecation/#deprecate-using-the-hsfs-apis","title":"Deprecate using the HSFS APIs","text":""},{"location":"user_guides/fs/feature_group/deprecation/#retrieve-the-feature-group","title":"Retrieve the feature group","text":"<p>To deprecate a feature group using the HSFS APIs you need to provide a Feature Group.</p> Python <pre><code>fg = fs.get_feature_group(name=\"feature_group_name\", version=feature_group_version)\n</code></pre>"},{"location":"user_guides/fs/feature_group/deprecation/#deprecate-feature-group","title":"Deprecate Feature Group","text":"<p>Feature group deprecation occurs by calling the <code>update_deprecated</code> method on the feature group.</p> Python <pre><code>fg.update_deprecated()\n</code></pre> <p>Users can also un-deprecate the feature group if need be, by setting the <code>deprecate</code> parameter to False.</p> Python <pre><code>fg.update_deprecated(deprecate=False)\n</code></pre>"},{"location":"user_guides/fs/feature_group/deprecation/#deprecate-using-the-ui","title":"Deprecate using the UI","text":"<p>You can deprecate/de-deprecate feature groups through the UI. For this, navigate to the <code>Feature Groups</code> section and select a feature group.</p> <p> </p> <p>Subsequently, make sure that the necessary feature group version is picked.</p> <p> </p> <p>Finally, click on the button with three vertical dots in the right corner and select <code>Deprecate</code>.</p> <p> </p> <p>The Feature group can be de-deprecated by selecting the <code>Undeprecate</code> option on a deprecated feature group.</p>"},{"location":"user_guides/fs/feature_group/statistics/","title":"How to compute statistics on feature data","text":""},{"location":"user_guides/fs/feature_group/statistics/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to configure, compute and visualize statistics for the features registered with Hopsworks. </p> <p>Hopsworks groups features in four categories:</p> <ul> <li> <p>Descriptive: These are the basic statistics Hopsworks computes. They include an approximate count of the distinctive values and the completeness (i.e. the percentage of non null values). For numerical features Hopsworks also computes the minimum, maximum, mean, standard deviation and the sum of each feature. Enabled by default.</p> </li> <li> <p>Histograms: Hopsworks computes the distribution of the values of a feature. Exact histograms are computed as long as the number of distinct values is less than 20. If a feature has a numerical data type (e.g. integer, float, double, ...) and has more than 20 unique values, then the values are bucketed in 20 buckets and the histogram represents the distribution of values in those buckets. By default histograms are disabled.</p> </li> <li> <p>Correlation: If enabled, Hopsworks computes the Pearson correlation between features of numerical data type within a feature group. By default correlation is disabled.</p> </li> <li> <p>Exact Statistics: Exact statistics are an enhancement of the descriptive statistics that provide an exact count of distinctive values, entropy, uniqueness and distinctiveness of the value of a feature. These statistics are more expensive to compute as they take into consideration all the values and they don't use approximations. By default they are disabled. </p> </li> </ul> <p>When statistics are enabled, they are computed every time new data is written into the offline storage of a feature group. Statistics are then displayed on the Hopsworks UI and users can track how data has changed over time. </p>"},{"location":"user_guides/fs/feature_group/statistics/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide we suggest you read the Feature Group concept page to understand what a feature group is and how it fits in the ML pipeline.  We also suggest you familiarize with the APIs to create a feature group.</p>"},{"location":"user_guides/fs/feature_group/statistics/#enable-statistics-when-creating-a-feature-group","title":"Enable statistics when creating a feature group","text":"<p>As mentioned above, by default only descriptive statistics are enabled when creating a feature group. To enable histograms, correlations or exact statistics the <code>statistics_config</code> configuration parameter can be provided in the create statement.</p> <p>The <code>statistics_config</code> parameter takes a dictionary with the keys: <code>enabled</code>, <code>correlations</code>, <code>histograms</code> and <code>exact_uniqueness</code> and, as values, a boolean to describe whether or not to compute the specific class of statistics.</p> <p>Additionally it is possible to restrict the statistics computation to only a subset of columns. This is configurable by adding a <code>columns</code> key to the <code>statistics_config</code> parameter. The key should contain the list of columns for which to compute statistics.  By default the value is empty list <code>[]</code> and the statistics are computed for all columns in the feature group.</p> Python <pre><code>fg = feature_store.create_feature_group(name=\"weather\",\n    version=1,\n    description=\"Weather Features\",\n    online_enabled=True,\n    primary_key=['location_id'],\n    partition_key=['day'],\n    event_time='event_time',\n    statistics_config={\n        \"enabled\": True,\n        \"histograms\": True,\n        \"correlations\": True,\n        \"exact_uniqueness\": False,\n        \"columns\": []\n    }\n)\n</code></pre>"},{"location":"user_guides/fs/feature_group/statistics/#enable-statistics-after-creating-a-feature-group","title":"Enable statistics after creating a feature group","text":"<p>It is possible users to change the statistics configuration after a feature group was created. Either to add or remove a class of statistics, or to change the set of features for which to compute statistics.</p> Python <pre><code>fg.statistics_config = {\n        \"enabled\": True,\n        \"histograms\": False,\n        \"correlations\": False,\n        \"exact_uniqueness\": False \n        \"columns\": ['location_id', 'min_temp', 'max_temp']\n    }\n\nfg.update_statistics_config()\n</code></pre>"},{"location":"user_guides/fs/feature_group/statistics/#explicitly-compute-statistics","title":"Explicitly compute statistics","text":"<p>As mentioned above, the statistics are computed every time new data is written into the offline storage of a feature group. By invoking the <code>compute_statistics</code> method, users can trigger explicitly the statistics computation for the data available in a feature group.</p> <p>This is useful when a feature group is receiving frequent updates. Users can schedule periodic statistics computation that take into consideration several data commits.</p> <p>By default, the <code>compute_statistics</code> method computes statistics on the most recent version of the data available in a feature group. Users can provide a specific time using the <code>wallclock_time</code> parameter, to compute the statistics for a previous version of the data.</p> <p>Hopsworks can compute statistics of external feature groups. As external feature groups are read only from an Hopsworks perspective, statistics computation can be triggered using the <code>compute_statistics</code> method.</p> Python <pre><code>fg.compute_statistics(wallclock_time='20220611 20:00')\n</code></pre>"},{"location":"user_guides/fs/feature_group/statistics/#inspect-statistics","title":"Inspect statistics","text":"<p>You can also create a new feature group through the UI.</p>"},{"location":"user_guides/fs/feature_view/","title":"Feature View User Guides","text":"<p>This section serves to provide guides and examples for the common usage of abstractions and functionality of the Feature View through the Hopsworks UI and APIs.</p> <ul> <li>Create a Feature View</li> <li>Create a Training Data with different splits</li> <li>Batch Data</li> <li>Feature Vectors</li> <li>Feature Server</li> <li>Query</li> <li>Transformation Functions</li> </ul>"},{"location":"user_guides/fs/feature_view/batch-data/","title":"Batch data (analytical ML systems)","text":""},{"location":"user_guides/fs/feature_view/batch-data/#creation","title":"Creation","text":"<p>It is very common that ML models are deployed in a \"batch\" setting where ML pipelines score incoming new data at a regular interval, for example, daily or weekly. Feature views support batch prediction by returning batch data as a DataFrame over a time range, by <code>start_time</code> and <code>end_time</code>. The resultant DataFrame (or batch-scoring DataFrame) can then be fed to models to make predictions.</p> PythonJava <pre><code># get batch data\ndf = feature_view.get_batch_data(\n    start_time = \"20220620\",\n    end_time = \"20220627\"\n) # return a dataframe\n</code></pre> <pre><code>Dataset&lt;Row&gt; ds = featureView.getBatchData(\"20220620\", \"20220627\")\n</code></pre>"},{"location":"user_guides/fs/feature_view/batch-data/#retrieve-batch-data-with-primary-keys-and-event-time","title":"Retrieve batch data with primary keys and event time","text":"<p>For certain use cases, e.g. time series models, the input data needs to be sorted according to the primary key(s) and event time combination. Or one might want to merge predictions back with the original input data for postmortem analysis. Primary key(s) and event time are not usually included in the feature view query as they are not features used for training. To retrieve the primary key(s) and/or event time when retrieving batch data for inference, you need to set the parameters <code>primary_keys=True</code> and/or <code>event_time=True</code>.</p> Python <pre><code># get batch data\ndf = feature_view.get_batch_data(\nstart_time = \"20220620\",\nend_time = \"20220627\",\nprimary_keys=True,\nevent_time=True\n) # return a dataframe with primary keys and event time\n</code></pre> <p>Note</p> <p>If the event time columns have the same name across all the feature groups included in the feature view, then only the event time of the label feature group (left most feature group in the query) will be returned. If they have different names, then all of them will be returned. The Join prefix does not have any influence on this behaviour.</p> <p>For Python-clients, handling small or moderately-sized data, we recommend enabling the ArrowFlight Server with DuckDB, which will provide significant speedups over Spark/Hive for reading batch data. If the service is enabled, and you want to read this particular batch data with Hive instead, you can set the read_options to <code>{\"use_hive\": True}</code>. <pre><code># get batch data with Hive\ndf = feature_view.get_batch_data(\n    start_time = \"20220620\",\n    end_time = \"20220627\",\n    read_options={\"use_hive: True})\n)\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/batch-data/#creation-with-transformation","title":"Creation with transformation","text":"<p>If you have specified transformation functions when creating a feature view, you will get back transformed batch data as well. If your transformation functions require statistics of training dataset, you must also provide the training data version. <code>init_batch_scoring</code> will then fetch the statistics and initialize the functions with required statistics. Then you can follow the above examples and create the batch data. Please note that transformed batch data can only be returned in the python client but not in the java client.</p> <pre><code>feature_view.init_batch_scoring(training_dataset_version=1)\n</code></pre> <p>It is important to note that in addition to the filters defined in feature view, extra filters will be applied if they are defined in the given training dataset version.</p>"},{"location":"user_guides/fs/feature_view/feature-server/","title":"Feature Store REST API Server","text":"<p>This API server allows users to retrieve single/batch feature vectors from a feature view.</p>"},{"location":"user_guides/fs/feature_view/feature-server/#how-to-use","title":"How to use","text":"<p>Hopsworks 3.3 includes a preview of the feature store REST API, version 0.1.0. By default, the server listens on the <code>0.0.0.0:4406</code>. Please refer to <code>/srv/hops/mysql-cluster/rdrs_config.json</code> config file located on machines running the REST Server for additional configuration parameters.</p>"},{"location":"user_guides/fs/feature_view/feature-server/#single-feature-vector","title":"Single feature vector","text":""},{"location":"user_guides/fs/feature_view/feature-server/#request","title":"Request","text":"<p><code>POST /{api-version}/feature_store</code></p> <p>Body</p> <pre><code>{\n        \"featureStoreName\": \"fsdb002\",\n        \"featureViewName\": \"sample_2\",\n        \"featureViewVersion\": 1,\n        \"passedFeatures\": {},\n        \"entries\": {\n                \"id1\": 36\n        },\n        \"metadataOptions\": {\n                \"featureName\": true,\n                \"featureType\": true\n        }\n}\n</code></pre> <p>Parameters</p> parameter type note featureStoreName string featureViewName string featureViewVersion number(int) entries objects Map of serving key of feature view as key and value of serving key as value. Serving key are a set of the primary key of feature groups which are included in the feature view query. If feature groups are joint with prefix, the primary key needs to be attached with prefix. passedFeatures objects Optional. Map of feature name as key and feature value as value. This overwrites feature values in the response. metadataOptions objects Optional. Map of metadataoption as key and boolean as value. Default metadata option is false. Metadata is returned on request. Metadata options available: 1. featureName 2. featureType"},{"location":"user_guides/fs/feature_view/feature-server/#response","title":"Response","text":"<pre><code>{\n        \"features\": [\n                36,\n                \"2022-01-24\",\n                \"int24\",\n                \"str14\"\n        ],\n        \"metadata\": [\n                {\n                        \"featureName\": \"id1\",\n                        \"featureType\": \"bigint\"\n                },\n                {\n                        \"featureName\": \"ts\",\n                        \"featureType\": \"date\"\n                },\n                {\n                        \"featureName\": \"data1\",\n                        \"featureType\": \"string\"\n                },\n                {\n                        \"featureName\": \"data2\",\n                        \"featureType\": \"string\"\n                }\n        ],\n        \"status\": \"COMPLETE\"\n}\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-server/#error-handling","title":"Error handling","text":"Code reason response 200 400 Requested metadata does not exist 400 Error in pk or passed feature value 401 Access denied Access unshared feature store failed 500 Failed to read feature store metadata <p>Response with pk/pass feature error</p> <pre><code>{\n        \"code\": 12,\n        \"message\": \"Wrong primay-key column. Column: ts\",\n        \"reason\": \"Incorrect primary key.\"\n}\n</code></pre> <p>Response with metadata error</p> <pre><code>{\n        \"code\": 2,\n        \"message\": \"\",\n        \"reason\": \"Feature store does not exist.\"\n}\n</code></pre> <p>Pk value no match</p> <pre><code>{\n        \"features\": [\n                9876543,\n                null,\n                null,\n                null\n        ],\n        \"metadata\": null,\n        \"status\": \"MISSING\"\n}\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-server/#batch-feature-vectors","title":"Batch feature vectors","text":""},{"location":"user_guides/fs/feature_view/feature-server/#request_1","title":"Request","text":"<p><code>POST /{api-version}/batch_feature_store</code></p> <p>Body</p> <pre><code>{\n        \"featureStoreName\": \"fsdb002\",\n        \"featureViewName\": \"sample_2\",\n        \"featureViewVersion\": 1,\n        \"passedFeatures\": [],\n        \"entries\": [\n                {\n                        \"id1\": 16\n                },\n                {\n                        \"id1\": 36\n                },\n                {\n                        \"id1\": 71\n                },\n                {\n                        \"id1\": 48\n                },\n                {\n                        \"id1\": 29\n                }\n        ],\n        \"requestId\": null,\n        \"metadataOptions\": {\n                \"featureName\": true,\n                \"featureType\": true\n        }\n}\n</code></pre> <p>Parameters</p> parameter type note featureStoreName string featureViewName string featureViewVersion number(int) entries <code>array&lt;objects&gt;</code> Each items is a map of serving key as key and value of serving key as value. Serving key of feature view. passedFeatures <code>array&lt;objects&gt;</code> Optional. Each items is a map of feature name as key and feature value as value. This overwrites feature values in the response. If provided, its size and order has to be equal to the size of entries. Item can be null. metadataOptions objects Optional. Map of metadataoption as key and boolean as value. Default metadata option is false. Metadata is returned on request. Metadata options available: 1. featureName 2. featureType"},{"location":"user_guides/fs/feature_view/feature-server/#response_1","title":"Response","text":"<pre><code>{\n        \"features\": [\n                [\n                        16,\n                        \"2022-01-27\",\n                        \"int31\",\n                        \"str24\"\n                ],\n                [\n                        36,\n                        \"2022-01-24\",\n                        \"int24\",\n                        \"str14\"\n                ],\n                [\n                        71,\n                        \"2022-01-22\",\n                        \"int3\",\n                        \"str97\"\n                ],\n                [\n                        48,\n                        \"2022-01-26\",\n                        \"int92\",\n                        \"str31\"\n                ],\n                [\n                        29,\n                        \"2022-01-03\",\n                        \"int53\",\n                        \"str91\"\n                ]\n        ],\n        \"metadata\": [\n                {\n                        \"featureName\": \"id1\",\n                        \"featureType\": \"bigint\"\n                },\n                {\n                        \"featureName\": \"ts\",\n                        \"featureType\": \"date\"\n                },\n                {\n                        \"featureName\": \"data1\",\n                        \"featureType\": \"string\"\n                },\n                {\n                        \"featureName\": \"data2\",\n                        \"featureType\": \"string\"\n                }\n        ],\n        \"status\": [\n                \"COMPLETE\",\n                \"COMPLETE\",\n                \"COMPLETE\",\n                \"COMPLETE\",\n                \"COMPLETE\"\n        ]\n}\n</code></pre> <p>note: Order of the returned features are the same as the order of entries in the request.</p>"},{"location":"user_guides/fs/feature_view/feature-server/#error-handling_1","title":"Error handling","text":"Code reason response 200 400 Requested metadata does not exist 401 Access denied Access unshared feature store failed 500 Failed to read feature store metadata <p>Response with partial failure</p> <pre><code>{\n        \"features\": [\n                [\n                        81,\n                        \"id81\",\n                        \"2022-01-29 00:00:00\",\n                        6\n                ],\n                null,\n                [\n                        51,\n                        \"id51\",\n                        \"2022-01-10 00:00:00\",\n                        49\n                ]\n        ],\n        \"metadata\": null,\n        \"status\": [\n                \"COMPLETE\",\n                \"ERROR\",\n                \"COMPLETE\"\n        ]\n}\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-server/#access-control-to-feature-store","title":"Access control to feature store","text":"<p>Currently, the REST API server only supports Hopsworks API Keys for authentication and authorization. Add the API key to the HTTP requests using the <code>X-API-KEY</code> header.</p>"},{"location":"user_guides/fs/feature_view/feature-vectors/","title":"Feature Vectors","text":"<p>Once you have trained a model, it is time to deploy it. You can get back all the features required to feed into an ML model with a single method call. A feature view provides great flexibility for you to retrieve a vector (or row) of features from any environment, whether you are either inside the Hopsworks platform, a model serving platform, or in an external environment, such as your application server. Harnessing the powerful RonDB, feature vectors are served at in-memory latency.</p> <p>If you want to understand more about the concept of feature vectors, you can refer to here.</p>"},{"location":"user_guides/fs/feature_view/feature-vectors/#retrieval","title":"Retrieval","text":"<p>You can get back feature vectors from either python or java client by providing the primary key value(s) for the feature view. Note that filters defined in feature view and training data will not be applied when feature vectors are returned.</p> PythonJava <pre><code># get a single vector\nfeature_view.get_feature_vector(\n    entry = {\"pk1\": 1, \"pk2\": 2}\n)\n\n# get multiple vectors\nfeature_view.get_feature_vectors(\n    entry = [\n        {\"pk1\": 1, \"pk2\": 2},\n        {\"pk1\": 3, \"pk2\": 4},\n        {\"pk1\": 5, \"pk2\": 6}\n    ]\n)\n</code></pre> <pre><code>// get a single vector\nMap&lt;String, Object&gt; entry1 = Maps.newHashMap();\nentry1.put(\"pk1\", 1);\nentry1.put(\"pk2\", 2);\nfeatureView.getFeatureVector(entry1);\n\n// get multiple vectors\nMap&lt;String, Object&gt; entry2 = Maps.newHashMap();\nentry2.put(\"pk1\", 3);\nentry2.put(\"pk2\", 4);\nfeatureView.getFeatureVectors(Lists.newArrayList(entry1, entry2);\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-vectors/#missing-primary-key-entries","title":"Missing Primary Key Entries","text":"<p>It can happen that some of the primary key entries are not available in some or all of the feature groups used by a feature view.</p> <p>Take the above example assuming the feature view consists of two joined feature groups, first one with primary key column <code>pk1</code>, the second feature group with primary key column <code>pk2</code>. <pre><code># get a single vector\nfeature_view.get_feature_vector(\n    entry = {\"pk1\": 1, \"pk2\": 2}\n)\n</code></pre> This call will raise an exception if <code>pk1 = 1</code> OR <code>pk2 = 2</code> can't be found but also if <code>pk1 = 1</code> AND <code>pk2 = 2</code> can't be found, meaning, it will not return a partial or empty feature vector.</p> <p>When retrieving a batch of vectors, the behaviour is slightly different. <pre><code># get multiple vectors\nfeature_view.get_feature_vectors(\n    entry = [\n        {\"pk1\": 1, \"pk2\": 2},\n        {\"pk1\": 3, \"pk2\": 4},\n        {\"pk1\": 5, \"pk2\": 6}\n    ]\n)\n</code></pre> This call will raise an exception if for example for the third entry <code>pk1 = 5</code> OR <code>pk2 = 6</code> can't be found, however, it will simply not return a vector for this entry if <code>pk1 = 5</code> AND <code>pk2 = 6</code> can't be found. That means, <code>get_feature_vectors</code> will never return partial feature vector, but will omit empty feature vectors.</p> <p>If you are aware of missing featurs, you can use the passed features functionality, described down below.</p>"},{"location":"user_guides/fs/feature_view/feature-vectors/#retrieval-with-transformation","title":"Retrieval with transformation","text":"<p>If you have specified transformation functions when creating a feature view, you receive transformed feature vectors. If your transformation functions require statistics of training dataset, you must also provide the training data version. <code>init_serving</code> will then fetch the statistics and initialize the functions with the required statistics. Then you can follow the above examples and retrieve the feature vectors. Please note that transformed feature vectors can only be returned in the python client but not in the java client.</p> <pre><code>feature_view.init_serving(training_dataset_version=1)\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-vectors/#passed-features","title":"Passed features","text":"<p>If some of the features values are only known at prediction time and cannot be computed and cached in the online feature store, you can provide those values as <code>passed_features</code> option. The <code>get_feature_vector</code> method is going to use the passed values to construct the final feature vector to submit to the model.</p> <p>You can use the <code>passed_features</code> parameter to overwrite individual features being retrieved from the online feature store. The feature view will apply the necessary transformations to the passed features as it does for the feature data retrieved from the online feature store.</p> Python <pre><code># get a single vector\nfeature_view.get_feature_vector(\n    entry = {\"pk1\": 1, \"pk2\": 2},\n    passed_features = {\"feature_a\": \"value_a\"}\n)\n\n# get multiple vectors\nfeature_view.get_feature_vectors(\n    entry = [\n        {\"pk1\": 1, \"pk2\": 2},\n        {\"pk1\": 3, \"pk2\": 4},\n        {\"pk1\": 5, \"pk2\": 6}\n    ],\n    passed_features = [\n        {\"feature_a\": \"value_a1\"},\n        {\"feature_a\": \"value_a2\"},\n        {\"feature_a\": \"value_a3\"},\n    ]\n)\n</code></pre> <p>You can also use the parameter to provide values for all the features which are part of a specific feature group and used in the feature view. In this second case, you do not have to provide the primary key value for that feature group as no data needs to be retrieved from the online feature store.</p> Python <pre><code># get a single vector, replace values from an entire feature group\n# note how in this example you don't have to provide the value of \n# pk2, but you need to provide the features coming from that feature group\n# in this case feature_b and feature_c \n\nfeature_view.get_feature_vector(\n    entry = { \"pk1\": 1 },\n    passed_features = {\n        \"feature_a\": \"value_a\", \n        \"feature_b\": \"value_b\", \n        \"feature_c\": \"value_c\"\n    }\n)\n</code></pre>"},{"location":"user_guides/fs/feature_view/feature-vectors/#feature-server","title":"Feature Server","text":"<p>In addition to Python/Java clients, from Hopsworks 3.3, a new feature server implemented in Go is introduced. With this new API, single or batch feature vectors can be retrieved in any programming language.</p>"},{"location":"user_guides/fs/feature_view/helper-columns/","title":"Helper columns","text":"<p>Hopsworks Feature Store provides a functionality to define two types of helper columns <code>inference_helper_columns</code> and <code>training_helper_columns</code> for feature views.</p> <p>Note</p> <p>Both inference and training helper column name(s) must be part of the <code>Query</code> object. If helper column name(s) belong to feature group that is part of a <code>Join</code> with <code>prefix</code> defined, then this prefix needs to prepended to the original column name when defining helper column list.</p>"},{"location":"user_guides/fs/feature_view/helper-columns/#inference-helper-columns","title":"Inference Helper columns","text":"<p><code>inference_helper_columns</code> are a list of feature names that are not used for training the model itself but are used for extra information during online or batch inference.  For example computing on-demand feature like distance between previous and current place of transaction <code>loc_delta_t_minus_1</code> in credit card fraud detection system. Feature <code>loc_delta_t_minus_1</code> will be computed using previous transaction coordinates <code>longitude</code> and <code>latitude</code> that needs to fetched from the feature store and compared to the new transaction coordinates that arrives at inference application.  In this use case <code>longitude</code> and <code>latitude</code> are <code>inference_helper_columns</code>. They are not used for training but are necessary for computing on-demand feature <code>loc_delta_t_minus_1</code>.</p> Python <p>Define inference columns for feature views.</p> <pre><code># define query object \nquery = label_fg.select(\"fraud_label\")\\\n                .join(trans_fg.select([\"amount\", \"loc_delta_t_minus_1\", \"longitude\", \"latitude\", \"category\"])) \n\n# define feature view with helper columns\nfeature_view = fs.get_or_create_feature_view(\n    name='fv_with_helper_col',\n    version=1,\n    query=query,\n    labels=[\"fraud_label\"],\n    transformation_functions=transformation_functions,\n    inference_helper_columns=[\"longitude\", \"latitude\"],\n)\n</code></pre>"},{"location":"user_guides/fs/feature_view/helper-columns/#retrieval","title":"Retrieval","text":"<p>When retrieving data for model inference, helper columns will be omitted. However, they can be optionally fetched with inference or training data.</p>"},{"location":"user_guides/fs/feature_view/helper-columns/#batch-inference","title":"Batch inference","text":"Python <p>Fetch inference helper column values and compute on-demand features during batch inference.</p> <pre><code># import feature functions\nfrom feature_functions import location_delta, time_delta\n\n# Fetch feature view object  \nfeature_view = fs.get_feature_view(\n    name='fv_with_helper_col',\n    version=1,\n)\n\n# Fetch feature data for batch inference with helper columns\ndf = feature_view.get_batch_data(start_time=start_time, end_time=end_time, inference_helpers=True)\ndf['longitude_prev'] = df['longitude'].shift(-1)\ndf['latitute_prev'] = df['latitute'].shift(-1)\n\n# compute location delta\ndf['loc_delta_t_minus_1'] = df.apply(lambda row: location_delta(row['longitude'], \n                                                                row['latitute'],\n                                                                row['longitude_prev'], \n                                                                row['latitute_prev']), axis=1)\n\n# prepare datatame for prediction\ndf = df[[f.name for f in feature_view.features if not (f.label or f.inference_helper_column or f.training_helper_column)]]\n</code></pre>"},{"location":"user_guides/fs/feature_view/helper-columns/#online-inference","title":"Online inference","text":"Python <p>Fetch inference helper column values and compute on-demand features during online inference.</p> <pre><code>from feature_functions import location_delta, time_delta\n\n# Fetch feature view object  \nfeature_view = fs.get_feature_view(\n    name='fv_with_helper_col',\n    version=1,\n)\n\n# Fetch feature data for batch inference without helper columns\ndf_without_inference_helpers = feature_view.get_batch_data()\n\n# Fetch feature data for batch inference with helper columns\ndf_with_inference_helpers = feature_view.get_batch_data(inference_helpers=True)\n\n# here cc_num, longitute and lattitude are provided as parameters to the application\ncc_num = ...\nlongitude = ...\nlatitute = ...\n\n# get previous transaction location of this credit card\ninference_helper = feature_view.get_inference_helper({\"cc_num\": cc_num}, return_type=\"dict\")\n\n# compute location delta \nloc_delta_t_minus_1 = location_delta(longitude, \n                                     latitute, \n                                     inference_helper['longitude'], \n                                     inference_helper['latitute'])\n\n\n# Now get assembled feature vector for prediction\nfeature_vector = feature_view.get_feature_vector({\"cc_num\": cc_num}, \n                                                  passed_features={\"loc_delta_t_minus_1\": loc_delta_t_minus_1}\n                                                 )\n</code></pre>"},{"location":"user_guides/fs/feature_view/helper-columns/#training-helper-columns","title":"Training Helper columns","text":"<p><code>training_helper_columns</code> are a list of feature names that are not the part of the model schema itself but are used during training for the extra information.  For example one might want to use feature like <code>category</code> of the purchased product to assign different weights.</p> Python <p>Define training helper columns for feature views.</p> <pre><code># define query object \nquery = label_fg.select(\"fraud_label\")\\\n                .join(trans_fg.select([\"amount\", \"loc_delta_t_minus_1\", \"longitude\", \"latitude\", \"category\"])) \n\n# define feature view with helper columns\nfeature_view = fs.get_or_create_feature_view(\n    name='fv_with_helper_col',\n    version=1,\n    query=query,\n    labels=[\"fraud_label\"],\n    transformation_functions=transformation_functions,\n    training_helper_columns=[\"category\"]\n)\n</code></pre>"},{"location":"user_guides/fs/feature_view/helper-columns/#retrieval_1","title":"Retrieval","text":"<p>When retrieving training data helper columns will be omitted. However, they can be optionally fetched.</p> Python <p>Fetch training data with or without inference helper column values.</p> <pre><code># import feature functions\nfrom feature_functions import location_delta, time_delta\n\n# Fetch feature view object  \nfeature_view = fs.get_feature_view(\n    name='fv_with_helper_col',\n    version=1,\n)\n\n# Create and training data with training helper columns\nTEST_SIZE = 0.2\nX_train, X_test, y_train, y_test = feature_view.train_test_split(\n    description='transactions fraud training dataset',\n    test_size=TEST_SIZE,\n     training_helper_columns=True\n)\n\n# Get existing training data with training helper columns\nX_train, X_test, y_train, y_test = feature_view.get_train_test_split(\n     training_dataset_version=1,\n     training_helper_columns=True\n)\n</code></pre> <p>Note</p> <p>To use helper columns with materialized training dataset it needs to be created with <code>training_helper_columns=True</code>.  </p>"},{"location":"user_guides/fs/feature_view/overview/","title":"Feature View","text":"<p>A feature view is a set of features that come from one or more feature groups. It is a logical view over the feature groups, as the feature data is only stored in feature groups. Feature views are used to read feature data for both training and serving (online and batch). You can create training datasets, create batch data and get feature vectors.</p> <p>If you want to understand more about the concept of feature view, you can refer to here.</p>"},{"location":"user_guides/fs/feature_view/overview/#creation","title":"Creation","text":"<p>Query and transformation function are the building blocks of a feature view. You can define your set of features by building a <code>query</code>. You can also define which columns in your feature view are the <code>labels</code>, which is useful for supervised machine learning tasks. Furthermore, in python client, each feature can be attached to its own transformation function. This way, when a feature is read (for training or scoring), the transformation is executed on-demand - just before the feature data is returned. For example, when a client reads a numerical feature, the feature value could be normalized by a StandardScalar transformation function before it is returned to the client.</p> PythonJava <pre><code># create a simple feature view\nfeature_view = fs.create_feature_view(\n    name='transactions_view',\n    query=query\n)\n\n# create a feature view with transformation and label\nfeature_view = fs.create_feature_view(\n    name='transactions_view',\n    query=query,\n    labels=[\"fraud_label\"],\n    transformation_functions={\n        \"amount\": fs.get_transformation_function(name=\"standard_scaler\", version=1)\n    }\n)\n</code></pre> <pre><code>// create a simple feature view\nFeatureView featureView = featureStore.createFeatureView()\n                                        .name(\"transactions_view)\n                                        .query(query)\n                                        .build();\n\n// create a feature view with label\nFeatureView featureView = featureStore.createFeatureView()\n                                        .name(\"transactions_view)\n                                        .query(query)\n                                        .labels(Lists.newArrayList(\"fraud_label\")\n                                        .build();\n</code></pre> <p>You can refer to query and transformation function for creating <code>query</code> and <code>transformation_function</code>. To see a full example of how to create a feature view, you can read this notebook.</p>"},{"location":"user_guides/fs/feature_view/overview/#retrieval","title":"Retrieval","text":"<p>Once you have created a feature view, you can retrieve it by its name and version.</p> PythonJava <pre><code>feature_view = fs.get_feature_view(name=\"transactions_view\", version=1)\n</code></pre> <pre><code>FeatureView featureView = featureStore.getFeatureView(\"transactions_view\", 1)\n</code></pre>"},{"location":"user_guides/fs/feature_view/overview/#deletion","title":"Deletion","text":"<p>If there are some feature view instances which you do not use anymore, you can delete a feature view. It is important to mention that all training datasets (include all materialised hopsfs training data) will be deleted along with the feature view.</p> PythonJava <pre><code>feature_view.delete()\n</code></pre> <pre><code>featureView.delete()\n</code></pre>"},{"location":"user_guides/fs/feature_view/overview/#tags","title":"Tags","text":"<p>Feature views also support tags. You can attach, get, and remove tags. You can refer to here if you want to learn more about how tags work.</p> PythonJava <pre><code># attach\nfeature_view.add_tag(name=\"tag_schema\", value={\"key\", \"value\"}\n\n# get\nfeature_view.get_tag(name=\"tag_schema\")\n\n#remove\nfeature_view.delete_tag(name=\"tag_schema\")\n</code></pre> <pre><code>// attach\nMap&lt;String, String&gt; tag = Maps.newHashMap();\ntag.put(\"key\", \"value\");\nfeatureView.addTag(\"tag_schema\", tag)\n\n// get\nfeatureView.getTag(\"tag_schema\")\n\n// remove\nfeatureView.deleteTag(\"tag_schema\")\n</code></pre>"},{"location":"user_guides/fs/feature_view/overview/#next","title":"Next","text":"<p>Once you have created a feature view, you can now create training data</p>"},{"location":"user_guides/fs/feature_view/query/","title":"Query vs DataFrame","text":"<p>HSFS provides a DataFrame API to ingest data into the Hopsworks Feature Store. You can also retrieve feature data in a DataFrame, that can either be used directly to train models or materialized to file(s) for later use to train models.</p> <p>The idea of the Feature Store is to have pre-computed features available for both training and serving models. The key functionality required to generate training datasets from reusable features are: feature selection, joins, filters, and point in time queries. The Query object enables you to select features from different feature groups to join together to be used in a feature view.</p> <p>The joining functionality is heavily inspired by the APIs used by Pandas to merge DataFrames. The APIs allow you to specify which features to select from which feature group, how to join them and which features to use in join conditions.</p> PythonScala <pre><code># create a query\nfeature_join = rain_fg.select_all() \\\n    .join(temperature_fg.select_all(), on=[\"date\", \"location_id\"]) \\\n    .join(location_fg.select_all())\n\n# save the query to feature view\nfeature_view = fs.create_feature_view(\n    name='rain_dataset',\n    query=feature_join\n)\n\n# retrieve the query back from the feature view\nfeature_view = fs.get_feature_view(\u201crain_dataset\u201d, version=1)\nquery = feature_view.query\n</code></pre> <pre><code>// create a query\nval featureJoin = (rainFg.selectAll()\n    .join(temperatureFg.selectAll(), on=Seq(\"date\", \"location_id\"))\n    .join(locationFg.selectAll()))\n\nval featureView = featureStore.createFeatureView()\n    .name(\"rain_dataset\")\n    .query(featureJoin)\n    .build();\n\n// retrieve the query back from the feature view\nval featureView = fs.getFeatureView(\u201crain_dataset\u201d, 1)\nval query = featureView.getQuery()\n</code></pre> <p>If a data scientist wants to modify a new feature that is not available in the feature store, she can write code to compute the new feature (using existing features or external data) and ingest the new feature values into the feature store. If the new feature is based solely on existing feature values in the Feature Store, we call it a derived feature. The same HSFS APIs can be used to compute derived features as well as features using external data sources.</p>"},{"location":"user_guides/fs/feature_view/query/#the-query-abstraction","title":"The Query Abstraction","text":"<p>Most operations performed on <code>FeatureGroup</code> metadata objects will return a <code>Query</code> with the applied operation.</p>"},{"location":"user_guides/fs/feature_view/query/#examples","title":"Examples","text":"<p>Selecting features from a feature group is a lazy operation, returning a query with the selected features only:</p> PythonScala <pre><code>rain_fg = fs.get_feature_group(\"rain_fg\")\n\n# Returns Query\nfeature_join = rain_fg.select([\"location_id\", \"weekly_rainfall\"])\n</code></pre> <pre><code>val rainFg = fs.getFeatureGroup(\"rain_fg\")\n\n# Returns Query\nval featureJoin = rainFg.select(Seq(\"location_id\", \"weekly_rainfall\"))\n</code></pre>"},{"location":"user_guides/fs/feature_view/query/#join","title":"Join","text":"<p>Similarly, joins return query objects. The simplest join in one where we join all of the features together from two different feature groups without specifying a join key - <code>HSFS</code> will infer the join key as a common primary key between the two feature groups. By default, Hopsworks will use the maximal matching subset of the primary keys of the two feature groups as joining key(s), if not specified otherwise.</p> PythonScala <pre><code># Returns Query\nfeature_join = rain_fg.join(temperature_fg)\n</code></pre> <pre><code>// Returns Query\nval featureJoin = rainFg.join(temperatureFg)\n</code></pre> <p>More complex joins are possible by selecting subsets of features from the joined feature groups and by specifying a join key and type. Possible join types are \"inner\", \"left\" or \"right\". Furthermore, it is possible to specify different features for the join key of the left and right feature group. The join key lists should contain the names of the features to join on.</p> PythonScala <pre><code>feature_join = rain_fg.select_all() \\\n    .join(temperature_fg.select_all(), on=[\"date\", \"location_id\"]) \\\n    .join(location_fg.select_all(), left_on=[\"location_id\"], right_on=[\"id\"], join_type=\"left\")\n</code></pre> <pre><code>val featureJoin = (rainFg.selectAll()\n    .join(temperatureFg.selectAll(), Seq(\"date\", \"location_id\"))\n    .join(locationFg.selectAll(), Seq(\"location_id\"), Seq(\"id\"), \"left\"))\n</code></pre> <p>Nested Joins</p> <p>The API currently does not support nested joins. That is joins of joins. You can fall back to Spark DataFrames to cover these cases. However, if you have to use joins of joins, most likely there is potential to optimise your feature group structure.</p>"},{"location":"user_guides/fs/feature_view/query/#filter","title":"Filter","text":"<p>In the same way as joins, applying filters to feature groups creates a query with the applied filter.</p> <p>Filters are constructed with Python Operators <code>==</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code> and additionally with the methods <code>isin</code> and <code>like</code>. Bitwise Operators <code>&amp;</code> and <code>|</code> are used to construct conjunctions. For the Scala part of the API, equivalent methods are available in the <code>Feature</code> and <code>Filter</code> classes.</p> PythonScala <pre><code>filtered_rain = rain_fg.filter(rain_fg.location_id == 10)\n</code></pre> <pre><code>val filteredRain = rainFg.filter(rainFg.getFeature(\"location_id\").eq(10))\n</code></pre> <p>Filters are fully compatible with joins:</p> PythonScala <pre><code>feature_join = rain_fg.select_all() \\\n    .join(temperature_fg.select_all(), on=[\"date\", \"location_id\"]) \\\n    .join(location_fg.select_all(), left_on=[\"location_id\"], right_on=[\"id\"], join_type=\"left\") \\\n    .filter((rain_fg.location_id == 10) | (rain_fg.location_id == 20))\n</code></pre> <pre><code>val featureJoin = (rainFg.selectAll()\n    .join(temperatureFg.selectAll(), Seq(\"date\", \"location_id\"))\n    .join(locationFg.selectAll(), Seq(\"location_id\"), Seq(\"id\"), \"left\")\n    .filter(rainFg.getFeature(\"location_id\").eq(10).or(rainFg.getFeature(\"location_id\").eq(20))))\n</code></pre> <p>The filters can be applied at any point of the query:</p> PythonScala <pre><code>feature_join = rain_fg.select_all() \\\n    .join(temperature_fg.select_all().filter(temperature_fg.avg_temp &gt;= 22), on=[\"date\", \"location_id\"]) \\\n    .join(location_fg.select_all(), left_on=[\"location_id\"], right_on=[\"id\"], join_type=\"left\") \\\n    .filter(rain_fg.location_id == 10)\n</code></pre> <pre><code>val featureJoin = (rainFg.selectAll()\n    .join(temperatureFg.selectAll().filter(temperatureFg.getFeature(\"avg_temp\").ge(22)), Seq(\"date\", \"location_id\"))\n    .join(locationFg.selectAll(), Seq(\"location_id\"), Seq(\"id\"), \"left\")\n    .filter(rainFg.getFeature(\"location_id\").eq(10)))\n</code></pre>"},{"location":"user_guides/fs/feature_view/query/#joins-andor-filters-on-feature-view-query","title":"Joins and/or Filters on feature view query","text":"<p>The query retrieved from a feature view can be extended with new joins and/or new filters. However, this operation will not update the metadata and persist the updated query of the feature view itself. This query can then be used to create a new feature view.</p> PythonScala <pre><code>fs = ...\nwind_speed_fg = fs.get_feature_group(name=\"wind_speed_fg\", version=1)\nrain_fg = fs.get_feature_group(name=\"rain_fg\", version=1)\nfeature_view = fs.get_feature_view(\u201crain_dataset\u201d, version=1)\nfeature_view.query \\\n    .join(wind_speed_fg.select_all()) \\\n    .filter((rain_fg.location_id == 54)\n</code></pre> <pre><code>val fs = ...\nval windSpeedFg = fs.getFeatureGroup(\"wind_speed_fg\", 1)\nval rainFg = fs.getFeatureGroup(\"rain_fg\", 1)\nval featureView = fs.getFeatureView(\u201crain_dataset\u201d, 1)\nfeatureView.getQuery()\n    .join(windSpeedFg.selectAll())\n    .filter(rainFg.getFeature(\"location_id\").eq(54))\n</code></pre> <p>Warning</p> <p>Every join/filter operation applied to an existing feature view query instance will update its state and accumulate. To successfully apply new join/filter logic it is recommended to refresh the query instance by re-fetching the feature view:</p> PythonScala <pre><code>fs = ...\nwind_speed_fg = fs.get_feature_group(name=\"wind_speed_fg\", version=1)\nsolar_irradiance_fg = fs.get_feature_group(name=\"solar_irradiance_fg\", version=1)\nrain_fg = fs.get_feature_group(name=\"rain_fg\", version=1)\n\n# fetch new feature view and its query instance\nfeature_view = fs.get_feature_view(\u201crain_dataset\u201d, version=1)\n\n# apply join/filter logic based on location and wind speed\nfeature_view.query.join(wind_speed_fg.select_all()) \\\n    .filter((rain_fg.location_id == 54)\n\n# to apply new logic independent of location and wind speed from above \n# re-fetch new feature view and its query instance\nfeature_view = fs.get_feature_view(\u201crain_dataset\u201d, version=1)\n\n# apply new join/filter logic based on solar irradiance\nfeature_view.query.join(solar_irradiance_fg.select_all()) \\\n    .filter(solar_irradiance_fg.location_id == 28)\n</code></pre> <pre><code>fs = ...\nwindSpeedFg = fs.getFeatureGroup(\"wind_speed_fg\", 1)\nsolarIrradianceFg = fs.getFeatureGroup(\"solar_irradiance_fg\", 1)\nrainFg = fs.getFeatureGroup(\"rain_fg\", 1)\n\n// fetch new feature view and its query instance\nval featureView = fs.getFeatureView(\u201crain_dataset\u201d, version=1)\n\n// apply join/filter logic based on location and wind speed\nfeatureView.getQuery.join(windSpeedFg.selectAll())\n    .filter(rainFg.getFeature(\"location_id\").eq(54))\n\n// to apply new logic independent of location and wind speed from above \n// re-fetch new feature view and its query instance\nval featureView = fs.getFeatureView(\u201crain_dataset\u201d, 1)\n\n// apply new join/filter logic based on solar irradiance\nfeatureView.getQuery.join(solarIrradianceFg.selectAll())\n    .filter(solarIrradianceFg.getFeature(\"location_id\").eq(28))\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/","title":"Using Spines","text":"<p>In this section we will illustrate how to use a Spine Group instead of a regular Feature Group for performing point-in-time joins when reading batch data for inference or when creating training datasets.</p>"},{"location":"user_guides/fs/feature_view/spine-query/#prerequisites","title":"Prerequisites","text":"<ol> <li>Make sure you have read the concept section about spines in feature and inference pipelines.</li> <li>Make sure you have gone through the Spine Group creation guide.</li> <li>Make sure you understand the concept of feature views and how to create them using the query abstraction</li> </ol>"},{"location":"user_guides/fs/feature_view/spine-query/#feature-view-with-a-spine-group","title":"Feature View with a Spine Group","text":""},{"location":"user_guides/fs/feature_view/spine-query/#step-1-query-definition","title":"Step 1: Query Definition","text":"<p>The first step before creating a Feature View, is to construct the query by selecting the label and features which are needed:</p> <pre><code># Select features for training data.\nds_query = trans_fg.select([\"fraud_label\"])\\\n    .join(window_aggs_fg.select_except([\"cc_num\"]), on=\"cc_num\")\n\nds_query.show(5)\n</code></pre> <p>Similarly you can construct the query using a previously created spine equivalent.</p> <p>However, there are two thing to note:</p> <ol> <li>If you want to use the query for a feature view to be used for online serving, you can only select the \"label\" or target feature from the spine.</li> <li>Spine groups can only be used on the left side of the join. Think of the left side of the join as the base set of entities that should be included in you batch of data or training dataset, which we enrich with the relevant and point-in-time correct feature values.</li> </ol> <pre><code>trans_spine = fs.get_or_create_spine_group(\n    name=\"spine_transactions\",\n    version=1,\n    description=\"Transaction data\",\n    primary_key=['cc_num'],\n    event_time='datetime',\n    dataframe=trans_df\n)\n\n# Select features for training data.\nds_query_spine = trans_spine.select([\"fraud_label\"])\\\n    .join(window_aggs_fg.select_except([\"cc_num\"]), on=\"cc_num\")\n</code></pre> <p>Calling the <code>show()</code> or <code>read()</code> method of this query object will use the spine dataframe included in the Spine Group object to perform the join.</p> <pre><code>ds_query_spine.show(10)\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/#step-2-feature-view-creation","title":"Step 2: Feature View Creation","text":"<p>With the above defined query, we can continue to create the Feature View in the same way we would do it also without a spine:</p> <pre><code>feature_view_spine = fs.get_or_create_feature_view(\n    name='transactions_view_spine',\n    query=ds_query_spine,\n    version=1,\n    labels=[\"fraud_label\"],\n)\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/#step-3-training-dataset-creation","title":"Step 3: Training Dataset Creation","text":"<p>With the regular feature view, the labels are fetched from the feature store, but with the feature view created with a spine, you need to provide the dataframe. Here you have the chance to pass a different set of entities to generate the training dataset.</p> <pre><code>X_train, X_test, y_train, y_test = feature_view_spine.train_test_split(0.2, spine=new_entities_df)\n\nX_train.show()\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/#step-4-retrieving-new-batches-inference-data","title":"Step 4: Retrieving New Batches Inference Data","text":"<p>You can now use the offline and online API of the feature stores to read features for inference. Similarly to training dataset creation, every time you read up a new batch of data, you can pass a different spine dataframe.</p> <pre><code>feature_view_spine.get_batch_data(spine=scroing_spine_df).show()\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/#step-5-online-feature-lookup","title":"Step 5: Online Feature Lookup","text":"<p>For the online lookup, the label is not required, therefore it was important to only select label from the left spine group, so that we don't need to provide a spine for online serving:</p> <pre><code># Note: no spine needs to be passed\nfeature_view.get_feature_vector({\"cc_num\": 4473593503484549})\n</code></pre>"},{"location":"user_guides/fs/feature_view/spine-query/#replacing-a-regular-feature-group-with-a-spine-at-serving-time","title":"Replacing a Regular Feature Group with a Spine at Serving Time","text":"<p>In the case where you create a feature view with a regular feature group, but you would like to retrieve batch inference data using IDs (primary key values), you can use a spine to replace the left feature group. To do this, you can pass the Spine Group instead of a dataframe.</p> <pre><code># Note: here feature_view was created with regular feature groups only\n# and trans_spine is of type SpineGroup instead of a dataframe\nfeature_view.get_batch_data(spine=trans_spine).show()\n</code></pre>"},{"location":"user_guides/fs/feature_view/training-data/","title":"Training data","text":"<p>Training data can be created from the feature view and used by different ML libraries for training different models.</p> <p>You can read training data concepts for more details. To see a full example of how to create training data, you can read this notebook.</p> <p>For Python-clients, handling small or moderately-sized data, we recommend enabling the ArrowFlight Server with DuckDB service, which will provide significant speedups over Spark/Hive for reading and creating in-memory training datasets.</p>"},{"location":"user_guides/fs/feature_view/training-data/#creation","title":"Creation","text":"<p>It can be created as in-memory DataFrames or materialised as <code>tfrecords</code>, <code>parquet</code>, <code>csv</code>, or <code>tsv</code> files to HopsFS or in all other locations, for example, S3, GCS. If you materialise a training dataset, a <code>PySparkJob</code> will be launched. By default, <code>create_training_data</code> waits for the job to finish. However, you can run the job asynchronously by passing <code>write_options={\"wait_for_job\": False}</code>. You can monitor the job status in the jobs overview UI. </p> <pre><code># create a training dataset as dataframe\nfeature_df, label_df = feature_view.training_data(\n    description = 'transactions fraud batch training dataset',\n)\n\n# materialise a training dataset\nversion, job = feature_view.create_training_data(\n    description = 'transactions fraud batch training dataset',\n    data_format = 'csv',\n    write_options = {\"wait_for_job\": False}\n) # By default, it is materialised to HopsFS\nprint(job.id) # get the job's id and view the job status in the UI\n</code></pre>"},{"location":"user_guides/fs/feature_view/training-data/#extra-filters","title":"Extra filters","text":"<p>Sometimes data scientists need to train different models using subsets of a dataset. For example, there can be different models for different countries, seasons, and different groups. One way is to create different feature views for training different models. Another way is to add extra filters on top of the feature view when creating training data.</p> <p>In the transaction fraud example, there are different transaction categories, for example: \"Health/Beauty\", \"Restaurant/Cafeteria\", \"Holliday/Travel\" etc. Examples below show how to create training data for different transaction categories. <pre><code># Create a training dataset for Health/Beauty\ndf_health = feature_view.training_data(\n    description = 'transactions fraud batch training dataset for Health/Beauty',\n    extra_filter = trans_fg.category == \"Health/Beauty\"\n)\n# Create a training dataset for Restaurant/Cafeteria and Holliday/Travel\ndf_restaurant_travel = feature_view.training_data(\n    description = 'transactions fraud batch training dataset for Restaurant/Cafeteria and Holliday/Travel',\n    extra_filter = trans_fg.category == \"Restaurant/Cafeteria\" and trans_fg.category == \"Holliday/Travel\"\n)\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/training-data/#trainvalidationtest-splits","title":"Train/Validation/Test Splits","text":"<p>In most cases, ML practitioners want to slice a dataset into multiple splits, most commonly train-test splits or train-validation-test splits, so that they can train and test their models. Feature view provides a sklearn-like API for this purpose, so it is very easy to create a training dataset with different splits.</p> <p>Create a training dataset (as in-memory DataFrames) or materialise a training dataset with train and test splits. <pre><code># create a training dataset \nX_train, X_test, y_train, y_test = feature_view.train_test_split(test_size=0.2)\n\n# materialise a training dataset\nversion, job = feature_view.create_train_test_split(\n    test_size = 0.2,\n    description = 'transactions fraud batch training dataset',\n    data_format = 'csv'\n)\n</code></pre></p> <p>Create a training dataset (as in-memory DataFrames) or materialise a training dataset with train, validation, and test splits. <pre><code># create a training dataset as DataFrame\nX_train, X_val, X_test, y_train, y_val, y_test = feature_view.train_validation_test_split(validation_size=0.3, test_size=0.2)\n\n# materialise a training dataset\nversion, job = feature_view.create_train_validation_test_split(\n    validation_size = 0.3, \n    test_size = 0.2\n    description = 'transactions fraud batch training dataset',\n    data_format = 'csv'\n)\n</code></pre></p> <p>If the ArrowFlight Server with DuckDB service is enabled, and you want to create a particular in-memory training dataset with Hive instead, you can set <code>read_options={\"use_hive\": True}</code>. <pre><code># create a training dataset as DataFrame with Hive\nX_train, X_test, y_train, y_test = feature_view.train_test_split(test_size=0.2, read_options={\"use_hive: True})\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/training-data/#read-training-data","title":"Read Training Data","text":"<p>Once you have created a training dataset, all its metadata are saved in Hopsworks. This enables you to reproduce exactly the same dataset at a later point in time. This holds for training data as both DataFrames or files. That is, you can delete the training data files (for example, to reduce storage costs), but still reproduce the training data files later on if you need to. <pre><code># get a training dataset\nfeature_df, label_df = feature_view.get_training_data(training_dataset_version=1)\n\n# get a training dataset with train and test splits\nX_train, X_test, y_train, y_test = feature_view.get_train_test_split(training_dataset_version=1)\n\n# get a training dataset with train, validation and test splits\nX_train, X_val, X_test, y_train, y_val, y_test = feature_view.get_train_validation_test_split(training_dataset_version=1)\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/training-data/#read-training-data-with-primary-keys-and-event-time","title":"Read training data with primary key(s) and event time","text":"<p>For certain use cases, e.g. time series models, the input data needs to be sorted according to the primary key(s) and event time combination.  Primary key(s) and event time are not usually included in the feature view query as they are not features used for training. To retrieve the primary key(s) and/or event time when retrieving training data, you need to set the parameters <code>primary_keys=True</code> and/or <code>event_time=True</code>.</p> <pre><code># get a training dataset\nX_train, X_test, y_train, y_test = feature_view.get_train_test_split(training_dataset_version=1, \n                                                                     primary_keys=True,\n                                                                     event_time=True)\n</code></pre> <p>Note</p> <p>If the event time columns have the same name across all the feature groups included in the feature view, then only the event time of the label feature group (left most feature group in the query) will be returned. If they have different names, then all of them will be returned. The Join prefix does not have any influence on this behaviour.</p> <p>To use primary key(s) and event time column with materialized training datasets it needs to be created with <code>primary_keys=True</code> and/or <code>with_event_time=True</code>.  </p>"},{"location":"user_guides/fs/feature_view/training-data/#deletion","title":"Deletion","text":"<p>To clean up unused training data, you can delete all training data or for a particular version. Note that all metadata of training data and materialised files stored in HopsFS will be deleted and cannot be recreated anymore. <pre><code># delete a training data version\nfeature_view.delete_training_dataset(training_dataset_version=1)\n\n# delete all training datasets\nfeature_view.delete_all_training_datasets()\n</code></pre> It is also possible to keep the metadata and delete only the materialised files. Then you can recreate the deleted files by just specifying a version, and you get back the exact same dataset again. This is useful when you are running out of storage. <pre><code># delete files of a training data version\nfeature_view.purge_training_data(training_dataset_version=1)\n\n# delete files of all training datasets\nfeature_view.purge_all_training_data()\n</code></pre> To recreate a training dataset: <pre><code>feature_view.recreate_training_dataset(training_dataset_version=1)\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/training-data/#tags","title":"Tags","text":"<p>Similar to feature view, You can attach, get, and remove tags. You can refer to here if you want to learn more about how tags work. <pre><code># attach\nfeature_view.add_training_dataset_tag(\n    training_dataset_version=1, \n    name=\"tag_schema\", \n    value={\"key\", \"value\"}\n)\n\n# get\nfeature_view.get_training_dataset_tag(training_dataset_version=1, name=\"tag_schema\")\n\n#remove\nfeature_view.delete_training_dataset_tag(training_dataset_version=1, name=\"tag_schema\")\n</code></pre></p>"},{"location":"user_guides/fs/feature_view/training-data/#next","title":"Next","text":"<p>Once you have created a training dataset and trained your model, you can deploy your model in a \"batch\"  or \"online\" setting. Next, you can learn how to create batch data and get feature vectors.</p>"},{"location":"user_guides/fs/feature_view/transformation-function/","title":"Transformation Functions","text":"<p>HSFS provides functionality to attach transformation functions to feature views.</p> <p>User defined, custom transformation functions need to be registered in the feature store to make them accessible for feature view creation. To register them in the feature store, they either have to be part of the library installed in Hopsworks or attached when starting a Jupyter notebook or Hopsworks job.</p> <p>Pyspark decorators</p> <p>Don't decorate transformation functions with Pyspark <code>@udf</code> or <code>@pandas_udf</code>, and also make sure not to use any Pyspark dependencies. That is because, the transformation functions may be executed by Python clients. HSFS will decorate transformation function for you only if it is used inside Pyspark application.</p>"},{"location":"user_guides/fs/feature_view/transformation-function/#creation","title":"Creation","text":"<p>Hopsworks ships built-in transformation functions such as <code>min_max_scaler</code>, <code>standard_scaler</code>, <code>robust_scaler</code> and <code>label_encoder</code>. </p> <p>You can also create new functions. Let's assume that you have already installed Python library transformation_fn_template containing the transformation function <code>plus_one</code>.</p> Python <p>Register transformation function  <code>plus_one</code> in the Hopsworks feature store.</p> <pre><code>from custom_functions import transformations\nplus_one_meta = fs.create_transformation_function(\n            transformation_function=transformations.plus_one,\n            output_type=int,\n            version=1)\nplus_one_meta.save()\n</code></pre>"},{"location":"user_guides/fs/feature_view/transformation-function/#retrieval","title":"Retrieval","text":"<p>To retrieve all transformation functions from the feature store, use <code>get_transformation_functions</code> which will return the list of available <code>TransformationFunction</code> objects. A specific transformation function can be retrieved with the <code>get_transformation_function</code> method where you can provide its name and version of the transformation function. If only the function name is provided then it will default to version 1.</p> Python <p>Retrieving transformation functions from the feature store</p> <pre><code># get all transformation functions\nfs.get_transformation_functions()\n\n# get transformation function by name. This will default to version 1\nplus_one_fn = fs.get_transformation_function(name=\"plus_one\")\n\n# get built-in transformation function min max scaler\nmin_max_scaler_fn = fs.get_transformation_function(name=\"min_max_scaler\")\n\n# get transformation function by name and version.\nplus_one_fn = fs.get_transformation_function(name=\"plus_one\", version=2)\n</code></pre>"},{"location":"user_guides/fs/feature_view/transformation-function/#apply-transformation-functions-to-features","title":"Apply transformation functions to features","text":"<p>You can define in the feature view transformation functions as dict, where key is feature name and value is online transformation function name. Then the transformation functions are applied when you read training data, read batch data, or get feature vectors.</p> Python <p>Attaching transformation functions to the feature view</p> <pre><code>plus_one_fn = fs.get_transformation_function(name=\"plus_one\", version=1)\nfeature_view = fs.create_feature_view(\n    name='transactions_view',\n    query=query,\n    labels=[\"fraud_label\"],\n    transformation_functions={\n        \"amount_spent\": plus_one_fn\n    }\n)\n</code></pre> <p>Built-in transformation functions are attached in the same way. The only difference is that it will compute the necessary statistics for the specific function in the background. For example min and max values for <code>min_max_scaler</code>; mean and standard deviation for <code>standard_scaler</code> etc.</p> Python <p>Attaching built-in transformation functions to the feature view</p> <pre><code>min_max_scaler = fs.get_transformation_function(name=\"min_max_scaler\")\nstandard_scaler = fs.get_transformation_function(name=\"standard_scaler\")\nrobust_scaler = fs.get_transformation_function(name=\"robust_scaler\")\nlabel_encoder = fs.get_transformation_function(name=\"label_encoder\")\n\nfeature_view = fs.create_feature_view(\n    name='transactions_view',\n    query=query,\n    labels=[\"fraud_label\"],\n    transformation_functions = {\n        \"category\": label_encoder,\n        \"amount\": robust_scaler,\n        \"loc_delta\": min_max_scaler,\n        \"age_at_transaction\": standard_scaler\n    }\n)\n</code></pre> <p>Java/Scala support</p> <p>Creating and attaching Transformation functions to feature views are not supported for HSFS Java or Scala client. If feature view with transformation function was created using python client, you cannot get training data or get feature vectors from HSFS Java or Scala client.</p>"},{"location":"user_guides/fs/provenance/provenance/","title":"Provenance","text":""},{"location":"user_guides/fs/provenance/provenance/#introduction","title":"Introduction","text":"<p>Hopsworks feature store allows users to track provenance (lineage) between feature groups, feature views and training dataset. Tracking lineage allows users to determine where/if a feature group is being used. You can track if feature groups are being used to create additional (derived) feature groups or feature views. </p> <p>You can interact with the provenance graph using the UI and the APIs.</p>"},{"location":"user_guides/fs/provenance/provenance/#step-1-feature-group-lineage","title":"Step 1: Feature group lineage","text":""},{"location":"user_guides/fs/provenance/provenance/#assign-parents-to-a-feature-group","title":"Assign parents to a feature group","text":"<p>When creating a feature group, it is possible to specify a list of feature groups used to create the derived features. For example, you could have an external feature group defined over a Snowflake or Redshift table, which you use to compute the features and save them in a feature group. You can mark the external feature group as parent of the feature group you are creating by using the <code>parents</code> parameter in the get_or_create_feature_group or create_feature_group methods:</p> Python <pre><code># Retrieve the feature group\nprofiles_fg = fs.get_external_feature_group(\"user_profiles\", version=1)\n\n# Do feature engineering \nage_df = transaction_df.merge(profiles_fg.read(), on=\"cc_num\", how=\"left\")\ntransaction_df[\"age_at_transaction\"] = (age_df[\"datetime\"] - age_df[\"birthdate\"]) / np.timedelta64(1, \"Y\")\n\n# Create the transaction feature group\ntransaction_fg = fs.get_or_create_feature_group(\n    name=\"transaction_fraud_batch\",\n    version=1,\n    description=\"Transaction features\",\n    primary_key=[\"cc_num\"],\n    event_time=\"datetime\",\n    parents=[profiles_fg]\n)\ntransaction_fg.insert(transaction_df)\n</code></pre> <p>Another example use case for derived feature group is if you have a feature group containing features with daily resolution and you are using the content of that feature group to populate a second feature group with monthly resolution: </p> Python <pre><code># Retrieve the feature group\ndaily_transaction_fg = fs.get_feature_group(\"daily_transaction\", version=1)\ndaily_transaction_df = daily_transaction_fg.read()\n\n# Do feature engineering \ncc_group = daily_transaction_df[[\"cc_num\", \"amount\", \"datetime\"]] \\\n                .groupby(\"cc_num\") \\\n                .rolling(\"1M\", on=\"datetime\")\nmonthly_transaction_df  = pd.DataFrame(cc_group.mean())\n\n# Create the transaction feature group\nmonthly_transaction_fg = fs.get_or_create_feature_group(\n    name=\"monthly_transaction_fraud_batch\",\n    version=1,\n    description=\"Transaction features - monthly aggregates\",\n    primary_key=[\"cc_num\"],\n    event_time=\"datetime\",\n    parents=[daily_transaction_fg]\n)\nmonthly_transaction_fg.insert(monthly_transaction_df)\n</code></pre>"},{"location":"user_guides/fs/provenance/provenance/#list-feature-group-parents","title":"List feature group parents","text":"<p>You can query the provenance graph of a feature group using the UI and the APIs. From the APIs you can list the parent feature groups by calling the method get_parent_feature_groups</p> Python <pre><code>lineage = transaction_fg.get_parent_feature_groups()\n\n# List all accessible parent feature groups\nlineage.accessible\n\n# List all deleted parent feature groups\nlineage.deleted\n\n# List all the inaccessible parent feature groups\nlineage.inaccessible\n</code></pre> <p>A parent is marked as <code>deleted</code> (and added to the deleted list) if the parent feature group was deleted. <code>inaccessible</code> if you no longer have access to the parent feature group (e.g. the parent feature group belongs to a project you no longer have access to).</p> <p>To traverse the provenance graph in the opposite direction (i.e. from the parent feature group to the child), you can use the get_generate_feature_groups method. When navigating the provenance graph downstream, the <code>deleted</code> feature groups are not tracked by provenance, as such, the <code>deleted</code> property will always return an empty list.</p> Python <pre><code>lineage = transaction_fg.get_generated_feature_groups()\n\n# List all accessible child feature groups\nlineage.accessible\n\n# List all the inaccessible child feature groups\nlineage.inaccessible\n</code></pre> <p>You can also visualize the relationship between the parent and child feature groups in the UI. In each feature group overview page you can find a provenance section with the graph of parent feature groups and child feature groups/feature views.</p> <p> Provenance graph of derived feature groups </p>"},{"location":"user_guides/fs/provenance/provenance/#step-2-feature-view-lineage","title":"Step 2: Feature view lineage","text":"<p>The relationship between feature groups and feature views is captured automatically when you create a feature view. You can inspect the relationship between feature groups and feature views using the APIs or the UI.</p>"},{"location":"user_guides/fs/provenance/provenance/#using-the-apis","title":"Using the APIs","text":"<p>Starting from a feature view metadata object, you can traverse upstream the provenance graph to retrieve the metadata objects of the feature groups that are part of the feature view. To do so, you can use the get_parent_feature_groups method.</p> Python <pre><code>lineage = fraud_fv.get_parent_feature_groups()\n\n# List all accessible parent feature groups\nlineage.accessible\n\n# List all deleted parent feature groups\nlineage.deleted\n\n# List all the inaccessible parent feature groups\nlineage.inaccessible\n</code></pre> <p>You can also traverse the provenance graph in the opposite direction. Starting from a feature group you can navigate downstream and list all the feature views the feature group is used in. As for the derived feature group example above, when navigating the provenance graph downstream <code>deleted</code> feature views are not tracked. As such, the <code>deleted</code> property will always be empty.</p> Python <pre><code>lineage = transaction_fg.get_generated_feature_views()\n\n# List all accessible downstream feature views \nlineage.accessible\n\n# List all the inaccessible downstream feature views \nlineage.inaccessible\n</code></pre>"},{"location":"user_guides/fs/provenance/provenance/#using-the-ui","title":"Using the UI","text":"<p>In the feature view overview UI you can explore the provenance graph of the feature view:</p> <p> Feature view provenance graph </p>"},{"location":"user_guides/fs/sharing/sharing/","title":"Sharing","text":""},{"location":"user_guides/fs/sharing/sharing/#introduction","title":"Introduction","text":"<p>Hopsworks allows artifacts (e.g. feature groups, feature views) to be shared between projects. There are two main use cases for sharing features between projects:</p> <ul> <li> <p>If you have multiple teams working on the same Hopsworks deployment. Each team works within its own set of projects.    If team A wants to leverage features built by team B, they can do so by sharing the feature groups from a team A project to a team B project.</p> </li> <li> <p>By creating different projects for the different stages of the development lifecycle (e.g. a dev project, a testing project, and a production project),    you can make sure that changes on the development project don't impact the features in the production project. At the same time, you might want to    leverage production features to develop new models or additional features. In this case, you can share the production feature store with the    development feature store in <code>read-only</code> mode.</p> </li> </ul>"},{"location":"user_guides/fs/sharing/sharing/#step-1-open-the-project-of-the-feature-store-that-you-would-like-to-share-on-hopsworks","title":"Step 1: Open the project of the feature store that you would like to share on Hopsworks.","text":"<p>In the <code>Project Settings</code> navigate to the <code>Shared with other projects</code> section.</p> <p> </p>"},{"location":"user_guides/fs/sharing/sharing/#step-2-share","title":"Step 2: Share","text":"<p>Click <code>Share feature store</code> to bring up the dialog for sharing.</p> <p>In the <code>Project</code> section choose project you wish to share the feature store with.</p> <p> </p> <p>Feature stores can be shared exclusively using <code>read-only</code> permission. This means that a member is not capable of enacting any changes on the shared project.</p>"},{"location":"user_guides/fs/sharing/sharing/#step-3-accept-the-invitation","title":"Step 3: Accept the Invitation","text":"<p>In the project where the feature store was shared (step 2) go to <code>Project Settings</code> and navigate to the <code>Shared from other projects</code> section. Click <code>accept</code>.</p> <p> </p> <p>After accepting the share, the shared feature store is listed under the <code>Shared from other projects</code> section.</p> <p> </p>"},{"location":"user_guides/fs/sharing/sharing/#use-features-from-a-shared-feature-store","title":"Use features from a shared feature store","text":""},{"location":"user_guides/fs/sharing/sharing/#step-1-get-feature-store-handles","title":"Step 1: Get feature store handles","text":"<p>To access features from a shared feature store you need to first retrieve the handle for the shared feature store.  To retrieve the handle use the get_feature_store() method and provide the name of the shared feature store</p> <pre><code>import hsfs\n\nconnection = hsfs.connection()\n\nproject_feature_store = connection.get_feature_store()\nshared_feature_store = connection.get_feature_store(name=\"name_of_shared_feature_store\")\n</code></pre>"},{"location":"user_guides/fs/sharing/sharing/#step-2-fetch-feature-groups","title":"Step 2: Fetch feature groups","text":"<pre><code># fetch feature group object from shared feature store\nshared_fg = shared_feature_store.get_feature_group(\n    name=\"shared_fg_name\",\n    version=\"1\")\n\n# fetch feature group object from project feature store\nfg_a = project_feature_store.get_or_create_feature_group(\n    name=\"feature_group_name\",\n    version=1)\n</code></pre>"},{"location":"user_guides/fs/sharing/sharing/#step-3-join-feature-groups","title":"Step 3: Join feature groups","text":"<pre><code># join above feature groups\nquery = shared_fg.select_all().join(fg_a.select_all())\n</code></pre>"},{"location":"user_guides/fs/sharing/sharing/#conclusion","title":"Conclusion","text":"<p>In this guide, you learned how to share a feature store and how to join features from different feature stores.</p>"},{"location":"user_guides/fs/storage_connector/","title":"Storage Connector Guides","text":"<p>You can define storage connectors in Hopsworks for batch and streaming data sources. Storage connectors securely store the authentication information about how to connect to an external data store. They can be used from programs within Hopsworks or externally.</p> <p>There are three main use cases for Storage Connectors:</p> <ul> <li>Simply use it to read data from the storage into a dataframe.</li> <li>External (on-demand) Feature Groups can be defined with storage connectors as data source. This way, Hopsworks stores only the metadata about the features, but does not keep a copy of the data itself. This is also called the Connector API.</li> <li>Write training data to an external storage system to make it accessible by third parties.</li> </ul> <p>Storage connectors provide two main mechanisms for authentication: using credentials or an authentication role (IAM Role on AWS or Managed Identity on Azure). Hopsworks supports both a single IAM role (AWS) or Managed Identity (Azure) for the whole Hopsworks cluster or multiple IAM roles (AWS) or Managed Identities (Azure) that can only be assumed by users with a specific role in a specific project.</p> <p>By default, each project is created with three default Storage Connectors: A JDBC connector to the online feature store, a HopsFS connector to the Training Datasets directory of the project and a JDBC connector to the offline feature store.</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/#cloud-agnostic","title":"Cloud Agnostic","text":"<p>Cloud agnostic storage systems:</p> <ol> <li>JDBC: Connect to JDBC compatible databases and query them using SQL.</li> <li>Snowflake: Query Snowflake databases and tables using SQL.</li> <li>Kafka: Read data from a Kafka cluster into a Spark Structured Streaming Dataframe.</li> <li>HopsFS: Easily connect and read from directories of Hopsworks' internal File System.</li> </ol>"},{"location":"user_guides/fs/storage_connector/#aws","title":"AWS","text":"<p>For AWS the following storage systems are supported:</p> <ol> <li>S3: Read data from a variety of file based storage in S3 such as parquet or CSV.</li> <li>Redshift: Query Redshift databases and tables using SQL.</li> </ol>"},{"location":"user_guides/fs/storage_connector/#azure","title":"Azure","text":"<p>For AWS the following storage systems are supported:</p> <ol> <li>ADLS: Read data from a variety of file based storage in ADLS such as parquet or CSV.</li> </ol>"},{"location":"user_guides/fs/storage_connector/#gcp","title":"GCP","text":"<p>For GCP the following storage systems are supported:</p> <ol> <li>BigQuery: Query BigQuery databases and tables using SQL.</li> <li>GCS: Read data from a variety of file based storage in Google Cloud Storage such as parquet or CSV.</li> </ol>"},{"location":"user_guides/fs/storage_connector/#next-steps","title":"Next Steps","text":"<p>Move on to the Configuration and Creation Guides to learn how to set up a storage connector.</p>"},{"location":"user_guides/fs/storage_connector/usage/","title":"Storage Connector Usage","text":"<p>Here, we look at how to use a Storage Connector after it has been created.  Storage Connectors provide an important first step for integrating with external data sources. The 3 fundamental functionalities where storage connectors are used are:</p> <ol> <li>Reading data into Spark Dataframes</li> <li>Creating external feature groups</li> <li>Writing training data</li> </ol> <p>We will walk through each functionality in the sections below.</p>"},{"location":"user_guides/fs/storage_connector/usage/#retrieving-a-storage-connector","title":"Retrieving a Storage Connector","text":"<p>We retrieve a storage connector simply by its unique name.</p> PySparkScala <pre><code>import hsfs\n# Connect to the Hopsworks feature store\nhsfs_connection = hsfs.connection()\n# Retrieve the metadata handle\nfeature_store = hsfs_connection.get_feature_store()\n# Retrieve storage connector\nconnector = feature_store.get_storage_connector('connector_name')\n</code></pre> <pre><code>import com.logicalclocks.hsfs._\nval connection = HopsworksConnection.builder().build();\nval featureStore = connection.getFeatureStore();\n// get directly via connector sub-type class e.g. for GCS type\nval connector = featureStore.getGcsConnector(\"connector_name\")\n</code></pre>"},{"location":"user_guides/fs/storage_connector/usage/#reading-a-spark-dataframe-from-a-storage-connector","title":"Reading a Spark Dataframe from a Storage Connector","text":"<p>One of the most common usages of a Storage Connector is to read data directly into a Spark Dataframe. It's achieved via the <code>read</code> API of the connector object, which hides all the complexity of authentication and integration  with a data storage source.  The <code>read</code> API primarily has two parameters for specifying the data source, <code>path</code> and <code>query</code>, depending on the storage connector type. The exact behaviour could change depending on the storage connector type, but broadly they could be classified as below</p>"},{"location":"user_guides/fs/storage_connector/usage/#data-lakeobject-based-connectors","title":"Data lake/object based connectors","text":"<p>For data sources based on object/file storage such as AWS S3, ADLS, GCS, we set the full object path in the <code>path</code> argument and users should pass a Spark data format (parquet, csv, orc, hudi, delta) to the <code>data_format</code> argument.</p> PySparkScala <pre><code># read data into dataframe using path \ndf = connector.read(data_format='data_format', path='fileScheme://bucket/path/')   \n</code></pre> <pre><code>// read data into dataframe using path     \nval df = connector.read(\"\", \"data_format\", new HashMap(), \"fileScheme://bucket/path/\")  \n</code></pre>"},{"location":"user_guides/fs/storage_connector/usage/#prepare-spark-api","title":"Prepare Spark API","text":"<p>Additionally, for reading file based data sources, another way to read the data is using the <code>prepare_spark</code> method. This method can be used if you are reading the data directly through Spark. </p> <p>Firstly, it handles the setup of all Spark configurations or properties necessary for a particular type of connector and  prepares the absolute path to read from, along with bucket name and the appropriate file scheme of the data source. A Spark session can handle only one configuration setup at a time, so HSFS cannot set the Spark configurations when retrieving the connector since it would lead to only always initialising the last connector being retrieved. Instead, user can do this setup explicitly with the <code>prepare_spark</code> method and therefore potentially use multiple connectors in one Spark session. <code>prepare_spark</code> handles only one bucket associated with that particular connector, however, it is possible to set up multiple connectors with different types as long as their Spark properties do not interfere with each other. So, for example a S3 connector and a Snowflake connector can be used in the same session, without calling <code>prepare_spark</code> multiple times, as the properties don\u2019t interfere with each other.</p> <p>If the storage connector is used in another API call, <code>prepare_spark</code> gets implicitly invoked, for example,  when a user materialises a training dataset using a storage connector or uses the storage connector to set up an External Feature Group.  So users do not need to call <code>prepare_spark</code> every time they do an operation with a connector, it is only necessary when reading directly using Spark . Using <code>prepare_spark</code> is also  not necessary when using the <code>read</code> API.</p> <p>For example, to read directly from a S3 connector, we use the <code>prepare_spark</code> as follows</p> PySpark <pre><code>connector.prepare_spark()\nspark.read.format(\"json\").load(\"s3a://[bucket]/path\")\n# or\nspark.read.format(\"json\").load(connector.prepare_spark(\"s3a://[bucket]/path\"))\n</code></pre>"},{"location":"user_guides/fs/storage_connector/usage/#data-warehousesql-based-connectors","title":"Data warehouse/SQL based connectors","text":"<p>For data sources accessed via SQL such as data warehouses and JDBC compliant databases, e.g. Redshift, Snowflake, BigQuery, JDBC, users pass the SQL query to read the data to the <code>query</code>  argument. In most cases, this will be some form of a <code>SELECT</code> query. Depending on the connector type, users can also just set the table path and read the whole table without explicitly  passing any SQL query to the <code>query</code> argument. This is mostly relevant for Google BigQuery.</p> PySparkScala <pre><code># read results from a SQL \ndf = connector.read(query=\"SELECT * FROM TABLE\")    \n# or directly read a table if set on connector\ndf = connector.read()\n</code></pre> <pre><code>// read results from a SQL \nval df = connector.read(\"SELECT * FROM TABLE\", \"\" , new HashMap(),\"\")    \n</code></pre>"},{"location":"user_guides/fs/storage_connector/usage/#streaming-based-connector","title":"Streaming based connector","text":"<p>For reading data streams, the Kafka Storage Connector supports reading a Kafka topic into Spark Structured Streaming Dataframes  instead of a static Dataframe as in other connector types.</p> PySpark <pre><code>df = connector.read_stream(topic='kafka_topic_name')\n</code></pre>"},{"location":"user_guides/fs/storage_connector/usage/#creating-an-external-feature-group","title":"Creating an External Feature Group","text":"<p>Another important aspect of a storage connector is its ability to facilitate creation of external feature groups with  the Connector API. External feature groups are basically offline feature groups and essentially stored as tables on external data sources.  The <code>Connector API</code> relies on storage connectors behind the scenes to integrate with external datasource. This enables seamless integration with any data source as long as there is a storage connector defined.</p> <p>To create an external feature group, we use the <code>create_external_feature_group</code> API, also known as <code>Connector API</code>,  and simply pass the storage connector created before to the <code>storage_connector</code> argument.  Depending on the external data source, we should set either the <code>query</code> argument for data warehouse based data sources, or  the <code>path</code> and <code>data_format</code> arguments for data lake based sources, similar to reading into dataframes as explained in above section.</p> <p>Example for any data warehouse/SQL based external sources, we set the desired SQL to <code>query</code> argument, and set the <code>storage_connector</code> argument to the storage connector object of desired data source.</p> PySpark <pre><code>fg = feature_store.create_external_feature_group(name=\"sales\",\n    version=1\n    description=\"Physical shop sales features\",\n    query=\"SELECT * FROM TABLE\",\n    storage_connector=connector,\n    primary_key=['ss_store_sk'],\n    event_time='sale_date'\n)\n</code></pre> <p><code>Connector API</code> (external feature groups) only stores the metadata about the features within Hopsworks,  while the actual data is still stored externally. This enables users to create feature groups within Hopsworks without the hassle of data migration. For more information on <code>Connector API</code>, read detailed guide about external feature groups.</p>"},{"location":"user_guides/fs/storage_connector/usage/#writing-training-data","title":"Writing Training Data","text":"<p>Storage connectors are also used while writing training data to external sources. While calling the  Feature View API <code>create_training_data</code> , we can pass the <code>storage_connector</code> argument which is necessary to materialise  the data to external sources, as shown below.</p> PySpark <pre><code># materialise a training dataset\nversion, job = feature_view.create_training_data(\n    description = 'describe training data',\n    data_format = 'spark_data_format', # e.g. data_format = \"parquet\" or data_format = \"csv\"\n    write_options = {\"wait_for_job\": False},\n    storage_connector = connector\n) \n</code></pre> <p>Read more about training data creation here.</p>"},{"location":"user_guides/fs/storage_connector/usage/#next-steps","title":"Next Steps","text":"<p>We have gone through the basic use cases of a storage connector.  For more details about the API functionality for any specific connector type,  checkout the API section.</p>"},{"location":"user_guides/fs/storage_connector/creation/adls/","title":"How-To set up a ADLS Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/adls/#introduction","title":"Introduction","text":"<p>Azure Data Lake Storage (ADLS) Gen2 is a HDFS-compatible filesystem on Azure for data analytics. The ADLS Gen2 filesystem stores its data in Azure Blob storage, ensuring low-cost storage, high availability, and disaster recovery. In Hopsworks, you can access ADLS Gen2 by defining a Storage Connector and creating and granting permissions to a service principal.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a connection to your Azure ADLS filesystem. When you're finished, you'll be able to read files using Spark through HSFS APIs. You can also use the connector to write out training data from the Feature Store, in order to make it accessible by third parties.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/adls/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from your Azure ADLS account:</p> <ul> <li>Data Lake Storage Gen2 Account: Create an Azure Data Lake Storage Gen2 account and initialize a filesystem, enabling the hierarchical namespace. Note that your storage account must belong to an Azure resource group.</li> <li>Azure AD application and service principal: Create an Azure AD application and service principal that can access your ADLS storage account and its resource group.</li> <li>Service Principal Registration: Register the service principal, granting it a role assignment such as Storage Blob Data Contributor, on the Azure Data Lake Storage Gen2 account.</li> </ul> <p>Info</p> <p>When you specify the 'container name' in the ADLS storage connector, you need to have previously created that container - the Hopsworks Feature Store will not create that storage container for you.</p>"},{"location":"user_guides/fs/storage_connector/creation/adls/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/adls/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/adls/#step-2-enter-adls-information","title":"Step 2: Enter ADLS Information","text":"<p>Enter the details for your ADLS connector. Start by giving it a name and an optional description.</p> <p> </p> ADLS Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/adls/#step-3-azure-create-an-adls-resource","title":"Step 3: Azure Create an ADLS Resource","text":"<p>When programmatically signing in, you need to pass the tenant ID with your authentication request and the application ID. You also need a certificate or an authentication key (described in the following section). To get those values, use the following steps:</p> <ol> <li>Select Azure Active Directory.</li> <li>From App registrations in Azure AD, select your application.</li> <li> <p>Copy the Directory (tenant) ID and store it in your application code.      You need to copy the Directory (tenant) id and paste it to the Hopsworks ADLS storage connector  \"Directory id\" text field. </p> </li> <li> <p>Copy the Application ID and store it in your application code.      &gt;You need to copy the Application id and paste it to the Hopsworks ADLS storage connector \"Application id\" text field. </p> </li> <li> <p>Create an Application Secret and copy it into the Service Credential field.      You need to copy the Application Secret and paste it to the Hopsworks ADLS storage connector \"Service Credential\" text field. </p> </li> </ol>"},{"location":"user_guides/fs/storage_connector/creation/adls/#common-problems","title":"Common Problems","text":"<p>If you get a permission denied error when writing or reading to/from a ADLS container, it is often because the storage principal (app) does not have the correct permissions. Have you added the \"Storage Blob Data Owner\" or \"Storage Blob Data Contributor\" role to the resource group for your storage account (or the subscription for your storage group, if you apply roles at the subscription level)? Go to your resource group, then in \"Access Control (IAM)\", click the \"Add\" button to add a \"role assignment\".</p> <p>If you get an error \"StatusCode=404 StatusDescription=The specified filesystem does not exist.\", then maybe you have not created the storage account or the storage container.</p>"},{"location":"user_guides/fs/storage_connector/creation/adls/#references","title":"References","text":"<ul> <li>How to create a service principal on Azure</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/adls/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created ADLS connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/bigquery/","title":"How-To set up a BigQuery Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/bigquery/#introduction","title":"Introduction","text":"<p>A BigQuery storage connector provides integration to Google Cloud BigQuery. BigQuery is Google Cloud's managed data warehouse supporting that lets you run analytics and  execute SQL queries over large scale data. Such data warehouses are often the source of raw data for feature  engineering pipelines.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to connect to your BigQuery project by saving the necessary information. When you're finished, you'll be able to execute queries and read results of BigQuery using Spark through  HSFS APIs.</p> <p>The storage connector uses the Google <code>spark-bigquery-connector</code> behind the scenes. To read more about the spark connector, like the spark options or usage, check Apache Spark SQL connector for Google BigQuery.</p> <p>Note</p> <pre><code>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.\n</code></pre>"},{"location":"user_guides/fs/storage_connector/creation/bigquery/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information about your GCP account:</p> <ul> <li>BigQuery Project: You need a BigQuery project, dataset and table created and have read access to it. Or, if    you wish to query a public dataset you need its corresponding details.</li> <li>Authentication Method: Authentication to GCP account is handled by uploading the <code>JSON keyfile for service   account</code> to the Hopsworks Project. You will need to create this JSON keyfile from GCP. For more information on   service accounts   and creating keyfile in GCP, read Google Cloud documentation.</li> </ul> <p>Note</p> <pre><code>To read data, the BigQuery service account user needs permission to `create read sesssion` which is available in **BigQuery Admin role**.\n</code></pre>"},{"location":"user_guides/fs/storage_connector/creation/bigquery/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/bigquery/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/bigquery/#step-2-enter-connector-details","title":"Step 2: Enter connector details","text":"<p>Enter the details for your BigQuery connector. Start by giving it a unique name and an optional description.</p> <p> </p> BigQuery Connector Creation Form <ol> <li>Choose <code>Google BigQuery</code> from the connector options.</li> <li>Next, set the name of the parent BigQuery project. This is used for billing by GCP.</li> <li>Authentication: Here you should upload your <code>JSON keyfile for service     account</code> used for authentication. You can choose to either    upload from your local using <code>Upload new file</code> or choose an existing file within project using <code>From Project</code>.</li> <li> <p>Read Options: There are two ways to read via BigQuery, using the BigQuery Table or BigQuery Query option:</p> <ol> <li>BigQuery Table - This option reads directly from BigQuery table reference. Note that it can only be used in <code>read</code> API for reading data from BigQuery. Creating external Feature Groups using this option is not yet supported. In the UI set the below fields, <ol> <li>BigQuery Project: The BigQuery project</li> <li>BigQuery Dataset: The dataset of the table</li> <li>BigQuery Table: The table to read</li> </ol> </li> <li>BigQuery Query - This option executes a SQL query at runtime. It can be used for both reading data and creating external Feature Groups. <ol> <li>Materialization Dataset: Temporary dataset used by BigQuery for writing. It must be set to a dataset where the GCP user has table creation permission. The queried table must be in the same location as the <code>materializationDataset</code> (e.g 'EU' or 'US'). Also, if a table in the <code>SQL statement</code> is from project other than the <code>parentProject</code> then use the fully qualified table name i.e. <code>[project].[dataset].[table]</code>   (Read more details from Google documentation on usage of query for BigQuery spark connector here).</li> </ol> </li> </ol> </li> <li> <p>Spark Options: Optionally, you can set additional spark options using the <code>Key - Value</code> pairs.</p> </li> </ol>"},{"location":"user_guides/fs/storage_connector/creation/bigquery/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created BigQuery  connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/gcs/","title":"How-To set up a GCS Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/gcs/#introduction","title":"Introduction","text":"<p>This particular type of storage connector provides integration to Google Cloud Storage (GCS). GCS is  an object storage service offered by Google Cloud. An object could be simply any piece  of immutable data consisting of a file of any format, for example a <code>CSV</code> or <code>PARQUET</code>. These objects are stored in  containers called as <code>buckets</code>.</p> <p>These types of storages are often the source for raw data from which features can be engineered.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to connect to your GCS bucket by saving the  necessary information. When you're finished, you'll be able to read files from the GCS bucket using Spark through HSFS APIs.</p> <p>The storage connector uses the Google <code>gcs-connector-hadoop</code> behind the scenes. For more information, check out Google Cloud Storage Connector for Spark and Hadoop</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/gcs/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information about your GCP account and bucket:</p> <ul> <li>Bucket: You need a GCS bucket created and have read access to it. The bucket is identified by its name.</li> <li>Authentication Method: Authentication to GCP account is handled by uploading the <code>JSON keyfile for service    account</code> to the Hopsworks Project. You will need to create this JSON keyfile from GCP. For more information on    service accounts    and creating keyfile in GCP, read Google Cloud documentation.</li> <li>Server-side Encryption GCS encrypts the data on server side by default. The connector additionally supports the    optional encryption method <code>Customer Supplied Encryption Key</code> by GCP. You can choose the encryption option <code>AES-256</code> and provide AES-256 key and hash, encoded in    standard Base64. The encryption details are stored as Secrets    in the Hopsworks for keeping it secure.   Read more about encryption on Google Documentation.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/gcs/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/gcs/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/gcs/#step-2-enter-connector-details","title":"Step 2: Enter connector details","text":"<p>Enter the details for your GCS connector. Start by giving  it a unique name and an optional  description.</p> <p> </p> GCS Connector Creation Form <ol> <li>Choose <code>Google Cloud Storage</code> from the connector options.</li> <li>Next, set the name of the GCS Bucket you wish to connect with.</li> <li>Authentication: Here you should upload your <code>JSON keyfile for service    account</code> used for authentication. You can choose to either    upload from your local using <code>Upload new file</code> or choose an existing file within project using <code>From Project</code>.</li> <li>GCS Server Side Encryption: You can leave this to <code>Default Encryption</code> if you do not wish to provide explicit encrypting keys. Otherwise,  optionally you can set the encryption setting for <code>AES-256</code> and provide the encryption key and hash when selected.</li> </ol>"},{"location":"user_guides/fs/storage_connector/creation/gcs/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created GCS  connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/hopsfs/","title":"How-To set up a HopsFS Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#introduction","title":"Introduction","text":"<p>HopsFS is a HDFS-compatible filesystem on AWS/Azure/on-premises for data analytics. HopsFS stores its data on object storage in the cloud (S3 in AWs and Blob storage on Azure) and on commodity servers on-premises, ensuring low-cost storage, high availability, and disaster recovery. In Hopsworks, you can access HopsFS natively in programs (Spark, TensorFlow, etc) without the need to define a Storage Connector. By default, every Project has a Storage Connector for Training Datasets. When you create training datasets from features in the Feature Store the HopsFS connector is the default Storage Connector. However, if you want to output data to a different dataset, you can define a new Storage Connector for that dataset.</p> <p>In this guide, you will configure a HopsFS Storage Connector in Hopsworks which points at a different directory on the file system than the Training Datasets directory. When you're finished, you'll be able to write training data to different locations in your cluster through HSFS APIs.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to identify a directory on the filesystem of Hopsworks, to which you want to point the Storage Connector that you are going to create.</p>"},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#step-2-enter-hopsfs-settings","title":"Step 2: Enter HopsFS Settings","text":"<p>Enter the details for your HopsFS connector. Start by giving it a name and an optional description.</p> <ol> <li>Select \"HopsFS\" as connector protocol.</li> <li>Select the top-level directory to point the connector to.</li> <li>Click \"Setup storage connector\".</li> </ol> <p> </p> HopsFS Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/hopsfs/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created HopsFS connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/jdbc/","title":"How-To set up a JDBC Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/jdbc/#introduction","title":"Introduction","text":"<p>JDBC is an API provided by many database systems. Using JDBC connections one can query and update data in a database, usually oriented towards relational databases. Examples of databases you can connect to using JDBC are MySQL, Postgres, Oracle, DB2, MongoDB or Microsoft SQLServer.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a JDBC connection to your database of choice. When you're finished, you'll be able to query the database using Spark through HSFS APIs.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/jdbc/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from your JDBC compatible database:</p> <ul> <li>JDBC Connection URL: Consult the documentation of your target database to determine the correct JDBC URL and parameters. As an example, for MySQL the URL could be:</li> </ul> <pre><code>jdbc:mysql://10.0.2.15:3306/[databaseName]?useSSL=false&amp;allowPublicKeyRetrieval=true\n</code></pre> <ul> <li>Username and Password: Typically, you will need to add username and password in your JDBC URL or as key/value parameters. So make sure you have retrieved a username and password with the suitable permissions for the database and table you want to query.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/jdbc/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/jdbc/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/jdbc/#step-2-enter-jdbc-settings","title":"Step 2: Enter JDBC Settings","text":"<p>Enter the details for your JDBC enabled database.</p> <ol> <li>Select \"JDBC\" as connector protocol.</li> <li>Enter the JDBC connection url. This can for example also contain the username and password.</li> <li>Add additional key/value arguments to be passed to the connection. These might differ by database. It can be the username and password.</li> <li>Click \"Setup storage connector\".</li> </ol> <p> </p> JDBC Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/jdbc/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created JDBC connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/kafka/","title":"How-To set up a Kafka Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/kafka/#introduction","title":"Introduction","text":"<p>Apache Kafka is a distributed event store and stream-processing platform. It's a very popular framework for handling realtime data streams and is often used as a message broker for events coming from production systems until they are being processed and either loaded into a data warehouse or aggregated into features for Machine Learning.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a connection to your Kafka cluster. When you're finished, you'll be able to read from Kafka topics in your cluster using Spark through HSFS APIs.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/kafka/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from Kafka cluster, the following options are mandatory:</p> <ul> <li>Kafka Bootstrap servers: It is the url of one of the Kafka brokers which you give to fetch the initial metadata about your Kafka cluster. The metadata consists of the topics, their partitions, the leader brokers for those partitions etc. Depending upon this metadata your producer or consumer produces or consumes the data.</li> <li>Security Protocol: The security protocol you want to use to authenticate with your Kafka cluster. Make sure the chosen protocol is supported by your cluster. For an overview of the available protocols, please see the Confluent Kafka Documentation.</li> <li>Certificates: Depending on the chosen security protocol, you might need TrustStore and KeyStore files along with the corresponding key password. Contact your Kafka administrator, if you don't know how to retrieve these. If you want to setup a storage connector to Hopsworks' internal Kafka cluster, you can download the needed certificates from the integration tab in your project settings.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/kafka/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/kafka/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/kafka/#step-2-enter-kafka-settings","title":"Step 2: Enter Kafka Settings","text":"<p>Enter the details for your Kafka connector. Start by giving it a name and an optional description.</p> <ol> <li>Select \"Kafka\" as connector protocol.</li> <li>Add all the bootstrap server addresses and ports that you want the consumers/producers to connect to. The client will make use of all servers irrespective of which servers are specified here for bootstrapping\u2014this list only impacts the initial hosts used to discover the full set of servers.</li> <li> <p>Choose the Security protocol.</p> <p>TSL/SSL</p> <p>By default, Apache Kafka communicates in <code>PLAINTEXT</code>, which means that all data is sent in the clear. To encrypt communication, you should configure all the Confluent Platform components in your deployment to use TLS/SSL encryption.</p> <p>TLS uses private-key/certificate pairs, which are used during the TLS handshake process.</p> <p>Each broker needs its own private-key/certificate pair, and the client uses the certificate to authenticate the broker. Each logical client needs a private-key/certificate pair if client authentication is enabled, and the broker uses the certificate to authenticate the client.</p> <p>These are provided in the form of TrustStore and KeyStore <code>JKS</code> files together with a key password. For more information, refer to the official Apacha Kafka Guide for TSL/SSL authentication.</p> <p>SASL SSL or SASL plaintext</p> <p>Apache Kafka brokers support client authentication using SASL. SASL authentication can be enabled concurrently with TLS/SSL encryption (TLS/SSL client authentication will be disabled).</p> <p>This authentication method often requires extra arguments depending on your setup. Make use of the optional additional key/value arguments (5) to provide these.</p> <p>SASL authentication can be enabled concurrently with TLS/SSL encryption (TLS/SSL client authentication will be disabled). For more information, please refer to the offical Apache Kafka Guide for SASL authentication.</p> </li> <li> <p>The endpoint identification algorithm used by clients to validate server host name. The default value is <code>https</code>. Clients including client connections created by the broker for inter-broker communication verify that the broker host name matches the host name in the broker\u2019s certificate.</p> </li> <li>Optional additional key/value arguments.</li> <li>Click \"Setup storage connector\".</li> </ol> <p> </p> Kafka Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/kafka/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created Kafka connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/redshift/","title":"How-To set up a Redshift Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/redshift/#introduction","title":"Introduction","text":"<p>Amazon Redshift is a popular managed data warehouse on AWS, used as a data warehouse in many enterprises. </p> <p>Data warehouses are often the source of raw data for feature engineering pipelines and Redshift supports scalable feature computation with SQL. However, Redshift is not viable as an online feature store that serves features to models in production, with its columnar database layout its latency is too high compared to OLTP databases or key-value stores.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a connection to your AWS Redshift cluster. When you're finished, you'll be able to query the database using Spark through HSFS APIs.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/redshift/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from your AWS account and Redshift database, the following options are mandatory:</p> <ul> <li>Cluster identifier: The name of the cluster.</li> <li>Database endpoint: The endpoint for the database. Should be in the format of <code>[UUID].eu-west-1.redshift.amazonaws.com</code>.</li> <li>Database name: The name of the database to query.</li> <li>Database port: The port of the cluster. Defaults to 5349.</li> <li>Authentication method: There are three options available for authenticating with the Redshift cluster. The first option is to configure a username and a password.  The second option is to configure an IAM role. With IAM roles, Jobs or notebooks launched on Hopsworks do not need to explicitly authenticate with Redshift, as the HSFS library will transparently use the IAM role to acquire a temporary credential to authenticate the specified user.  Read more about IAM roles in our AWS credentials passthrough guide. Lastly,    option <code>Instance Role</code> will use the default ARN Role configured for the cluster instance.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/redshift/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/redshift/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/redshift/#step-2-enter-the-connector-information","title":"Step 2: Enter The Connector Information","text":"<p>Enter the details for your Redshift connector. Start by giving it a name and an optional description.</p> <ol> <li>Select \"Redshift\" as connector protocol.</li> <li>The name of the cluster.</li> <li>The database endpoint. Should be in the format <code>[UUID].eu-west-1.redshift.amazonaws.com</code>. For example, if the endpoint info     displayed in Redshift is <code>cluster-id.uuid.eu-north-1.redshift.amazonaws.com:5439/dev</code> the value to enter     here is just <code>uuid.eu-north-1.redshift.amazonaws.com</code> </li> <li>The database name.</li> <li>The database port.</li> <li>The database username, here you have the possibility to let Hopsworks auto-create the username for you.</li> <li>Database Driver (optional): You can use the default JDBC Redshift Driver <code>com.amazon.redshift.jdbc42.Driver</code>     included in Hopsworks or set a different driver (More on this later).</li> <li>Optionally provide the database group and table for the connector. A database group is the group created     for the user if applicable. More information, at redshift documentation</li> <li>Set the appropriate authentication method. </li> </ol> <p> </p> Redshift Connector Creation Form <p>Session Duration</p> <p>By default, the session duration that the role will be assumed for is 1 hour or 3600 seconds. This means if you want to use the storage connector for example to read or create an external Feature Group from Redshift, the operation cannot take longer than one hour.</p> <p>Your administrator can change the default session duration for AWS storage connectors, by first increasing the max session duration of the IAM Role that you are assuming. And then changing the <code>fs_storage_connector_session_duration</code> configuration property to the appropriate value in seconds.</p>"},{"location":"user_guides/fs/storage_connector/creation/redshift/#step-3-upload-the-redshift-database-driver-optional","title":"Step 3: Upload the Redshift database driver (optional)","text":"<p>The <code>redshift-jdbc42</code> JDBC driver is included by default in the Hopsworks distribution.  If you wish to use a different driver, you need to upload it on Hopsworks and add it as a dependency of Jobs and Jupyter Notebooks that need it. First, you need to download the library. Select the driver version without the AWS SDK.</p>"},{"location":"user_guides/fs/storage_connector/creation/redshift/#add-the-driver-to-jupyter-notebooks-and-spark-jobs","title":"Add the driver to Jupyter Notebooks and Spark jobs","text":"<p>You can now add the driver file to the default job and Jupyter configuration. This way, all jobs and Jupyter instances in the project will have the driver attached so that Spark can access it.</p> <ol> <li>Go into the Project's settings.</li> <li>Select \"Compute configuration\".</li> <li>Select \"Spark\".</li> <li>Under \"Additional Jars\" choose \"Upload new file\" to upload the driver jar file.</li> </ol> <p> </p> Attaching the Redshift Driver to all Jobs and Jupyter Instances of the Project <p>Alternatively, you can choose the \"From Project\" option. You will first have to upload the jar file to the Project using the File Browser. After you have uploaded the jar  file, you can select it using the \"From Project\" option. To upload the jar file to the Project through the File Browser, see the example below:</p> <ol> <li>Open File Browser</li> <li>Navigate to \"Resources\" directory</li> <li>Upload the jar file</li> </ol> <p> </p> Redshift Driver Upload in the File Browser <p>Tip</p> <p>If you face network connectivity issues to your Redshift cluster, a common cause could be the cluster database port  not being accessible from outside the Redshift cluster VPC network. A quick and dirty way to enable connectivity is  to Enable Publicly Accessible. However, in a production setting, you should use VPC peering  or some equivalent mechanism for connecting the clusters.</p>"},{"location":"user_guides/fs/storage_connector/creation/redshift/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created Redshift connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/","title":"How-To set up a S3 Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/s3/#introduction","title":"Introduction","text":"<p>Amazon S3 or Amazon Simple Storage Service is a service offered by AWS that provides object storage. That means you can store arbitrary objects associated with a key. These kind of storage systems are often used as Data Lakes with large volumes of unstructured data or file based storage. Popular file formats are <code>CSV</code> or <code>PARQUET</code>.</p> <p>There are so called Data Lake House technologies such as Delta Lake or Apache Hudi, building an additional layer on top of object based storage with files, to provide database semantics like ACID transactions among others. This has the advantage that cheap storage can be turned into a cloud native data warehouse. These kind of storages are often the source for raw data from which features can be engineered.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a connection to your AWS S3 bucket. When you're finished, you'll be able to read files using Spark through HSFS APIs. You can also use the connector to write out training data from the Feature Store, in order to make it accessible by third parties.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from your AWS S3 account and bucket:</p> <ul> <li>Bucket: You will need a S3 bucket that you have access to. The bucket is identified by its name.</li> <li>Authentication Method: You can authenticate using Access Key/Secret, or use IAM roles. If you want to use an IAM role it either needs to be attached to the entire Hopsworks cluster or Hopsworks needs to be able to assume the role. See IAM role documentation for more information.</li> <li>Server Side Encryption details: If your bucket has server side encryption (SSE) enabled, make sure you know which algorithm it is using (AES256 or SSE-KMS). If you are using SSE-KMS, you need the resource ARN of the managed key.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/s3/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/s3/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/s3/#step-2-enter-bucket-information","title":"Step 2: Enter Bucket Information","text":"<p>Enter the details for your S3 connector. Start by giving it a name and an optional description. And set the name of the S3 Bucket you want to point the connector to.</p> <p> </p> S3 Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/s3/#step-3-configure-authentication","title":"Step 3: Configure Authentication","text":""},{"location":"user_guides/fs/storage_connector/creation/s3/#instance-role","title":"Instance Role","text":"<p>Choose instance role if you have an EC2 instance profile attached to your Hopsworks cluster nodes with a role which grants you access to the specified bucket.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#temporary-credentials","title":"Temporary Credentials","text":"<p>Choose temporary credentials if you are using AWS Role chaining to control the access permission on a project and user role base. Once you have selected Temporary Credentials select the role that give access to the specified bucket. For this role to appear in the list it needs to have been configured by an administrator, see the AWS Role chaining documentation for more details.</p> <p>Session Duration</p> <p>By default, the session duration that the role will be assumed for is 1 hour or 3600 seconds. This means if you want to use the storage connector for example to write training data to S3, the training dataset creation cannot take longer than one hour.</p> <p>Your administrator can change the default session duration for AWS storage connectors, by first increasing the max session duration of the IAM Role that you are assuming. And then changing the <code>fs_storage_connector_session_duration</code> configuration variable to the appropriate value in seconds.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#access-keysecret","title":"Access Key/Secret","text":"<p>The most simple authentication method are Access Key/Secret, choose this option to get started quickly, if you are able to retrieve the keys using the IAM user administration.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#step-4-configure-server-side-encryption","title":"Step 4: Configure Server Side Encryption","text":"<p>Additionally, you can specify if your Bucket has SSE enabled.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#aes256","title":"AES256","text":"<p>For AES256, there is nothing to do but enabling the encryption by toggling the <code>AES256</code> option. This is using S3-Managed Keys, also called SSE-S3. </p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#sse-kms","title":"SSE-KMS","text":"<p>With this option the encryption key is managed by AWS KMS, with some additional benefits and charges for using this service. The difference is that you need to provide the resource ARN of the key. </p> <p>If you have SSE-KMS enabled for your bucket, you can find the key ARN in the \"Properties\" section of the bucket details on AWS.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#step-5-add-spark-options-optional","title":"Step 5: Add Spark Options (optional)","text":"<p>Here you can specify any additional spark options that you wish to add to the spark context at runtime. Multiple options can be added as key - value pairs.</p> <p>Tip</p> <p>To connect to a S3 compatiable storage other than AWS S3, you can add the option with key as <code>fs.s3a.endpoint</code> and the endpoint you want to use as value. The storage connector will then be able to read from your specified S3 compatible storage.</p>"},{"location":"user_guides/fs/storage_connector/creation/s3/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created S3 connector.</p>"},{"location":"user_guides/fs/storage_connector/creation/snowflake/","title":"How-To set up a Snowflake Storage Connector","text":""},{"location":"user_guides/fs/storage_connector/creation/snowflake/#introduction","title":"Introduction","text":"<p>Snowflake provides a cloud-based data storage and analytics service, used as a data warehouse in many enterprises. </p> <p>Data warehouses are often the source of raw data for feature engineering pipelines and Snowflake supports scalable feature computation with SQL. However, Snowflake is not viable as an online feature store that serves features to models in production, with its columnar database layout its latency is too high compared to OLTP databases or key-value stores.</p> <p>In this guide, you will configure a Storage Connector in Hopsworks to save all the authentication information needed in order to set up a connection to your Snowflake database. When you're finished, you'll be able to query the database using Spark through HSFS APIs.</p> <p>Note</p> <p>Currently, it is only possible to create storage connectors in the Hopsworks UI. You cannot create a storage connector programmatically.</p>"},{"location":"user_guides/fs/storage_connector/creation/snowflake/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need to retrieve the following information from your Snowflake account and database, the following options are mandatory:</p> <ul> <li>Snowflake Connection URL: Consult the documentation of your target snowflake account to determine the correct connection URL. This is usually some form of your Snowflake account identifier. For example: <pre><code>&lt;account_identifier&gt;.snowflakecomputing.com\n</code></pre> OR: <pre><code>https://&lt;orgname&gt;-&lt;account_name&gt;.snowflakecomputing.com\n</code></pre> The account and organization details can be viewed in the Snowsight UI under Admin &gt; Account or by querying it in  SQL, as explained in Snowflake documentation. Below is an example of how to view the account and organization to get the account identifier from the Snowsight UI.</li> </ul> <p> </p> Viewing Snowflake account identifier <p>Token-based authentication or password based</p> <p>The Snowflake storage connector supports both username and password authentication as well as token-based authentication.</p> <p>Currently token-based authentication is in beta phase. Users are advised to use username/password and/or create a service account for accessing Snowflake from Hopsworks.</p> <ul> <li>Username and Password: Login name for the Snowflake user and password. This is often also referred to as <code>sfUser</code> and <code>sfPassword</code>.</li> <li>Warehouse: The warehouse to use for the session after connecting</li> <li>Database: The database to use for the session after connecting.</li> <li>Schema: The schema to use for the session after connecting.</li> </ul> <p>These are a few additional optional arguments:</p> <ul> <li>Role: The role field can be used to specify which Snowflake security role to assume for the session after the connection is established.</li> <li>Application: The application field can also be specified to have better observability in Snowflake with regards to which application is running which query. The application field can be a simple string like \u201cHopsworks\u201d or, for instance, the project name, to track usage and queries from each Hopsworks project.</li> </ul>"},{"location":"user_guides/fs/storage_connector/creation/snowflake/#creation-in-the-ui","title":"Creation in the UI","text":""},{"location":"user_guides/fs/storage_connector/creation/snowflake/#step-1-set-up-new-storage-connector","title":"Step 1: Set up new storage connector","text":"<p>Head to the Storage Connector View on Hopsworks (1) and set up a new storage connector (2).</p> <p> </p> The Storage Connector View in the User Interface"},{"location":"user_guides/fs/storage_connector/creation/snowflake/#step-2-enter-snowflake-settings","title":"Step 2: Enter Snowflake Settings","text":"<p>Enter the details for your Snowflake connector. Start by giving it a name and an optional description.</p> <ol> <li>Select \"Snowflake\" as connector protocol.</li> <li>Specify the hostname for your account in the following format <code>&lt;account_identifier&gt;.snowflakecomputing.com</code>  or <code>https://&lt;orgname&gt;-&lt;account_name&gt;.snowflakecomputing.com</code>.</li> <li>Login name for the Snowflake user.</li> <li>Password for the Snowflake user or Token.</li> <li>The database to connect to.</li> <li>The schema to use for the connection to the database.</li> <li>Additional optional arguments. For example, you can point the connector to a specific table in the database only.</li> <li>Optional additional key/value arguments.</li> <li>Click \"Setup storage connector\".</li> </ol> <p> </p> Snowflake Connector Creation Form"},{"location":"user_guides/fs/storage_connector/creation/snowflake/#next-steps","title":"Next Steps","text":"<p>Move on to the usage guide for storage connectors to see how you can use your newly created Snowflake connector.</p>"},{"location":"user_guides/fs/tags/tags/","title":"Tags","text":""},{"location":"user_guides/fs/tags/tags/#introduction","title":"Introduction","text":"<p>Hopsworks feature store enables users to attach tags to artifacts, such as feature groups, feature views or training datasets.</p> <p>A tag is a <code>{key: value}</code> pair which provides additional information about the data managed by Hopsworks. Tags allow you to design custom metadata for your artifacts. For example, you could design a tag schema that encodes governance rules for your feature store, such as classifying data as personally identifiable, defining a data retention period for the data, and defining who signed off on the creation of some feature.</p>"},{"location":"user_guides/fs/tags/tags/#prerequisites","title":"Prerequisites","text":"<p>Tags have a schema. Before you can attach a tag to an artifact and fill in the tag values, you first need to select an existing tag schema or create a new tag schema.</p> <p>Tag schemas can be defined by Hopsworks administrator in the <code>Cluster settings</code> section of the platform. Schemas are defined globally across all projects. When users attach tags to an artifact, the tag will be validated against a specific schema. This allows tags to be consistent no matter the project or the team generating them. </p> <p>Immutable</p> <p>Tag schemas are immutable. Once defined, a tag schema cannot be edited nor deleted. </p>"},{"location":"user_guides/fs/tags/tags/#step-1-define-a-tag-schema","title":"Step 1: Define a tag schema","text":"<p>Tag schemas can be defined using the UI wizard in the <code>Cluster settings</code> &gt; <code>Tag schemas</code> section.  Tag schemas have a name, the name is used to uniquely identify the schema. You can also provide an optional description.</p> <p>You can define a schema by using the UI tool or by providing the schema in JSON format. If you use the UI tool, you should provide the name of the property in the schema, the type of the property, whether or not the property is required and an optional description. </p> <p> UI tag schema definition </p> <p>The UI tool allows you to define simple not-nested schemas. For more advanced use cases, more complex schemas (e.g. nested schemas) might be required to fully express the content of a given artifact. In such cases it is possible to provide the schema directly as JSON string. The JSON should follow the standard https://json-schema.org. An example of complex schema is the following:</p> <pre><code>{\n  \"type\" : \"object\",\n  \"properties\" :\n  {\n    \"first_name\" : { \"type\" : \"string\" },\n    \"last_name\" : { \"type\" : \"string\" },\n    \"age\" : { \"type\" : \"integer\" },\n    \"hobbies\" : {\n        \"type\" : \"array\",\n        \"items\" : { \"type\" : \"string\" }\n    }\n  },\n  \"required\" : [\"first_name\", \"last_name\", \"age\"],\n  \"additionalProperties\": false\n}\n</code></pre> <p>Additionally it is also possible to define a single property as tag. You can achieve this by defining a JSON schema like the following:</p> <pre><code>{ \"type\" : \"string\" }\n</code></pre> <p>Where the type is a valid primitive type: <code>string</code>, <code>boolean</code>, <code>integer</code>, <code>number</code>.</p>"},{"location":"user_guides/fs/tags/tags/#step-2-attach-a-tag-to-an-artifact","title":"Step 2: Attach a tag to an artifact","text":"<p>Once the tag schema has been created, you can attach a tag with that schema to a feature group, feature view or training datasets either using the feature store APIs, or by using the UI.</p>"},{"location":"user_guides/fs/tags/tags/#using-the-api","title":"Using the API","text":"<p>You can attach tags to feature groups and feature views by using the <code>add_tag()</code> method of the feature store APIs:</p> Python <pre><code># Retrieve the feature group\nfg = fs.get_feature_group(\"transactions_4h_aggs_fraud_batch_fg\", version=1)\n\n# Define the tag\ntag = {\n    'business_unit': 'Fraud',\n    'data_owner': 'email@hopsworks.ai',\n    'pii': True\n}\n\n# Attach the tag\nfg.add_tag(\"data_privacy\", tag) \n</code></pre> <p>You can see the list of tags attached to a given artifact by using the <code>get_tags()</code> method:</p> Python <pre><code># Retrieve the feature group\nfg = fs.get_feature_group(\"transactions_4h_aggs_fraud_batch_fg\", version=1)\n\n# Retrieve the tags for this feature group \nfg.get_tags()\n</code></pre> <p>Finally you can remove a tag from a given artifact by calling the <code>delete_tag()</code> method:</p> Python <pre><code># Retrieve the feature group\nfg = fs.get_feature_group(\"transactions_4h_aggs_fraud_batch_fg\", version=1)\n\n# Retrieve the tags for this feature group \nfg.delete_tag(\"data_privacy\")\n</code></pre> <p>The same APIs work for feature views and training dataset alike.</p>"},{"location":"user_guides/fs/tags/tags/#using-the-ui","title":"Using the UI","text":"<p>You can attach tags to feature groups and feature views directly from the UI. You can navigate on the artifact page and click on the <code>Add tags</code> button. From there you can select the tag schema of the tag you want to attach and populate the values as shown in the gif below.</p> <p> Attach tag to a feature group </p>"},{"location":"user_guides/fs/tags/tags/#step-3-search","title":"Step 3: Search","text":"<p>Hopsworks indexes the tags attached to feature groups, feature views and training datasets. The tags will then be searchable using the free text search box located at the top of the UI. </p> <p> Search for tags in the feature store </p>"},{"location":"user_guides/integrations/","title":"Client Integrations","text":"<p>Hopsworks is an open platform aiming to be accessible from a variety of tools. Learn in this section how to connect to Hopsworks from</p> <ul> <li>Python</li> <li>Databricks</li> <li>AWS SageMaker</li> <li>AWS EMR</li> <li>Azure HDInsight</li> <li>Azure Machine Learning</li> <li>Apache Spark</li> </ul>"},{"location":"user_guides/integrations/assume_role/","title":"Assuming a role","text":"<p>When deploying Hopsworks on EC2 instances you might need to assume different roles to access resources on AWS. These roles are configured in AWS and mapped to projects in Hopsworks, for a guide on how to configure this see role mapping.</p> <p>After an administrator configured role mappings in Hopsworks you can see the roles you can assume by going to your project settings.</p> <p> Cloud roles mapped to project. </p> <p>You can then use the Hops Python and Java APIs to assume the roles listed in your project's settings page.</p> <p>When calling the assume role method you can pass the role ARN string or use the get role method that takes the role id as an argument. If you assign a default role for your project you can call the assume role method with no argument.</p> <p>You can assign (if you are a Data owner in that project) a default role to you project by clicking on the Default button above the role you want to make default. You can set one default per project role. If a default is set for a project role (Data scientist or Data owner) and all members (ALL) the default set for the project role will take precedence over the default set for all members. In the image above if a Data scientist called the assume role method with no arguments she will assume the role with id 1029 but if a Data owner called the same method she will assume the role with id 1.</p> <p>Use temporary credentials.</p> <p>Python <pre><code>from hops.credentials_provider import get_role, assume_role\ncredentials = assume_role(role_arn=get_role(1))\nspark.read.csv(\"s3a://resource/test.csv\").show()\n</code></pre> Scala <pre><code>import io.hops.util.CredentialsProvider\nval creds = CredentialsProvider.assumeRole(CredentialsProvider.getRole(1))\nspark.read.csv(\"s3a://resource/test.csv\").show()\n</code></pre></p> <p>The assume role method sets spark hadoop configurations that will allow spark to read s3 buckets. The code examples above show how to read s3 buckets using Python and Scala.</p> <p>Assume role also sets environment variables AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY and AWS_SESSION_TOKEN so that programs running in the container can use the credentials for the newly assumed role.</p> <p>To read s3 buckets with TensorFlow you also need to set AWS_REGION environment variable (s3 bucket region). The code below shows how to read training and validation datasets from s3 bucket using TensorFlow.</p> <p>Use temporary credentials with TensorFlow.</p> <pre><code>from hops.credentials_provider import get_role, assume_role\nimport tensorflow as tf\nimport os\n\nassume_role(role_arn=get_role(1))\n# s3 bucket region need to be set for TensorFlow\nos.environ[\"AWS_REGION\"] = \"eu-north-1\"\n\ntrain_filenames = [\"s3://resource/train/train.tfrecords\"]\nvalidation_filenames = [\"s3://resourcet/validation/validation.tfrecords\"]\n\ntrain_dataset = tf.data.TFRecordDataset(train_filenames)\nvalidation_dataset = tf.data.TFRecordDataset(validation_filenames)\n\nfor raw_record in train_dataset.take(1):\n    example = tf.train.Example()\n    example.ParseFromString(raw_record.numpy())\n    print(example)\n</code></pre>"},{"location":"user_guides/integrations/beam/","title":"Apache Beam Dataflow Runner","text":"<p>Connecting to the Feature Store from an Apache Beam Dataflow Runner, requires configuring the Hopsworks certificates. For this in your Beam Java application <code>pom.xml</code> file include following snippet: <pre><code>    &lt;resources&gt;\n      &lt;resource&gt;\n        &lt;directory&gt;java.io.tmpdir&lt;/directory&gt;\n        &lt;includes&gt;\n          &lt;include&gt;**/*.jks&lt;/include&gt;\n        &lt;/includes&gt;\n      &lt;/resource&gt;\n    &lt;/resources&gt;\n</code></pre></p>"},{"location":"user_guides/integrations/beam/#generating-an-api-key","title":"Generating an API Key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Beam integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/beam/#connecting-to-the-feature-store","title":"Connecting to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from Beam:</p> <pre><code>//Establish connection with Hopsworks.\nHopsworksConnection hopsworksConnection = HopsworksConnection.builder()\n  .host(\"my_instance\")                      // DNS of your Feature Store instance\n  .port(443)                                // Port to reach your Hopsworks instance, defaults to 443\n  .project(\"my_project\")                    // Name of your Hopsworks Feature Store project \n  .apiKeyValue(\"api_key\")                   // The API key to authenticate with the feature store\n  .hostnameVerification(false)              // Disable for self-signed certificates\n  .build();\n\n//get feature store handle\nFeatureStore fs = hopsworksConnection.getFeatureStore();\n</code></pre>"},{"location":"user_guides/integrations/beam/#next-steps","title":"Next Steps","text":"<p>For more information and how to integrate Beam feature pipeline  to the Hopsworks Feature store follow the tutorial.</p>"},{"location":"user_guides/integrations/flink/","title":"Flink Integration","text":"<p>Connecting to the Feature Store from an external Flink cluster, such as AWS EMR and GCP DataProc requires configuring it with the Hopsworks certificates. This guide explains step by step how to connect to the Feature Store from an external Flink cluster.</p>"},{"location":"user_guides/integrations/flink/#download-the-hopsworks-certificates","title":"Download the Hopsworks Certificates","text":"<p>In the Project Settings, select the integration tab and scroll to the Configure Spark Integration section. Click on Download certificates. </p> <p> The Spark Integration gives access to Jars and configuration for an external Spark cluster </p> <p>Hopsworks uses X.509 certificates for authentication and authorization. If you are interested in the Hopsworks security model, you can read more about it in this blog post. The certificates are composed of three different components: the <code>keyStore.jks</code> containing the private key and the certificate for your project user, the <code>trustStore.jks</code> containing the certificates for the Hopsworks certificates authority, and a password to unlock the private key in the <code>keyStore.jks</code>. The password is displayed in a pop-up when downloading the certificate and should be saved in a file named <code>material_passwd</code>.</p> <p>Warning</p> <p>When you copy-paste the password to the <code>material_passwd</code> file, pay attention to not introduce additional empty spaces or new lines.</p> <p>The three files (<code>keyStore.jks</code>, <code>trustStore.jks</code> and <code>material_passwd</code>) should be accessible by your Flink application.</p>"},{"location":"user_guides/integrations/flink/#configure-your-flink-cluster","title":"Configure your Flink cluster","text":"<p>Add the following configuration to the <code>flink-conf.yaml</code>:</p> <pre><code>flink.hadoop.hops.ssl.keystore.name: replace_this_with_actual_path/keyStore.jks\nflink.hadoop.hops.ssl.truststore.name: replace_this_with_actual_path/trustStore.jks\nflink.hadoop.hops.ssl.keystores.passwd.name: replace_this_with_actual_path/material_passwd\n</code></pre>"},{"location":"user_guides/integrations/flink/#generating-an-api-key","title":"Generating an API Key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Flink integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/flink/#connecting-to-the-feature-store","title":"Connecting to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from Flink:</p> <pre><code>//Establish connection with Hopsworks.\nHopsworksConnection hopsworksConnection = HopsworksConnection.builder()\n  .host(\"my_instance\")                      // DNS of your Feature Store instance\n  .port(443)                                // Port to reach your Hopsworks instance, defaults to 443\n  .project(\"my_project\")                    // Name of your Hopsworks Feature Store project \n  .apiKeyValue(\"api_key\")                   // The API key to authenticate with the feature store\n  .hostnameVerification(false)              // Disable for self-signed certificates\n  .build();\n\n//get feature store handle\nFeatureStore fs = hopsworksConnection.getFeatureStore();\n</code></pre>"},{"location":"user_guides/integrations/flink/#next-steps","title":"Next Steps","text":"<p>For more information and how to integrate Flink streaming feature pipeline to the Hopsworks Feature store follow the tutorial.</p>"},{"location":"user_guides/integrations/hdinsight/","title":"Configure HDInsight for the Hopsworks Feature Store","text":"<p>To enable HDInsight to access the Hopsworks Feature Store, you need to set up a Hopsworks API key, add a script action and configurations to your HDInsight cluster.</p> <p>Prerequisites</p> <p>A HDInsight cluster with cluster type Spark is required to connect to the Feature Store. You can either use an existing cluster or create a new one.</p> <p>Network Connectivity</p> <p>To be able to connect to the Feature Store, please ensure that your HDInsight cluster and the Hopsworks Feature Store are either in the same Virtual Network or Virtual Network Peering is set up between the different networks. In addition, ensure that the Network Security Group of your Hopsworks instance is configured to allow incoming traffic from your HDInsight cluster on ports 443, 3306, 8020, 30010, 9083 and 9085 (443,3306,8020,30010,9083,9085). See Network security groups for more information.</p>"},{"location":"user_guides/integrations/hdinsight/#step-1-set-up-a-hopsworks-api-key","title":"Step 1: Set up a Hopsworks API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the HDInsight integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/hdinsight/#step-2-use-a-script-action-to-install-the-feature-store-connector","title":"Step 2:  Use a script action to install the Feature Store connector","text":"<p>HDInsight requires Hopsworks connectors to be able to communicate with the Hopsworks Feature Store. These connectors can be installed with the script action shown below. Copy the content into a file, name the file <code>hopsworks.sh</code> and replace MY_INSTANCE, MY_PROJECT, MY_VERSION, MY_API_KEY and MY_CONDA_ENV with your values. Copy the <code>hopsworks.sh</code> file into any storage that is readable by your HDInsight clusters and take note of the URI of that file e.g., <code>https://account.blob.core.windows.net/scripts/hopsworks.sh</code>.</p> <p>The script action needs to be applied head and worker nodes and can be applied during cluster creation or to an existing cluster. Ensure to persist the script action so that it is run on newly created nodes. For more information about how to use script actions, see Customize Azure HDInsight clusters by using script actions.</p> <p>Matching Hopsworks version</p> <p>The major version of <code>HSFS</code> needs to match the major version of Hopsworks. Check PyPI for available releases.</p> <p><p> You find the Hopsworks version inside any of your Project's settings tab on Hopsworks </p></p> <p>Feature Store script action: <pre><code>set -e\n\nHOST=\"MY_INSTANCE.cloud.hopsworks.ai\" # DNS of your Feature Store instance\nPROJECT=\"MY_PROJECT\"                  # Port to reach your Hopsworks instance, defaults to 443\nHSFS_VERSION=\"MY_VERSION\"             # The major version of HSFS needs to match the major version of Hopsworks\nAPI_KEY=\"MY_API_KEY\"                  # The API key to authenticate with Hopsworks\nCONDA_ENV=\"MY_CONDA_ENV\"              # py35 is the default for HDI 3.6\n\napt-get --assume-yes install python3-dev\napt-get --assume-yes install jq\n\n/usr/bin/anaconda/envs/$CONDA_ENV/bin/pip install hsfs==$HSFS_VERSION\n\nPROJECT_ID=$(curl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/getProjectInfo/$PROJECT | jq -r .projectId)\n\nmkdir -p /usr/lib/hopsworks\nchown root:hadoop /usr/lib/hopsworks\ncd /usr/lib/hopsworks\n\ncurl -o client.tar.gz -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/client\n\ntar -xvf client.tar.gz\ntar -xzf client/apache-hive-*-bin.tar.gz\nmv apache-hive-*-bin apache-hive-bin\nrm client.tar.gz\nrm client/apache-hive-*-bin.tar.gz\n\ncurl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .kStore | base64 -d &gt; keyStore.jks\n\ncurl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .tStore | base64 -d &gt; trustStore.jks\n\necho -n $(curl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .password) &gt; material_passwd\n\nchown -R root:hadoop /usr/lib/hopsworks\n</code></pre></p>"},{"location":"user_guides/integrations/hdinsight/#step-3-configure-hdinsight-for-feature-store-access","title":"Step 3: Configure HDInsight for Feature Store access","text":"<p>The Hadoop and Spark installations of the HDInsight cluster need to be configured in order to access the Feature Store. This can be achieved either by using a bootstrap script when creating clusters or using Ambari on existing clusters. Apply the following configurations to your HDInsight cluster.</p> <p>Using Hive and the Feature Store</p> <p>HDInsight clusters cannot use their local Hive when being configured for the Feature Store as the Feature Store relies on custom Hive binaries and its own Metastore which will overwrite the local one. If you rely on Hive for feature engineering then it is advised to write your data to an external data storage such as ADLS from your main HDInsight cluster and in the Feature Store, create an on-demand Feature Group on the storage container in ADLS.</p> <p>Hadoop hadoop-env.sh: <pre><code>export HADOOP_CLASSPATH=$HADOOP_CLASSPATH:/usr/lib/hopsworks/client/*\n</code></pre></p> <p>Hadoop core-site.xml: <pre><code>hops.ipc.server.ssl.enabled=true\nfs.hopsfs.impl=io.hops.hopsfs.client.HopsFileSystem\nclient.rpc.ssl.enabled.protocol=TLSv1.2\nhops.ssl.keystore.name=/usr/lib/hopsworks/keyStore.jks\nhops.rpc.socket.factory.class.default=io.hops.hadoop.shaded.org.apache.hadoop.net.HopsSSLSocketFactory\nhops.ssl.keystores.passwd.name=/usr/lib/hopsworks/material_passwd\nhops.ssl.hostname.verifier=ALLOW_ALL\nhops.ssl.trustore.name=/usr/lib/hopsworks/trustStore.jks\n</code></pre></p> <p>Spark spark-defaults.conf: <pre><code>spark.executor.extraClassPath=/usr/lib/hopsworks/client/*\nspark.driver.extraClassPath=/usr/lib/hopsworks/client/*\nspark.sql.hive.metastore.jars=path\nspark.sql.hive.metastore.jars.path=/usr/lib/hopsworks/apache-hive-bin/lib/*\n</code></pre></p> <p>Spark hive-site.xml: <pre><code>hive.metastore.uris=thrift://MY_HOPSWORKS_INSTANCE_PRIVATE_IP:9083\n</code></pre></p> <p>Info</p> <p>Replace MY_HOPSWORKS_INSTANCE_PRIVATE_IP with the private IP address of you Hopsworks Feature Store.</p>"},{"location":"user_guides/integrations/hdinsight/#step-5-connect-to-the-feature-store","title":"Step 5: Connect to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store, for instance using a Jupyter notebook in HDInsight with a PySpark3 kernel:</p> <pre><code>import hsfs\n\n# Put the API key into Key Vault for any production setup:\n# See, https://azure.microsoft.com/en-us/services/key-vault/\nsecret_value = 'MY_API_KEY'\n\n# Create a connection\nconn = hsfs.connection(\n    host='MY_INSTANCE.cloud.hopsworks.ai', # DNS of your Feature Store instance\n    port=443,                              # Port to reach your Hopsworks instance, defaults to 443\n    project='MY_PROJECT',                  # Name of your Hopsworks Feature Store project\n    api_key_value=secret_value,            # The API key to authenticate with Hopsworks\n    hostname_verification=True             # Disable for self-signed certificates\n)\n\n# Get the feature store handle for the project's feature store\nfs = conn.get_feature_store()\n</code></pre>"},{"location":"user_guides/integrations/hdinsight/#next-steps","title":"Next Steps","text":"<p>For more information about how to use the Feature Store, see the Quickstart Guide.</p>"},{"location":"user_guides/integrations/mlstudio_designer/","title":"Azure Machine Learning Designer Integration","text":"<p>Connecting to the Feature Store from the Azure Machine Learning Designer requires setting up a Feature Store API key for the Designer and installing the HSFS on the Designer. This guide explains step by step how to connect to the Feature Store from Azure Machine Learning Designer.</p> <p>Network Connectivity</p> <p>To be able to connect to the Feature Store, please ensure that the Network Security Group of your Hopsworks instance on Azure is configured to allow incoming traffic from your compute target on ports 443, 9083 and 9085 (443,9083,9085). See Network security groups for more information. If your compute target is not in the same VNet as your Hopsworks instance and the Hopsworks instance is not accessible from the internet then you will need to configure Virtual Network Peering.</p>"},{"location":"user_guides/integrations/mlstudio_designer/#generate-an-api-key","title":"Generate an API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Azure ML Designer integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/mlstudio_designer/#connect-to-the-feature-store","title":"Connect to the Feature Store","text":"<p>To connect to the Feature Store from the Azure Machine Learning Designer, create a new pipeline or open an existing one:</p> <p> Add an Execute Python Script step </p> <p>In the pipeline, add a new <code>Execute Python Script</code> step and replace the Python script from the next step:</p> <p> Add the code to access the Feature Store </p> <p>Updating the script</p> <p>Replace MY_VERSION, MY_API_KEY, MY_INSTANCE, MY_PROJECT and MY_FEATURE_GROUP with the respective values. The major version set for MY_VERSION needs to match the major version of Hopsworks. Check PyPI for available releases.</p> <p><p> You find the Hopsworks version inside any of your Project's settings tab on Hopsworks </p></p> <pre><code>import os\nimport importlib.util\n\n\npackage_name = 'hsfs'\nversion = 'MY_VERSION'\nspec = importlib.util.find_spec(package_name)\nif spec is None:\n    import os\n    os.system(f\"pip install %s[python]==%s\" % (package_name, version))\n\n# Put the API key into Key Vault for any production setup:\n# See, https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-secrets-in-runs\n#from azureml.core import Experiment, Run\n#run = Run.get_context()\n#secret_value = run.get_secret(name=\"fs-api-key\")\nsecret_value = 'MY_API_KEY'\n\ndef azureml_main(dataframe1 = None, dataframe2 = None):\n\n    import hsfs\n    conn = hsfs.connection(\n        host='MY_INSTANCE.cloud.hopsworks.ai', # DNS of your Feature Store instance\n        port=443,                              # Port to reach your Hopsworks instance, defaults to 443\n        project='MY_PROJECT',                  # Name of your Hopsworks Feature Store project\n        api_key_value=secret_value,            # The API key to authenticate with Hopsworks\n        hostname_verification=True,            # Disable for self-signed certificates\n        engine='python'                        # Choose python as engine\n    )\n    fs = conn.get_feature_store()              # Get the project's default feature store\n\n    return fs.get_feature_group('MY_FEATURE_GROUP', version=1).read(),\n</code></pre> <p>Select a compute target and save the step. The step is now ready to use:</p> <p> Select a compute target </p> <p>As a next step, you have to connect the previously created <code>Execute Python Script</code> step with the next step in the pipeline. For instance, to export the features to a CSV file, create a <code>Export Data</code> step:</p> <p> Add an Export Data step </p> <p>Configure the <code>Export Data</code> step to write to you data store of choice:</p> <p> Configure the Export Data step </p> <p>Connect the to steps by drawing a line between them:</p> <p> Connect the steps </p> <p>Finally, submit the pipeline and wait for it to finish:</p> <p>Performance on the first execution</p> <p>The <code>Execute Python Script</code> step can be slow when being executed for the first time as the HSFS library needs to be installed on the compute target. Subsequent executions on the same compute target should use the already installed library.</p> <p> Execute the pipeline </p>"},{"location":"user_guides/integrations/mlstudio_designer/#next-steps","title":"Next Steps","text":"<p>For more information about how to use the Feature Store, see the Quickstart Guide.</p>"},{"location":"user_guides/integrations/mlstudio_notebooks/","title":"Azure Machine Learning Notebooks Integration","text":"<p>Connecting to the Feature Store from Azure Machine Learning Notebooks requires setting up a Feature Store API key for Azure Machine Learning Notebooks and installing the HSFS on the notebook. This guide explains step by step how to connect to the Feature Store from Azure Machine Learning Notebooks.</p> <p>Network Connectivity</p> <p>To be able to connect to the Feature Store, please ensure that the Network Security Group of your Hopsworks instance on Azure is configured to allow incoming traffic from your compute target on ports 443, 9083 and 9085 (443,9083,9085). See Network security groups for more information. If your compute target is not in the same VNet as your Hopsworks instance and the Hopsworks instance is not accessible from the internet then you will need to configure Virtual Network Peering.</p>"},{"location":"user_guides/integrations/mlstudio_notebooks/#generate-an-api-key","title":"Generate an API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Azure ML Notebooks integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/mlstudio_notebooks/#connect-from-an-azure-machine-learning-notebook","title":"Connect from an Azure Machine Learning Notebook","text":"<p>To access the Feature Store from Azure Machine Learning, open a Python notebook and proceed with the following steps to install HSFS and connect to the Feature Store:</p> <p> Connecting from an Azure Machine Learning Notebook </p>"},{"location":"user_guides/integrations/mlstudio_notebooks/#install-hsfs","title":"Install HSFS","text":"<p>To be able to access the Hopsworks Feature Store, the <code>HSFS</code> Python library needs to be installed. One way of achieving this is by opening a Python notebook in Azure Machine Learning and installing the <code>HSFS</code> with a magic command and pip:</p> <pre><code>!pip install hsfs[python]~=[HOPSWORKS_VERSION]\n</code></pre> <p>Hive Dependencies</p> <p>By default, <code>HSFS</code> assumes Spark is used as execution engine and therefore Hive dependencies are not installed. Hence, if you are using a regular Python Kernel without Spark, make sure to install the \"python\" extra dependencies (<code>hsfs[python]</code>).</p> <p>Matching Hopsworks version</p> <p>The major version of <code>HSFS</code> needs to match the major version of Hopsworks. Check PyPI for available releases.</p> <p><p> You find the Hopsworks version inside any of your Project's settings tab on Hopsworks </p></p>"},{"location":"user_guides/integrations/mlstudio_notebooks/#connect-to-the-feature-store","title":"Connect to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from the notebook:</p> <pre><code>import hsfs\n\n# Put the API key into Key Vault for any production setup:\n# See, https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-secrets-in-runs\n#from azureml.core import Experiment, Run\n#run = Run.get_context()\n#secret_value = run.get_secret(name=\"fs-api-key\")\nsecret_value = 'MY_API_KEY'\n\n# Create a connection\nconn = hsfs.connection(\n    host='MY_INSTANCE.cloud.hopsworks.ai', # DNS of your Feature Store instance\n    port=443,                              # Port to reach your Hopsworks instance, defaults to 443\n    project='MY_PROJECT',                  # Name of your Hopsworks Feature Store project\n    api_key_value=secret_value,            # The API key to authenticate with Hopsworks\n    hostname_verification=True,            # Disable for self-signed certificates\n    engine='python'                        # Choose Python as engine\n)\n\n# Get the feature store handle for the project's feature store\nfs = conn.get_feature_store()\n</code></pre>"},{"location":"user_guides/integrations/mlstudio_notebooks/#next-steps","title":"Next Steps","text":"<p>For more information about how to use the Feature Store, see the Quickstart Guide.</p>"},{"location":"user_guides/integrations/python/","title":"Python Environments (Local or Kubeflow)","text":"<p>Connecting to the Feature Store from any Python environment requires setting up a Feature Store API key and installing the library. This guide explains step by step how to connect to the Feature Store from any Python environment such as your local environment or KubeFlow.</p>"},{"location":"user_guides/integrations/python/#install-hsfs","title":"Install HSFS","text":"<p>To be able to access the Hopsworks Feature Store, the <code>HSFS</code> Python library needs to be installed in the environment from which you want to connect to the Feature Store. You can install the library through pip. We recommend using a Python environment manager such as virtualenv or conda.</p> <pre><code>pip install hsfs[python]~=[HOPSWORKS_VERSION]\n</code></pre> <p>Hive Dependencies</p> <p>By default, <code>HSFS</code> assumes Spark/EMR is used as execution engine and therefore Hive dependencies are not installed. Hence, on a local Python evnironment, if you are planning to use a regular Python Kernel without Spark/EMR, make sure to install the \"python\" extra dependencies (<code>hsfs[python]</code>).</p> <p>Matching Hopsworks version</p> <p>The major version of <code>HSFS</code> needs to match the major version of Hopsworks.</p> <p> You find the Hopsworks version inside any of your Project's settings tab on Hopsworks </p>"},{"location":"user_guides/integrations/python/#generate-an-api-key","title":"Generate an API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Python client to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/python/#connect-to-the-feature-store","title":"Connect to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from your Python environment:</p> <pre><code>import hsfs\nconn = hsfs.connection(\n    host='my_instance',                 # DNS of your Feature Store instance\n    port=443,                           # Port to reach your Hopsworks instance, defaults to 443\n    project='my_project',               # Name of your Hopsworks Feature Store project\n    api_key_value='apikey',             # The API key to authenticate with Hopsworks\n    hostname_verification=True,         # Disable for self-signed certificates\n    engine=\"python\"                     # Set to \"spark\" if you are using Spark/EMR\n)\nfs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre> <p>Engine</p> <p><code>HSFS</code> uses either Apache Spark or Pandas on Python as an execution engine to perform queries against the feature store. The <code>engine</code> option of the connection let's you overwrite the default behaviour by setting it to <code>\"python\"</code> or <code>\"spark\"</code>. By default, <code>HSFS</code> will try to use Spark as engine if PySpark is available. So if you have PySpark installed in your local Python environment, but you have not configured Spark, you will have to set <code>engine='python'</code>. Please refer to the Spark integration guide to configure your local Spark cluster to be able to connect to the Hopsworks Feature Store.</p> <p>Ports</p> <p>If you have trouble to connect, please ensure that your Feature Store can receive incoming traffic from your Python environment on ports 443, 9083 and 9085 (443,9083,9085).</p> <p>If you deployed your Hopsworks Feature Store instance with managed.hopsworks.ai, it suffices to enable outside access of the Feature Store and Online Feature Store services.</p>"},{"location":"user_guides/integrations/python/#next-steps","title":"Next Steps","text":"<p>For more information about how to connect, see the Connection API reference. Or continue with the Data Source guide to import your own data to the Feature Store.</p>"},{"location":"user_guides/integrations/role_mapping/","title":"IAM role mapping","text":"<p>Using an EC2 instance profile enables your Hopsworks cluster to access AWS resources. This forces all Hopsworks users to share the instance profile role and the resource access policies attached to that role. To allow for per project access policies you could have your users use AWS credentials directly in their programs which is not recommended so you should instead use Role chaining.</p> <p>To use Role chaining, you need to first setup IAM roles in AWS:</p> <ol> <li>Create an instance profile role that contains the different resource roles that we want to allow selected users to be able to assume in the Hopsworks cluster.  In the example below, we define 4 different resource roles: test-role, s3-role, dev-s3-role, and redshift -  and later we will define which users will be allowed to assume which of these resources roles.</li> </ol> <p><pre><code>    {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n            {\n                \"Sid\": \"AssumeDataRoles\",\n                \"Effect\": \"Allow\",\n                \"Action\": \"sts:AssumeRole\",\n                \"Resource\": [\n                    \"arn:aws:iam::123456789011:role/test-role\",\n                    \"arn:aws:iam::xxxxxxxxxxxx:role/s3-role\",\n                    \"arn:aws:iam::xxxxxxxxxxxx:role/dev-s3-role\",\n                    \"arn:aws:iam::xxxxxxxxxxxx:role/redshift\"\n                ]\n            }\n        ]\n    }\n</code></pre> Example policy for assuming four roles.</p> <ol> <li>Create the resource roles and edit the trust relationship and add a policy document that will allow the instance profile to assume the resource roles.</li> </ol> <p><pre><code>    {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n            {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"arn:aws:iam::xxxxxxxxxxxx:role/instance-profile\"\n            },\n            \"Action\": \"sts:AssumeRole\"\n            }\n        ]\n    }\n</code></pre> Example policy document.</p> <ol> <li>Finally attach the instance profile to the master node of your Hopsworks AWS instance.</li> </ol> <p>Role chaining allows the instance profile to assume any of the 4 resource roles in the policy that was attached in step 1. Typically, we will not want any user in Hopsworks to assume any of the resource roles. You can grant selected users the ability to assume any of the 4 resource roles from the admin page in hopsworks. In particular, we specify in which project(s) a given resource role can be used. Within a given project, we can further restrict who can assume the resource role by mapping the role to the group of users (data owners or data scientists).</p> <p> Resource role mapping. </p> <p>By clicking the 'Resource role mapping' icon in the admin page shown in the image above you can add mappings by entering the project name and which roles in that project can access the resource role. Optionally, you can set a role mapping as default by marking the default checkbox. The default roles can only be changed by a Data owner who can do so in the project settings page.</p> <p> Add resource role to project mapping. </p> <p>Any member of a project can then go to the project settings page to see which roles they can assume.</p> <p> Resource role mapped to project. </p> <p>For instructions on how to use the assume role API see assuming a role.</p>"},{"location":"user_guides/integrations/sagemaker/","title":"AWS SageMaker Integration","text":"<p>Connecting to the Feature Store from SageMaker requires setting up a Feature Store API key for SageMaker and installing the HSFS on SageMaker. This guide explains step by step how to connect to the Feature Store from SageMaker.</p>"},{"location":"user_guides/integrations/sagemaker/#generate-an-api-key","title":"Generate an API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the SageMaker integration to work make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/sagemaker/#quickstart-api-key-argument","title":"Quickstart API key Argument","text":"<p>API key as Argument</p> <p>To get started quickly, without saving the Hopsworks API in a secret storage, you can simply supply it as an argument when instantiating a connection: <pre><code>    import hsfs\n    conn = hsfs.connection(\n        host='my_instance',                 # DNS of your Feature Store instance\n        port=443,                           # Port to reach your Hopsworks instance, defaults to 443\n        project='my_project',               # Name of your Hopsworks Feature Store project\n        api_key_value='apikey',             # The API key to authenticate with Hopsworks\n        hostname_verification=True          # Disable for self-signed certificates\n    )\n    fs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre></p>"},{"location":"user_guides/integrations/sagemaker/#store-the-api-key-on-aws","title":"Store the API key on AWS","text":"<p>The API key now needs to be stored on AWS, so it can be retrieved from within SageMaker notebooks.</p>"},{"location":"user_guides/integrations/sagemaker/#identify-your-sagemaker-role","title":"Identify your SageMaker role","text":"<p>You need to know the IAM role used by your SageMaker instance to set up the API key for it. You can find it in the overview of your SageMaker notebook instance of the AWS Management Console.</p> <p>In this example, the name of the role is AmazonSageMaker-ExecutionRole-20190511T072435.</p> <p> The role is attached to your SageMaker notebook instance </p>"},{"location":"user_guides/integrations/sagemaker/#store-the-api-key","title":"Store the API key","text":"<p>You have two options to make your API key accessible from SageMaker:</p>"},{"location":"user_guides/integrations/sagemaker/#option-1-using-the-aws-systems-manager-parameter-store","title":"Option 1: Using the AWS Systems Manager Parameter Store","text":""},{"location":"user_guides/integrations/sagemaker/#store-the-api-key-in-the-aws-systems-manager-parameter-store","title":"Store the API key in the AWS Systems Manager Parameter Store","text":"<ol> <li>In the AWS Management Console, ensure that your active region is the region you use for SageMaker.</li> <li>Go to the AWS Systems Manager choose Parameter Store in the left navigation bar and select Create Parameter.</li> <li>As name, enter <code>/hopsworks/role/[MY_SAGEMAKER_ROLE]/type/api-key</code> replacing <code>[MY_SAGEMAKER_ROLE]</code> with the AWS role used by the SageMaker instance that should access the Feature Store.</li> <li>Select Secure String as type and create the parameter.</li> </ol> <p> Store the API key in the AWS Systems Manager Parameter Store </p>"},{"location":"user_guides/integrations/sagemaker/#grant-access-to-the-parameter-store-from-the-sagemaker-notebook-role","title":"Grant access to the Parameter Store from the SageMaker notebook role","text":"<ol> <li>In the AWS Management Console, go to IAM, select Roles and then the role that is used when creating SageMaker notebook instances.</li> <li>Select Add inline policy.</li> <li>Choose Systems Manager as service, expand the Read access level and check GetParameter.</li> <li>Expand Resources and select Add ARN.</li> <li>Enter the region of the Systems Manager as well as the name of the parameter WITHOUT the leading slash e.g. <code>hopsworks/role/[MY_SAGEMAKER_ROLE]/type/api-key</code> and click Add.</li> <li>Click on Review, give the policy a name und click on Create policy.</li> </ol> <p> Grant access to the Parameter Store from the SageMaker notebook role </p>"},{"location":"user_guides/integrations/sagemaker/#option-2-using-the-aws-secrets-manager","title":"Option 2: Using the AWS Secrets Manager","text":""},{"location":"user_guides/integrations/sagemaker/#store-the-api-key-in-the-aws-secrets-manager","title":"Store the API key in the AWS Secrets Manager","text":"<ol> <li>In the AWS Management Console, ensure that your active region is the region you use for SageMaker.</li> <li>Go to the AWS Secrets Manager and select Store new secret.</li> <li>Select Other type of secrets and add api-key as the key and paste the API key created in the previous step as the value.</li> <li>Click next.</li> </ol> <p> Store the API key in the AWS Secrets Manager </p> <ol> <li>As secret name, enter <code>hopsworks/role/[MY_SAGEMAKER_ROLE]</code> replacing <code>[MY_SAGEMAKER_ROLE]</code> with the AWS role used by the SageMaker instance that should access the Feature Store.</li> <li>Select next twice and finally store the secret.</li> <li>Then click on the secret in the secrets list and take note of the Secret ARN.</li> </ol> <p> Store the API key in the AWS Secrets Manager </p>"},{"location":"user_guides/integrations/sagemaker/#grant-access-to-the-secretsmanager-to-the-sagemaker-notebook-role","title":"Grant access to the SecretsManager to the SageMaker notebook role","text":"<ol> <li>In the AWS Management Console, go to IAM, select Roles and then the role that is used when creating SageMaker notebook instances.</li> <li>Select Add inline policy.</li> <li>Choose Secrets Manager as service, expand the Read access level and check GetSecretValue.</li> <li>Expand Resources and select Add ARN.</li> <li>Paste the ARN of the secret created in the previous step.</li> <li>Click on Review, give the policy a name und click on Create policy.</li> </ol> <p> Grant access to the SecretsManager to the SageMaker notebook role </p>"},{"location":"user_guides/integrations/sagemaker/#install-hsfs","title":"Install HSFS","text":"<p>To be able to access the Hopsworks Feature Store, the <code>HSFS</code> Python library needs to be installed. One way of achieving this is by opening a Python notebook in SageMaker and installing the <code>HSFS</code> with a magic command and pip:</p> <pre><code>!pip install hsfs[python]~=[HOPSWORKS_VERSION]\n</code></pre> <p>Hive Dependencies</p> <p>By default, <code>HSFS</code> assumes Spark/EMR is used as execution engine and therefore Hive dependencies are not installed. Hence, on AWS SageMaker, if you are planning to use a regular Python Kernel without Spark/EMR, make sure to install the \"python\" extra dependencies (<code>hsfs[python]</code>).</p> <p>Matching Hopsworks version</p> <p>The major version of <code>HSFS</code> needs to match the major version of Hopsworks.</p> <p> You find the Hopsworks version inside any of your Project's settings tab on Hopsworks </p> <p>Note that the library will not be persistent. For information around how to permanently install a library to SageMaker, see Install External Libraries and Kernels in Notebook Instances.</p>"},{"location":"user_guides/integrations/sagemaker/#connect-to-the-feature-store","title":"Connect to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from SageMaker:</p> <pre><code>import hsfs\nconn = hsfs.connection(\n    'my_instance',                      # DNS of your Feature Store instance\n    443,                                # Port to reach your Hopsworks instance, defaults to 443\n    'my_project',                       # Name of your Hopsworks Feature Store project\n    secrets_store='secretsmanager',     # Either parameterstore or secretsmanager\n    hostname_verification=True,         # Disable for self-signed certificates\n    engine='python'                     # Choose Python as engine if you haven't set up AWS EMR\n)\nfs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre> <p>Engine</p> <p><code>HSFS</code> uses either Apache Spark or Pandas on Python as an execution engine to perform queries against the feature store. Most AWS SageMaker Kernels have PySpark installed but are not connected to AWS EMR by default, hence, the <code>engine</code> option of the connection let's you overwrite the default behaviour. By default, <code>HSFS</code> will try to use Spark as engine if PySpark is available, however, if Spark/EMR is not configured, you will have to set the engine manually to <code>\"python\"</code>. Please refer to the EMR integration guide to setup EMR with the Hopsworks Feature Store.</p> <p>Ports</p> <p>If you have trouble connecting, please ensure that the Security Group of your Hopsworks instance on AWS is configured to allow incoming traffic from your SageMaker instance on ports 443, 9083 and 9085 (443,9083,9085). See VPC Security Groups for more information. If your SageMaker instances are not in the same VPC as your Hopsworks instance and the Hopsworks instance is not accessible from the internet then you will need to configure VPC Peering on AWS.</p>"},{"location":"user_guides/integrations/sagemaker/#next-steps","title":"Next Steps","text":"<p>For more information about how to use the Feature Store, see the Quickstart Guide.</p>"},{"location":"user_guides/integrations/spark/","title":"Spark Integration","text":"<p>Connecting to the Feature Store from an external Spark cluster, such as Cloudera, requires configuring it with the Hopsworks client jars and configuration. This guide explains step by step how to connect to the Feature Store from an external Spark cluster.</p>"},{"location":"user_guides/integrations/spark/#download-the-hopsworks-client-jars","title":"Download the Hopsworks Client Jars","text":"<p>In the Project Settings, select the integration tab and scroll to the Configure Spark Integration section. Click on Download client Jars. This will start the download of the client.tar.gz archive. The archive contains two jar files for HopsFS, the Apache Hudi jar and the Java version of the HSFS library. You should upload these libraries to your Spark cluster and attach them as local resources to your Job. If you are using <code>spark-submit</code>, you should specify the <code>--jar</code> option. For more details see: Spark Dependency Management.</p> <p> The Spark Integration gives access to Jars and configuration for an external Spark cluster </p>"},{"location":"user_guides/integrations/spark/#download-the-certificates","title":"Download the certificates","text":"<p>Download the certificates from the same section as above. Hopsworks uses X.509 certificates for authentication and authorization. If you are interested in the Hopsworks security model, you can read more about it in this blog post. The certificates are composed of three different components: the <code>keyStore.jks</code> containing the private key and the certificate for your project user, the <code>trustStore.jks</code> containing the certificates for the Hopsworks certificates authority, and a password to unlock the private key in the <code>keyStore.jks</code>. The password is displayed in a pop-up when downloading the certificate and should be saved in a file named <code>material_passwd</code>.</p> <p>Warning</p> <p>When you copy-paste the password to the <code>material_passwd</code> file, pay attention to not introduce additional empty spaces or new lines.</p> <p>The three files (<code>keyStore.jks</code>, <code>trustStore.jks</code> and <code>material_passwd</code>) should be attached as resources to your Spark application as well.</p>"},{"location":"user_guides/integrations/spark/#configure-your-spark-cluster","title":"Configure your Spark cluster","text":"<p>Spark version limitation</p> <p>Currently Spark version 3.3.x is suggested to be able to use the full suite of Hopsworks Feature Store capabilities.</p> <p>Add the following configuration to the Spark application:</p> <pre><code>spark.hadoop.fs.hopsfs.impl                         io.hops.hopsfs.client.HopsFileSystem\nspark.hadoop.hops.ipc.server.ssl.enabled            true\nspark.hadoop.hops.ssl.hostname.verifier             ALLOW_ALL\nspark.hadoop.hops.rpc.socket.factory.class.default  io.hops.hadoop.shaded.org.apache.hadoop.net.HopsSSLSocketFactory\nspark.hadoop.client.rpc.ssl.enabled.protocol        TLSv1.2\nspark.hadoop.hops.ssl.keystores.passwd.name         material_passwd\nspark.hadoop.hops.ssl.keystore.name                 keyStore.jks\nspark.hadoop.hops.ssl.trustore.name                 trustStore.jks\nspark.sql.hive.metastore.jars                       path\nspark.sql.hive.metastore.jars.path                  [Path to the Hopsworks Hive Jars]\nspark.hadoop.hive.metastore.uris                    thrift://[metastore_ip]:[metastore_port]\n</code></pre> <p><code>spark.sql.hive.metastore.jars.path</code> should point to the path with the jars from the uncompressed Hive archive you can find in clients.tar.gz.</p>"},{"location":"user_guides/integrations/spark/#pyspark","title":"PySpark","text":"<p>To use PySpark, install the HSFS Python library which can be found on PyPi.</p> <p>Matching Hopsworks version</p> <p>The major version of <code>HSFS</code> needs to match the major version of Hopsworks.</p>"},{"location":"user_guides/integrations/spark/#generating-an-api-key","title":"Generating an API Key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Spark integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/spark/#connecting-to-the-feature-store","title":"Connecting to the Feature Store","text":"<p>You are now ready to connect to the Hopsworks Feature Store from Spark:</p> <pre><code>import hsfs\nconn = hsfs.connection(\n    host='my_instance',                 # DNS of your Feature Store instance\n    port=443,                           # Port to reach your Hopsworks instance, defaults to 443\n    project='my_project',               # Name of your Hopsworks Feature Store project\n    api_key_value='api_key',            # The API key to authenticate with the feature store\n    hostname_verification=True          # Disable for self-signed certificates\n)\nfs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre> <p>Engine</p> <p><code>HSFS</code> uses either Apache Spark or Pandas on Python as an execution engine to perform queries against the feature store. The <code>engine</code> option of the connection let's you overwrite the default behaviour by setting it to <code>\"python\"</code> or <code>\"spark\"</code>. By default, <code>HSFS</code> will try to use Spark as engine if PySpark is available, hence, no further action should be required if you setup Spark correctly as described above.</p>"},{"location":"user_guides/integrations/spark/#next-steps","title":"Next Steps","text":"<p>For more information about how to connect, see the Connection API reference. Or continue with the Data Source guide to import your own data to the Feature Store.</p>"},{"location":"user_guides/integrations/databricks/api_key/","title":"Hopsworks API key","text":"<p>In order for the Databricks cluster to be able to communicate with the Hopsworks Feature Store, the clients running on Databricks need to be able to access a Hopsworks API key.</p>"},{"location":"user_guides/integrations/databricks/api_key/#generate-an-api-key","title":"Generate an API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the Databricks integration to work make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/databricks/api_key/#quickstart-api-key-argument","title":"Quickstart API key Argument","text":"<p>API key as Argument</p> <p>To get started quickly, without saving the Hopsworks API in a secret storage, you can simply supply it as an argument when instantiating a connection: <pre><code>    import hsfs\n    conn = hsfs.connection(\n        host='my_instance',                 # DNS of your Feature Store instance\n        port=443,                           # Port to reach your Hopsworks instance, defaults to 443\n        project='my_project',               # Name of your Hopsworks Feature Store project\n        api_key_value='apikey',             # The API key to authenticate with Hopsworks\n        hostname_verification=True          # Disable for self-signed certificates\n    )\n    fs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre></p>"},{"location":"user_guides/integrations/databricks/api_key/#store-the-api-key","title":"Store the API key","text":""},{"location":"user_guides/integrations/databricks/api_key/#aws","title":"AWS","text":""},{"location":"user_guides/integrations/databricks/api_key/#step-1-create-an-instance-profile-to-attach-to-your-databricks-clusters","title":"Step 1: Create an instance profile to attach to your Databricks clusters","text":"<p>Go to the AWS IAM choose Roles and click on Create Role. Select AWS Service as the type of trusted entity and EC2 as the use case as shown below:</p> <p> Create an instance profile </p> <p>Click on Next: Permissions, Next:Tags, and then Next: Review. Name the instance profile role and then click Create role.</p>"},{"location":"user_guides/integrations/databricks/api_key/#step-2-storing-the-api-key","title":"Step 2: Storing the API Key","text":"<p>Option 1: Using the AWS Systems Manager Parameter Store</p> <p>In the AWS Management Console, ensure that your active region is the region you use for Databricks. Go to the AWS Systems Manager choose Parameter Store and select Create Parameter. As name enter <code>/hopsworks/role/[MY_DATABRICKS_ROLE]/type/api-key</code> replacing <code>[MY_DATABRICKS_ROLE]</code> with the name of the AWS role you have created in Step 1. Select Secure String as type and create the parameter.</p> <p> Storing the Feature Store API key in the Parameter Store </p> <p>Once the API Key is stored, you need to grant access to it from the AWS role that you have created in Step 1. In the AWS Management Console, go to IAM, select Roles and then search for the role that you have created in Step 1. Select Add inline policy. Choose Systems Manager as service, expand the Read access level and check GetParameter. Expand Resources and select Add ARN. Enter the region of the Systems Manager as well as the name of the parameter WITHOUT the leading slash e.g. hopsworks/role/[MY_DATABRICKS_ROLE]/type/api-key and click Add. Click on Review, give the policy a name und click on Create policy.</p> <p> Configuring the access policy for the Parameter Store </p> <p>Option 2: Using the AWS Secrets Manager</p> <p>In the AWS management console ensure that your active region is the region you use for Databricks. Go to the AWS Secrets Manager and select Store new secret. Select Other type of secrets and add api-key as the key and paste the API key created in the previous step as the value. Click next.</p> <p> Storing a Feature Store API key in the Secrets Manager Step 1 </p> <p>As secret name, enter hopsworks/role/[MY_DATABRICKS_ROLE] replacing [MY_DATABRICKS_ROLE] with the AWS role you have created in Step 1. Select next twice and finally store the secret. Then click on the secret in the secrets list and take note of the Secret ARN.</p> <p> Storing a Feature Store API key in the Secrets Manager Step 2 </p> <p>Once the API Key is stored, you need to grant access to it from the AWS role that you have created in Step 1. In the AWS Management Console, go to IAM, select Roles and then the role that that you have created in Step 1. Select Add inline policy. Choose Secrets Manager as service, expand the Read access level and check GetSecretValue. Expand Resources and select Add ARN. Paste the ARN of the secret created in the previous step. Click on Review, give the policy a name und click on Create policy.</p> <p> Configuring the access policy for the Secrets Manager </p>"},{"location":"user_guides/integrations/databricks/api_key/#step-3-allow-databricks-to-use-the-aws-role-created-in-step-1","title":"Step 3: Allow Databricks to use the AWS role created in Step 1","text":"<p>First you need to get the AWS role used by Databricks for deployments as described in this step. Once you get the role name, go to AWS IAM, search for the role, and click on it. Then, select the Permissions tab, click on Add inline policy, select the JSON tab, and paste the following snippet. Replace [ACCOUNT_ID] with your AWS account id, and [MY_DATABRICKS_ROLE] with the AWS role name created in Step 1.</p> <pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"PassRole\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"iam:PassRole\",\n            \"Resource\": \"arn:aws:iam::[ACCOUNT_ID]:role/[MY_DATABRICKS_ROLE]\"\n        }\n    ]\n}\n</code></pre> <p>Click Review Policy, name the policy, and click Create Policy. Then, go to your Databricks workspace and follow this step to add the instance profile to your workspace. Finally, when launching Databricks clusters, select Advanced settings and choose the instance profile you have just added.</p>"},{"location":"user_guides/integrations/databricks/api_key/#azure","title":"Azure","text":"<p>On Azure we currently do not support storing the API key in a secret storage. Instead just store the API key in a file in your Databricks workspace so you can access it when connecting to the Feature Store.</p>"},{"location":"user_guides/integrations/databricks/api_key/#next-steps","title":"Next Steps","text":"<p>Continue with the configuration guide to finalize the configuration of the Databricks Cluster to communicate with the Hopsworks Feature Store.</p>"},{"location":"user_guides/integrations/databricks/configuration/","title":"Databricks Integration","text":"<p>Users can configure their Databricks clusters to write the results of feature engineering pipelines in the Hopsworks Feature Store using HSFS. Configuring a Databricks cluster can be done from the Hopsworks Feature Store UI. This guide explains each step.</p>"},{"location":"user_guides/integrations/databricks/configuration/#prerequisites","title":"Prerequisites","text":"<p>In order to be able to configure a Databricks cluster to use the Feature Store of your Hopsworks instance, it is necessary to ensure networking is setup correctly between the instances and that the Databricks cluster has access to the Hopsworks API key to perform requests with HSFS from Databricks to Hopsworks.</p>"},{"location":"user_guides/integrations/databricks/configuration/#networking","title":"Networking","text":"<p>If you haven't done so already, follow the networking guides for either AWS or Azure for instructions on how to configure networking properly between Databricks' VPC (or Virtual Network on Azure) and the managed.hopsworks.ai VPC/VNet.</p>"},{"location":"user_guides/integrations/databricks/configuration/#hopsworks-api-key","title":"Hopsworks API key","text":"<p>In order for the Feature Store API to be able to communicate with the user's Hopsworks instance, the client library (HSFS) needs to have access to a previously generated API key from Hopsworks. For ways to setup and store the Hopsworks API key, please refer to the API key guide for Databricks.</p>"},{"location":"user_guides/integrations/databricks/configuration/#databricks-api-key","title":"Databricks API key","text":"<p>Hopsworks uses the Databricks REST APIs to communicate with the Databricks instance and configure clusters on behalf of users. To achieve that, the first step is to register an instance and a valid API key in Hopsworks.</p> <p>Users can get a valid Databricks API key by following the Databricks Documentation</p> <p>Cluster access control</p> <p>If users have enabled Databricks Cluster access control, it is important that the users running the cluster configuration (i.e. the user generating the API key) has <code>Can Manage</code> privileges on the cluster they are trying to configure.</p>"},{"location":"user_guides/integrations/databricks/configuration/#register-a-new-databricks-instance","title":"Register a new Databricks Instance","text":"<p>To register a new Databricks instance, first navigate to <code>Project settings</code>, which can be found on the left-hand side of a Project's landing page, then select the <code>Integrations</code> tab. </p> <p> Hopsworks's Integrations page </p> <p>Registering a Databricks instance requires adding the instance address and the Databricks API key.</p> <p>The instance name corresponds to the address of the Databricks instance and should be in the format <code>[UUID].cloud.databricks.com</code> (or <code>adb-[UUID].19.azuredatabricks.net</code> for Databricks on Azure), essentially the same web address used to reach the Databricks instance from the browser.</p> <p> Register a Databricks Instance along with a Databricks API key </p> <p>The API key will be stored in the Hopsworks secret store for the user and will be available only for that user.  If multiple users need to configure Databricks clusters, each has to generate an API key and register an instance. The Databricks instance registration does not have a project scope, meaning that once registered, the user can configure clusters for all projects they are part of.</p>"},{"location":"user_guides/integrations/databricks/configuration/#databricks-cluster","title":"Databricks Cluster","text":"<p>A cluster needs to exist before users can configure it using the Hopsworks UI. The cluster can be in any state prior to the configuration.</p> <p>Runtime limitation</p> <p>Currently Runtime 12.2 LTS is suggested to be able to use the full suite of Hopsworks Feature Store capabilities.</p>"},{"location":"user_guides/integrations/databricks/configuration/#configure-a-cluster","title":"Configure a cluster","text":"<p>Clusters are configured for a project user, which, in Hopsworks terms, means a user operating within the scope of a project. To configure a cluster, click on the <code>Configure</code> button. By default the cluster will be configured for the user making the request. If the user doesn't have <code>Can Manage</code> privilege on the cluster, they can ask a project <code>Data Owner</code> to configure it for them. Hopsworks <code>Data Owners</code> are allowed to configure clusters for other project users, as long as they have the required Databricks privileges.</p> <p> Configure a Databricks Cluster from Hopsworks </p> <p>During the cluster configuration the following steps will be taken:</p> <ul> <li>Upload an archive to DBFS containing the necessary Jars for HSFS and HopsFS to be able to read and write from the Hopsworks Feature Store</li> <li>Add an initScript to configure the Jars when the cluster is started</li> <li>Install <code>hsfs</code> python library</li> <li>Configure the necessary Spark properties to authenticate and communicate with the Feature Store</li> </ul> <p>When a cluster is configured for a specific project user, all the operations with the Hopsworks Feature Store will be executed as that project user. If another user needs to re-use the same cluster, the cluster can be reconfigured by following the same steps above.</p>"},{"location":"user_guides/integrations/databricks/configuration/#connecting-to-the-feature-store","title":"Connecting to the Feature Store","text":"<p>At the end of the configuration, Hopsworks will start the cluster. Once the cluster is running users can establish a connection to the Hopsworks Feature Store from Databricks:</p> <p>API key on Azure</p> <p>Please note, for Azure it is necessary to store the Hopsworks API key locally on the cluster as a file. As we currently do not support storing the API key on an Azure Secret Management Service as we do for AWS. Consult the API key guide for Azure, for more information.</p> AWSAzure <pre><code>import hsfs\nconn = hsfs.connection(\n    'my_instance',                      # DNS of your Feature Store instance\n    443,                                # Port to reach your Hopsworks instance, defaults to 443\n    'my_project',                       # Name of your Hopsworks Feature Store project\n    secrets_store='secretsmanager',     # Either parameterstore or secretsmanager\n    hostname_verification=True         # Disable for self-signed certificates\n)\nfs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre> <pre><code>import hsfs\nconn = hsfs.connection(\n    'my_instance',                      # DNS of your Feature Store instance\n    443,                                # Port to reach your Hopsworks instance, defaults to 443\n    'my_project',                       # Name of your Hopsworks Feature Store project\n    secrets_store='local',\n    api_key_file=\"featurestore.key\",    # For Azure, store the API key locally\n    secrets_store = \"local\",\n    hostname_verification=True          # Disable for self-signed certificates\n)\nfs = conn.get_feature_store()           # Get the project's default feature store\n</code></pre>"},{"location":"user_guides/integrations/databricks/configuration/#next-steps","title":"Next Steps","text":"<p>For more information about how to connect, see the Connection API reference. Or continue with the Data Source guide to import your own data to the Feature Store.</p>"},{"location":"user_guides/integrations/databricks/networking/","title":"Networking","text":"<p>In order for Spark to communicate with the Feature Store from Databricks, networking needs to be set up correctly. This includes deploying the Hopsworks Instance to either the same VPC or enable VPC/VNet peering between the VPC/VNet of the Databricks Cluster and the Hopsworks Cluster.</p>"},{"location":"user_guides/integrations/databricks/networking/#aws","title":"AWS","text":""},{"location":"user_guides/integrations/databricks/networking/#step-1-ensure-network-connectivity","title":"Step 1: Ensure network connectivity","text":"<p>The DataFrame API needs to be able to connect directly to the IP on which the Feature Store is listening. This means that if you deploy the Feature Store on AWS you will either need to deploy the Feature Store in the same VPC as your Databricks cluster or to set up VPC Peering between your Databricks VPC and the Feature Store VPC.</p> <p>Option 1: Deploy the Feature Store in the Databricks VPC</p> <p>When you deploy the Feature Store Hopsworks instance, select the Databricks VPC and Availability Zone as the VPC and Availability Zone of your Feature Store cluster. Identify your Databricks VPC by searching for VPCs containing Databricks in their name in your Databricks AWS region in the AWS Management Console:</p> <p> Identify the Databricks VPC </p> <p>Hopsworks installer</p> <p>If you are performing an installation using the Hopsworks installer script, ensure that the virtual machines you install Hopsworks on are deployed in the EMR VPC.</p> <p>managed.hopsworks.ai</p> <p>If you are working on managed.hopsworks.ai, you can directly deploy the Hopsworks instance to the Databricks VPC, by simply selecting it at the VPC selection step during cluster creation.</p> <p>Option 2: Set up VPC peering</p> <p>Follow the guide VPC Peering to set up VPC peering between the Feature Store cluster and Databricks. Get your Feature Store VPC ID and CIDR by searching for thr Feature Store VPC in the AWS Management Console:</p> <p>managed.hopsworks.ai</p> <p>On managed.hopsworks.ai, the VPC is shown in the cluster details.</p> <p> Identify the Feature Store VPC </p>"},{"location":"user_guides/integrations/databricks/networking/#step-2-configure-the-security-group","title":"Step 2: Configure the Security Group","text":"<p>The Feature Store Security Group needs to be configured to allow traffic from your Databricks clusters to be able to connect to the Feature Store.</p> <p>managed.hopsworks.ai</p> <p>If you deployed your Hopsworks Feature Store with managed.hopsworks.ai, you only need to enable outside access of the Feature Store, Online Feature Store, and Kafka services.</p> <p>Open your feature store instance under EC2 in the AWS Management Console and ensure that ports 443, 3306, 9083, 9085, 8020, 50010, and 9092 are reachable from the Databricks Security Group:</p> <p> Hopsworks Feature Store Security Group </p> <p>Connectivity from the Databricks Security Group can be allowed by opening the Security Group, adding a port to the Inbound rules and searching for dbe-worker in the source field. Selecting any of the dbe-worker Security Groups will be sufficient:</p> <p> Hopsworks Feature Store Security Group details </p>"},{"location":"user_guides/integrations/databricks/networking/#azure","title":"Azure","text":""},{"location":"user_guides/integrations/databricks/networking/#step-1-set-up-vnet-peering-between-hopsworks-and-databricks","title":"Step 1: Set up VNet peering between Hopsworks and Databricks","text":"<p>VNet peering between the Hopsworks and the Databricks virtual network is required to be able to connect to the Feature Store from Databricks.</p> <p>In the Azure portal, go to Azure Databricks and go to Virtual Network Peering:</p> <p> Azure Databricks </p> <p>Select Add Peering:</p> <p> Add peering </p> <p>Name the peering and select the virtual network used by your Hopsworks cluster. The virtual network is shown in the cluster details on managed.hopsworks.ai (see the next picture). Ensure to press the copy button on the bottom of the page and save the value somewhere. Press Add and create the peering:</p> <p> Configure peering </p> <p>The virtual network used by your cluster is shown under Details:</p> <p> Check the Hopsworks virtual network </p> <p>The peering connection should now be listed as initiated:</p> <p> Peering connection initiated </p> <p>On the Azure portal, go to Virtual networks and search for the virtual network used by your Hopsworks cluster:</p> <p> Virtual networks </p> <p>Open the network and select Peerings:</p> <p> Select peerings </p> <p>Choose to add a peering connection:</p> <p> Add a peering connection </p> <p>Name the peering connection and select I know my resource ID. Paste the string copied when creating the peering from Databricks Azure. If you haven't copied that string, then manually select the virtual network used by Databricks and press OK to create the peering:</p> <p> Configure peering </p> <p>The peering should now be Updating:</p> <p> Cloud account settings </p> <p>Wait for the peering to show up as Connected. There should now be bi-directional network connectivity between the Feature Store and Databricks:</p> <p> Cloud account settings </p>"},{"location":"user_guides/integrations/databricks/networking/#step-2-configure-the-network-security-group","title":"Step 2: Configure the Network Security Group","text":"<p>The virtual network peering will allow full access between the Hopsworks virtual network and the Databricks virtual network by default. However, if you have a different setup, ensure that the Network Security Group of the Feature Store is configured to allow traffic from your Databricks clusters.</p> <p>Ensure that ports 443, 9083, 9085, 8020, 50010, and 9092 are reachable from the Databricks cluster Network Security Group.</p> <p>managed.hopsworks.ai</p> <p>If you deployed your Hopsworks Feature Store instance with managed.hopsworks.ai, it suffices to enable outside access of the Feature Store, Online Feature Store, and Kafka services.</p>"},{"location":"user_guides/integrations/databricks/networking/#next-steps","title":"Next Steps","text":"<p>Continue with the Hopsworks API key guide to setup access to a Hopsworks API key from the Databricks Cluster, in order to be able to use the Hopsworks Feature Store.</p>"},{"location":"user_guides/integrations/emr/emr_configuration/","title":"Configure EMR for the Hopsworks Feature Store","text":"<p>To enable EMR to access the Hopsworks Feature Store, you need to set up a Hopsworks API key, add a bootstrap action and configurations to your EMR cluster.</p> <p>Info</p> <p>Ensure Networking is set up correctly before proceeding with this guide.</p>"},{"location":"user_guides/integrations/emr/emr_configuration/#step-1-set-up-a-hopsworks-api-key","title":"Step 1: Set up a Hopsworks API key","text":"<p>For instructions on how to generate an API key follow this user guide. For the EMR integration to work correctly make sure you add the following scopes to your API key:</p> <ol> <li>featurestore</li> <li>project</li> <li>job</li> <li>kafka</li> </ol>"},{"location":"user_guides/integrations/emr/emr_configuration/#store-the-api-key-in-the-aws-secrets-manager","title":"Store the API key in the AWS Secrets Manager","text":"<p>In the AWS management console ensure that your active region is the region you use for EMR. Go to the AWS Secrets Manager and select Store new secret. Select Other type of secrets and add api-key as the key and paste the API key created in the previous step as the value. Click next.</p> <p> Store a Hopsworks API key in the Secrets Manager </p> <p>As a secret name, enter hopsworks/featurestore. Select next twice and finally store the secret. Then click on the secret in the secrets list and take note of the Secret ARN.</p> <p> Name the secret </p>"},{"location":"user_guides/integrations/emr/emr_configuration/#grant-access-to-the-secret-to-the-emr-ec2-instance-profile","title":"Grant access to the secret to the EMR EC2 instance profile","text":"<p>Identify your EMR EC2 instance profile in the EMR cluster summary:</p> <p> Identify your EMR EC2 instance profile </p> <p>In the AWS Management Console, go to IAM, select Roles and then the EC2 instance profile used by your EMR cluster. Select Add inline policy. Choose Secrets Manager as a service, expand the Read access level and check GetSecretValue. Expand Resources and select Add ARN. Paste the ARN of the secret created in the previous step. Click on Review, give the policy a name und click on Create policy.</p> <p> Configure the access policy for the Secrets Manager </p>"},{"location":"user_guides/integrations/emr/emr_configuration/#step-2-configure-your-emr-cluster","title":"Step 2: Configure your EMR cluster","text":""},{"location":"user_guides/integrations/emr/emr_configuration/#add-the-hopsworks-feature-store-configuration-to-your-emr-cluster","title":"Add the Hopsworks Feature Store configuration to your EMR cluster","text":"<p>In order for EMR to be able to talk to the Feature Store, you need to update the Hadoop and Spark configurations. Copy the configuration below and replace ip-XXX-XX-XX-XXX.XX-XXXX-X.compute.internal with the private DNS name of your Hopsworks master node.</p> <pre><code>[\n  {\n    \"Classification\": \"hadoop-env\",\n    \"Properties\": {\n\n    },\n    \"Configurations\": [\n      {\n        \"Classification\": \"export\",\n        \"Properties\": {\n          \"HADOOP_CLASSPATH\": \"$HADOOP_CLASSPATH:/usr/lib/hopsworks/client/*\"\n        },\n        \"Configurations\": [\n\n        ]\n      }\n    ]\n  },\n  {\n    \"Classification\": \"spark-defaults\",\n    \"Properties\": {\n      \"spark.hadoop.hops.ipc.server.ssl.enabled\": true,\n      \"spark.hadoop.fs.hopsfs.impl\": \"io.hops.hopsfs.client.HopsFileSystem\",\n      \"spark.hadoop.client.rpc.ssl.enabled.protocol\": \"TLSv1.2\",\n      \"spark.hadoop.hops.ssl.hostname.verifier\": \"ALLOW_ALL\",\n      \"spark.hadoop.hops.rpc.socket.factory.class.default\": \"io.hops.hadoop.shaded.org.apache.hadoop.net.HopsSSLSocketFactory\",\n      \"spark.hadoop.hops.ssl.keystores.passwd.name\": \"/usr/lib/hopsworks/material_passwd\",\n      \"spark.hadoop.hops.ssl.keystore.name\": \"/usr/lib/hopsworks/keyStore.jks\",\n      \"spark.hadoop.hops.ssl.trustore.name\": \"/usr/lib/hopsworks/trustStore.jks\",\n      \"spark.serializer\": \"org.apache.spark.serializer.KryoSerializer\",\n      \"spark.executor.extraClassPath\": \"/usr/lib/hopsworks/client/*\",\n      \"spark.driver.extraClassPath\": \"/usr/lib/hopsworks/client/*\",\n      \"spark.sql.hive.metastore.jars\": \"path\",\n      \"spark.sql.hive.metastore.jars.path\": \"/usr/lib/hopsworks/apache-hive-bin/lib/*\",\n      \"spark.hadoop.hive.metastore.uris\": \"thrift://ip-XXX-XX-XX-XXX.XX-XXXX-X.compute.internal:9083\"\n    }\n  },\n]\n</code></pre> <p>When you create your EMR cluster, add the configuration:</p> <p>Note</p> <p>Don't forget to replace ip-XXX-XX-XX-XXX.XX-XXXX-X.compute.internal with the private DNS name of your Hopsworks master node.</p> <p> Configure EMR to access the Feature Store </p>"},{"location":"user_guides/integrations/emr/emr_configuration/#add-the-bootstrap-action-to-your-emr-cluster","title":"Add the Bootstrap Action to your EMR cluster","text":"<p>EMR requires Hopsworks connectors to be able to communicate with the Hopsworks Feature Store. These connectors can be installed with the bootstrap action shown below. Copy the content into a file and name the file <code>hopsworks.sh</code>. Copy that file into any S3 bucket that is readable by your EMR clusters and take note of the S3 URI of that file e.g., <code>s3://my-emr-init/hopsworks.sh</code>.</p> <pre><code>#!/bin/bash\nset -e\n\nif [ \"$#\" -ne 3 ]; then\n    echo \"Usage hopsworks.sh HOPSWORKS_API_KEY_SECRET, HOPSWORKS_HOST, PROJECT_NAME\"\n    exit 1\nfi\n\nSECRET_NAME=$1\nHOST=$2\nPROJECT=$3\n\nAPI_KEY=$(aws secretsmanager get-secret-value --secret-id $SECRET_NAME | jq -r .SecretString | jq -r '.[\"api-key\"]')\n\nPROJECT_ID=$(curl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/getProjectInfo/$PROJECT | jq -r .projectId)\n\nsudo yum -y install python3-devel.x86_64 || true\n\nsudo mkdir /usr/lib/hopsworks\nsudo chown hadoop:hadoop /usr/lib/hopsworks\ncd /usr/lib/hopsworks\n\ncurl -o client.tar.gz -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/client\n\ntar -xvf client.tar.gz\ntar -xzf client/apache-hive-*-bin.tar.gz || true\nmv apache-hive-*-bin apache-hive-bin\nrm client.tar.gz\nrm client/apache-hive-*-bin.tar.gz\n\ncurl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .kStore | base64 -d &gt; keyStore.jks\n\ncurl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .tStore | base64 -d &gt; trustStore.jks\n\necho -n $(curl -H \"Authorization: ApiKey ${API_KEY}\" https://$HOST/hopsworks-api/api/project/$PROJECT_ID/credentials | jq -r .password) &gt; material_passwd\n\nchmod -R o-rwx /usr/lib/hopsworks\n\nsudo pip3 install --upgrade hsfs~=X.X.0\n</code></pre> <p>Note</p> <p>Don't forget to replace X.X.0 with the major and minor version of your Hopsworks deployment.</p> <p> To find your Hopsworks version, enter any of your projects and go to the settings tab inside your project. </p> <p>Add the bootstrap actions when configuring your EMR cluster. Provide 3 arguments to the bootstrap action: The name of the API key secret e.g., <code>hopsworks/featurestore</code>, the public DNS name of your Hopsworks cluster, such as <code>ad005770-33b5-11eb-b5a7-bfabd757769f.cloud.hopsworks.ai</code>, and the name of your Hopsworks project, e.g. <code>demo_fs_meb10179</code>.</p> <p> Set the bootstrap action for EMR </p> <p>Your EMR cluster will now be able to access your Hopsworks Feature Store.</p>"},{"location":"user_guides/integrations/emr/emr_configuration/#next-steps","title":"Next Steps","text":"<p>Use the Connection API to connect to the Hopsworks Feature Store. For more information about how to use the Feature Store, see the Quickstart Guide.</p>"},{"location":"user_guides/integrations/emr/networking/","title":"Networking","text":"<p>In order for Spark to communicate with the Hopsworks Feature Store from EMR, networking needs to be set up correctly. This includes deploying the Hopsworks Feature Store to either the same VPC or enable VPC peering between the VPC of the EMR cluster and the Hopsworks Feature Store.</p>"},{"location":"user_guides/integrations/emr/networking/#step-1-ensure-network-connectivity","title":"Step 1: Ensure network connectivity","text":"<p>The DataFrame API needs to be able to connect directly to the IP on which the Feature Store is listening. This means that if you deploy the Feature Store on AWS you will either need to deploy the Feature Store in the same VPC as your EMR cluster or to set up VPC Peering between your EMR VPC and the Feature Store VPC.</p> <p>Option 1: Deploy the Feature Store in the EMR VPC</p> <p>When deploying the Hopsworks Feature Store, select the EMR VPC and Availability Zone as the VPC and Availability Zone of your Feature Store. Identify your EMR VPC in the Summary of your EMR cluster:</p> <p> Identify the EMR VPC </p> <p> Identify the EMR VPC </p> <p>Hopsworks installer</p> <p>If you are performing an installation using the Hopsworks installer script, ensure that the virtual machines you install Hopsworks on are deployed in the EMR VPC.</p> <p>managed.hopsworks.ai</p> <p>If you are on managed.hopsworks.ai, you can directly deploy Hopsworks to the EMR VPC, by simply selecting it at the VPC selection step during cluster creation.</p> <p>Option 2: Set up VPC peering</p> <p>Follow the guide VPC Peering to set up VPC peering between the Feature Store and EMR. Get your Feature Store VPC ID and CIDR by searching for the Feature Store VPC in the AWS Management Console:</p> <p>managed.hopsworks.ai</p> <p>On managed.hopsworks.ai, the VPC is shown in the cluster details.</p> <p> Identify the Feature Store VPC </p>"},{"location":"user_guides/integrations/emr/networking/#step-2-configure-the-security-group","title":"Step 2: Configure the Security Group","text":"<p>The Feature Store Security Group needs to be configured to allow traffic from your EMR clusters to be able to connect to the Feature Store.</p> <p>managed.hopsworks.ai</p> <p>If you deployed your Hopsworks Feature Store with managed.hopsworks.ai, you only need to enable outside access of the Feature Store services.</p> <p>Open your feature store instance under EC2 in the AWS Management Console and ensure that ports 443, 3306, 9083, 9085, 8020 and 30010 (443,3306,8020,30010,9083,9085) are reachable from the EMR Security Group:</p> <p> Hopsworks Feature Store Security Group </p> <p>Connectivity from the EMR Security Group can be allowed by opening the Security Group, adding a port to the Inbound rules and setting the EMR master and core security group as source:</p> <p> Hopsworks Feature Store Security Group details </p> <p>You can find your EMR security groups in the EMR cluster summary:</p> <p> EMR Security Groups </p>"},{"location":"user_guides/integrations/emr/networking/#next-steps","title":"Next Steps","text":"<p>Continue with the Configure EMR for the Hopsworks Feature Store, in order to be able to use the Hopsworks Feature Store.</p>"},{"location":"user_guides/migration/30_migration/","title":"3.0 Migration Guide","text":""},{"location":"user_guides/migration/30_migration/#breaking-changes","title":"Breaking Changes","text":""},{"location":"user_guides/migration/30_migration/#feature-view","title":"Feature View","text":"<p>Feature View is a new core abstraction introduced in version 3.0. The Feature View extends and replaces the old Training Dataset. Feature views are now the gateway for users to access feature data from the feature store.</p> Pre-3.03.0 <pre><code>td = fs.create_training_dataset()\n</code></pre> <p>First create the feature view using a Query object: <pre><code>fv = fs.create_feature_view()\n</code></pre></p> <p>You can then create training data from the feature view by writing it as new files with <code>.create_</code> methods: <pre><code>td_df = fv.create_training_data()\nfv.create_train_test_split()\nfv.create_train_validation_test_split()\n</code></pre></p> <p>Or you can directly create the training data in memory by below methods: <pre><code>fv.training_data()\nfv.train_test_split()\nfv.train_validation_test_split()\n</code></pre></p> <p>This means that the process for generating training data changes slightly and training data is grouped by feature views. This has the following advantages:</p> <ol> <li>It will be easier to create new versions of training data for re-training of models in the future.</li> <li>You do not have to keep references to training data in your model serving code, instead you use the Feature View object.</li> <li>The feature view offers the same interface for retrieving batch data for batch scoring, so you don\u2019t have to execute SQL against the feature store explicitly anymore.</li> </ol> <p>A feature view uses the Query abstraction to define the schema of the view, and therefore, the Query is a mandatory argument, this effectively removes the possibility to create a training dataset directly from a Spark Dataframe.</p>"},{"location":"user_guides/migration/30_migration/#required-changes","title":"Required changes","text":"<p>After the upgrade all existing training datasets will be located under a Feature View with the same name. The versions of the training datasets stay untouched. You can use <code>feature_view.get_training_data</code> to get back existing training datasets. Except that training datasets created directly from Spark Dataframe are not migrated to feature view. In this case, you can use the old APIs for retrieving these training datasets, so that your existing training pipelines are still functional. </p> <p>However, if you have any pipelines, that automatically create training datasets, you will have to adjust these to the above workflow. <code>fs.create_training_dataset()</code> has been removed.</p> <p>To learn more about the new Feature View, have a look at the dedicated concept and guide section in the documentation.</p>"},{"location":"user_guides/migration/30_migration/#deequ-based-data-validation-in-favour-of-great-expectations","title":"Deequ-based Data Validation in favour of Great Expectations","text":"<p>Unfortunately, the Deequ data validation library is no longer actively maintained which makes it impossible for us to maintain the functionality within Hopsworks. Therefore, we are dropping the entire support for Deequ as validation engine in Hopsworks 3.0 in favour of Great Expectations (GE).</p> <p>This has the following advantages:</p> <ol> <li>Great Expectations has become the defacto standard for data validation within the community.</li> <li>Hopsworks is fully compatible with GE native objects, that means you can bring your existing expectation suites without the need for rewriting them.</li> <li>GE is both available for Spark and for Pandas Dataframes, whereas Deequ was only supporting Spark.</li> </ol>"},{"location":"user_guides/migration/30_migration/#required-changes_1","title":"Required changes","text":"<p>All APIs regarding data validation have been redesigned to accomodate the functionality of GE. This means that you will have to redesign your previous expectations in the form of GE expectation suites that you can attach to Feature Groups. Please refer to the data validation guide for a full specification of the functionality.</p>"},{"location":"user_guides/migration/30_migration/#limitations","title":"Limitations","text":"<p>GE is a Python library and therefore we can support synchronous data validation only in Python and PySpark kernels and not on Java/Scala Spark kernels. However, you have the possibility to launch a job asynchronously after writing with Java/Scala in order to perform data validation.</p>"},{"location":"user_guides/migration/30_migration/#deprecated-features","title":"Deprecated Features","text":"<p>These changes or new features introduce changes in APIs which might break your pipelines in the future. We try to keep old APIs around until the next major release in order to give you some time to adapt your pipelines, however, this is not always possible, and these methods might be removed in any upcoming release, so we recommend addressing these changes as soon as possible. For this reason, we list some of the changes as breaking change, even though they are still backwards compatible.</p>"},{"location":"user_guides/migration/30_migration/#on-demand-feature-groups-are-now-called-external-feature-groups","title":"On-Demand Feature Groups are now called External Feature Groups","text":"<p>Most data engineers but also many data scientists have a background where they at least partially where exposed to database terminology. Therefore, we decided to rename On-Demand Feature Groups to simply External Feature Groups. We think this makes the abstraction clearer, as practitioners are usually familiar with the concept of Extern Tables in a database.</p> <p>This lead to a change in HSFS APIs:</p> Pre-3.03.0 <pre><code>fs.create_on_demand_feature_group()\nfs.get_on_demand_feature_group()\nfs.get_on_demand_feature_groups()\n</code></pre> <pre><code>fs.create_external_feature_group()\nfs.get_external_feature_group()\nfs.get_external_feature_groups()\n</code></pre> <p>Note, pre-3.0 methods are marked as deprecated and still available in the library for backwards compatibility.</p>"},{"location":"user_guides/migration/30_migration/#streaming-api-for-writing-becomes-the-python-default","title":"Streaming API for writing becomes the Python Default","text":"<p>Hopsworks provides three write APIs to the Feature Store to accommodate the different use cases:</p> <ol> <li>Batch Write: This was the default mode prior to version 3.0. It involves writing a DataFrame in batch either to the offline feature store, or the online one, or both. This mode is still the default when you are writing Spark DataFrames on Hopsworks.</li> <li>External connectors: This mode allows users to mount external tables existing in DataWarehouses like Snowflake, Redshift and BigQuery as feature groups in Hopsworks. In this case the data is not moved and remains on the external data storage.</li> <li>Stream Write: This mode was introduced in version 2.0 and expanded in version 3.0. This mode has a \"Kappa-style\" architecture, where the DataFrame gets streamed into a Kafka topic and, as explained later in the post, the data is picked up from Kafka by Hopsworks and written into the desired stores. In Hopsworks 3.0 this is the default mode for Python clients.</li> </ol> <p>With 3.0 the stream API becomes the default for Feature Groups created from pure Python environments with Pandas Dataframes.</p> <p>This has the following advantages:</p> <ol> <li> <p>Reduced write amplification: Instead of uploading data to Hopsworks and subsequently starting a Spark job to upsert the data on offline storage and writing it to Kafka for the online storage upsert, the data is directly written to Kafka and from there it\u2019s being upserted directly to offline and/or online.</p> </li> <li> <p>Fresher features: Since new data gets written to Kafka directly without prior upload, the data ends up in the online feature store with subsecond latency, which is a massive improvement given it is written from Python without any Streaming framework.</p> </li> <li> <p>Batching of offline upserts: You can control now yourself how often the Spark application that performs the upsert on the offline feature store is running. Either you run it synchronously with every new Dataframe ingestion, or you batch multiple Dataframes by launching the job less regularly.</p> </li> </ol>"},{"location":"user_guides/migration/30_migration/#required-changes_2","title":"Required changes","text":"<p>Your existing feature groups will not be affected by this change, that means all existing feature groups will continue to use the old upload path for ingestion. However, we strongly recommend creating new versions of your existing feature groups that use ingest to using Python, in order to leverage the above advantages.</p>"},{"location":"user_guides/migration/30_migration/#built-in-transformation-functions-dont-have-to-be-registered-explicitly-for-every-project","title":"Built-in transformation functions don\u2019t have to be registered explicitly for every project","text":"<p>In Hopsworks 2.5 users had to register the built-in transformation functions (min-max scaler, standard scaler, label encoder and robust scaler) explicitly for every project by calling <code>fs.register_builtin_transformation_functions()</code>. This is no longer necessary, as all new projects will have the functions registered by default.</p>"},{"location":"user_guides/migration/30_migration/#hive-installation-extra-deprecated-in-favour-of-python-extra","title":"Hive installation extra deprecated in favour of Python extra","text":"<p>In the past when using HSFS in pure Python environments without PySpark, users had to install the hive extra when installing the PyPi package. This extra got deprecated and users now have to install an extra called python to reflect the environment:</p> Pre-3.03.0 <pre><code>pip install hsfs[hive]\n</code></pre> <pre><code>pip install hsfs[python]\n</code></pre>"},{"location":"user_guides/migration/30_migration/#more-restrictive-feature-types","title":"More restrictive feature types","text":"<p>With Hopsworks 3.0 we made feature types more strict and therefore made ingestion pipelines more robust. Both Spark and Pandas are quite forgiving when it comes to types, which often led to schema incompatibilities when ingesting to a feature group.</p> <p>In this release we narrowed down the allowed Python types, and defined a clear mapping to Spark and Online Feature Store types. Please refer to the feature type guide in the documentation for the exact mapping.</p>"},{"location":"user_guides/migration/30_migration/#required-changes_3","title":"Required Changes","text":"<p>The most common Python/Pandas types are still supported, we recommend you double check your feature groups with the type mapping above.</p>"},{"location":"user_guides/migration/30_migration/#deprecation-of-save-methods-in-favour-of-insert-together-with-get_or_create_","title":"Deprecation of .save methods in favour of .insert together with .get_or_create_","text":"<p>The <code>.save()</code> methods to create feature store entities has been deprecated in favour of <code>.insert()</code>. That means if there is no metadata for an entity in the feature store, a call to <code>.insert()</code> will create it.</p> <p>Together with the new <code>.get_or_create_ APIs</code> this will avoid that users have to change their code between creating entities and deploying the same code into production.</p> Pre-3.03.0 <pre><code>try:\n    fg = fs.get_feature_group(...)\n    fg.insert(df)\nexcept RESTError as e:\n    fg = fs.create_feature_group(...)\n    fg.save(df)\n</code></pre> <pre><code>fg = fs.get_or_create_feature_group(...)\nfg.insert(df)\n</code></pre>"},{"location":"user_guides/migration/30_migration/#hops-python-library-superseded-by-hopsworks-library","title":"hops python library superseded by Hopsworks library","text":"<p>The hops python library is now deprecated and is superseded by the hopsworks python library. <code>hopsworks</code> is essentially a reimplementation of <code>hops</code>, but with an object-oriented API, similar in style with hsfs. For guides on how to use the API follow the Projects guides.</p> <p>Furthermore, the functionality provided by the <code>model</code> and <code>serving</code> module in <code>hops</code>, is now ported to the hsml python library. To create models and serving follow the MLOps guides.</p>"},{"location":"user_guides/migration/30_migration/#new-feature-highlights","title":"New Feature Highlights","text":"<p>This list is meant to serve as a starting point to explore the new features of the Hopsworks 3.0 release, which can significantly improve your workflows.</p>"},{"location":"user_guides/migration/30_migration/#added-new-storage-connectors-gcs-bigquery-and-kafka","title":"Added new Storage Connectors: GCS, BigQuery and Kafka","text":"<p>With the added support for Google Cloud, we added also two new storage connectors: Google Cloud Storage and Google BigQuery. Users can use these connectors to create external feature groups or write out training data.</p> <p>Additionally, to make it easier for users to get started with Spark Streaming applications, we added a Kafka connector, which let\u2019s you easily read a Kafka topic into a Spark Streaming Dataframe.</p>"},{"location":"user_guides/migration/30_migration/#optimized-default-hudi-options","title":"Optimized Default Hudi Options","text":"<p>By default, Hudi tends to over-partition input, and therefore the layout of Feature Groups. The default parallelism is 200, to ensure each Spark partition stays within the 2GB limit for inputs up to 500GB. The new default is the following for all insert/upsert operations:</p> <pre><code>extra_write_options = {\n  'hoodie.bulkinsert.shuffle.parallelism': '5',\n  'hoodie.insert.shuffle.parallelism': '5',\n  'hoodie.upsert.shuffle.parallelism': '5'\n}\n</code></pre> <p>In most of the cases, you will not have to change this default. For very large inputs you should bump this up accordingly, by passing it to the <code>write_options</code> argument of the Feature Group <code>.insert()</code> method:</p> <pre><code>fg.insert(df, write_options=extra_write_options)\n</code></pre> <p>We recommend having shuffle parallelism <code>hoodie.[insert|upsert|bulkinsert].shuffle.parallelism</code> such that its at least input_data_size/500MB.</p>"},{"location":"user_guides/migration/30_migration/#feature-view-passed-features","title":"Feature View passed features","text":"<p>With the introduction of the Feature View abstraction, we added APIs to allow users to overwrite features with so-called passed features when calling <code>fv.get_feature_vector()</code>:</p> <pre><code># get a single vector\nfeature_view.get_feature_vector(\n    entry = {\"pk1\": 1, \"pk2\": 2},\n    passed_features = {\"feature_a\": \"value_a\"}\n)\n# get multiple vectors\nfeature_view.get_feature_vectors(\n    entry = [\n        {\"pk1\": 1, \"pk2\": 2},\n        {\"pk1\": 3, \"pk2\": 4},\n        {\"pk1\": 5, \"pk2\": 6}\n    ],\n    passed_features = [\n        {\"feature_a\": \"value_a\"},\n        {\"feature_a\": \"value_b\"},\n        {\"feature_a\": \"value_c\"},\n    ]\n)\n</code></pre> <p>This is useful, if some of the features values are only known at prediction time and cannot be computed and cached in the online feature store, you can provide those values as <code>passed_features</code> option. The <code>get_feature_vector</code> method is going to use the passed values to construct the final feature vector to submit to the model, it will also apply any transformations to the passed features attached to the respective features.</p>"},{"location":"user_guides/migration/30_migration/#reading-training-data-directly-from-hopsfs-in-python-environments","title":"Reading Training Data directly from HopsFS in Python environments","text":"<p>In Hopsworks 3.0 we added support for reading training data from Hopsworks directly into external Python environments. Previously, users had to write the training data to external storage like S3 in order to access it from external environment.</p>"},{"location":"user_guides/mlops/","title":"Model Registry &amp; Serving Guides","text":"<p>This section serves to provide guides and examples for the common usage of abstractions and functionality of Models and Deployments through the Hopsworks UI and APIs.</p> <ul> <li>Model Registry</li> <li>Model Serving</li> <li>Vector Database</li> </ul>"},{"location":"user_guides/mlops/registry/","title":"Model Registry Guides","text":"<p>Hopsworks Model Registry is a centralized repository, within an organization, to manage machine learning models. A model is the product of training a machine learning algorithm with training data.</p> <p>This section provides guides for creating models and publish them to the Model Registry to make them available for download for batch predictions, or deployed to serve realtime applications.</p>"},{"location":"user_guides/mlops/registry/#exporting-a-model","title":"Exporting a model","text":"<p>Follow these framework-specific guides to export a Model to the Model Registry.</p> <ul> <li> <p>TensorFlow</p> </li> <li> <p>Scikit-learn</p> </li> <li> <p>Other frameworks</p> </li> </ul>"},{"location":"user_guides/mlops/registry/#model-schema","title":"Model Schema","text":"<p>A Model schema describes the input and outputs for a model. It provides a functional description of the model which makes it simpler to get started working with it. For example if the model inputs a tensor, the model schema can define the shape and data type of the tensor.</p>"},{"location":"user_guides/mlops/registry/#input-example","title":"Input Example","text":"<p>An Input example provides an instance of a valid model input. Input examples are stored with the model as separate artifacts.</p>"},{"location":"user_guides/mlops/registry/input_example/","title":"How To Attach An Input Example","text":""},{"location":"user_guides/mlops/registry/input_example/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to attach an input example to a model. An input example is simply an instance of a valid model input. Attaching an input example to your model will give other users a better understanding of what data it expects.</p>"},{"location":"user_guides/mlops/registry/input_example/#code","title":"Code","text":""},{"location":"user_guides/mlops/registry/input_example/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/registry/input_example/#step-2-generate-an-input-example","title":"Step 2: Generate an input example","text":"<p>Generate an input example which corresponds to a valid input to your model. Currently we support <code>pandas.DataFrame, pandas.Series, numpy.ndarray, list</code> to be passed as input example.</p> <pre><code>import numpy as np\n\ninput_example = np.random.randint(0, high=256, size=784, dtype=np.uint8)\n</code></pre>"},{"location":"user_guides/mlops/registry/input_example/#step-3-set-input_example-parameter","title":"Step 3: Set input_example parameter","text":"<p>Set the <code>input_example</code> parameter in the <code>create_model</code> function and call <code>save()</code> to attaching it to the model and register it in the registry. <pre><code>model = mr.tensorflow.create_model(name=\"mnist\",\n                                   input_example=input_example)\nmodel.save(\"./model\")\n</code></pre></p>"},{"location":"user_guides/mlops/registry/input_example/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to attach an input example to your model.</p>"},{"location":"user_guides/mlops/registry/model_schema/","title":"How To Attach A Model Schema","text":""},{"location":"user_guides/mlops/registry/model_schema/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to attach a model schema to your model. A model schema, describes the type and shape of inputs and outputs (predictions) for your model. Attaching a model schema to your model will give other users a better understanding of what data it expects.</p>"},{"location":"user_guides/mlops/registry/model_schema/#code","title":"Code","text":""},{"location":"user_guides/mlops/registry/model_schema/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/registry/model_schema/#step-2-create-modelschema","title":"Step 2: Create ModelSchema","text":"<p>Create a ModelSchema for your inputs and outputs by passing in an example that your model is trained on and a valid prediction. Currently, we support <code>pandas.DataFrame, pandas.Series, numpy.ndarray, list</code>.</p> <pre><code># Import a Schema and ModelSchema definition\nfrom hsml.utils.model_schema import ModelSchema\nfrom hsml.utils.schema import Schema\n\n# Model inputs for MNIST dataset\ninputs = [{'type': 'uint8', 'shape': [28, 28, 1], 'description': 'grayscale representation of 28x28 MNIST images'}]\n\n# Build the input schema\ninput_schema = Schema(inputs)\n\n# Model outputs\noutputs = [{'type': 'float32', 'shape': [10]}]\n\n# Build the output schema\noutput_schema = Schema(outputs)\n\n# Create ModelSchema object\nmodel_schema = ModelSchema(input_schema=input_schema, output_schema=output_schema)\n</code></pre>"},{"location":"user_guides/mlops/registry/model_schema/#step-3-set-model_schema-parameter","title":"Step 3: Set model_schema parameter","text":"<p>Set the <code>model_schema</code> parameter in the <code>create_model</code> function and call <code>save()</code> to attaching it to the model and register it in the registry. <pre><code>model = mr.tensorflow.create_model(name=\"mnist\",\n                                   model_schema=model_schema)\nmodel.save(\"./model\")\n</code></pre></p>"},{"location":"user_guides/mlops/registry/model_schema/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to attach an input example to your model.</p>"},{"location":"user_guides/mlops/registry/frameworks/python/","title":"How To Export a Python Model","text":""},{"location":"user_guides/mlops/registry/frameworks/python/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to export a generic Python model and register it in the Model Registry.</p>"},{"location":"user_guides/mlops/registry/frameworks/python/#code","title":"Code","text":""},{"location":"user_guides/mlops/registry/frameworks/python/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/python/#step-2-train","title":"Step 2: Train","text":"<p>Define your XGBoost model and run the training loop.</p> <pre><code># Define a model\nmodel = XGBClassifier()\n\n# Train model\nmodel.fit(X_train, y_train)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/python/#step-3-export-to-local-path","title":"Step 3: Export to local path","text":"<p>Export the XGBoost model to a directory on the local filesystem.</p> <pre><code>model_file = \"model.json\"\n\nmodel.save_model(model_file)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/python/#step-4-register-model-in-registry","title":"Step 4: Register model in registry","text":"<p>Use the <code>ModelRegistry.python.create_model(..)</code> function to register a model as a Python model. Define a name, and attach optional metrics for your model, then invoke the <code>save()</code> function with the parameter being the path to the local directory where the model was exported to.</p> <pre><code># Model evaluation metrics\nmetrics = {'accuracy': 0.92}\n\npy_model = mr.python.create_model(\"py_model\", metrics=metrics)\n\npy_model.save(model_dir)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/python/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to export a Python model to the Model Registry. You can also try attaching an Input Example and a Model Schema to your model to document the shape and type of the data the model was trained on.</p>"},{"location":"user_guides/mlops/registry/frameworks/skl/","title":"How To Export a Scikit-learn Model","text":""},{"location":"user_guides/mlops/registry/frameworks/skl/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to export a Scikit-learn model and register it in the Model Registry.</p>"},{"location":"user_guides/mlops/registry/frameworks/skl/#code","title":"Code","text":""},{"location":"user_guides/mlops/registry/frameworks/skl/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/skl/#step-2-train","title":"Step 2: Train","text":"<p>Define your Scikit-learn model and run the training loop.</p> <pre><code># Define a model\niris_knn = KNeighborsClassifier(..)\n\niris_knn.fit(..)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/skl/#step-3-export-to-local-path","title":"Step 3: Export to local path","text":"<p>Export the Scikit-learn model to a directory on the local filesystem.</p> <pre><code>model_file = \"skl_knn.pkl\"\n\njoblib.dump(iris_knn, model_file)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/skl/#step-4-register-model-in-registry","title":"Step 4: Register model in registry","text":"<p>Use the <code>ModelRegistry.sklearn.create_model(..)</code> function to register a model as a Scikit-learn model. Define a name, and attach optional metrics for your model, then invoke the <code>save()</code> function with the parameter being the path to the local directory where the model was exported to.</p> <pre><code># Model evaluation metrics\nmetrics = {'accuracy': 0.92}\n\nskl_model = mr.sklearn.create_model(\"skl_model\", metrics=metrics)\n\nskl_model.save(model_file)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/skl/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to export a Scikit-learn model to the Model Registry. You can also try attaching an Input Example and a Model Schema to your model to document the shape and type of the data the model was trained on.</p>"},{"location":"user_guides/mlops/registry/frameworks/tf/","title":"How To Export a TensorFlow Model","text":""},{"location":"user_guides/mlops/registry/frameworks/tf/#introduction","title":"Introduction","text":"<p>In this guide you will learn how to export a TensorFlow model and register it in the Model Registry.</p> <p>Save in SavedModel format</p> <p>Make sure the model is saved in the SavedModel format to be able to deploy it on TensorFlow Serving.</p>"},{"location":"user_guides/mlops/registry/frameworks/tf/#code","title":"Code","text":""},{"location":"user_guides/mlops/registry/frameworks/tf/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/tf/#step-2-train","title":"Step 2: Train","text":"<p>Define your TensorFlow model and run the training loop.</p> <pre><code># Define a model\nmodel = tf.keras.Sequential()\n\n# Add layers\nmodel.add(..)\n\n# Compile the model.\nmodel.compile(..)\n\n# Train the model\nmodel.fit(..)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/tf/#step-3-export-to-local-path","title":"Step 3: Export to local path","text":"<p>Export the TensorFlow model to a directory on the local filesystem.</p> <pre><code>model_dir = \"./model\"\n\ntf.saved_model.save(model, model_dir)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/tf/#step-4-register-model-in-registry","title":"Step 4: Register model in registry","text":"<p>Use the <code>ModelRegistry.tensorflow.create_model(..)</code> function to register a model as a TensorFlow model. Define a name, and attach optional metrics for your model, then invoke the <code>save()</code> function with the parameter being the path to the local directory where the model was exported to.  </p> <pre><code># Model evaluation metrics\nmetrics = {'accuracy': 0.92}\n\ntf_model = mr.tensorflow.create_model(\"tf_model\", metrics=metrics)\n\ntf_model.save(model_dir)\n</code></pre>"},{"location":"user_guides/mlops/registry/frameworks/tf/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to export a TensorFlow model to the Model Registry. You can also try attaching an Input Example and a Model Schema to your model to document the shape and type of the data the model was trained on.</p>"},{"location":"user_guides/mlops/serving/","title":"Model Serving Guide","text":""},{"location":"user_guides/mlops/serving/#deployment","title":"Deployment","text":"<p>Assuming you have already created a model in the Model Registry, a deployment can now be created to prepare a model artifact for this model and make it accessible for running predictions behind a REST endpoint. Follow the Deployment Creation Guide to create a Deployment for your model.</p>"},{"location":"user_guides/mlops/serving/#predictor","title":"Predictor","text":"<p>Predictors are responsible for running a model server that loads a trained model, handles inference requests and returns predictions, see the Predictor Guide.</p>"},{"location":"user_guides/mlops/serving/#transformer","title":"Transformer","text":"<p>Transformers are used to apply transformations on the model inputs before sending them to the predictor for making predictions using the model, see the Transformer Guide.</p>"},{"location":"user_guides/mlops/serving/#inference-batcher","title":"Inference Batcher","text":"<p>Configure the predictor to batch inference requests, see the Inference Batcher Guide.</p>"},{"location":"user_guides/mlops/serving/#inference-logger","title":"Inference Logger","text":"<p>Configure the predictor to log inference requests and predictions, see the Inference Logger Guide.</p>"},{"location":"user_guides/mlops/serving/deployment-state/","title":"How To Inspect A Deployment State","text":""},{"location":"user_guides/mlops/serving/deployment-state/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to inspect the state of a deployment.</p> <p>A state can be seen as a snapshot of the current inner workings of a deployment. The following is the state transition diagram for deployments.</p> <p> State transitions of deployments </p> <p>States are composed of a status and a condition. While a status represents a high-level view of the state, conditions contain more detailed information closely related to infrastructure terms.</p>"},{"location":"user_guides/mlops/serving/deployment-state/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/deployment-state/#step-1-inspect-deployment-status","title":"Step 1: Inspect deployment status","text":"<p>If you have at least one deployment already created, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, find the deployment you want to inspect. Next to the actions buttons, you can find an indicator showing the current status of the deployment. This indicator changes its color based on the status.</p> <p>To inspect the condition of the deployment, click on the name of the deployment to open the deployment overview page.</p>"},{"location":"user_guides/mlops/serving/deployment-state/#step-2-inspect-condition","title":"Step 2: Inspect condition","text":"<p>Once in the deployment overview page, you can find the aforementioned status indicator at the top of page. Below it, a one-line message is shown with a more detailed description of the deployment status. This message is built using the current condition of the deployment.</p> <p> Deployments status condition </p>"},{"location":"user_guides/mlops/serving/deployment-state/#step-3-check-no-of-running-instances","title":"Step 3: Check n\u00ba of running instances","text":"<p>Additionally, you can find the n\u00ba of instances currently running by scrolling down to the <code>resource allocation</code> section. </p> <p> Resource allocation for a deployment </p> <p>Scale-to-zero capabilities</p> <p>If scale-to-zero capabilities are enabled, you can see how the n\u00ba of instances of a running deployment goes to zero and the status changes to <code>idle</code>. To enable scale-to-zero in a deployment, see Resource Allocation Guide</p>"},{"location":"user_guides/mlops/serving/deployment-state/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/deployment-state/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment-state/#step-2-retrieve-an-existing-deployment","title":"Step 2: Retrieve an existing deployment","text":"<pre><code>deployment = ms.get_deployment(\"mydeployment\")\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment-state/#step-3-inspect-deployment-state","title":"Step 3: Inspect deployment state","text":"<pre><code>state = deployment.get_state()\n\nstate.describe()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment-state/#step-4-check-no-of-running-instances","title":"Step 4: Check n\u00ba of running instances","text":"<pre><code># n\u00ba of predictor instances\ndeployment.resources.describe()\n\n# n\u00ba of transformer instances\ndeployment.transformer.resources.describe()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment-state/#api-reference","title":"API Reference","text":"<p>Deployment</p> <p>PredictorState</p>"},{"location":"user_guides/mlops/serving/deployment-state/#deployment-status","title":"Deployment status","text":"<p>The status of a deployment is a high-level description of its current state.</p> Show deployment status Status Description CREATED Deployment has never been started STARTING Deployment is starting RUNNING Deployment is ready and running. Predictions are served without additional latencies. IDLE Deployment is ready, but idle. Higher latencies (i.e., cold-start) are expected in the first incoming inference requests FAILED Deployment is in a failed state, which can be due to multiple reasons. More details can be found in the condition UPDATING Deployment is applying updates to the running instances STOPPING Deployment is stopping STOPPED Deployment has been stopped"},{"location":"user_guides/mlops/serving/deployment-state/#deployment-conditions","title":"Deployment conditions","text":"<p>A condition contains more specific information about the status of the deployment. They are mainly useful to track the progress of starting or stopping deployments.</p> <p>Status conditions contain three pieces of information: type, status and reason. While the type describes the purpose of the condition, the status represents its progress. Additionally, a reason field is provided with a more descriptive message of the status.</p> Show deployment conditions Type Status Description STOPPED <code>Unknown</code> Deployment is stopping. <code>True</code> Deployment is stopped. Therefore, no instances are running and no resources are allocated. SCHEDULED <code>Unknown</code> Deployment is being scheduled <code>False</code> Deployment failed to be scheduled. This is commonly due to insufficient resources to satisfy the deployment requirements <code>True</code> Deployment has been scheduled successfully. At this point, resources have been already allocated for the deployment. INITIALIZED <code>Unknown</code> Deployment is initializing. This step involves initialization tasks such as pulling docker images or mounting data volumes <code>False</code> Deployment failed to initialized <code>True</code> Deployment has been initialized successfully. At this point, the docker images have been pulled and data volumes mounted STARTED <code>Unknown</code> Deployment is starting. In this step, the model server is started and predictor / transformer scripts (if provided) are executed <code>False</code> Deployment failed to start. This can be due to errors in the predictor / transformer script, missing dependencies or model server incompatibilities. <code>True</code> Deployment has been started successfully. At this point, the model server has been started and the predictor / transformer scripts (if provided) executed. READY <code>Unknown</code> Connectivity is being set up. <code>False</code> Connectivity failed to be set up, mainly due to networking issues. <code>True</code> Connectivity has been set up and the deployment is ready <p>The following are two diagrams with the state transitions of conditions in starting and stopping deployments, respectively.</p> <p> Condition transitions in starting deployments </p> <p> Condition transitions in stopping deployments </p>"},{"location":"user_guides/mlops/serving/deployment/","title":"How To Create A Deployment","text":""},{"location":"user_guides/mlops/serving/deployment/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to create a new deployment for a trained model.</p> <p>Warning</p> <p>This guide assumes that a model has already been trained and saved into the Model Registry. To learn how to create a model in the Model Registry, see Model Registry Guide</p> <p>Deployments are used to unify the different components involved in making one or more trained models online and accessible to compute predictions on demand. In each deployment, there are three main components to consider:</p> <ol> <li>Model artifact</li> <li>Predictor</li> <li>Transformer</li> </ol>"},{"location":"user_guides/mlops/serving/deployment/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/deployment/#step-1-create-a-deployment","title":"Step 1: Create a deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/deployment/#step-2-basic-deployment-configuration","title":"Step 2: Basic deployment configuration","text":"<p>A simplified creation form will appear including the most common deployment fields among all the configuration possible. We provide default values for the rest of the fields, adjusted to the type of deployment you want to create.</p> <p>In the simplified form, select the model framework used to train your model (i.e., TensorFlow Serving or Python). Then, select the model you want to deploy from the list of available models under <code>pick a model</code>.</p> <p>After selecting the model, the rest of fields are filled automatically. We pick the last model version and model artifact version available in the Model Registry. Moreover, we infer the deployment name from the model name.</p> <p>Deployment name validation rules</p> <p>A valid deployment name can only contain characters a-z, A-Z and 0-9.</p> <p>Predictor script for Python models</p> <p>For Python models, you can select a custom predictor script to load and run the trained model by clicking on <code>From project</code> or <code>Upload new file</code>, to choose an existing script in the project file system or upload a new script, respectively.</p> <p>If you prefer, change the name of the deployment, model version or artifact version. Then, click on <code>Create new deployment</code> to create the deployment for your model.</p> <p> Simplified deployment creation forms for TensorFlow models (left) and Python models (right) </p>"},{"location":"user_guides/mlops/serving/deployment/#step-3-optional-advanced-configuration","title":"Step 3 (Optional): Advanced configuration","text":"<p>Optionally, you can access and adjust other parameters of the deployment configuration by clicking on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p> <p>You will be redirected to a full-page deployment creation form where you can see all the default configuration values we selected for your deployment and adjust them according to your use case. Apart from the aforementioned simplified configuration, in this form you can setup the following components:</p> <p>Deployment advanced options</p> <ol> <li>Predictor</li> <li>Transformer</li> <li>Inference logger</li> <li>Inference batcher</li> <li>Resources</li> </ol> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/deployment/#step-4-deployment-creation","title":"Step 4: Deployment creation","text":"<p>Wait for the deployment creation process to finish.</p> <p> Deployment creation in progress </p>"},{"location":"user_guides/mlops/serving/deployment/#step-5-deployment-overview","title":"Step 5: Deployment overview","text":"<p>Once the deployment is created, you will be redirected to the list of all your existing deployments in the project. You can use the filters on the top of the page to easily locate your new deployment.</p> <p> List of deployments </p> <p>After that, click on the new deployment to access the overview page.</p> <p> Deployment overview </p>"},{"location":"user_guides/mlops/serving/deployment/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/deployment/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment/#step-2-create-deployment","title":"Step 2: Create deployment","text":"<p>Retrieve the trained model you want to deploy.</p> <pre><code>my_model = mr.get_model(\"my_model\", version=1)\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment/#option-a-using-the-model-object","title":"Option A: Using the model object","text":"<pre><code>my_deployment = my_model.deploy()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment/#option-b-using-the-model-serving-handle","title":"Option B: Using the Model Serving handle","text":"<pre><code># get Hopsworks Model Serving handle\nms = project.get_model_serving()\n\nmy_predictor = ms.create_predictor(my_model)\nmy_deployment = my_predictor.deploy()\n\n# or\nmy_deployment = ms.create_deployment(my_predictor)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/deployment/#api-reference","title":"API Reference","text":"<p>Model Serving</p>"},{"location":"user_guides/mlops/serving/deployment/#model-artifact","title":"Model Artifact","text":"<p>A model artifact is a package containing all of the necessary files for the deployment of a model. It includes the model file(s) and/or custom scripts for loading the model (predictor script) or transforming the model inputs at inference time (the transformer script).</p> <p>When a new deployment is created, a model artifact is generated in two cases:</p> <ul> <li>the artifact version in the predictor is set to <code>CREATE</code> (see Artifact Version)</li> <li>no model artifact with the same files has been created before.</li> </ul>"},{"location":"user_guides/mlops/serving/deployment/#predictor","title":"Predictor","text":"<p>Predictors are responsible for running the model server that loads the trained model, listens to inference requests and returns prediction results. To learn more about predictors, see the Predictor Guide</p> <p>Note</p> <p>Currently, only one predictor is supported in a deployment. Support for multiple predictors (the inference graphs) is coming soon.</p> <p>Info</p> <p>Model artifacts are assigned an incremental version number, being <code>0</code> the version reserved for model artifacts that do not contain predictor or transformer scripts (i.e., shared artifacts containing only the model files).</p>"},{"location":"user_guides/mlops/serving/deployment/#transformer","title":"Transformer","text":"<p>Transformers are used to apply transformations on the model inputs before sending them to the predictor for making predictions using the model. To learn more about transformers, see the Transformer Guide.</p> <p>Warning</p> <p>Transformers are only supported in KServe deployments.</p>"},{"location":"user_guides/mlops/serving/deployment/#inference-logger","title":"Inference logger","text":"<p>Inference loggers are deployment components that log inference requests into a Kafka topic for later analysis. To learn about the different logging modes, see the Inference Logger Guide</p>"},{"location":"user_guides/mlops/serving/deployment/#inference-batcher","title":"Inference batcher","text":"<p>Inference batcher are deployment component that apply batching to the incoming inference requests for a better throughput-latency trade-off. To learn about the different configuration available for the inference batcher, see the Inference Batcher Guide.</p>"},{"location":"user_guides/mlops/serving/deployment/#resources","title":"Resources","text":"<p>Resources include the number of replicas for the deployment as well as the resources (i.e., memory, CPU, GPU) to be allocated per replica. To learn about the different combinations available, see the Resources Guide.</p>"},{"location":"user_guides/mlops/serving/deployment/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a deployment.</p>"},{"location":"user_guides/mlops/serving/inference-batcher/","title":"How To Configure Inference Batcher","text":""},{"location":"user_guides/mlops/serving/inference-batcher/#introduction","title":"Introduction","text":"<p>Inference batching can be enabled to increase inference request throughput at the cost of higher latencies. The configuration of the inference batcher depends on the serving tool and the model server used in the deployment. See the compatibility matrix.</p>"},{"location":"user_guides/mlops/serving/inference-batcher/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/inference-batcher/#step-1-create-new-deployment","title":"Step 1: Create new deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/inference-batcher/#step-2-go-to-advanced-options","title":"Step 2: Go to advanced options","text":"<p>A simplified creation form will appear including the most common deployment fields among all the configuration possible. Inference batching is part of the advanced options of a deployment. To navigate to the advanced creation form, click on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p>"},{"location":"user_guides/mlops/serving/inference-batcher/#step-3-configure-inference-batching","title":"Step 3: Configure inference batching","text":"<p>To enable inference batching, click on the <code>Request batching</code> checkbox.</p> <p> Inference batching configuration (default values) </p> <p>If your deployment uses KServe, you can optionally set three additional parameters for the inference batcher: maximum batch size, maximum latency (ms) and timeout (s).</p> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/inference-batcher/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/inference-batcher/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-batcher/#step-2-define-an-inference-logger","title":"Step 2: Define an inference logger","text":"<pre><code>from hsml.inference_batcher import InferenceBatcher\n\nmy_batcher = InferenceBatcher(enabled=True,\n                              # optional\n                              max_batch_size=32,\n                              max_latency=5000, # milliseconds\n                              timeout=5 # seconds\n                              )\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-batcher/#step-3-create-a-deployment-with-the-inference-batcher","title":"Step 3: Create a deployment with the inference batcher","text":"<pre><code>my_model = mr.get_model(\"my_model\", version=1)\n\nmy_predictor = ms.create_predictor(my_model,\n                                   inference_batcher=my_batcher\n                                   )\nmy_predictor.deploy()\n\n# or\n\nmy_deployment = ms.create_deployment(my_predictor)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-batcher/#api-reference","title":"API Reference","text":"<p>Inference Batcher</p>"},{"location":"user_guides/mlops/serving/inference-batcher/#compatibility-matrix","title":"Compatibility matrix","text":"Show supported inference batcher configuration Serving tool Model server Inference batching Fine-grained configuration Docker Flask \u274c - TensorFlow Serving \u2705 \u274c Kubernetes Flask \u274c - TensorFlow Serving \u2705 \u274c KServe Flask \u2705 \u2705 TensorFlow Serving \u2705 \u2705"},{"location":"user_guides/mlops/serving/inference-logger/","title":"How To Configure Inference Logging","text":""},{"location":"user_guides/mlops/serving/inference-logger/#introduction","title":"Introduction","text":"<p>Once a model is deployed and starts making predictions as inference requests arrive, logging model inputs and predictions becomes essential to monitor the health of the model and take action if the model's performance degrades over time.</p> <p>Hopsworks supports logging both inference requests and predictions as events to a Kafka topic for analysis.</p> <p>Topic schemas vary depending on the serving tool. See below</p>"},{"location":"user_guides/mlops/serving/inference-logger/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/inference-logger/#step-1-create-new-deployment","title":"Step 1: Create new deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/inference-logger/#step-2-go-to-advanced-options","title":"Step 2: Go to advanced options","text":"<p>A simplified creation form will appear including the most common deployment fields among all the configuration possible. Inference logging is part of the advanced options of a deployment. To navigate to the advanced creation form, click on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p>"},{"location":"user_guides/mlops/serving/inference-logger/#step-3-configure-inference-logging","title":"Step 3: Configure inference logging","text":"<p>To enable inference logging, choose <code>CREATE</code> as Kafka topic name to create a new topic, or select an existing topic. If you prefer, you can disable inference logging by selecting <code>NONE</code>.</p> <p>If you decide to create a new topic, select the number of partitions and number of replicas for your topic, or use the default values.</p> <p> Inference logging configuration with a new kafka topic </p> <p>If the deployment is created with KServe enabled, you can specify which inference logs you want to send to the Kafka topic (i.e., <code>MODEL_INPUTS</code>, <code>PREDICTIONS</code> or both)</p> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/inference-logger/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/inference-logger/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-logger/#step-2-define-an-inference-logger","title":"Step 2: Define an inference logger","text":"<pre><code>from hsml.inference_logger import InferenceLogger\nfrom hsml.kafka_topic import KafkaTopic\n\nnew_topic = KafkaTopic(name=\"CREATE\",\n                       # optional\n                       num_partitions=1,\n                       num_replicas=1\n                       )\n\nmy_logger = InferenceLogger(kafka_topic=new_topic, mode=\"ALL\")\n</code></pre> <p>Use dict for simpler code</p> <p>Similarly, you can create the same logger with:</p> <pre><code>my_logger = InferenceLogger(kafka_topic={\"name\": \"CREATE\"}, mode=\"ALL\")\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-logger/#step-3-create-a-deployment-with-the-inference-logger","title":"Step 3: Create a deployment with the inference logger","text":"<pre><code>my_model = mr.get_model(\"my_model\", version=1)\n\nmy_predictor = ms.create_predictor(my_model,\n                                   inference_logger=my_logger\n                                   )\nmy_predictor.deploy()\n\n# or\n\nmy_deployment = ms.create_deployment(my_predictor)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/inference-logger/#api-reference","title":"API Reference","text":"<p>Inference Logger</p>"},{"location":"user_guides/mlops/serving/inference-logger/#topic-schema","title":"Topic schema","text":"<p>The schema of Kafka events varies depending on the serving tool. In KServe deployments, model inputs and predictions are logged in separate events, but sharing the same <code>requestId</code> field. In non-KServe deployments, the same event contains both the model input and prediction related to the same inference request. </p> Show kafka topic schemas KServeDocker / Kubernetes <pre><code>{\n    \"fields\": [\n        { \"name\": \"servingId\", \"type\": \"int\" },\n        { \"name\": \"modelName\", \"type\": \"string\" },\n        { \"name\": \"modelVersion\", \"type\": \"int\" },\n        { \"name\": \"requestTimestamp\", \"type\": \"long\" },\n        { \"name\": \"responseHttpCode\", \"type\": \"int\" },\n        { \"name\": \"inferenceId\", \"type\": \"string\" },\n        { \"name\": \"messageType\", \"type\": \"string\" },\n        { \"name\": \"payload\", \"type\": \"string\" }\n    ],\n    \"name\": \"inferencelog\",\n    \"type\": \"record\"\n}\n</code></pre> <pre><code>{\n    \"fields\": [\n        { \"name\": \"modelId\", \"type\": \"int\" },\n        { \"name\": \"modelName\", \"type\": \"string\" },\n        { \"name\": \"modelVersion\", \"type\": \"int\" },\n        { \"name\": \"requestTimestamp\", \"type\": \"long\" },\n        { \"name\": \"responseHttpCode\", \"type\": \"int\" },\n        { \"name\": \"inferenceRequest\", \"type\": \"string\" },\n        { \"name\": \"inferenceResponse\", \"type\": \"string\" },\n        { \"name\": \"modelServer\", \"type\": \"string\" },\n        { \"name\": \"servingTool\", \"type\": \"string\" }\n    ],\n    \"name\": \"inferencelog\",\n    \"type\": \"record\"\n}\n</code></pre>"},{"location":"user_guides/mlops/serving/predictor/","title":"How To Configure A Predictor","text":""},{"location":"user_guides/mlops/serving/predictor/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to configure a predictor for a trained model.</p> <p>Warning</p> <p>This guide assumes that a model has already been trained and saved into the Model Registry. To learn how to create a model in the Model Registry, see Model Registry Guide</p> <p>Predictors are the main component of deployments. They are responsible for running a model server that loads a trained model, handles inference requests and returns predictions. They can be configured to use different model servers, serving tools, log specific inference data or scale differently. In each predictor, you can configure the following components:</p> <ol> <li>Model server</li> <li>Serving tool</li> <li>Custom script</li> <li>Transformer</li> <li>Inference Logger</li> <li>Inference Batcher</li> <li>Resources</li> </ol>"},{"location":"user_guides/mlops/serving/predictor/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/predictor/#step-1-create-new-deployment","title":"Step 1: Create new deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/predictor/#step-2-choose-a-model-server","title":"Step 2: Choose a model server","text":"<p>A simplified creation form will appear, including the most common deployment fields among all the configuration possible. These fields include the model server and custom script (for python models).</p> <p> Simplified deployment creation forms for TensorFlow models (left) and Python models (right) </p> <p>Moreover, you can optionally select a predictor script (see Step 3), enable KServe (see Step 4) or change other advanced configuration (see Step 5). Otherwise, click on <code>Create new deployment</code> to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/predictor/#step-3-optional-select-a-predictor-script","title":"Step 3 (Optional): Select a predictor script","text":"<p>For python models, if you want to use your own predictor script click on <code>From project</code> and navigate through the file system to find it, or click on <code>Upload new file</code> to upload a predictor script now.</p> <p> Select a predictor script in the simplified deployment form </p>"},{"location":"user_guides/mlops/serving/predictor/#step-4-optional-enable-kserve","title":"Step 4 (Optional): Enable KServe","text":"<p>Other configuration such as the serving tool, is part of the advanced options of a deployment. To navigate to the advanced creation form, click on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p> <p>Here, you change the serving tool for your deployment by enabling or disabling the KServe checkbox.</p> <p> KServe checkbox in the advanced deployment form </p>"},{"location":"user_guides/mlops/serving/predictor/#step-5-optional-other-advanced-options","title":"Step 5 (Optional): Other advanced options","text":"<p>Additionally, you can adjust the default values of the rest of components:</p> <p>Predictor components</p> <ol> <li>Transformer</li> <li>Inference logger</li> <li>Inference batcher</li> <li>Resources</li> </ol> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/predictor/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/predictor/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/predictor/#step-2-optional-implement-predictor-script","title":"Step 2 (Optional): Implement predictor script","text":"Python <pre><code>class Predict(object):\n\n    def __init__(self):\n        \"\"\" Initialization code goes here:\n            - Download the model artifact\n            - Load the model\n        \"\"\"\n        pass\n\n    def predict(self, inputs):\n        \"\"\" Serve predictions using the trained model\"\"\"\n        pass\n</code></pre> <p>Jupyter magic</p> <p>In a jupyter notebook, you can add <code>%%writefile my_predictor.py</code> at the top of the cell to save it as a local file.</p>"},{"location":"user_guides/mlops/serving/predictor/#step-3-optional-upload-the-script-to-your-project","title":"Step 3 (Optional): Upload the script to your project","text":"<p>You can also use the UI to upload your predictor script. See above</p> <pre><code>uploaded_file_path = dataset_api.upload(\"my_predictor.py\", \"Resources\", overwrite=True)\npredictor_script_path = os.path.join(\"/Projects\", project.name, uploaded_file_path)\n</code></pre>"},{"location":"user_guides/mlops/serving/predictor/#step-4-define-predictor","title":"Step 4: Define predictor","text":"<pre><code>my_model = mr.get_model(\"my_model\", version=1)\n\nmy_predictor = ms.create_predictor(my_model,\n                                   # optional\n                                   model_server=\"PYTHON\",\n                                   serving_tool=\"KSERVE\",\n                                   script_file=predictor_script_path\n                                   )\n</code></pre>"},{"location":"user_guides/mlops/serving/predictor/#step-3-create-a-deployment-with-the-predictor","title":"Step 3: Create a deployment with the predictor","text":"<pre><code>my_deployment = my_predictor.deploy()\n\n# or\nmy_deployment = ms.create_deployment(my_predictor)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/predictor/#api-reference","title":"API Reference","text":"<p>Predictor</p>"},{"location":"user_guides/mlops/serving/predictor/#model-server","title":"Model Server","text":"<p>Hopsworks Model Serving currently supports deploying models with a Flask server for python-based models or TensorFlow Serving for TensorFlow / Keras models. Support for TorchServe for running PyTorch models is coming soon. Today, you can deploy PyTorch models as python-based models.</p> Show supported model servers Model Server Supported ML Frameworks Flask \u2705 python-based (scikit-learn, xgboost, pytorch...) TensorFlow Serving \u2705 keras, tensorflow TorchServe \u274c pytorch"},{"location":"user_guides/mlops/serving/predictor/#serving-tool","title":"Serving tool","text":"<p>In Hopsworks, model servers can be deployed in three different ways: directly on Docker, on Kubernetes deployments or using KServe inference services. Although the same models can be deployed in either of our two serving tools (Python or KServe), the use of KServe is highly recommended. The following is a comparitive table showing the features supported by each of them.</p> Show serving tools comparison Feature / requirement Docker Kubernetes (enterprise) KServe (enterprise) Autoscaling (scale-out) \u274c \u2705 \u2705 Resource allocation \u2796 fixed \u2796 min. resources \u2705 min / max. resources Inference logging \u2796 simple \u2796 simple \u2705 fine-grained Inference batching \u2796 partially \u2796 partially \u2705 Scale-to-zero \u274c \u274c \u2705 after 30s of inactivity) Transformers \u274c \u274c \u2705 Low-latency predictions \u274c \u274c \u2705 Multiple models \u274c \u274c \u2796 (python-based) Custom predictor required  (python-only) \u2705 \u2705 \u274c"},{"location":"user_guides/mlops/serving/predictor/#custom-script","title":"Custom script","text":"<p>Depending on the model server and serving tool used in the deployment, you can provide your own python script to load the model and make predictions.</p> Show supported custom predictors Serving tool Model server Custom predictor script Docker Flask \u2705 (required) TensorFlow Serving \u274c Kubernetes Flask \u2705 (required) TensorFlow Serving \u274c KServe Flask \u2705 (only required for artifacts with multiple models) TensorFlow Serving \u274c"},{"location":"user_guides/mlops/serving/predictor/#environment-variables","title":"Environment variables","text":"<p>A number of different environment variables is available in the predictor to ease its implementation.</p> Show environment variables Name Description ARTIFACT_FILES_PATH Local path to the model artifact files DEPLOYMENT_NAME Name of the current deployment MODEL_NAME Name of the model being served by the current deployment MODEL_VERSION Version of the model being served by the current deployment ARTIFACT_VERSION Version of the model artifact being served by the current deployment"},{"location":"user_guides/mlops/serving/predictor/#transformer","title":"Transformer","text":"<p>Transformers are used to apply transformations on the model inputs before sending them to the predictor for making predictions using the model. To learn more about transformers, see the Transformer Guide.</p> <p>Warning</p> <p>Transformers are only supported in KServe deployments.</p>"},{"location":"user_guides/mlops/serving/predictor/#inference-logger","title":"Inference logger","text":"<p>Inference loggers are deployment components that log inference requests into a Kafka topic for later analysis. To learn about the different logging modes, see the Inference Logger Guide</p>"},{"location":"user_guides/mlops/serving/predictor/#inference-batcher","title":"Inference batcher","text":"<p>Inference batcher are deployment component that apply batching to the incoming inference requests for a better throughput-latency trade-off. To learn about the different configuration available for the inference batcher, see the Inference Batcher Guide.</p>"},{"location":"user_guides/mlops/serving/predictor/#resources","title":"Resources","text":"<p>Resources include the number of replicas for the deployment as well as the resources (i.e., memory, CPU, GPU) to be allocated per replica. To learn about the different combinations available, see the Resources Guide.</p>"},{"location":"user_guides/mlops/serving/predictor/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure a predictor.</p>"},{"location":"user_guides/mlops/serving/resources/","title":"How To Allocate Resources For A Deployment","text":""},{"location":"user_guides/mlops/serving/resources/#introduction","title":"Introduction","text":"<p>Depending on the serving tool used to deploy a trained model, resource allocation can be configured at different levels. While deployments on Docker containers only support a fixed number of resources (CPU and memory), using Kubernetes or KServe allows a better exploitation of the resources available in the platform, by enabling you to specify how many CPUs, GPUs, and memory are allocated to a deployment. See the compatibility matrix.</p>"},{"location":"user_guides/mlops/serving/resources/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/resources/#step-1-create-new-deployment","title":"Step 1: Create new deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/resources/#step-2-go-to-advanced-options","title":"Step 2: Go to advanced options","text":"<p>A simplified creation form will appear including the most common deployment fields among all the configuration possible. Resource allocation is part of the advanced options of a deployment. To navigate to the advanced creation form, click on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p>"},{"location":"user_guides/mlops/serving/resources/#step-3-configure-resource-allocation","title":"Step 3: Configure resource allocation","text":"<p>In the <code>Resource allocation</code> section of the form, you can optionally set the resources to be allocated to the predictor and/or the transformer (if available). Moreover, you can choose the minimum number of replicas for each of these components. </p> Scale-to-zero capabilities <p>Deployments with KServe enabled can scale to zero by choosing <code>0</code> as the number of instances.</p> <p> Resource allocation for the predictor and transformer </p> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/resources/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/resources/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Registry handle\nmr = project.get_model_registry()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/resources/#step-2-define-the-predictor-resource-configuration","title":"Step 2: Define the predictor resource configuration","text":"<pre><code>from hsml.resources import PredictorResources, Resources\n\nminimum_res = Resources(cores=1, memory=128, gpus=1)\nmaximum_res = Resources(cores=2, memory=256, gpus=1)\n\npredictor_res = PredictorResources(num_instances=1, requests=minimum_res, limits=maximum_res)\n</code></pre>"},{"location":"user_guides/mlops/serving/resources/#step-3-optional-define-the-transformer-resource-configuration","title":"Step 3 (Optional): Define the transformer resource configuration","text":"<pre><code>from hsml.resources import TransformerResources\n\nminimum_res = Resources(cores=1, memory=128, gpus=1)\nmaximum_res = Resources(cores=2, memory=256, gpus=1)\n\ntransformer_res = TransformerResources(num_instances=2, requests=minimum_res, limits=maximum_res)\n</code></pre>"},{"location":"user_guides/mlops/serving/resources/#step-4-create-a-deployment-with-the-resource-configuration","title":"Step 4: Create a deployment with the resource configuration","text":"<pre><code>my_model = mr.get_model(\"my_model\", version=1)\n\nmy_predictor = ms.create_predictor(my_model,\n                                   resources=predictor_res,\n                                   # transformer=Transformer(script_file,\n                                   #                         resources=transformer_res)\n                                   )\nmy_predictor.deploy()\n\n# or\n\nmy_deployment = ms.create_deployment(my_predictor)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/resources/#api-reference","title":"API Reference","text":"<p>Resource Allocation</p>"},{"location":"user_guides/mlops/serving/resources/#compatibility-matrix","title":"Compatibility matrix","text":"Show supported resource allocation configuration Serving tool Component Resources Docker Predictor Fixed Transformer \u274c Kubernetes Predictor Minimum resources Transformer \u274c KServe Predictor Minimum / maximum resources Transformer Minimum / maximum resources"},{"location":"user_guides/mlops/serving/transformer/","title":"How To Configure A Transformer","text":""},{"location":"user_guides/mlops/serving/transformer/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to configure a transformer in a deployment.</p> <p>Transformers are used to apply transformations on the model inputs before sending them to the predictor for making predictions using the model. They run on a built-in Flask server provided by Hopsworks and require a custom python script implementing the Transformer class.</p> Warning <p>Transformers are only supported in deployments using KServe as serving tool.</p> <p>A transformer has two configurable components:</p> <ol> <li>Custom script</li> <li>Resources</li> </ol> <p>See examples of transformer scripts in the serving example notebooks.</p>"},{"location":"user_guides/mlops/serving/transformer/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/transformer/#step-1-create-new-deployment","title":"Step 1: Create new deployment","text":"<p>If you have at least one model already trained and saved in the Model Registry, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, click on <code>New deployment</code> if there are not existing deployments or on <code>Create new deployment</code> at the top-right corner to open the deployment creation form.</p>"},{"location":"user_guides/mlops/serving/transformer/#step-2-go-to-advanced-options","title":"Step 2: Go to advanced options","text":"<p>A simplified creation form will appear including the most common deployment fields among all the configuration possible. Transformers are part of the advanced options of a deployment. To navigate to the advanced creation form, click on <code>Advanced options</code>.</p> <p> Advanced options. Go to advanced deployment creation form </p>"},{"location":"user_guides/mlops/serving/transformer/#step-3-select-a-transformer-script","title":"Step 3: Select a transformer script","text":"<p>Transformers require KServe as the serving platform for the deployment. Make sure that KServe is enabled for this deployment by activating the corresponding checkbox.</p> <p> Enable KServe in the advanced deployment form </p> <p>Then, if the transformer script is already located in Hopsworks, click on <code>From project</code> and navigate through the file system to find your script. Otherwise, you can click on <code>Upload new file</code> to upload the transformer script now.</p> <p> Choose a transformer script in the advanced deployment form </p> <p>After selecting the transformer script, you can optionally configure resource allocation for your transformer (see Step 4). Otherwise, click on <code>Create new deployment</code> to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/transformer/#step-4-optional-configure-resource-allocation","title":"Step 4 (Optional): Configure resource allocation","text":"<p>At the end of the page, you can configure the resources to be allocated for the transformer, as well as the minimum and maximum number of replicas to be deployed.</p> Scale-to-zero capabilities <p>Deployments with KServe enabled can scale to zero by choosing <code>0</code> as the number of instances.</p> <p> Resource allocation for the transformer </p> <p>Once you are done with the changes, click on <code>Create new deployment</code> at the bottom of the page to create the deployment for your model.</p>"},{"location":"user_guides/mlops/serving/transformer/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/transformer/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Dataset API instance\ndataset_api = project.get_dataset_api()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/transformer/#step-2-implement-transformer-script","title":"Step 2: Implement transformer script","text":"Python <pre><code>class Transformer(object):\n    def __init__(self):\n        \"\"\" Initialization code goes here \"\"\"\n        pass\n\n    def preprocess(self, inputs):\n        \"\"\" Transform the requests inputs here. The object returned by this method will be used as model input to make predictions. \"\"\"\n        return inputs\n\n    def postprocess(self, outputs):\n        \"\"\" Transform the predictions computed by the model before returning a response \"\"\"\n        return outputs\n</code></pre> <p>Jupyter magic</p> <p>In a jupyter notebook, you can add <code>%%writefile my_transformer.py</code> at the top of the cell to save it as a local file.</p>"},{"location":"user_guides/mlops/serving/transformer/#step-3-upload-the-script-to-your-project","title":"Step 3: Upload the script to your project","text":"<p>You can also use the UI to upload your transformer script. See above</p> <pre><code>uploaded_file_path = dataset_api.upload(\"my_transformer.py\", \"Resources\", overwrite=True)\ntransformer_script_path = os.path.join(\"/Projects\", project.name, uploaded_file_path)\n</code></pre>"},{"location":"user_guides/mlops/serving/transformer/#step-4-define-a-transformer","title":"Step 4: Define a transformer","text":"<pre><code>my_transformer = ms.create_transformer(script_file=uploaded_file_path)\n\n# or\n\nfrom hsml.transformer import Transformer\n\nmy_transformer = Transformer(script_file)\n</code></pre>"},{"location":"user_guides/mlops/serving/transformer/#step-5-create-a-deployment-with-the-transformer","title":"Step 5: Create a deployment with the transformer","text":"<pre><code>my_predictor = ms.create_predictor(transformer=my_transformer)\nmy_deployment = my_predictor.deploy()\n\n# or\nmy_deployment = ms.create_deployment(my_predictor, transformer=my_transformer)\nmy_deployment.save()\n</code></pre>"},{"location":"user_guides/mlops/serving/transformer/#api-reference","title":"API Reference","text":"<p>Transformer</p>"},{"location":"user_guides/mlops/serving/transformer/#resources","title":"Resources","text":"<p>Resources include the number of replicas for the deployment as well as the resources (i.e., memory, CPU, GPU) to be allocated per replica. To learn about the different combinations available, see the Resources Guide.</p>"},{"location":"user_guides/mlops/serving/transformer/#environment-variables","title":"Environment variables","text":"<p>A number of different environment variables is available in the transformer to ease its implementation.</p> Show environment variables Name Description ARTIFACT_FILES_PATH Local path to the model artifact files DEPLOYMENT_NAME Name of the current deployment MODEL_NAME Name of the model being served by the current deployment MODEL_VERSION Version of the model being served by the current deployment ARTIFACT_VERSION Version of the model artifact being served by the current deployment"},{"location":"user_guides/mlops/serving/transformer/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure a transformer.</p>"},{"location":"user_guides/mlops/serving/troubleshooting/","title":"How To Troubleshoot A Deployment","text":""},{"location":"user_guides/mlops/serving/troubleshooting/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to troubleshoot a deployment that is having issues to serve a trained model. But before that, it is important to understand how deployment states are defined and the possible transitions between conditions.</p> <p>When a deployment is starting, it follows an ordered sequence of states before becoming ready for serving predictions. Similarly, it follows an ordered sequence of states when being stopped, although with fewer steps.</p>"},{"location":"user_guides/mlops/serving/troubleshooting/#gui","title":"GUI","text":""},{"location":"user_guides/mlops/serving/troubleshooting/#step-1-inspect-deployment-status","title":"Step 1: Inspect deployment status","text":"<p>If you have at least one deployment already created, navigate to the deployments page by clicking on the <code>Deployments</code> tab on the navigation menu on the left.</p> <p> Deployments navigation tab </p> <p>Once in the deployments page, find the deployment you want to inspect. Next to the actions buttons, you can find an indicator showing the current status of the deployment. For a more descriptive representation, this indicator changes its color based on the status.</p> <p>To inspect the condition of the deployment, click on the name of the deployment to open the deployment overview page.</p>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-2-inspect-condition","title":"Step 2: Inspect condition","text":"<p>At the top of page, you can find the same status indicator mentioned in the previous step. Below it, a one-line message is shown with a more detailed description of the deployment status. This message is built using the current status condition of the deployment.</p> <p>Oftentimes, the status and the one-line description are enough to understand the current state of a deployment. For instance, when the cluster lacks enough allocatable resources to meet the deployment requirements, a meaningful error message will be shown with the root cause.</p> <p> Condition of a deployment that cannot be scheduled </p> <p>However, when the deployment fails to start futher details might be needed depending on the source of failure. For example, failures in the initialization or starting steps will show a less relevant message. In those cases, you can explore the deployments logs in search of the cause of the problem.</p> <p> Condition of a deployment that fails to start </p>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-3-explore-transient-logs","title":"Step 3: Explore transient logs","text":"<p>Each deployment is composed of several components depending on its configuration and the model being served. Transient logs refer to component-specific logs that are directly retrieved from the component itself. Therefore, these logs can only be retrieved as long as the deployment components are reachable. </p> <p>Transient logs are informative and fast to retrieve, facilitating the troubleshooting of deployment components at a glance</p> <p>Transient logs are convenient when access to the most recent logs of a deployment is needed. </p> <p>Info</p> <p>When a deployment is in idle state, there are no components running (i.e., scaled to zero) and, thus, no transient logs are available.</p> <p>Note</p> <p>In the current version of Hopsworks, transient logs can only be accessed using the Hopsworks Machine Learning Python library. See an example here.</p>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-4-explore-historical-logs","title":"Step 4: Explore historical logs","text":"<p>Transient logs are continuously collected and stored in OpenSearch, where they become historical logs accessible using the integrated OpenSearch Dashboards. Therefore, historical logs contain the same information than transient logs. However, there might be cases where transient logs could not be collected in time for a specific component and, thus, not included in the historical logs.</p> <p>Historical logs are persisted transient logs that can be queried, filtered and sorted using OpenSearch Dashboards, facilitating a more sophisticated exploration of past records.</p> <p>Historical logs are convenient when a deployment fails occasionally, either at inference time or without a clear reason. In this case, narrowing the inspection of component-specific logs at a concrete point in time and searching for keywords can be helpful.</p> <p>To access the OpenSearch Dashboards, click on the <code>See logs</code> button at the top of the deployment overview page. </p> <p> Access to historical logs of a deployment </p> <p>Note</p> <p>In case you are not familiar with the interface, you may find the official documentation useful.</p> <p>Once in the OpenSearch Dashboards, you can search for keywords, apply multiple filters and sort the records by timestamp.</p> Show available filters Filter Description component Name of the deployment component (i.e., predictor or transformer) container_name Name of the container within a component (i.e., kserve-container, storage-initializer, inference-logger) serving_name Name of the deployment model_name Name of the model being served model_version Version of the model being served timestamp Timestamp when the record was reported"},{"location":"user_guides/mlops/serving/troubleshooting/#code","title":"Code","text":""},{"location":"user_guides/mlops/serving/troubleshooting/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\n# get Hopsworks Model Serving handle\nms = project.get_model_serving()\n</code></pre>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-2-retrieve-an-existing-deployment","title":"Step 2: Retrieve an existing deployment","text":"<pre><code>deployment = ms.get_deployment(\"mydeployment\")\n</code></pre>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-3-get-current-deployment-state","title":"Step 3: Get current deployment state","text":"<pre><code>state = deployment.get_state()\n\nstate.describe()\n</code></pre>"},{"location":"user_guides/mlops/serving/troubleshooting/#step-4-explore-transient-logs","title":"Step 4: Explore transient logs","text":"<pre><code>deployment.get_logs(component=\"predictor|transformer\", tail=10)\n</code></pre>"},{"location":"user_guides/mlops/serving/troubleshooting/#api-reference","title":"API Reference","text":"<p>Deployment</p> <p>PredictorState</p>"},{"location":"user_guides/mlops/vector_database/","title":"How To Use OpenSearch k-NN plugin","text":""},{"location":"user_guides/mlops/vector_database/#introduction","title":"Introduction","text":"<p>The k-NN plugin enables users to search for the k-nearest neighbors to a query point across an index of vectors. To determine the neighbors, you can specify the space (the distance function) you want to use to measure the distance between points.</p> <p>Use cases include recommendations (for example, an \u201cother songs you might like\u201d feature in a music application), image recognition, and fraud detection.</p> <p>Limited to internal Jobs and Notebooks</p> <p>Currently it's only possible to configure the opensearch-py client in a job or jupyter notebook running inside the Hopsworks cluster.</p>"},{"location":"user_guides/mlops/vector_database/#code","title":"Code","text":"<p>In this guide, you will learn how to create a simple recommendation application, using the <code>k-NN plugin</code> in OpenSearch.</p>"},{"location":"user_guides/mlops/vector_database/#step-1-get-the-opensearch-api","title":"Step 1: Get the OpenSearch API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nopensearch_api = project.get_opensearch_api()\n</code></pre>"},{"location":"user_guides/mlops/vector_database/#step-2-configure-the-opensearch-py-client","title":"Step 2: Configure the opensearch-py client","text":"<pre><code>from opensearchpy import OpenSearch\n\nclient = OpenSearch(**opensearch_api.get_default_py_config())\n</code></pre>"},{"location":"user_guides/mlops/vector_database/#step-3-create-an-index","title":"Step 3: Create an index","text":"<p>Create an index to use by calling <code>opensearch_api.get_project_index(..)</code>.</p> <pre><code>knn_index_name = opensearch_api.get_project_index(\"demo_knn_index\")\n\nindex_body = {\n    \"settings\": {\n        \"knn\": True,\n        \"knn.algo_param.ef_search\": 100,\n    },\n    \"mappings\": {\n        \"properties\": {\n            \"my_vector1\": {\n                \"type\": \"knn_vector\",\n                \"dimension\": 2\n            }\n        }\n    }\n}\n\nresponse = client.indices.create(knn_index_name, body=index_body)\n\nprint(response)\n</code></pre>"},{"location":"user_guides/mlops/vector_database/#step-4-bulk-ingestion-of-vectors","title":"Step 4: Bulk ingestion of vectors","text":"<p>Ingest 10 vectors in a bulk fashion to the index. These vectors represent the list of vectors to calculate the similarity for.</p> <pre><code>from opensearchpy.helpers import bulk\nimport random\n\nactions = [\n    {\n        \"_index\": knn_index_name,\n        \"_id\": count,\n        \"_source\": {\n            \"my_vector1\": [random.uniform(0, 10), random.uniform(0, 10)],\n        }\n    }\n    for count in range(0, 10)\n]\n\nbulk(\n    client,\n    actions,\n)\n</code></pre>"},{"location":"user_guides/mlops/vector_database/#step-5-score-vector-similarity","title":"Step 5: Score vector similarity","text":"<p>Score the vector <code>[2.5, 3]</code> and find the 3 most similar vectors.</p> <pre><code># Define the search request\nquery = {\n    \"size\": 3,\n    \"query\": {\n        \"knn\": {\n            \"my_vector1\": {\n                \"vector\": [2.5, 3],\n                \"k\": 3\n            }\n        }\n    }\n}\n\n# Perform the similarity search\nresponse = client.search(\n    body = query,\n    index = knn_index_name\n)\n\n# Pretty print response\nimport pprint\npp = pprint.PrettyPrinter()\npp.pprint(response)\n</code></pre> <p><code>Output</code> from the above script shows the score for each of the three most similar vectors that have been indexed.</p> <p><code>[4.798869166444522, 4.069064892468535]</code> is the most similar vector to <code>[2.5, 3]</code> with a score of <code>0.1346312</code>.</p> <pre><code>2022-05-30 09:55:50,529 INFO: POST https://10.0.2.15:9200/my_project_demo_knn_index/_search [status:200 request:0.017s]\n{'_shards': {'failed': 0, 'skipped': 0, 'successful': 1, 'total': 1},\n 'hits': {'hits': [{'_id': '9',\n                    '_index': 'my_project_demo_knn_index',\n                    '_score': 0.1346312,\n                    '_source': {'my_vector1': [4.798869166444522,\n                                               4.069064892468535]},\n                    '_type': '_doc'},\n                   {'_id': '0',\n                    '_index': 'my_project_demo_knn_index',\n                    '_score': 0.040784083,\n                    '_source': {'my_vector1': [6.267438489652193,\n                                               6.0538134453735175]},\n                    '_type': '_doc'},\n                   {'_id': '7',\n                    '_index': 'my_project_demo_knn_index',\n                    '_score': 0.03222388,\n                    '_source': {'my_vector1': [7.973873201006634,\n                                               2.7361877621502115]},\n                    '_type': '_doc'}],\n          'max_score': 0.1346312,\n          'total': {'relation': 'eq', 'value': 3}},\n 'timed_out': False,\n 'took': 9}\n</code></pre>"},{"location":"user_guides/mlops/vector_database/#api-reference","title":"API Reference","text":"<p>k-NN plugin</p> <p>OpenSearch</p>"},{"location":"user_guides/mlops/vector_database/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a simple recommendation application.</p>"},{"location":"user_guides/projects/","title":"Projects Guides","text":"<p>This section serves to provide guides and examples for the common usage of services in a Project through the Hopsworks UI and APIs.</p> <ul> <li>Projects</li> <li>Authentication</li> <li>API Keys</li> <li>Jupyter</li> <li>Jobs</li> <li>Git</li> <li>Python Environment</li> <li>Kafka</li> <li>OpenSearch</li> <li>Secrets</li> </ul>"},{"location":"user_guides/projects/airflow/airflow/","title":"Orchestrate Jobs using Apache Airflow","text":""},{"location":"user_guides/projects/airflow/airflow/#introduction","title":"Introduction","text":"<p>Hopsworks jobs can be orchestrated using Apache Airflow. You can define a Airflow DAG (Directed Acyclic Graph) containing the dependencies between Hopsworks jobs.  You can then schedule the DAG to be executed at a specific schedule using a cron expression.</p> <p>Airflow DAGs are defined as Python files. Within the Python file, different operators can be used to trigger different actions. Hopsworks provides an operator to execute jobs on Hopsworks and a sensor to wait for a specific job to finish.</p>"},{"location":"user_guides/projects/airflow/airflow/#use-apache-airflow-in-hopsworks","title":"Use Apache Airflow in Hopsworks","text":"<p>Hopsworks deployments include a deployment of Apache Airflow. You can access it from the Hopsworks UI by clicking on the Airflow button on the left menu.</p> <p>Airfow is configured to enforce Role Based Access Control (RBAC) to the Airflow DAGs. Admin users on Hopsworks have access to all the DAGs in the deployment. Regular users can access all the DAGs of the projects they are a member of.</p> <p>Access Control</p> <p>Airflow does not have any knowledge of the Hopsworks project you are currently working on. As such, when opening the Airflow UI, you will see all the DAGs all of the projects you are a member of.</p>"},{"location":"user_guides/projects/airflow/airflow/#hopsworks-dag-builder","title":"Hopsworks DAG Builder","text":"Airflow DAG Builder <p>You can create a new Airflow DAG to orchestrate jobs using the Hopsworks DAG builder tool. Click on New Workflow to create a new Airflow DAG. You should provide a name for the DAG as well as a schedule interval. You can define the schedule using the dropdown menus or by providing a cron expression.</p> <p>You can add to the DAG Hopsworks operators and sensors:</p> <ul> <li> <p>Operator: The operator is used to trigger a job execution. When configuring the operator you select the job you want to execute and you can optionally provide execution arguments. You can decide whether or not the operator should wait for the execution to be completed. If you select the wait option, the operator will block and Airflow will not execute any parallel task. If you select the wait option the Airflow task fails if the job fails. If you want to execute tasks in parallel, you should not select the wait option but instead use the sensor. When configuring the operator, you can can also provide which other Airflow tasks it depends on. If you add a dependency, the task will be executed only after the upstream tasks have been executed successfully. </p> </li> <li> <p>Sensor: The sensor can be used to wait for executions to be completed. Similarly to the wait option of the operator, the sensor blocks until the job execution is completed. The sensor can be used to launch several jobs in parallel and wait for their execution to be completed. Please note that the sensor is defined at the job level rather than the execution level. The sensor will wait for the most recent execution to be completed and it will fail the Airflow task if the execution was not successful. </p> </li> </ul> <p>You can then create the DAG and Hopsworks will generate the Python file. </p>"},{"location":"user_guides/projects/airflow/airflow/#write-your-own-dag","title":"Write your own DAG","text":"<p>If you prefer to code the DAGs or you want to edit a DAG built with the builder tool, you can do so. The Airflow DAGs are stored in the Airflow dataset which you can access using the file browser in the project settings.</p> <p>When writing the code for the DAG you can invoke the operator as follows:</p> <pre><code>HopsworksLaunchOperator(dag=dag,\n    task_id=\"profiles_fg_0\",\n    project_name=\"airflow_doc\",\n    job_name=\"profiles_fg\",\n    job_arguments=\"\",\n    wait_for_completion=True)\n</code></pre> <p>You should provide the name of the Airflow task (<code>task_id</code>) and the Hopsworks job information (<code>project_name</code>, <code>job_name</code>, <code>job_arguments</code>). You can set the <code>wait_for_completion</code> flag to <code>True</code> if you want the operator to block and wait for the job execution to be finished.</p> <p>Similarly, you can invoke the sensor as shown below. You should provide the name of the Airflow task (<code>task_id</code>) and the Hopsworks job information (<code>project_name</code>, <code>job_name</code>) </p> <pre><code>HopsworksJobSuccessSensor(dag=dag,\n    task_id='wait_for_profiles_fg',\n    project_name=\"airflow_doc\",\n    job_name='profiles_fg')\n</code></pre> <p>When writing the DAG file, you should also add the <code>access_control</code> parameter to the DAG configuration. The <code>access_control</code> parameter specicifies which projects have access to the DAG and which actions the project members can perform on it. If you do not specify the <code>access_control</code> option, project members will not be able to see the DAG in the Airflow UI.</p> <p>Admin access</p> <p>The <code>access_control</code> configuration does not apply to Hopsworks admin users which have full access to all the DAGs even if they are not member of the project. </p> <pre><code>    dag = DAG(\n        dag_id = \"example_dag\",\n        default_args = args,\n        access_control = {\n            \"project_name\": {\"can_dag_read\", \"can_dag_edit\"},\n        },\n\n        schedule_interval = \"0 4 * * *\"\n    )\n</code></pre> <p>Project Name</p> <p>You should replace the <code>project_name</code> in the snippet above with the name of your own project</p>"},{"location":"user_guides/projects/airflow/airflow/#manage-airflow-dags-using-git","title":"Manage Airflow DAGs using Git","text":"<p>You can leverage the Git integration to track your Airflow DAGs in a git repository. Airflow will only consider the DAG files which are stored in the Airflow Dataset in Hopsworks.  After cloning the git repository in Hopsworks, you can automate the process of copying the DAG file in the Airflow Dataset using the copy method of the Hopsworks API.</p>"},{"location":"user_guides/projects/api_key/create_api_key/","title":"How To Create An API Key","text":""},{"location":"user_guides/projects/api_key/create_api_key/#introduction","title":"Introduction","text":"<p>An API key allows a user or a program to make API calls without having to authenticate with a username and password. To access an endpoint using an API key, a client should send the access token using the ApiKey authentication scheme.</p> <p>The API Key can now be used when connecting to your Hopsworks instance using the <code>hopsworks</code>, <code>hsfs</code> or <code>hsml</code> python library or set in the <code>ApiKey</code> header for the REST API.</p> <pre><code>GET /resource HTTP/1.1\nHost: server.hopsworks.ai\nAuthorization: ApiKey &lt;api_key&gt;\n</code></pre>"},{"location":"user_guides/projects/api_key/create_api_key/#ui","title":"UI","text":"<p>In this guide, you will learn how to create an API key.</p>"},{"location":"user_guides/projects/api_key/create_api_key/#step-1-navigate-to-api-keys","title":"Step 1: Navigate to API Keys","text":"<p>In the Account Settings page you can find the API section showing a list of all API keys.</p> <p> List of API Keys </p>"},{"location":"user_guides/projects/api_key/create_api_key/#step-2-create-an-api-key","title":"Step 2: Create an API Key","text":"<p>Click <code>New Api key</code>, select the required scopes and create it by clicking <code>Create Api Key</code>. </p> <p>Copy the value and save it in a secure location, such as a password manager.</p> <p> Create new API Key </p>"},{"location":"user_guides/projects/api_key/create_api_key/#login-with-api-key-using-sdk","title":"Login with API Key using SDK","text":"<p>In this guide you learned how to create an API Key. You can now use the API Key to login using the <code>hopsworks</code> python SDK.</p>"},{"location":"user_guides/projects/auth/krb/","title":"Login using Kerberos","text":""},{"location":"user_guides/projects/auth/krb/#introduction","title":"Introduction","text":"<p>Hopsworks supports different methods of authentication. Here we will look at authentication using Kerberos.</p>"},{"location":"user_guides/projects/auth/krb/#prerequisites","title":"Prerequisites","text":"<p>A Hopsworks cluster with Kerberos authentication.  See Configure Kerberos on how to configure Kerberos on your cluster.</p>"},{"location":"user_guides/projects/auth/krb/#step-1-log-in-with-kerberos","title":"Step 1: Log in with Kerberos","text":"<p>If Kerberos is configured you will see a Log in using alternative on the login page. Choose Kerberos and click on  Go to Hopsworks to login. </p> Log in using Kerberos <p>If password login is disabled you only see the Log in using Kerberos/SSO alternative. Click on Go to Hopsworks to login.</p> Kerberos only authentication <p>To be able to authenticate with Kerberos you need to configure your browser to use Kerberos.  Note that without a properly configured browser, the Kerberos token is not sent to the server and so SSO will not work.</p> <p>If Kerberos is not configured properly you will see Wrong credentials message when trying to log in.</p> Missing Kerberos ticket"},{"location":"user_guides/projects/auth/krb/#step-2-give-consent","title":"Step 2: Give consent","text":"<p>When logging in with Kerberos for the first time Hopsworks will retrieve and save consented claims (firstname, lastname and email), about the logged in end-user. If you have multiple email addresses registered in Kerberos you can choose  one to use with Hopsworks.</p> <p>If you do not want your information to be saved in Hopsworks you can click Cancel. This will redirect you back to the login page.</p> Give consent <p>After clicking on Register you will be redirected to the landing page:  Landing page </p> <p>In the landing page, you will find two buttons. Use these buttons to either create a  demo project or a new project.</p>"},{"location":"user_guides/projects/auth/krb/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to log in to Hopsworks using Kerberos.</p>"},{"location":"user_guides/projects/auth/ldap/","title":"Login using LDAP","text":""},{"location":"user_guides/projects/auth/ldap/#introduction","title":"Introduction","text":"<p>Hopsworks supports different methods of authentication. Here we will look at authentication using LDAP.</p>"},{"location":"user_guides/projects/auth/ldap/#prerequisites","title":"Prerequisites","text":"<p>A Hopsworks cluster with LDAP authentication.  See Configure LDAP on how to configure LDAP on your cluster.</p>"},{"location":"user_guides/projects/auth/ldap/#step-1-log-in-with-ldap","title":"Step 1: Log in with LDAP","text":"<p>If LDAP is configured you will see a Log in using alternative on the login page. Choose LDAP and type in your  username and password then click on Login.</p> <p>Note that you need to use your LDAP credentials.</p> Log in using LDAP"},{"location":"user_guides/projects/auth/ldap/#step-2-give-consent","title":"Step 2: Give consent","text":"<p>When logging in with LDAP for the first time Hopsworks will retrieve and save consented claims (firstname, lastname and email), about the logged in end-user. If you have multiple email addresses registered in LDAP you can choose one to use with Hopsworks. </p> <p>If you do not want your information to be saved in Hopsworks you can click Cancel. This will redirect you back  to the login page.</p> Give consent <p>After clicking on Register you will be redirected to the landing page:  Landing page </p> <p>In the landing page, you will find two buttons. Use these buttons to either create a  demo project or a new project.</p>"},{"location":"user_guides/projects/auth/ldap/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to log in to Hopsworks using LDAP.</p>"},{"location":"user_guides/projects/auth/login/","title":"Log in To Hopsworks","text":""},{"location":"user_guides/projects/auth/login/#introduction","title":"Introduction","text":"<p>Hopsworks supports different methods of authentication. Here we will look at authentication using username and password.</p>"},{"location":"user_guides/projects/auth/login/#prerequisites","title":"Prerequisites","text":"<p>An account on a Hopsworks cluster.</p>"},{"location":"user_guides/projects/auth/login/#step-1-log-in-with-email-and-password","title":"Step 1: Log in with email and password","text":"<p>After your account is validated by an administrator you can use your email and password to login.</p> Login with password"},{"location":"user_guides/projects/auth/login/#step-2-two-factor-authentication","title":"Step 2: Two-factor authentication","text":"<p>If two-factor authentication is enabled you will be presented with a two-factor authentication window after you  enter your password. Use your authenticator app (example. Google Authenticator) on your phone to get a one-time password.</p> One time password <p>Upon successful login, you will arrive at the landing page:</p> Landing page <p>In the landing page, you will find two buttons. Use these buttons to either create a  demo project or a new project.</p>"},{"location":"user_guides/projects/auth/login/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to log in to Hopsworks.</p>"},{"location":"user_guides/projects/auth/oauth/","title":"Login Using A Third-party Identity Provider","text":""},{"location":"user_guides/projects/auth/oauth/#introduction","title":"Introduction","text":"<p>Hopsworks supports different methods of authentication. Here we will look at authentication using Third-party Identity Provider.</p>"},{"location":"user_guides/projects/auth/oauth/#prerequisites","title":"Prerequisites","text":"<p>A Hopsworks cluster with OAuth authentication.  See Configure OAuth2 on how to configure OAuth on your cluster.</p>"},{"location":"user_guides/projects/auth/oauth/#step-1-log-in-with-oauth","title":"Step 1: Log in with OAuth","text":"<p>If OAuth is configured a **Login with ** button will appear in the login page. Use this button to log in to Hopsworks using your OAuth credentials.</p> Login with OAuth2"},{"location":"user_guides/projects/auth/oauth/#step-2-give-consent","title":"Step 2: Give consent","text":"<p>When logging in with OAuth for the first time Hopsworks will retrieve and save consented claims (firstname, lastname  and email), about the logged in end-user.</p> Give consent <p>After clicking on Register you will be redirected to the landing page:  Landing page </p> <p>In the landing page, you will find two buttons. Use these buttons to either create a  demo project or a new project.</p>"},{"location":"user_guides/projects/auth/oauth/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to log in to Hopsworks using Third-party Identity Provider.</p>"},{"location":"user_guides/projects/auth/profile/","title":"Update Your Profile and Credentials","text":""},{"location":"user_guides/projects/auth/profile/#introduction","title":"Introduction","text":"<p>A profile is required to access Hopsworks. A profile is created when a user registers and can be updated via Account settings.</p>"},{"location":"user_guides/projects/auth/profile/#prerequisites","title":"Prerequisites","text":"<p>An account on a Hopsworks cluster.</p> <p>Updating profile and credentials is not supported if you are using Third-party Identity Providers like Kerberos, LDAP, or OAuth  to authenticate to Hopsworks.</p>"},{"location":"user_guides/projects/auth/profile/#step-1-go-to-your-account-settings","title":"Step 1: Go to your Account settings","text":"<p>After you have logged in, in the upper right-hand corner of the screen, you will see your name. Click on your name, then click on the menu item Account settings. The account settings page will open with profile tab selected. In this tab you can change your first and last name. You cannot change your email address and will need to create a new  account if you wish to change your email address.</p> Update profile"},{"location":"user_guides/projects/auth/profile/#step-2-update-credential","title":"Step 2: Update credential","text":"<p>To update your credential go to the Authentication tab as shown in the image below.  Update credential </p>"},{"location":"user_guides/projects/auth/profile/#step-3-enablereset-two-factor-authentication","title":"Step 3: Enable/Reset Two-factor Authentication","text":"<p>You can also change your two-factor setting in the Authentication tab. Two-factor authentication is only available if it is enabled from the cluster administration page.</p> Enable Two-factor Authentication <p>After enabling or resetting two-factor you will be presented with a QR Code. You will then need to scan the QR code  to add it on your phone's authenticator application  (example. Google Authenticator). </p> <p>If you miss this step, you will have to recover your smartphone credentials at a later stage.</p> Register Two-factor Authentication <p>Use the one time password generated by your authenticator app to confirm the registration.</p>"},{"location":"user_guides/projects/auth/profile/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to edit your profile and credentials.</p>"},{"location":"user_guides/projects/auth/recovery/","title":"Password Recovery","text":""},{"location":"user_guides/projects/auth/recovery/#introduction","title":"Introduction","text":"<p>This topic describes how to recover a forgotten password.</p>"},{"location":"user_guides/projects/auth/recovery/#prerequisites","title":"Prerequisites","text":"<p>An account on a Hopsworks cluster.</p>"},{"location":"user_guides/projects/auth/recovery/#step-1-request-password-reset","title":"Step 1: Request password reset","text":"<p>If you forget your password start by clicking on Forgot password on the login page. Enter your email and click on the  Send reset link button.  Password reset </p>"},{"location":"user_guides/projects/auth/recovery/#step-2-use-the-password-reset-link","title":"Step 2: Use the password reset link","text":"<p>A password reset link will be sent to the email address you entered if the email is found in the system. Click on the reset link to set your new password.</p>"},{"location":"user_guides/projects/auth/recovery/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to recover your password.</p>"},{"location":"user_guides/projects/auth/registration/","title":"Register A New Account On Hopsworks","text":""},{"location":"user_guides/projects/auth/registration/#introduction","title":"Introduction","text":"<p>Hopsworks supports different methods of authentication.  To use username and password as the method of authentication, you first need to register.</p>"},{"location":"user_guides/projects/auth/registration/#prerequisites","title":"Prerequisites","text":"<p>Registration enabled Hopsworks cluster.</p> <p>The process for registering a new account is as follows</p>"},{"location":"user_guides/projects/auth/registration/#step-1-register-a-new-account","title":"Step 1: Register a new account","text":"<p>Click on the Register button on the login page and register your email address and details.</p> Register new account"},{"location":"user_guides/projects/auth/registration/#step-2-enable-two-factor-authentication","title":"Step 2: Enable Two-Factor Authentication","text":"<p>If two-factor authentication is required you will be presented with a page like in the figure below. Scan the QR  code or type the code in bold to register your account in your authenticator app  (example. Google Authenticator). </p> Add two-factor authentication"},{"location":"user_guides/projects/auth/registration/#step-3-validate-your-email-address","title":"Step 3: Validate your email address","text":"<p>Validate your email address by clicking on the link in the validation email you received. After your account is created an administrator needs to validate your account before you can log in.</p> Account created"},{"location":"user_guides/projects/auth/registration/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create an account in Hopsworks.</p>"},{"location":"user_guides/projects/git/clone_repo/","title":"How To Clone a Git Repository","text":""},{"location":"user_guides/projects/git/clone_repo/#introduction","title":"Introduction","text":"<p>Repositories are cloned and managed within the scope of a project. The content of the repository will reside on the Hopsworks File System. The content of the repository can be edited from Jupyter notebooks and can for example be used to configure Jobs. Repositories can be managed from the Git section in the project settings. The Git overview in the project settings provides a list of repositories currently cloned within the project, the location of their content as well which branch and commit their HEAD is currently at.</p>"},{"location":"user_guides/projects/git/clone_repo/#prerequisites","title":"Prerequisites","text":"<ul> <li>For cloning a private repository, you should configure a Git Provider with your git credentials. You can clone a GitHub and GitLab public repository without configuring the provider. However, for BitBucket you always need to configure the username and token to clone a repository.</li> </ul>"},{"location":"user_guides/projects/git/clone_repo/#ui","title":"UI","text":""},{"location":"user_guides/projects/git/clone_repo/#step-1-navigate-to-repositories","title":"Step 1: Navigate to repositories","text":"<p>In the left-hand sidebar found in your project click on <code>Project settings</code>, and then navigate to the <code>Git</code> section.</p> <p>This page lists all the cloned git repositories under <code>Repositories</code>, while operations performed on those repositories, e.g <code>push</code>/<code>pull</code>/<code>commit</code> are listed under <code>Git Executions</code>.</p> <p> Git repository overview </p>"},{"location":"user_guides/projects/git/clone_repo/#step-2-clone-a-repository","title":"Step 2: Clone a repository","text":"<p>To clone a new repository, click on the <code>Clone repository</code> button on the Git overview page.</p> <p> Git clone </p> <p>You should first choose the git provider e.g., GitHub, GitLab or BitBucket. If you are cloning a private repository, remember to configure the username and token for the provder first in Git Provider. The clone dialog also asks you to specify the URL of the repository to clone. The supported protocol is HTTPS. As an example, if the repository is hosted on GitHub, the URL should look like: <code>https://github.com/logicalclocks/hops-examples.git</code>.</p> <p>Then specify which branch you want to clone. By default the <code>main</code> branch will be used, however a different branch or commit can be specified by selecting <code>Clone from a specific branch</code>.</p> <p>You can select the folder, within your project, in which the repository should be cloned. By default, the repository is going to be cloned within the <code>Jupyter</code> dataset. However, by clicking on the location button, a different location can be selected.</p> <p>Finally, click on the <code>Clone repository</code> button to trigger the cloning of the repository.</p>"},{"location":"user_guides/projects/git/clone_repo/#step-3-track-progress-of-the-clone","title":"Step 3: Track progress of the clone","text":"<p>The progress of the git clone can be tracked under <code>Git Executions</code>.</p> <p> Track progress of clone </p>"},{"location":"user_guides/projects/git/clone_repo/#step-4-browse-repository-files","title":"Step 4: Browse repository files","text":"<p>In the <code>File browser</code> page you can now browse the files of the cloned repository. In the figure below, the repository is located in <code>Jupyter/hops-examples</code> directory.</p> <p> Browse repository files </p>"},{"location":"user_guides/projects/git/clone_repo/#code","title":"Code","text":"<p>You can also clone a repository through the hopsworks git API in python.</p>"},{"location":"user_guides/projects/git/clone_repo/#step-1-get-the-git-api","title":"Step 1: Get the git API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ngit_api = project.get_git_api()\n</code></pre>"},{"location":"user_guides/projects/git/clone_repo/#step-2-clone-the-repository","title":"Step 2: Clone the repository","text":"<pre><code>REPO_URL=\"https://github.com/logicalclocks/hops-examples.git\" # git repository\nHOPSWORKS_FOLDER=\"Jupyter\" # path in Hopsworks filesystem to clone to\nPROVIDER=\"GitHub\"\nBRANCH=\"master\" # optional branch to clone\n\nexamples_repo = git_api.clone(REPO_URL, HOPSWORKS_FOLDER, PROVIDER, branch=BRANCH)\n</code></pre>"},{"location":"user_guides/projects/git/clone_repo/#api-reference","title":"API Reference","text":"<p>Api reference for git repositories is available here: GitRepo</p> <p>A notebook for managing git can be found here.</p>"},{"location":"user_guides/projects/git/clone_repo/#errors-and-troubleshooting","title":"Errors and Troubleshooting","text":""},{"location":"user_guides/projects/git/clone_repo/#invalid-credentials","title":"Invalid credentials","text":"<p>This might happen when the credentials entered for the provider are incorrect. Try the following:</p> <ul> <li>Confirm that the settings for the provider ( in Account Settings &gt; Git providers) are correct. You must enter both your Git provider username and token.</li> <li>Confirm that you have selected the correct Git provider when cloning the repository.</li> <li>Ensure your personal access token has the correct repository access rights.</li> <li>Ensure your personal access token has not expired.</li> </ul>"},{"location":"user_guides/projects/git/clone_repo/#timeout-errors","title":"Timeout errors","text":"<p>Cloning a large repo or checking out a large branch may hit timeout errors. You can try again later if the system was under heavy load at the time.</p>"},{"location":"user_guides/projects/git/clone_repo/#symlink-errors","title":"Symlink errors","text":"<p>Git repositories with symlinks are not yet supported, therefore cloning repositories with symlinks will fail. You can create a separate branch to remove the symlinks, and clone from this branch.</p>"},{"location":"user_guides/projects/git/clone_repo/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to clone a Git repository. You can now start Jupyter from the cloned git repository path to work with the files.</p>"},{"location":"user_guides/projects/git/configure_git_provider/","title":"How To Configure a Git Provider","text":""},{"location":"user_guides/projects/git/configure_git_provider/#introduction","title":"Introduction","text":"<p>When you perform Git operations on Hopsworks that need to interact with the remote repository, Hopsworks relies on the Git HTTPS protocol to perform those operations. Authentication with the remote repository happens through a token generated by the Git repository hosting service (GitHub, GitLab, BitBucket).</p> <p>Token permissions</p> <p>The token permissions should grant access to public and private repositories including read and write access to repository contents and commit statuses.  If you are using the new GitHub access tokens, make sure you choose the correct <code>Resource owner</code> when generating the token for the repositories you will want to clone. For the <code>Repository permissions</code> of the new GitHub fine-grained token, you should atleast give read and write access to <code>Commit statuses</code> and <code>Contents</code>.</p>"},{"location":"user_guides/projects/git/configure_git_provider/#ui","title":"UI","text":"<p>Documentation on how to generate a token for the supported Git hosting services is available here:</p> <ul> <li>GitHub</li> <li>GitLab</li> <li>BitBucket</li> </ul>"},{"location":"user_guides/projects/git/configure_git_provider/#step-1-navigate-to-git-providers","title":"Step 1: Navigate to Git Providers","text":"<p>You can access the <code>Git Providers</code> page of your Hopsworks cluster by clicking on your name, in the top right corner, and choosing <code>Account Settings</code> from the dropdown menu. The <code>Git providers</code> section displays which providers have been already configured and can be used to clone new repositories.</p> <p> Git provider configuration list </p>"},{"location":"user_guides/projects/git/configure_git_provider/#step-2-configure-a-provider","title":"Step 2: Configure a provider","text":"<p>Click on <code>Edit Configuration</code> to change a provider username or token, or to configure a new provider.</p> <p>Tick the checkbox next to the provider you want to configure and insert the username and the token to use for that provider.</p> <p> Git provider configuration </p> <p>Click <code>Create Configuration</code> to save the configuration.</p>"},{"location":"user_guides/projects/git/configure_git_provider/#step-3-provider-is-configured","title":"Step 3: Provider is configured","text":"<p>The configured provider should now be marked as configured.</p> <p> Git provider configured </p>"},{"location":"user_guides/projects/git/configure_git_provider/#code","title":"Code","text":"<p>You can also configure a git provider using the hopsworks git API in python.</p>"},{"location":"user_guides/projects/git/configure_git_provider/#step-1-get-the-git-api","title":"Step 1: Get the git API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ngit_api = project.get_git_api()\n</code></pre>"},{"location":"user_guides/projects/git/configure_git_provider/#step-2-configure-git-provider","title":"Step 2: Configure git provider","text":"<pre><code>PROVIDER=\"GitHub\"\nGITHUB_USER=\"my_user\"\nAPI_TOKEN=\"my_token\"\n\ngit_api.set_provider(PROVIDER, GITHUB_USER, API_TOKEN)\n</code></pre>"},{"location":"user_guides/projects/git/configure_git_provider/#api-reference","title":"API Reference","text":"<p>GitProvider</p>"},{"location":"user_guides/projects/git/configure_git_provider/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how configure your git provider credentials. You can now use the credentials to clone a repository from the configured provider.</p>"},{"location":"user_guides/projects/git/repository_actions/","title":"Repository actions","text":""},{"location":"user_guides/projects/git/repository_actions/#introduction","title":"Introduction","text":"<p>This section explains the git operations or commands you can perform on hopsworks git repositories. These commands include commit, pull, push, create branches and many more.</p> <p>Repository permissions</p> <p>Git repositories are private. Only the owner of the repository can perform git actions on the repository such as commit, push, pull e.t.c.</p>"},{"location":"user_guides/projects/git/repository_actions/#ui","title":"UI","text":"<p>The operations to perform on the cloned repository can be found in the dropdown as shown below.</p> <p> Repository actions </p> <p>Note that some repository actions will require the username and token to be configured first depending on the provider. For example to be able to perform a push action in any repository, you must configure the provider for the repository first. To be able to perform a pull action for the for a GitLab repository, you must configure the GitLab provider first. You will see the dialog below in the case you need to configure the provider first to perform the repository action.</p> <p> Configure provider prompt </p>"},{"location":"user_guides/projects/git/repository_actions/#read-only-repositories","title":"Read only repositories","text":"<p>In read only repositories, the following actions are disabled: commit, push and file checkout. The read only property can be enabled or disabled in the Cluster settings &gt; Configuration, by updating the <code>enable_read_only_git_repositories</code> variable to true or false. Note that you need administrator privileges to update this property.</p>"},{"location":"user_guides/projects/git/repository_actions/#code","title":"Code","text":"<p>You can also perform the repository actions using the hopsworks git API in python. </p>"},{"location":"user_guides/projects/git/repository_actions/#step-1-get-the-git-api","title":"Step 1: Get the git API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ngit_api = project.get_git_api()\n</code></pre>"},{"location":"user_guides/projects/git/repository_actions/#step-2-get-the-git-repository","title":"Step 2: Get the git repository","text":"<pre><code>git_repo = git_api.get_repo(REPOSITORY_NAME)\n</code></pre>"},{"location":"user_guides/projects/git/repository_actions/#step-3-perform-the-git-repository-action-eg-commit","title":"Step 3: Perform the git repository action e.g commit","text":"<pre><code>git_repo = git_api.commit(\"Test commit\")\n</code></pre>"},{"location":"user_guides/projects/git/repository_actions/#api-reference","title":"API Reference","text":"<p>Api reference for repository actions is available here: GitRepo</p>"},{"location":"user_guides/projects/iam_role/iam_role_chaining/","title":"How To Use AWS IAM Roles on EC2 instances","text":""},{"location":"user_guides/projects/iam_role/iam_role_chaining/#introduction","title":"Introduction","text":"<p>When deploying Hopsworks on EC2 instances you might need to assume different roles to access resources on AWS.  These roles can be configured in AWS and mapped to a project in Hopsworks.</p>"},{"location":"user_guides/projects/iam_role/iam_role_chaining/#prerequisites","title":"Prerequisites","text":"<p>Before you begin this guide you'll need the following:</p> <ul> <li>A Hopsworks cluster running on EC2.</li> <li>Role chaining setup in AWS.</li> <li>Configure role mappings in Hopsworks. For a guide on how to configure this see AWS IAM Role Chaining.</li> </ul>"},{"location":"user_guides/projects/iam_role/iam_role_chaining/#ui","title":"UI","text":"<p>In this guide, you will learn how to use a mapped IAM role in your project.</p>"},{"location":"user_guides/projects/iam_role/iam_role_chaining/#step-1-navigate-to-your-projects-iam-role-chaining-tab","title":"Step 1: Navigate to your project's IAM Role Chaining tab","text":"<p>In the Project Settings page you can find the IAM Role Chaining section showing a list of all IAM roles mapped to your project.</p> Role Chaining"},{"location":"user_guides/projects/iam_role/iam_role_chaining/#step-2-use-the-iam-role","title":"Step 2: Use the IAM role","text":"<p>You can now use the IAM roles listed in your project when creating a storage connector with Temporary Credentials.</p>"},{"location":"user_guides/projects/iam_role/iam_role_chaining/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to use IAM roles on a cluster deployed on an EC2 instances.</p>"},{"location":"user_guides/projects/jobs/pyspark_job/","title":"How To Run A PySpark Job","text":""},{"location":"user_guides/projects/jobs/pyspark_job/#introduction","title":"Introduction","text":"<p>All members of a project in Hopsworks can launch the following types of applications through a project's Jobs service:</p> <ul> <li>Python (Hopsworks Enterprise only)</li> <li>Apache Spark</li> </ul> <p>Launching a job of any type is very similar process, what mostly differs between job types is the various configuration parameters each job type comes with. After following this guide you will be able to create a PySpark job.</p> <p>The PySpark program can either be a <code>.py</code> script or a <code>.ipynb</code> file.</p> <p>Instantiate the SparkSession</p> <p>For a <code>.py</code> file, remember to instantiate the SparkSession i.e <code>spark=SparkSession.builder.getOrCreate()</code></p> <p>For a <code>.ipynb</code> file, the <code>SparkSession</code> is already available as <code>spark</code> when the job is started.</p>"},{"location":"user_guides/projects/jobs/pyspark_job/#ui","title":"UI","text":""},{"location":"user_guides/projects/jobs/pyspark_job/#step-1-jobs-overview","title":"Step 1: Jobs overview","text":"<p>The image below shows the Jobs overview page in Hopsworks and is accessed by clicking <code>Jobs</code> in the sidebar.</p> <p> Jobs overview </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-2-create-new-job-dialog","title":"Step 2: Create new job dialog","text":"<p>To configure a  job, click <code>Advanced options</code>, which will open up the advanced configuration page for the job.</p> <p> Create new job dialog </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-3-set-the-script","title":"Step 3: Set the script","text":"<p>Next step is to select the program to run. You can either select <code>From project</code>, if the file was previously uploaded to Hopsworks, or <code>Upload new file</code> which lets you select a file from your local filesystem as demonstrated below.</p> <p> Configure program </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-4-set-the-job-type","title":"Step 4: Set the job type","text":"<p>Next step is to set the job type to <code>SPARK</code> to indicate it should be executed as a spark job. Then specify advanced configuration or click <code>Create New Job</code> to create the job.</p> <p> Set the job type </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-5-optional-advanced-configuration","title":"Step 5 (optional): Advanced configuration","text":"<p>Resource allocation for the Spark driver and executors can be configured, also the number of executors and whether dynamic execution should be enabled.</p> <ul> <li> <p><code>Driver memory</code>: Number of cores to allocate for the Spark driver</p> </li> <li> <p><code>Driver virtual cores</code>: Number of MBs to allocate for the Spark driver</p> </li> <li> <p><code>Executor memory</code>: Number of cores to allocate for each Spark executor</p> </li> <li> <p><code>Executor virtual cores</code>: Number of MBs to allocate for each Spark executor</p> </li> <li> <p><code>Dynamic/Static</code>: Run the Spark application in static or dynamic allocation mode (see spark docs for details).</p> </li> </ul> <p> Resource configuration for the Spark kernels </p> <p>Additional files or dependencies required for the Spark job can be configured.</p> <ul> <li> <p><code>Additional archives</code>: List of archives to be extracted into the working directory of each executor.</p> </li> <li> <p><code>Additional jars</code>: List of jars to be placed in the working directory of each executor.</p> </li> <li> <p><code>Additional python dependencies</code>: List of python files and archives to be placed on each executor and added to PATH.</p> </li> <li> <p><code>Additional files</code>: List of files to be placed in the working directory of each executor.</p> </li> </ul> <p> File configuration for the Spark kernels </p> <p>Line-separates properties to be set for the Spark application. For example, changing the configuration variables for the Kryo Serializer or setting environment variables for the driver, you can set the properties as shown below.</p> <p> Additional Spark configuration </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-6-execute-the-job","title":"Step 6: Execute the job","text":"<p>Now click the <code>Run</code> button to start the execution of the job, and then click on <code>Executions</code> to see the list of all executions.</p> <p> Start job execution </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-7-application-logs","title":"Step 7: Application logs","text":"<p>To monitor logs while the execution is running, click <code>Spark UI</code> to open the Spark UI in a separate tab. </p> <p>Once the execution is finished, you can click on <code>Logs</code> to see the full logs for execution.</p> <p> Access Spark logs </p>"},{"location":"user_guides/projects/jobs/pyspark_job/#code","title":"Code","text":""},{"location":"user_guides/projects/jobs/pyspark_job/#step-1-upload-the-pyspark-program","title":"Step 1: Upload the PySpark program","text":"<p>This snippet assumes the program to run is in the current working directory and named <code>script.py</code>. </p> <p>It will upload the python script to the <code>Resources</code> dataset in your project.</p> <pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ndataset_api = project.get_dataset_api()\n\nuploaded_file_path = dataset_api.upload(\"script.py\", \"Resources\")\n</code></pre>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-2-create-pyspark-job","title":"Step 2: Create PySpark job","text":"<p>In this snippet we get the <code>JobsApi</code> object to get the default job configuration for a <code>PYSPARK</code> job, set the python script to run and create the <code>Job</code> object.</p> <pre><code>jobs_api = project.get_jobs_api()\n\nspark_config = jobs_api.get_configuration(\"PYSPARK\")\n\nspark_config['appPath'] = uploaded_file_path\n\njob = jobs_api.create_job(\"pyspark_job\", spark_config)\n</code></pre>"},{"location":"user_guides/projects/jobs/pyspark_job/#step-3-execute-the-job","title":"Step 3: Execute the job","text":"<p>In this snippet we execute the job synchronously, that is wait until it reaches a terminal state, and then download and print the logs.</p> <pre><code>execution = job.run(await_termination=True)\n\nout, err = execution.download_logs()\n\nf_out = open(out, \"r\")\nprint(f_out.read())\n\nf_err = open(err, \"r\")\nprint(f_err.read())\n</code></pre>"},{"location":"user_guides/projects/jobs/pyspark_job/#api-reference","title":"API Reference","text":"<p>Jobs</p> <p>Executions</p>"},{"location":"user_guides/projects/jobs/pyspark_job/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create and run a PySpark job.</p>"},{"location":"user_guides/projects/jobs/python_job/","title":"How To Run A Python Job","text":""},{"location":"user_guides/projects/jobs/python_job/#introduction","title":"Introduction","text":"<p>All members of a project in Hopsworks can launch the following types of applications through a project's Jobs service:</p> <ul> <li>Python (Hopsworks Enterprise only)</li> <li>Apache Spark</li> </ul> <p>Launching a job of any type is very similar process, what mostly differs between job types is the various configuration parameters each job type comes with. After following this guide you will be able to create a Python job.</p> <p>Kubernetes integration required</p> <p>Python Jobs are only available if Hopsworks has been integrated with a Kubernetes cluster.</p> <p>Hopsworks can be integrated with Amazon EKS, Azure AKS and on-premise Kubernetes clusters.</p>"},{"location":"user_guides/projects/jobs/python_job/#ui","title":"UI","text":""},{"location":"user_guides/projects/jobs/python_job/#step-1-jobs-overview","title":"Step 1: Jobs overview","text":"<p>The image below shows the Jobs overview page in Hopsworks and is accessed by clicking <code>Jobs</code> in the sidebar.</p> <p> Jobs overview </p>"},{"location":"user_guides/projects/jobs/python_job/#step-2-create-new-job-dialog","title":"Step 2: Create new job dialog","text":"<p>By default, the dialog will create a Spark job. To instead configure a Python job, click <code>Advanced options</code>, which will open up the advanced configuration page for the job.</p> <p> Create new job dialog </p>"},{"location":"user_guides/projects/jobs/python_job/#step-3-set-the-script","title":"Step 3: Set the script","text":"<p>Next step is to select the python script to run. You can either select <code>From project</code>, if the file was previously uploaded to Hopsworks, or <code>Upload new file</code> which lets you select a file from your local filesystem as demonstrated below.</p> <p> Configure program </p>"},{"location":"user_guides/projects/jobs/python_job/#step-4-set-the-job-type","title":"Step 4: Set the job type","text":"<p>Next step is to set the job type to <code>PYTHON</code> to indicate it should be executed as a simple python script. Then click <code>Create New Job</code> to create the job. </p> <p> Set the job type </p>"},{"location":"user_guides/projects/jobs/python_job/#step-5-optional-additional-configuration","title":"Step 5 (optional): Additional configuration","text":"<p>It is possible to also set following configuration settings for a <code>PYTHON</code> job.</p> <ul> <li><code>Container memory</code>: The amount of memory in MB to be allocated to the Python script</li> <li><code>Container cores</code>: The number of cores to be allocated for the Python script</li> <li><code>Additional files</code>: List of files that will be locally accessible by the application</li> </ul> <p> Set the job type </p>"},{"location":"user_guides/projects/jobs/python_job/#step-6-execute-the-job","title":"Step 6: Execute the job","text":"<p>Now click the <code>Run</code> button to start the execution of the job, and then click on <code>Executions</code> to see the list of all executions.</p> <p>Once the execution is finished, click on <code>Logs</code> to see the logs for the execution.</p> <p> Start job execution </p>"},{"location":"user_guides/projects/jobs/python_job/#code","title":"Code","text":""},{"location":"user_guides/projects/jobs/python_job/#step-1-upload-the-python-script","title":"Step 1: Upload the Python script","text":"<p>This snippet assumes the python script is in the current working directory and named <code>script.py</code>. </p> <p>It will upload the python script to the <code>Resources</code> dataset in your project.</p> <pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ndataset_api = project.get_dataset_api()\n\nuploaded_file_path = dataset_api.upload(\"script.py\", \"Resources\")\n</code></pre>"},{"location":"user_guides/projects/jobs/python_job/#step-2-create-python-job","title":"Step 2: Create Python job","text":"<p>In this snippet we get the <code>JobsApi</code> object to get the default job configuration for a <code>PYTHON</code> job, set the python script to run and create the <code>Job</code> object.</p> <pre><code>jobs_api = project.get_jobs_api()\n\npy_job_config = jobs_api.get_configuration(\"PYTHON\")\n\npy_job_config['appPath'] = uploaded_file_path\n\njob = jobs_api.create_job(\"py_job\", py_job_config)\n</code></pre>"},{"location":"user_guides/projects/jobs/python_job/#step-3-execute-the-job","title":"Step 3: Execute the job","text":"<p>In this snippet we execute the job synchronously, that is wait until it reaches a terminal state, and then download and print the logs.</p> <pre><code># Run the job\nexecution = job.run(await_termination=True)\n\n# Download logs\nout, err = execution.download_logs()\n\nf_out = open(out, \"r\")\nprint(f_out.read())\n\nf_err = open(err, \"r\")\nprint(f_err.read())\n</code></pre>"},{"location":"user_guides/projects/jobs/python_job/#api-reference","title":"API Reference","text":"<p>Jobs</p> <p>Executions</p>"},{"location":"user_guides/projects/jobs/python_job/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create and run a Python job.</p>"},{"location":"user_guides/projects/jobs/schedule_job/","title":"How To Schedule a Job","text":""},{"location":"user_guides/projects/jobs/schedule_job/#introduction","title":"Introduction","text":"<p>Hopsworks jobs can be scheduled to run at regular intervals using the scheduling function provided by Hopsworks. Each job can be configured to have a single schedule.</p> <p>Schedules can be defined using the drop down menus in the UI or a Quartz cron expression. </p> <p>Schedule frequency</p> <p>The Hopsworks scheduler runs every minute. As such, the scheduling frequency should be of at least 1 minute.</p> <p>Parallel executions</p> <p>If a job execution needs to be scheduled, the scheduler will first check that there are no active executions for that job. If there is an execution running, the scheduler will postpone the execution until the running one is done. </p>"},{"location":"user_guides/projects/jobs/schedule_job/#ui","title":"UI","text":""},{"location":"user_guides/projects/jobs/schedule_job/#scheduling-jobs","title":"Scheduling Jobs","text":"<p>You can define a schedule for a job during the creation of the job itself or after the job has been created from the job overview UI. </p> <p> Schedule a Job </p> <p>The add schedule prompt requires you to select a frequency either through the drop down menus or by using a cron expression. You can also provide a start time to specify from when the schedule should have effect.  The start time can also be in the past. If that's the case, the scheduler will backfill the executions from the specified start time. As mentioned above, the execution backfilling will happen one execution at the time.</p> <p>You can optionally provide an end date time to specify until when the scheduling should continue. The end time can also be in the past.</p> <p>In the job overview, you can see the current scheduling configuration, whether or not it is enabled and when the next execution is planned for.</p> <p>All times will be considered as UTC time.</p> <p> Job scheduling overview </p>"},{"location":"user_guides/projects/jobs/schedule_job/#job-argument","title":"Job argument","text":"<p>When a job execution is triggered by the scheduler, a <code>-start_time</code> argument is added to the job arguments. The <code>-start_time</code> value will be the time of the scheduled execution in UTC in the ISO-8601 format (e.g.: <code>-start_time 2023-08-19T18:00:00Z</code>).</p> <p>The <code>-start_time</code> value passed as argument represents the time when the execution was scheduled, not when the execution was started. For example, if the scheduled execution time was in the past (e.g. in the case of backfilling), the <code>-start_time</code> passed to the execution is the time in the past, not the current time when the execution is running.  Similarly, if the scheduler was not running for a period of time, when it comes back online, it will start the executions it missed to schedule while offline. Even in that case, the <code>-start_time</code> value will contain the time at which the execution was supposed to be started, not the current time.</p>"},{"location":"user_guides/projects/jobs/schedule_job/#disable-enable-a-schedule","title":"Disable / Enable a schedule","text":"<p>You can decide to pause the scheduling of a job and avoid new executions to be started. You can later on re-enable the same scheduling configuration, and the scheduler will run the executions that were skipped while the schedule was disabled, if any, sequentially. In this way you will backfill the executions in between. </p> <p>You can skip the backfilling of the executions by editing the scheduling configuration and bringing forward the schedule start time for the job. </p>"},{"location":"user_guides/projects/jobs/schedule_job/#delete-a-scheduling","title":"Delete a scheduling","text":"<p>You can remove the schedule for a job using the UI and by clicking on the trash icon on the schedule section of the job overview. If you re-schedule a job after having deleted the previous schedule, even with the same options, it will not take into account previous scheduled executions.</p>"},{"location":"user_guides/projects/jobs/spark_job/","title":"How To Run A Spark Job","text":""},{"location":"user_guides/projects/jobs/spark_job/#introduction","title":"Introduction","text":"<p>All members of a project in Hopsworks can launch the following types of applications through a project's Jobs service:</p> <ul> <li>Python (Hopsworks Enterprise only)</li> <li>Apache Spark</li> </ul> <p>Launching a job of any type is very similar process, what mostly differs between job types is the various configuration parameters each job type comes with. After following this guide you will be able to create a Spark job.</p>"},{"location":"user_guides/projects/jobs/spark_job/#ui","title":"UI","text":""},{"location":"user_guides/projects/jobs/spark_job/#step-1-jobs-overview","title":"Step 1: Jobs overview","text":"<p>The image below shows the Jobs overview page in Hopsworks and is accessed by clicking <code>Jobs</code> in the sidebar.</p> <p> Jobs overview </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-2-create-new-job-dialog","title":"Step 2: Create new job dialog","text":"<p>To configure a  job, click <code>Advanced options</code>, which will open up the advanced configuration page for the job.</p> <p> Create new job dialog </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-3-set-the-jar","title":"Step 3: Set the jar","text":"<p>Next step is to select the program to run. You can either select <code>From project</code>, if the file was previously uploaded to Hopsworks, or <code>Upload new file</code> which lets you select a file from your local filesystem as demonstrated below. After that set the name for the job.</p> <p> Configure program </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-4-set-the-job-type","title":"Step 4: Set the job type","text":"<p>Next step is to set the job type to <code>SPARK</code> to indicate it should be executed as a spark job. Then specify additional configuration or click <code>Create New Job</code> to create the job.</p> <p> Set the job type </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-5-set-the-main-class","title":"Step 5: Set the main class","text":"<p>Next step is to set the main class for the application. Then specify advanced configuration or click <code>Create New Job</code> to create the job.</p> <p> Set the main class </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-6-optional-advanced-configuration","title":"Step 6 (optional): Advanced configuration","text":"<p>Resource allocation for the Spark driver and executors can be configured, also the number of executors and whether dynamic execution should be enabled.</p> <ul> <li> <p><code>Driver memory</code>: Number of cores to allocate for the Spark driver</p> </li> <li> <p><code>Driver virtual cores</code>: Number of MBs to allocate for the Spark driver</p> </li> <li> <p><code>Executor memory</code>: Number of cores to allocate for each Spark executor</p> </li> <li> <p><code>Executor virtual cores</code>: Number of MBs to allocate for each Spark executor</p> </li> <li> <p><code>Dynamic/Static</code>: Run the Spark application in static or dynamic allocation mode (see spark docs for details).</p> </li> </ul> <p> Resource configuration for the Spark kernels </p> <p>Additional files or dependencies required for the Spark job can be configured.</p> <ul> <li> <p><code>Additional archives</code>: List of archives to be extracted into the working directory of each executor.</p> </li> <li> <p><code>Additional jars</code>: List of jars to be placed in the working directory of each executor.</p> </li> <li> <p><code>Additional python dependencies</code>: List of python files and archives to be placed on each executor and added to PATH.</p> </li> <li> <p><code>Additional files</code>: List of files to be placed in the working directory of each executor.</p> </li> </ul> <p> File configuration for the Spark kernels </p> <p>Line-separates properties to be set for the Spark application. For example, changing the configuration variables for the Kryo Serializer or setting environment variables for the driver, you can set the properties as shown below.</p> <p> Additional Spark configuration </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-7-execute-the-job","title":"Step 7: Execute the job","text":"<p>Now click the <code>Run</code> button to start the execution of the job, and then click on <code>Executions</code> to see the list of all executions.</p> <p> Start job execution </p>"},{"location":"user_guides/projects/jobs/spark_job/#step-8-application-logs","title":"Step 8: Application logs","text":"<p>To monitor logs while the execution is running, click <code>Spark UI</code> to open the Spark UI in a separate tab.</p> <p>Once the execution is finished, you can click on <code>Logs</code> to see the full logs for execution.</p> <p> Access Spark logs </p>"},{"location":"user_guides/projects/jobs/spark_job/#code","title":"Code","text":""},{"location":"user_guides/projects/jobs/spark_job/#step-1-upload-the-spark-jar","title":"Step 1: Upload the Spark jar","text":"<p>This snippet assumes the Spark program is in the current working directory and named <code>sparkpi.jar</code>. </p> <p>It will upload the jar to the <code>Resources</code> dataset in your project.</p> <pre><code>import hopsworks\n\nproject = hopsworks.login()\n\ndataset_api = project.get_dataset_api()\n\nuploaded_file_path = dataset_api.upload(\"sparkpi.jar\", \"Resources\")\n</code></pre>"},{"location":"user_guides/projects/jobs/spark_job/#step-2-create-spark-job","title":"Step 2: Create Spark job","text":"<p>In this snippet we get the <code>JobsApi</code> object to get the default job configuration for a <code>SPARK</code> job, set the python script to run and create the <code>Job</code> object.</p> <pre><code>jobs_api = project.get_jobs_api()\n\nspark_config = jobs_api.get_configuration(\"SPARK\")\n\nspark_config['appPath'] = uploaded_file_path\nspark_config['mainClass'] = 'org.apache.spark.examples.SparkPi'\n\njob = jobs_api.create_job(\"pyspark_job\", spark_config)\n</code></pre>"},{"location":"user_guides/projects/jobs/spark_job/#step-3-execute-the-job","title":"Step 3: Execute the job","text":"<p>In this snippet we execute the job synchronously, that is wait until it reaches a terminal state, and then download and print the logs.</p> <pre><code>execution = job.run(await_termination=True)\n\nout, err = execution.download_logs()\n\nf_out = open(out, \"r\")\nprint(f_out.read())\n\nf_err = open(err, \"r\")\nprint(f_err.read())\n</code></pre>"},{"location":"user_guides/projects/jobs/spark_job/#api-reference","title":"API Reference","text":"<p>Jobs</p> <p>Executions</p>"},{"location":"user_guides/projects/jobs/spark_job/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create and run a Spark job.</p>"},{"location":"user_guides/projects/jupyter/python_notebook/","title":"How To Run A Python Notebook","text":""},{"location":"user_guides/projects/jupyter/python_notebook/#introduction","title":"Introduction","text":"<p>Jupyter is provided as a service in Hopsworks, providing the same user experience and features as if run on your laptop.</p> <ul> <li>Supports JupyterLab and the classic Jupyter front-end</li> <li>Configured with Python3, Spark, PySpark and SparkR kernels</li> </ul> <p>Important</p> <p>If Hopsworks is not configured to run Jupyter on Kubernetes then the Python kernel is disabled by default.  In this case the Python kernel can be enabled by setting the configuration variable <code>enable_jupyter_python_kernel_non_kubernetes</code> to True.  Follow this guide for instructions on how to set a configuration variable.</p>"},{"location":"user_guides/projects/jupyter/python_notebook/#step-1-jupyter-dashboard","title":"Step 1: Jupyter dashboard","text":"<p>The image below shows the Jupyter service page in Hopsworks and is accessed by clicking <code>Jupyter</code> in the sidebar.</p> <p> Jupyter dashboard in Hopsworks </p> <p>From this page, you can configure various options and settings to start Jupyter with as described in the sections below.</p>"},{"location":"user_guides/projects/jupyter/python_notebook/#step-2-optional-configure-resources","title":"Step 2 (Optional): Configure resources","text":"<p>Next step is to configure Jupyter, Click <code>edit configuration</code> to get to the configuration page and select <code>Python</code>.</p> <ul> <li> <p><code>Container cores</code>: Number of cores to allocate for the Jupyter instance</p> </li> <li> <p><code>Container memory</code>: Number of MBs to allocate for the Jupyter instance</p> </li> </ul> <p>Configured resource pool is shared by all running kernels. If a kernel crashes while executing a cell, try increasing the Container memory.</p> <p> Resource configuration for the Python kernel </p> <p>Click <code>Save</code> to save the new configuration.</p>"},{"location":"user_guides/projects/jupyter/python_notebook/#step-3-optional-configure-max-runtime-and-root-path","title":"Step 3 (Optional): Configure max runtime and root path","text":"<p>Before starting the server there are two additional configurations that can be set next to the <code>Run Jupyter</code> button.</p> <p>The runtime of the Jupyter instance can be configured, this is useful to ensure that idle instances will not be hanging around and keep allocating resources. If a limited runtime is not desirable, this can be disabled by setting <code>no limit</code>. </p> <p> Configure maximum runtime </p> <p>The root path from which to start the Jupyter instance can be configured. By default it starts by setting the <code>/Jupyter</code> folder as the root.</p> <p> Configure root folder </p>"},{"location":"user_guides/projects/jupyter/python_notebook/#step-4-start-jupyter","title":"Step 4: Start Jupyter","text":"<p>Start the Jupyter instance by clicking the <code>Run Jupyter</code> button.</p> <p> Starting Jupyter and running a Python notebook </p>"},{"location":"user_guides/projects/jupyter/python_notebook/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure and run a Python application in Jupyter. You can now follow this guide to install a library that can be used in a notebook.</p>"},{"location":"user_guides/projects/jupyter/remote_filesystem_driver/","title":"Configuring remote filesystem driver","text":""},{"location":"user_guides/projects/jupyter/remote_filesystem_driver/#introduction","title":"Introduction","text":"<p>We provide two ways to access and persist files in HopsFs from a jupyter notebook:</p> <ul> <li><code>hdfscontentsmanager</code>: With <code>hdfscontentsmanager</code> you interact with the project datasets using the dataset api. When you   start a notebook using the <code>hdfscontentsmanager</code> you will only see the files in the configured root path.</li> <li><code>hopsfsmount</code>: With <code>hopsfsmount</code> all the project datasets are available in the jupyter notebook as a local filesystem.   This means you can use native Python file I/O operations (copy, move, create, open, etc.) to interact with the project datasets.   When you open the jupyter notebook you will see all the project datasets.</li> </ul>"},{"location":"user_guides/projects/jupyter/remote_filesystem_driver/#configuring-the-driver","title":"Configuring the driver","text":"<p>To configure the driver you need to have admin role and set the <code>jupyter_remote_fs_driver</code> to either <code>hdfscontentsmanager</code> or <code>hopsfsmount</code>. The default driver is <code>hdfscontentsmanager</code>.</p>"},{"location":"user_guides/projects/jupyter/remote_filesystem_driver/#conclusion","title":"Conclusion","text":"<p>In this guide you learned about the filesystem drivers for jupyter notebooks and how to configure them.</p>"},{"location":"user_guides/projects/jupyter/spark_notebook/","title":"How To Run A Spark Notebook","text":""},{"location":"user_guides/projects/jupyter/spark_notebook/#introduction","title":"Introduction","text":"<p>Jupyter is provided as a service in Hopsworks, providing the same user experience and features as if run on your laptop.</p> <ul> <li>Supports JupyterLab and the classic Jupyter front-end</li> <li>Configured with Python3, Spark, PySpark and SparkR kernels</li> </ul>"},{"location":"user_guides/projects/jupyter/spark_notebook/#step-1-jupyter-dashboard","title":"Step 1: Jupyter dashboard","text":"<p>The image below shows the Jupyter service page in Hopsworks and is accessed by clicking <code>Jupyter</code> in the sidebar.</p> <p> Jupyter dashboard in Hopsworks </p> <p>From this page, you can configure various options and settings to start Jupyter with as described in the sections below.</p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#step-2-optional-configure-spark","title":"Step 2 (Optional): Configure spark","text":"<p>Next step is to configure the Spark properties to be used in Jupyter, Click <code>edit configuration</code> to get to the configuration page and select <code>Spark</code>.</p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#resource-and-compute","title":"Resource and compute","text":"<p>Resource allocation for the Spark driver and executors can be configured, also the number of executors and whether dynamic execution should be enabled.</p> <ul> <li> <p><code>Driver memory</code>: Number of cores to allocate for the Spark driver</p> </li> <li> <p><code>Driver virtual cores</code>: Number of MBs to allocate for the Spark driver</p> </li> <li> <p><code>Executor memory</code>: Number of cores to allocate for each Spark executor</p> </li> <li> <p><code>Executor virtual cores</code>: Number of MBs to allocate for each Spark executor</p> </li> <li> <p><code>Dynamic/Static</code>: Run the Spark application in static or dynamic allocation mode (see spark docs for details).</p> </li> </ul> <p> Resource configuration for the Spark kernels </p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#attach-files-or-dependencies","title":"Attach files or dependencies","text":"<p>Additional files or dependencies required for the Spark job can be configured.</p> <ul> <li> <p><code>Additional archives</code>: List of zip or .tgz files that will be locally accessible by the application</p> </li> <li> <p><code>Additional jars</code>: List of .jar files to add to the CLASSPATH of the application</p> </li> <li> <p><code>Additional python dependencies</code>: List of .py, .zip or .egg files that will be locally accessible by the application</p> </li> <li> <p><code>Additional files</code>: List of files that will be locally accessible by the application</p> </li> </ul> <p> File configuration for the Spark kernels </p> <p>Line-separates properties to be set for the Spark application. For example, changing the configuration variables for the Kryo Serializer or setting environment variables for the driver, you can set the properties as shown below.</p> <p> Additional Spark configuration </p> <p>Click <code>Save</code> to save the new configuration.</p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#step-3-optional-configure-max-runtime-and-root-path","title":"Step 3 (Optional): Configure max runtime and root path","text":"<p>Before starting the server there are two additional configurations that can be set next to the <code>Run Jupyter</code> button.</p> <p>The runtime of the Jupyter instance can be configured, this is useful to ensure that idle instances will not be hanging around and keep allocating resources. If a limited runtime is not desirable, this can be disabled by setting <code>no limit</code>.</p> <p> Configure maximum runtime </p> <p>The root path from which to start the Jupyter instance can be configured. By default it starts by setting the <code>/Jupyter</code> folder as the root.</p> <p> Configure root folder </p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#step-4-start-jupyter","title":"Step 4: Start Jupyter","text":"<p>Start the Jupyter instance by clicking the <code>Run Jupyter</code> button.</p> <p> Starting Jupyter and running a Spark notebook </p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#step-5-access-spark-ui","title":"Step 5: Access Spark UI","text":"<p>Navigate back to Hopsworks and a Spark session will have appeared, click on the <code>Spark UI</code> button to go to the Spark UI.</p> <p> Access Spark UI and see application logs </p>"},{"location":"user_guides/projects/jupyter/spark_notebook/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to configure and run a Spark application in Jupyter. You can now follow this guide to install a library that can be used in a notebook.</p>"},{"location":"user_guides/projects/kafka/consume_messages/","title":"How To Consume Message From A Topic","text":""},{"location":"user_guides/projects/kafka/consume_messages/#introduction","title":"Introduction","text":"<p>A Consumer is a process which reads messages from a Kafka topic. In Hopsworks, all user roles are capable of performing 'Read' and 'Describe' actions on Kafka topics within projects that they are a member of or are shared with them.</p>"},{"location":"user_guides/projects/kafka/consume_messages/#prerequisites","title":"Prerequisites","text":"<p>This guide requires that you have previously produced messages to a kafka topic.</p>"},{"location":"user_guides/projects/kafka/consume_messages/#code","title":"Code","text":"<p>In this guide, you will learn how to consume messages from a kafka topic.</p>"},{"location":"user_guides/projects/kafka/consume_messages/#step-1-get-the-kafka-api","title":"Step 1: Get the Kafka API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nkafka_api = project.get_kafka_api()\n</code></pre>"},{"location":"user_guides/projects/kafka/consume_messages/#step-2-configure-confluent-kafka-client","title":"Step 2: Configure confluent-kafka client","text":"<pre><code>consumer_config = kafka_api.get_default_config()\nconsumer_config['default.topic.config'] = {'auto.offset.reset': 'earliest'}\n\nfrom confluent_kafka import Consumer\n\nconsumer = Consumer(consumer_config)\n</code></pre>"},{"location":"user_guides/projects/kafka/consume_messages/#step-3-consume-messages-from-a-topic","title":"Step 3: Consume messages from a topic","text":"<pre><code># Subscribe to topic\nconsumer.subscribe([\"my_topic\"])\n\nfor i in range(0, 10):\n    msg = consumer.poll(timeout=10.0)\n    print(msg.value())\n</code></pre>"},{"location":"user_guides/projects/kafka/consume_messages/#api-reference","title":"API Reference","text":"<p>KafkaTopic</p>"},{"location":"user_guides/projects/kafka/consume_messages/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to consume messages from a Kafka Topic.</p>"},{"location":"user_guides/projects/kafka/create_schema/","title":"How To Create A Kafka Schema","text":""},{"location":"user_guides/projects/kafka/create_schema/#introduction","title":"Introduction","text":""},{"location":"user_guides/projects/kafka/create_schema/#code","title":"Code","text":"<p>In this guide, you will learn how to create a Kafka Avro Schema in the Hopsworks Schema Registry.</p>"},{"location":"user_guides/projects/kafka/create_schema/#step-1-get-the-kafka-api","title":"Step 1: Get the Kafka API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nkafka_api = project.get_kafka_api()\n</code></pre>"},{"location":"user_guides/projects/kafka/create_schema/#step-2-define-the-schema","title":"Step 2: Define the schema","text":"<p>Define the Avro Schema, see types for the format of the schema.</p> <pre><code>schema = {\n    \"type\": \"record\",\n    \"name\": \"tutorial\",\n    \"fields\": [\n        {\n            \"name\": \"id\",\n            \"type\": \"int\"\n        },\n        {\n            \"name\": \"data\",\n            \"type\": \"string\"\n        }\n    ]\n}\n</code></pre>"},{"location":"user_guides/projects/kafka/create_schema/#step-3-create-the-schema","title":"Step 3: Create the schema","text":"<p>Create the schema in the Schema Registry.</p> <pre><code>SCHEMA_NAME=\"schema_example\"\n\nmy_schema = kafka_api.create_schema(SCHEMA_NAME, schema)\n</code></pre>"},{"location":"user_guides/projects/kafka/create_schema/#api-reference","title":"API Reference","text":"<p>KafkaSchema</p>"},{"location":"user_guides/projects/kafka/create_schema/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a Kafka Schema.</p>"},{"location":"user_guides/projects/kafka/create_topic/","title":"How To Create A Kafka Topic","text":""},{"location":"user_guides/projects/kafka/create_topic/#introduction","title":"Introduction","text":"<p>A Topic is a queue to which records are stored and published. Producer applications write data to topics and consumer applications read from topics.</p>"},{"location":"user_guides/projects/kafka/create_topic/#prerequisites","title":"Prerequisites","text":"<p>This guide requires that you have 'Data owner' role and have previously created a Kafka Schema to be used for the topic.</p>"},{"location":"user_guides/projects/kafka/create_topic/#code","title":"Code","text":"<p>In this guide, you will learn how to create a Kafka Topic.</p>"},{"location":"user_guides/projects/kafka/create_topic/#step-1-get-the-kafka-api","title":"Step 1: Get the Kafka API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nkafka_api = project.get_kafka_api()\n</code></pre>"},{"location":"user_guides/projects/kafka/create_topic/#step-2-define-the-schema","title":"Step 2: Define the schema","text":"<pre><code>TOPIC_NAME=\"topic_example\"\nSCHEMA_NAME=\"schema_example\"\n\nmy_topic = kafka_api.create_topic(TOPIC_NAME, SCHEMA_NAME, 1, replicas=1, partitions=1)\n</code></pre>"},{"location":"user_guides/projects/kafka/create_topic/#api-reference","title":"API Reference","text":"<p>KafkaTopic</p>"},{"location":"user_guides/projects/kafka/create_topic/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a Kafka Topic.</p>"},{"location":"user_guides/projects/kafka/produce_messages/","title":"How To Produce To A Topic","text":""},{"location":"user_guides/projects/kafka/produce_messages/#introduction","title":"Introduction","text":"<p>A Producer is a process which produces messages to a Kafka topic. In Hopsworks, only users with the 'Data owner' role are capable of performing the 'Write' action on Kafka topics within the project that they are a member of.</p>"},{"location":"user_guides/projects/kafka/produce_messages/#prerequisites","title":"Prerequisites","text":"<p>This guide requires that you have 'Data owner' role and have previously created a Kafka Topic.</p>"},{"location":"user_guides/projects/kafka/produce_messages/#code","title":"Code","text":"<p>In this guide, you will learn how to produce messages to a kafka topic.</p>"},{"location":"user_guides/projects/kafka/produce_messages/#step-1-get-the-kafka-api","title":"Step 1: Get the Kafka API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nkafka_api = project.get_kafka_api()\n</code></pre>"},{"location":"user_guides/projects/kafka/produce_messages/#step-2-configure-confluent-kafka-client","title":"Step 2: Configure confluent-kafka client","text":"<pre><code>producer_config = kafka_api.get_default_config()\n\nfrom confluent_kafka import Producer\n\nproducer = Producer(producer_config)\n</code></pre>"},{"location":"user_guides/projects/kafka/produce_messages/#step-3-produce-messages-to-topic","title":"Step 3: Produce messages to topic","text":"<pre><code>import uuid\nimport json\n\n# Send a few messages\nfor i in range(0, 10):\n    producer.produce(\"my_topic\", json.dumps({\"id\": i, \"data\": str(uuid.uuid1())}), \"key\")\n\n# Trigger the sending of all messages to the brokers, 10 sec timeout\nproducer.flush(10)\n</code></pre>"},{"location":"user_guides/projects/kafka/produce_messages/#api-reference","title":"API Reference","text":"<p>KafkaTopic</p>"},{"location":"user_guides/projects/kafka/produce_messages/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to produce messages to a Kafka Topic. Next step is to create a Consumer to read the messages from the topic.</p>"},{"location":"user_guides/projects/opensearch/connect/","title":"How To Connect To OpenSearch","text":""},{"location":"user_guides/projects/opensearch/connect/#introduction","title":"Introduction","text":"<p>Text here</p> <p>Limited to internal Jobs and Notebooks</p> <p>Currently it's only possible to configure the opensearch-py client in a job or jupyter notebook running inside the Hopsworks cluster.</p>"},{"location":"user_guides/projects/opensearch/connect/#code","title":"Code","text":"<p>In this guide, you will learn how to connect to the OpenSearch cluster using an opensearch-py client. </p>"},{"location":"user_guides/projects/opensearch/connect/#step-1-get-the-opensearch-api","title":"Step 1: Get the OpenSearch API","text":"<pre><code>import hopsworks\n\nproject = hopsworks.login()\n\nopensearch_api = project.get_opensearch_api()\n</code></pre>"},{"location":"user_guides/projects/opensearch/connect/#step-2-configure-the-opensearch-py-client","title":"Step 2: Configure the opensearch-py client","text":"<pre><code>from opensearchpy import OpenSearch\n\nclient = OpenSearch(**opensearch_api.get_default_py_config())\n</code></pre>"},{"location":"user_guides/projects/opensearch/connect/#api-reference","title":"API Reference","text":"<p>OpenSearch</p>"},{"location":"user_guides/projects/opensearch/connect/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to connect to the OpenSearch cluster. You can now use the client to interact directly with the OpenSearch cluster, such as vector database.</p>"},{"location":"user_guides/projects/project/add_members/","title":"How To Add Members To A Project","text":""},{"location":"user_guides/projects/project/add_members/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to add new members to your project as well as the different roles within a project.</p>"},{"location":"user_guides/projects/project/add_members/#step-1-members-list","title":"Step 1: Members list","text":"<p>On the <code>Project settings</code> page, you can find the <code>General</code> section, which lists the members of the project.</p> <p> List of project members </p>"},{"location":"user_guides/projects/project/add_members/#step-2-add-a-new-member","title":"Step 2: Add a new member","text":"<p>Next click <code>Add members</code> and a dialog where users can be invited will appear. Select the users to invite.</p> <p> Add new member dialog </p> <p>Subsequently, the selected project members can be assigned to 2 different roles, depending on the privileges necessary for him/her to fulfill their needs.</p>"},{"location":"user_guides/projects/project/add_members/#data-owner","title":"Data owner","text":"<p>Data owners hold the highest authority in the project, having full control of its contents.</p> <p>They are allowed to: - Share a project - Manage the project and its members - Work with all feature store abstractions (such as Feature groups, Feature views, Storage connectors, etc.)</p> <p>It is worth mentioning that the project's creator (aka. <code>author</code>) is a special type of <code>Data owner</code>. He is the only user capable of deleting the project and it is impossible to change his role to <code>Data scientist</code>.</p>"},{"location":"user_guides/projects/project/add_members/#data-scientist","title":"Data scientist","text":"<p>Data scientists can be viewed as the users of data.</p> <p>They are allowed to: - Create feature views/training datasets using existing features - Manage the feature views/training datasets they have created</p>"},{"location":"user_guides/projects/project/add_members/#step-3-member-invited","title":"Step 3: Member invited","text":"<p>The invited user will now appear in the list of members and will have access to the project.</p> <p> List of project members </p>"},{"location":"user_guides/projects/project/add_members/#conclusion","title":"Conclusion","text":"<p>In this guide, you learned how to add a new member and the types of roles this member can be a part of.</p>"},{"location":"user_guides/projects/project/create_project/","title":"How To Create A Project","text":""},{"location":"user_guides/projects/project/create_project/#introduction","title":"Introduction","text":"<p>In this guide, you will learn how to create a new project.</p> <p>Project name validation rules</p> <p>A valid project name can only contain characters a-z, A-Z, 0-9 and special characters \u2018_\u2019 and \u2018.\u2019 but not \u2018__\u2019 (double underscore). There is also a number of reserved project names that can not be used.</p>"},{"location":"user_guides/projects/project/create_project/#gui","title":"GUI","text":""},{"location":"user_guides/projects/project/create_project/#step-1-create-a-project","title":"Step 1: Create a project","text":"<p>If you log in to the platform and do not have any projects, you are presented with the following view. To run the Feature Store tour click <code>Run a demo project</code>, to create a new project click <code>Create new project</code>.</p> <p>For this guide click <code>Create new project</code> to continue.</p> <p> Landing page </p>"},{"location":"user_guides/projects/project/create_project/#step-2-project-creation-form","title":"Step 2: Project creation form","text":"<p>In the creation form in which you enter the project name, an optional description and set of members to invite to the project.</p> <p> Project creation form </p>"},{"location":"user_guides/projects/project/create_project/#step-3-project-creation","title":"Step 3: Project creation","text":"<p>Then wait for the project creation process to finish.</p> <p> List of created API Keys </p>"},{"location":"user_guides/projects/project/create_project/#step-4-project-overview","title":"Step 4: Project overview","text":"<p>Once the project is created the overview page for it will appear.</p> <p> List of created API Keys </p>"},{"location":"user_guides/projects/project/create_project/#code","title":"Code","text":""},{"location":"user_guides/projects/project/create_project/#step-1-connect-to-hopsworks","title":"Step 1: Connect to Hopsworks","text":"<pre><code>import hopsworks\n\nconnection = hopsworks.connection()\n</code></pre>"},{"location":"user_guides/projects/project/create_project/#step-2-create-project","title":"Step 2: Create project","text":"<pre><code>project = connection.create_project(\"my_project\")\n</code></pre>"},{"location":"user_guides/projects/project/create_project/#api-reference","title":"API Reference","text":"<p>Projects</p>"},{"location":"user_guides/projects/project/create_project/#reserved-project-names","title":"Reserved project names","text":"<pre><code>PROJECTS, HOPS-SYSTEM, HOPSWORKS, INFORMATION_SCHEMA, AIRFLOW, GLASSFISH_TIMERS, GRAFANA, HOPS, METASTORE,\nMYSQL, NDBINFO, RONDB_REPLICATION, PERFORMANCE_SCHEMA, SQOOP, SYS, GLASSFISH_TIMERS, GRAFANA, HOPS, METASTORE, MYSQL, NDBINFO,\nPERFORMANCE_SCHEMA, SQOOP, SYS, BIGINT, BINARY, BOOLEAN, BOTH, BY, CASE, CAST, CHAR, COLUMN, CONF, CREATE, CROSS, CUBE, CURRENT, CURRENT_DATE,\nCURRENT_TIMESTAMP, CURSOR, DATABASE, DATE, DECIMAL, DELETE, DESCRIBE, DISTINCT, DOUBLE, DROP, ELSE, END,\nEXCHANGE, EXISTS, EXTENDED, EXTERNAL, FALSE, FETCH, FLOAT, FOLLOWING, FOR, FROM, FULL, FUNCTION, GRANT, GROUP,\nGROUPING, HAVING, IF, IMPORT, IN, INNER, INSERT, INT, INTERSECT, INTERVAL, INTO, IS, JOIN, LATERAL, LEFT, LESS,\nLIKE, LOCAL, MACRO, MAP, MORE, NONE, NOT, NULL, OF, ON, OR, ORDER, OUT, OUTER, OVER, PARTIALSCAN, PARTITION,\nPERCENT, PRECEDING, PRESERVE, PROCEDURE, RANGE, READS, REDUCE, REVOKE, RIGHT, ROLLUP, ROW, ROWS, SELECT, SET,\nSMALLINT, TABLE, TABLESAMPLE, THEN, TIMESTAMP, TO, TRANSFORM, TRIGGER, TRUE, TRUNCATE, UNBOUNDED, UNION,\nUNIQUEJOIN, UPDATE, USER, USING, UTC_TMESTAMP, VALUES, VARCHAR, WHEN, WHERE, WINDOW, WITH, COMMIT, ONLY,\nREGEXP, RLIKE, ROLLBACK, START, CACHE, CONSTRAINT, FOREIGN, PRIMARY, REFERENCES, DAYOFWEEK, EXTRACT, FLOOR,\nINTEGER, PRECISION, VIEWS, TIME, NUMERIC, SYNC, BASE, PYTHON37, FILEBEAT.\n\nAnd any word containing _FEATURESTORE.\n</code></pre>"},{"location":"user_guides/projects/project/create_project/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a project.</p>"},{"location":"user_guides/projects/python/custom_commands/","title":"Adding extra configuration with generic bash commands","text":""},{"location":"user_guides/projects/python/custom_commands/#introduction","title":"Introduction","text":"<p>Hopsworks comes with a prepackaged Python environment that contains libraries for data engineering, machine learning, and more general data science development. Hopsworks also offers the ability to install additional packages using different options e.g., Pypi, conda channel, and public or private git repository among others.</p> <p>Some Python libraries require the installation of some OS-Level libraries. In some cases, you may need to add more complex configuration to your environment. This demands writing your own commands and executing them on top of the existing environment.</p> <p>In this guide, you will learn how to run custom bash commands that can be used to add more complex configuration to your environment e.g., installing OS-Level packages or configuring an oracle database.</p>"},{"location":"user_guides/projects/python/custom_commands/#running-bash-commands","title":"Running bash commands","text":"<p>In this section, we will see how you can run custom bash commands in Hopsworks to configure your Python environment.</p> <p>In Hopsworks, we maintain a docker image built on top of Ubuntu Linux distribution. You can run generic bash commands on top of the project environment from the UI or REST API.</p>"},{"location":"user_guides/projects/python/custom_commands/#setting-up-the-bash-script-and-artifacts-from-the-ui","title":"Setting up the bash script and artifacts from the UI","text":"<p>To use the UI, navigate to the Python environment in the Project settings. In the Python environment page, navigate to custom commands. From the UI, you can write the bash commands in the textbox provided. These bash commands will be uploaded and executed when building your new environment. You can include build artifacts e.g., binaries that you would like to execute or include when building the environment. See Figure 1.</p> <p> Figure 1: You can write custom commands and upload build artifacts from the UI </p>"},{"location":"user_guides/projects/python/custom_commands/#code","title":"Code","text":"<p>You can also run the custom commands using the REST API. From the REST API, you should provide the path, in HOPSFS, to the bash script and the artifacts(comma seperated string of paths in HopsFs). The REST API endpoint for running custom commands is: <code>hopsworks-api/api/project/&lt;projectId&gt;/python/environments/&lt;pythonVersion&gt;/commands/custom</code> and the body should look like this: <pre><code>{\n    \"commandsFile\": \"&lt;pathToYourBashScriptInHopsFS&gt;\",\n    \"artifacts\": \"&lt;commaSeperatedListOfPathsToArtifactsInHopsFS&gt;\"\n}\n</code></pre></p>"},{"location":"user_guides/projects/python/custom_commands/#what-to-include-in-the-bash-script","title":"What to include in the bash script","text":"<p>There are few important things to be aware of when writing the bash script:</p> <ul> <li>The first line of your bash script should always be <code>#!/bin/bash</code> (known as shebang) so that the script can be interpreted and executed using the Bash shell.</li> <li>You can use <code>apt</code>, <code>apt-get</code> and <code>deb</code> commands to install packages. You should always run these commands with <code>sudo</code>. In some cases, these commands will ask for user input, therefore you should provide the input of what the command expects, e.g., <code>sudo apt -y install</code>, otherwise the build will fail. We have already configured <code>apt-get</code> to be non-interactive</li> <li>The build artifacts will be copied to <code>srv/hops/build</code>. You can use them in your script via this path. This path is also available via the environmental variable <code>BUILD_PATH</code>. If you want to use many artifacts it is advisable to create a zip file and upload it to HopsFS in one of your project datasets. You can then include the zip file as one of the artifacts.</li> <li>The conda environment is located in <code>/srv/hops/anaconda/envs/theenv</code>. You can install or uninstall packages in the conda environment using pip like: <code>/srv/hops/anaconda/envs/theenv/bin/pip install spotify==0.10.2</code>. If the command requires some input, write the command together with the expected input otherwise the build will fail.</li> </ul>"},{"location":"user_guides/projects/python/custom_commands/#conclusion","title":"Conclusion","text":"<p>In this guide you have learned how to add extra configuration to your python environment by running custom commands.</p>"},{"location":"user_guides/projects/python/environment_history/","title":"Python Environment History","text":"<p>The Hopsworks installation ships with a Miniconda environment that comes preinstalled with the most popular libraries you can find in a data scientist toolkit, including TensorFlow, PyTorch and sci-kit-learn. The environment may be managed using the Hopsworks Python service to install or manage libraries which may then be used in Jupyter or the Jobs service in the platform.</p> <p>The Python virtual environment is shared by different members of the project. When a member of the project introduces a change to the environment i.e., installs/uninstalls a library, a new environment is created and it becomes a defacto environment for everyone in the project. It is therefore important to track how the environment has been changing over time i.e., what libraries were installed, uninstalled, upgraded, or downgraded when the environment was created and who introduced the changes. </p> <p>In this guide, you will learn how you can track the changes of your Python environment.</p>"},{"location":"user_guides/projects/python/environment_history/#viewing-python-environment-history-in-the-ui","title":"Viewing python environment history in the UI","text":"<p>The Python environment evolves over time as libraries are installed, uninstalled, upgraded, and downgraded. To assist in tracking the changes in the environment, you can see the environment history in the UI. You can view what changes were introduced at each point a new environment was created. Hopsworks will keep a version of a YAML file for each environment so that if you want to restore an older environment you can use it. To see the differences between environments click on the button as shown in figure 1. You will then see the difference between the environment and the previous environment it was created from.</p> <p> Figure 1: You can see the difference between the two environments by clicking on the button pointed.  </p> <p>If you had built the environment using custom commands you can go back to see what commands were run during the build as shown in figure 2. </p> <p> Figure 2:  You can see custom commands that were used to create the environment by clicking on the button pointed.  </p>"},{"location":"user_guides/projects/python/environment_history/#conclusion","title":"Conclusion","text":"<p>In this guide, you have learned how you can track the changes of your Python environment.</p>"},{"location":"user_guides/projects/python/python_env_export/","title":"How To Export Python Environment","text":""},{"location":"user_guides/projects/python/python_env_export/#introduction","title":"Introduction","text":"<p>The python environment in a project can be exported to an <code>environment.yml</code> file. It can be useful to export it and then recreate it outside of Hopsworks, or just have a snapshot of all the installed libraries and their versions.</p> <p>In this guide, you will learn how to export the python environment for a project.</p>"},{"location":"user_guides/projects/python/python_env_export/#step-1-go-to-environment","title":"Step 1: Go to environment","text":"<p>Under the <code>Project settings</code> section you can find the <code>Python libraries</code> setting.</p>"},{"location":"user_guides/projects/python/python_env_export/#step-2-click-export-env","title":"Step 2: Click Export env","text":"<p>An existing Anaconda environment can be exported as a yml file, clicking the <code>Export env</code> will download the <code>environment.yml</code> file in your browser.</p> <p> Export environment </p>"},{"location":"user_guides/projects/python/python_env_export/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to export your python environment.</p>"},{"location":"user_guides/projects/python/python_env_recreate/","title":"How To Recreate Python Environment","text":""},{"location":"user_guides/projects/python/python_env_recreate/#introduction","title":"Introduction","text":"<p>Sometimes it may be desirable to recreate the python environment to start from the same state the python environment was created with.</p> <p>In this guide, you will learn how to recreate the python environment.</p> <p>Keep in mind</p> <p>There may be Jobs or Jupyter notebooks that depend on additional libraries that have been installed. It is recommended to first export the environment to save a snapshot of all libraries currently installed and their versions.</p>"},{"location":"user_guides/projects/python/python_env_recreate/#step-1-remove-the-environment","title":"Step 1: Remove the environment","text":"<p>Under the <code>Project settings</code> section you can find the <code>Python libraries</code> setting.</p> <p>First click <code>Remove env</code>.</p> <p> Remove environment </p>"},{"location":"user_guides/projects/python/python_env_recreate/#step-2-create-new-environment","title":"Step 2: Create new environment","text":"<p>After removing the environment, simply recreate it by clicking <code>Create Environment</code>.</p> <p> Create environment </p>"},{"location":"user_guides/projects/python/python_env_recreate/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to recreate your python environment.</p>"},{"location":"user_guides/projects/python/python_install/","title":"How To Install Python Libraries","text":""},{"location":"user_guides/projects/python/python_install/#introduction","title":"Introduction","text":"<p>The prepackaged python environment in Hopsworks contains a large number of libraries for data engineering, machine learning and more general data science development. But in some cases users want to install additional packages for their applications.</p> <p>In this guide, you will learn how to install Python packages using these different options.</p> <ul> <li>PyPi, using pip package manager</li> <li>A conda channel, using conda package manager</li> <li>Packages saved in certain file formats, currently we support .whl or .egg</li> <li>A public or private git repository</li> <li>A requirements.txt file to install multiple libraries at the same time using pip</li> <li>An environment.yml file to install multiple libraries at the same time using conda and pip</li> </ul> <p>Under the <code>Project settings</code> section you can find the <code>Python libraries</code> setting.</p> <p>Notice</p> <p>If your libraries require installing some extra OS-Level packages, refer to the guide custom commands guide on how to install OS-Level packages.</p>"},{"location":"user_guides/projects/python/python_install/#name-and-version","title":"Name and version","text":"<p>Enter the name and, optionally, the desired version to install.</p> <p> Installing library by name and version </p>"},{"location":"user_guides/projects/python/python_install/#search","title":"Search","text":"<p>Enter the search term and select a library and version to install.</p> <p> Installing library using search </p>"},{"location":"user_guides/projects/python/python_install/#distribution-whl-egg","title":"Distribution (.whl, .egg..)","text":"<p>Install a python package by uploading the corresponding package file and selecting it in the file browser.</p> <p> Installing library from file </p>"},{"location":"user_guides/projects/python/python_install/#git-source","title":"Git source","text":"<p>To install from a git repository simply provide the repository URL. The URL you should provide is the same as you would enter on the command line using <code>pip install git+{repo_url}</code>. In the case of a private git repository, also select whether it is a GitHub or GitLab repository and the preconfigured access token for the repository.</p> <p>Note: If you are installing from a git repository which is not GitHub or GitLab simply supply the access token in the URL. Keep in mind that in this case the access token may be visible in logs for other users in the same project to see.</p> <p> Installing library from git repo </p>"},{"location":"user_guides/projects/python/python_install/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to install python libraries. Now you can use the library in a Jupyter notebook or a Job.</p>"},{"location":"user_guides/projects/secrets/create_secret/","title":"How To Create A Secret","text":""},{"location":"user_guides/projects/secrets/create_secret/#introduction","title":"Introduction","text":"<p>A Secret is a key-value pair used to store encrypted information accessible only to the owner of the secret.  Also if you wish to, you can share the same secret API key with all the members of a Project.</p>"},{"location":"user_guides/projects/secrets/create_secret/#ui","title":"UI","text":""},{"location":"user_guides/projects/secrets/create_secret/#step-1-navigate-to-secrets","title":"Step 1: Navigate to Secrets","text":"<p>In the <code>Account Settings</code> page you can find the <code>Secrets</code> section showing a list of all secrets.</p> <p> List of secrets </p>"},{"location":"user_guides/projects/secrets/create_secret/#step-2-create-a-secret","title":"Step 2: Create a Secret","text":"<p>Click <code>New Secret</code> to bring up the dialog for secret creation. Enter a name for the secret to be used for lookup, and the secret value.</p> <p>If the secret should be private to this user, select <code>Private</code>, to share the secret with all members of a project select <code>Project</code> and enter the project name.</p> <p> Create new secret dialog </p>"},{"location":"user_guides/projects/secrets/create_secret/#step-3-secret-created","title":"Step 3: Secret created","text":"<p>Click <code>New Secret</code> to bring up the dialog for secret creation. Enter a name for the secret to be used for lookup, and the secret value.</p> <p>If the secret should be private to this user, select <code>Private</code>, to share the secret with all members of a project select <code>Project</code> and enter the project name.</p> <p> Secret is now created </p>"},{"location":"user_guides/projects/secrets/create_secret/#code","title":"Code","text":""},{"location":"user_guides/projects/secrets/create_secret/#step-1-get-secrets-api","title":"Step 1: Get secrets API","text":"<pre><code>import hopsworks\n\nconnection = hopsworks.connection()\n\nsecrets_api = connection.get_secrets_api()\n</code></pre>"},{"location":"user_guides/projects/secrets/create_secret/#step-2-create-secret","title":"Step 2: Create secret","text":"<pre><code>secret = secrets_api.create_secret(\"my_secret\", \"Fk3MoPlQXCQvPo\")\n</code></pre>"},{"location":"user_guides/projects/secrets/create_secret/#api-reference","title":"API Reference","text":"<p>Secrets</p>"},{"location":"user_guides/projects/secrets/create_secret/#conclusion","title":"Conclusion","text":"<p>In this guide you learned how to create a secret.</p>"}]}